================================================================================
Summary of training process:
Algorithm: FedAvg
Batch size: 20
Learing rate       : 0.005
Average Moving       : 1.0
Subset of users      : 5
Number of global rounds       : 800
Number of local rounds       : 20
Dataset       : Cifar10
Local Model       : cnn
================================================================================
---------------Running time:------------ 0
SGD
SGD
SGD
SGD
SGD
Number of users / total users: 5  /  5
Finished creating FedAvg server.
-------------Round number:  0  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
client Accurancy:  0.0
client Accurancy:  0.0
Average Global Accurancy:  0.1
Average Global Trainning Accurancy:  0.09897959183673469
Average Global Trainning Loss:  2.3055868343431123
All users are selected
model: 0 tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0., device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0056, -0.0029, -0.0004,  0.0008,  0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0., device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0056, -0.0063, -0.0039, -0.0025, -0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0., device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0010, -0.0018, -0.0036, -0.0020, -0.0012],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 25.0
model: 3 tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0., device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [4.3898e-03, 3.7597e-03, 2.1124e-03, 9.8589e-06, 8.5691e-04],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0., device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0078, 0.0072, 0.0058, 0.0037, 0.0008]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22222252 0.20750698 0.19486892 0.18905962 0.18634193]
np_weight_alpha[1] [0.2077671  0.21131285 0.199236   0.19230184 0.18938224]
np_weight_alpha[2] [0.17627986 0.19570778 0.24558294 0.20142555 0.18100393]
np_weight_alpha[3] [0.18930359 0.19230895 0.20039418 0.21120945 0.20678386]
np_weight_alpha[4] [0.18635762 0.18916103 0.19591884 0.2065347  0.2220278 ]
-------------Round number:  1  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
client Accurancy:  0.0
client Accurancy:  0.0
Average Global Accurancy:  0.1
Average Global Trainning Accurancy:  0.1
Average Global Trainning Loss:  2.2971872342687076
All users are selected
model: 0 tensor([0.2222, 0.2075, 0.1949, 0.1891, 0.1863], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0173,  0.0055, -0.0045, -0.0092, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2078, 0.2113, 0.1992, 0.1923, 0.1894], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0018,  0.0046, -0.0051, -0.0105, -0.0128],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1763, 0.1957, 0.2456, 0.2014, 0.1810], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0255, -0.0070,  0.0410, -0.0014, -0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1893, 0.1923, 0.2004, 0.2112, 0.2068], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0069, -0.0044,  0.0019,  0.0105,  0.0070],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1864, 0.1892, 0.1959, 0.2065, 0.2220], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047, -0.0025,  0.0029,  0.0113,  0.0237]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.14088334 0.17565021 0.21179506 0.23131688 0.24035454]
np_weight_alpha[1] [0.17662792 0.1675602  0.20121384 0.22227427 0.23232384]
np_weight_alpha[2] [0.19902748 0.19995564 0.20178284 0.20005831 0.19917573]
np_weight_alpha[3] [0.23276193 0.22232032 0.1973927  0.16806823 0.17945687]
np_weight_alpha[4] [0.24045843 0.23103118 0.20862152 0.17849036 0.14139852]
-------------Round number:  2  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.25793650793650796
client Accurancy:  0.0
client Accurancy:  0.0
client Accurancy:  0.0
Average Global Accurancy:  0.1007936507936508
Average Global Trainning Accurancy:  0.09965986394557823
Average Global Trainning Loss:  2.2917342620642005
All users are selected
model: 0 tensor([0.1409, 0.1757, 0.2118, 0.2313, 0.2404], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0342, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0621, -0.0246,  0.0133,  0.0335,  0.0433],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1766, 0.1676, 0.2012, 0.2223, 0.2323], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0296, -0.0397, -0.0040,  0.0181,  0.0287],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1990, 0.2000, 0.2018, 0.2001, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.4045e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0046, -0.0043, -0.0043, -0.0041, -0.0045],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.2328, 0.2223, 0.1974, 0.1681, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0359,  0.0250, -0.0008, -0.0323, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.2405, 0.2310, 0.2086, 0.1785, 0.1414], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0329, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0502,  0.0402,  0.0168, -0.0148, -0.0549]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2036578  0.20090781 0.19922067 0.19846685 0.19774693]
np_weight_alpha[1] [0.20093155 0.20194507 0.19989087 0.19892001 0.19831252]
np_weight_alpha[2] [0.20021991 0.19963428 0.20138875 0.1989147  0.19984233]
np_weight_alpha[3] [0.1984485  0.19891866 0.19983728 0.20196569 0.20082983]
np_weight_alpha[4] [0.19775625 0.19833249 0.19927098 0.20079763 0.20384267]
-------------Round number:  3  -------------
client Accurancy:  0.15476190476190477
client Accurancy:  0.30158730158730157
client Accurancy:  0.17063492063492064
client Accurancy:  0.17857142857142858
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.19444444444444445
Average Global Trainning Accurancy:  0.20068027210884354
Average Global Trainning Loss:  2.2828817562181123
All users are selected
model: 0 tensor([0.2037, 0.2009, 0.1992, 0.1985, 0.1977], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0008, 0.0008, 0.0016, 0.0021, 0.0020],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 25.0
model: 1 tensor([0.2009, 0.2019, 0.1999, 0.1989, 0.1983], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(4.3385e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0062, -0.0059, -0.0056, -0.0051, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2002, 0.1996, 0.2014, 0.1989, 0.1998], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(1.6567e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0045, -0.0059, -0.0060, -0.0069, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1984, 0.1989, 0.1998, 0.2020, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(4.0778e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010,  0.0009,  0.0001,  0.0002, -0.0001],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 25.0
model: 4 tensor([0.1978, 0.1983, 0.1993, 0.2008, 0.2038], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0099, 0.0099, 0.0094, 0.0088, 0.0089]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.21999066 0.21782729 0.19454835 0.1829032  0.18473047]
np_weight_alpha[1] [0.20419148 0.20357902 0.19984809 0.19654995 0.19583149]
np_weight_alpha[2] [0.19441591 0.20086078 0.20293804 0.20493957 0.1968457 ]
np_weight_alpha[3] [0.18350308 0.18714502 0.20641614 0.20819372 0.21474205]
np_weight_alpha[4] [0.19512455 0.19574188 0.1990909  0.20369367 0.20634891]
-------------Round number:  4  -------------
client Accurancy:  0.051587301587301584
client Accurancy:  0.2896825396825397
client Accurancy:  0.25
client Accurancy:  0.23809523809523808
client Accurancy:  0.24206349206349206
Average Global Accurancy:  0.21428571428571427
Average Global Trainning Accurancy:  0.2108843537414966
Average Global Trainning Loss:  2.2754916028911563
All users are selected
model: 0 tensor([0.2200, 0.2178, 0.1945, 0.1829, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0176,  0.0185, -0.0023, -0.0127, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2042, 0.2036, 0.1998, 0.1965, 0.1958], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0038, -0.0051, -0.0065, -0.0082, -0.0084],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1944, 0.2009, 0.2029, 0.2049, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0110, -0.0055, -0.0052, -0.0016, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1835, 0.1871, 0.2064, 0.2082, 0.2147], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0112,  0.0063,  0.0058,  0.0134],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1951, 0.1957, 0.1991, 0.2037, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0088, 0.0086, 0.0106, 0.0129, 0.0126]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20455949 0.2015031  0.19898953 0.19774404 0.19720387]
np_weight_alpha[1] [0.1913854  0.19705063 0.2003351  0.20543939 0.20578955]
np_weight_alpha[2] [0.217776   0.19604778 0.19660291 0.18123044 0.20834288]
np_weight_alpha[3] [0.19777988 0.19839996 0.20008141 0.20238109 0.20135765]
np_weight_alpha[4] [0.19707361 0.19780938 0.19917877 0.20146175 0.2044765 ]
-------------Round number:  5  -------------
client Accurancy:  0.007936507936507936
client Accurancy:  0.25396825396825395
client Accurancy:  0.25396825396825395
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.20317460317460317
Average Global Trainning Accurancy:  0.20136054421768707
Average Global Trainning Loss:  2.2690670506483843
All users are selected
model: 0 tensor([0.2046, 0.2015, 0.1990, 0.1977, 0.1972], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0028, 0.0028, 0.0022, 0.0022, 0.0026],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1914, 0.1971, 0.2003, 0.2054, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0007, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0171, -0.0123, -0.0068, -0.0004,  0.0007],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2178, 0.1960, 0.1966, 0.1812, 0.2083], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0108, -0.0116, -0.0128, -0.0264,  0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1978, 0.1984, 0.2001, 0.2024, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(7.5042e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004, -0.0004,  0.0002,  0.0001,  0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 125.0
model: 4 tensor([0.1971, 0.1978, 0.1992, 0.2015, 0.2045], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0120, 0.0119, 0.0120, 0.0124, 0.0121]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20307249 0.19998406 0.20054233 0.19951583 0.19688518]
np_weight_alpha[1] [0.24284235 0.22172976 0.19634181 0.1717837  0.16730237]
np_weight_alpha[2] [0.19921318 0.19992317 0.20171514 0.19986936 0.19927911]
np_weight_alpha[3] [0.23866406 0.24123383 0.16670145 0.1800277  0.17337303]
np_weight_alpha[4] [0.19714044 0.19798103 0.19924206 0.20112684 0.20450969]
-------------Round number:  6  -------------
client Accurancy:  0.0
client Accurancy:  0.25396825396825395
client Accurancy:  0.25396825396825395
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.2015873015873016
Average Global Trainning Accurancy:  0.20034013605442177
Average Global Trainning Loss:  2.2621791294642857
All users are selected
model: 0 tensor([0.2031, 0.2000, 0.2005, 0.1995, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(9.8355e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0029, 0.0021, 0.0055, 0.0053, 0.0036],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2428, 0.2217, 0.1963, 0.1718, 0.1673], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0340,  0.0119, -0.0110, -0.0343, -0.0380],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1992, 0.1999, 0.2017, 0.1999, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.0517e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0091, -0.0093, -0.0095, -0.0093],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.2387, 0.2412, 0.1667, 0.1800, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0401,  0.0423, -0.0343, -0.0230, -0.0291],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1971, 0.1980, 0.1992, 0.2011, 0.2045], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0143, 0.0148, 0.0142, 0.0141, 0.0140]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2081923  0.20875162 0.19246984 0.1925298  0.19805646]
np_weight_alpha[1] [0.20137228 0.20236291 0.19983175 0.1986464  0.19778669]
np_weight_alpha[2] [0.19778971 0.1992961  0.202      0.20119883 0.19971538]
np_weight_alpha[3] [0.19772883 0.19815171 0.20022306 0.20223096 0.20166549]
np_weight_alpha[4] [0.19714908 0.19743074 0.19934705 0.20128359 0.20478952]
-------------Round number:  7  -------------
client Accurancy:  0.0
client Accurancy:  0.25396825396825395
client Accurancy:  0.25396825396825395
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.2015873015873016
Average Global Trainning Accurancy:  0.20068027210884354
Average Global Trainning Loss:  2.2554488201530614
All users are selected
model: 0 tensor([0.2082, 0.2088, 0.1925, 0.1925, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0078,  0.0114, -0.0024, -0.0012,  0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2014, 0.2024, 0.1998, 0.1986, 0.1978], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(7.1129e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0088, -0.0089, -0.0085, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1978, 0.1993, 0.2020, 0.2012, 0.1997], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(5.4495e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115, -0.0110, -0.0101, -0.0092, -0.0098],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1977, 0.1982, 0.2002, 0.2022, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(8.1876e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013, -0.0014, -0.0011, -0.0013, -0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 25.0
model: 4 tensor([0.1971, 0.1974, 0.1993, 0.2013, 0.2048], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0162, 0.0158, 0.0163, 0.0160, 0.0163]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.18908712 0.17363708 0.2257139  0.21895884 0.19260302]
np_weight_alpha[1] [0.20234835 0.20230174 0.20057766 0.1972204  0.19755186]
np_weight_alpha[2] [0.19899708 0.19998734 0.20179173 0.20007822 0.19914563]
np_weight_alpha[3] [0.19959654 0.20339665 0.19682854 0.20549347 0.19468477]
np_weight_alpha[4] [0.19710535 0.1977355  0.19913828 0.20137218 0.20464869]
-------------Round number:  8  -------------
client Accurancy:  0.0
client Accurancy:  0.25
client Accurancy:  0.25793650793650796
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.2015873015873016
Average Global Trainning Accurancy:  0.20136054421768707
Average Global Trainning Loss:  2.2491353768069726
All users are selected
model: 0 tensor([0.1891, 0.1736, 0.2257, 0.2190, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0106, -0.0232,  0.0311,  0.0254,  0.0001],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2023, 0.2023, 0.2006, 0.1972, 0.1976], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0082, -0.0094, -0.0087, -0.0107, -0.0096],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1990, 0.2000, 0.2018, 0.2001, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.4762e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0118, -0.0115, -0.0115, -0.0113, -0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1996, 0.2034, 0.1968, 0.2055, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 4.0159e-05,  3.4017e-03, -4.3799e-03,  1.8827e-03, -7.8475e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1971, 0.1977, 0.1991, 0.2014, 0.2046], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0179, 0.0179, 0.0179, 0.0183, 0.0179]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20427643 0.20136218 0.19918786 0.19809338 0.1970802 ]
np_weight_alpha[1] [0.19691382 0.20262758 0.19727893 0.20435816 0.19882151]
np_weight_alpha[2] [0.19926342 0.19991761 0.20178136 0.19982263 0.199215  ]
np_weight_alpha[3] [0.19191994 0.17983525 0.21139733 0.1887643  0.22808318]
np_weight_alpha[4] [0.19716279 0.19779742 0.19919933 0.20109645 0.20474398]
-------------Round number:  9  -------------
client Accurancy:  0.0
client Accurancy:  0.25396825396825395
client Accurancy:  0.25793650793650796
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.20238095238095238
Average Global Trainning Accurancy:  0.20170068027210886
Average Global Trainning Loss:  2.242339465082908
All users are selected
model: 0 tensor([0.2043, 0.2014, 0.1992, 0.1981, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0057, 0.0056, 0.0061, 0.0064, 0.0060],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1969, 0.2026, 0.1973, 0.2044, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0096, -0.0123, -0.0036, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1993, 0.1999, 0.2018, 0.1998, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.1851e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0135, -0.0137, -0.0138, -0.0140, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1919, 0.1798, 0.2114, 0.1888, 0.2281], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0084, -0.0211,  0.0087, -0.0162,  0.0241],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1972, 0.1978, 0.1992, 0.2011, 0.2047], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0196, 0.0196, 0.0195, 0.0190, 0.0195]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20577468 0.20310675 0.19842814 0.19586685 0.19682364]
np_weight_alpha[1] [0.22152506 0.2013173  0.21013853 0.1748422  0.19217692]
np_weight_alpha[2] [0.19904087 0.19992612 0.2018276  0.20009395 0.19911142]
np_weight_alpha[3] [0.19777031 0.19836119 0.20008536 0.20237227 0.20141089]
np_weight_alpha[4] [0.19703421 0.19761495 0.19909377 0.20155586 0.20470119]
-------------Round number:  10  -------------
client Accurancy:  0.003968253968253968
client Accurancy:  0.25396825396825395
client Accurancy:  0.25793650793650796
client Accurancy:  0.24603174603174602
client Accurancy:  0.24206349206349206
Average Global Accurancy:  0.2007936507936508
Average Global Trainning Accurancy:  0.2030612244897959
Average Global Trainning Loss:  2.235789853050595
All users are selected
model: 0 tensor([0.2058, 0.2031, 0.1984, 0.1959, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0078, 0.0080, 0.0061, 0.0047, 0.0064],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2215, 0.2013, 0.2101, 0.1748, 0.1922], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0087, -0.0125, -0.0011, -0.0347, -0.0167],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1990, 0.1999, 0.2018, 0.2001, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.5320e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0148, -0.0148, -0.0148, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1978, 0.1984, 0.2001, 0.2024, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(7.6414e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0025, -0.0024, -0.0026, -0.0027, -0.0027],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1970, 0.1976, 0.1991, 0.2016, 0.2047], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0222, 0.0221, 0.0221, 0.0218]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19983362 0.19619374 0.20094159 0.20527153 0.19775945]
np_weight_alpha[1] [0.20158021 0.20255445 0.19998184 0.19827296 0.19761051]
np_weight_alpha[2] [0.1989326  0.19998841 0.20189717 0.2001011  0.19908069]
np_weight_alpha[3] [0.19755867 0.19738153 0.2001648  0.20307925 0.20181577]
np_weight_alpha[4] [0.19700293 0.19747086 0.19906183 0.201476   0.20498838]
-------------Round number:  11  -------------
client Accurancy:  0.003968253968253968
client Accurancy:  0.25396825396825395
client Accurancy:  0.26587301587301587
client Accurancy:  0.24206349206349206
client Accurancy:  0.24206349206349206
Average Global Accurancy:  0.2015873015873016
Average Global Trainning Accurancy:  0.20476190476190476
Average Global Trainning Loss:  2.2295077992134353
All users are selected
model: 0 tensor([0.1998, 0.1962, 0.2009, 0.2053, 0.1978], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0017, 0.0012, 0.0082, 0.0137, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2016, 0.2026, 0.2000, 0.1983, 0.1976], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(8.8575e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115, -0.0117, -0.0117, -0.0120, -0.0118],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1989, 0.2000, 0.2019, 0.2001, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.7970e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0010, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0163, -0.0161, -0.0161, -0.0158, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1976, 0.1974, 0.2002, 0.2031, 0.2018], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034, -0.0041, -0.0026, -0.0022, -0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1970, 0.1975, 0.1991, 0.2015, 0.2050], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0243, 0.0241, 0.0242, 0.0245, 0.0242]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22361988 0.22248009 0.1911144  0.17019328 0.19259231]
np_weight_alpha[1] [0.20139    0.20250893 0.19993302 0.19852556 0.19764252]
np_weight_alpha[2] [0.19915313 0.1999388  0.20193668 0.19983843 0.19913293]
np_weight_alpha[3] [0.19983701 0.20315658 0.19854666 0.19958426 0.19887552]
np_weight_alpha[4] [0.19695011 0.19762865 0.19911505 0.20121773 0.20508847]
-------------Round number:  12  -------------
client Accurancy:  0.023809523809523808
client Accurancy:  0.25
client Accurancy:  0.2698412698412698
client Accurancy:  0.25396825396825395
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.20714285714285716
Average Global Trainning Accurancy:  0.20918367346938777
Average Global Trainning Loss:  2.2226746851084185
All users are selected
model: 0 tensor([0.2236, 0.2225, 0.1911, 0.1702, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0269,  0.0289,  0.0004, -0.0193,  0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2014, 0.2025, 0.1999, 0.1985, 0.1976], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(7.9815e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0126, -0.0122, -0.0121, -0.0118, -0.0119],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1992, 0.1999, 0.2019, 0.1998, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(2.6248e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0010, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0186, -0.0187, -0.0189, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1998, 0.2032, 0.1985, 0.1996, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(6.7700e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013,  0.0012, -0.0054, -0.0067, -0.0065],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1970, 0.1976, 0.1991, 0.2012, 0.2051], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0266, 0.0265, 0.0263, 0.0259, 0.0261]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20490566 0.20170863 0.1988928  0.19762604 0.19686691]
np_weight_alpha[1] [0.20187536 0.20259948 0.19989541 0.19822167 0.19740812]
np_weight_alpha[2] [0.19887044 0.19990179 0.20200393 0.20015302 0.19907078]
np_weight_alpha[3] [0.18769352 0.17902769 0.2061909  0.21448514 0.2126028 ]
np_weight_alpha[4] [0.19668882 0.19739544 0.19904864 0.20159249 0.20527461]
-------------Round number:  13  -------------
client Accurancy:  0.03571428571428571
client Accurancy:  0.25396825396825395
client Accurancy:  0.2777777777777778
client Accurancy:  0.25396825396825395
client Accurancy:  0.23412698412698413
Average Global Accurancy:  0.2111111111111111
Average Global Trainning Accurancy:  0.21496598639455783
Average Global Trainning Loss:  2.2161297233737245
All users are selected
model: 0 tensor([0.2049, 0.2017, 0.1989, 0.1976, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0086, 0.0086, 0.0087, 0.0089, 0.0088],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2019, 0.2026, 0.1999, 0.1982, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0144, -0.0147, -0.0146, -0.0142, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1989, 0.1999, 0.2020, 0.2002, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(3.0941e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0010, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0204, -0.0206, -0.0205, -0.0203, -0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1877, 0.1790, 0.2062, 0.2145, 0.2126], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0138, -0.0230,  0.0023,  0.0079,  0.0072],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1967, 0.1974, 0.1990, 0.2016, 0.2053], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0295, 0.0297, 0.0298, 0.0296, 0.0296]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20559742 0.20230028 0.19891839 0.1966688  0.19651507]
np_weight_alpha[1] [0.20182717 0.20280354 0.20005935 0.19798896 0.19732094]
np_weight_alpha[2] [0.19890429 0.20006788 0.2020998  0.20005481 0.19887328]
np_weight_alpha[3] [0.1975984  0.19811487 0.2000391  0.20273538 0.20151223]
np_weight_alpha[4] [0.19679888 0.19730833 0.19885305 0.20165287 0.20538689]
-------------Round number:  14  -------------
client Accurancy:  0.05952380952380952
client Accurancy:  0.25
client Accurancy:  0.2896825396825397
client Accurancy:  0.2698412698412698
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.21825396825396826
Average Global Trainning Accurancy:  0.2217687074829932
Average Global Trainning Loss:  2.2095947265625
All users are selected
model: 0 tensor([0.2056, 0.2023, 0.1989, 0.1967, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0088, 0.0089, 0.0081, 0.0071, 0.0081],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2018, 0.2028, 0.2001, 0.1980, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0146, -0.0149, -0.0148, -0.0153, -0.0149],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1989, 0.2001, 0.2021, 0.2001, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(3.4434e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0218, -0.0216, -0.0218, -0.0215, -0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1976, 0.1981, 0.2000, 0.2027, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(9.5460e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0045, -0.0046, -0.0041, -0.0042, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1968, 0.1973, 0.1989, 0.2017, 0.2054], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0327, 0.0326, 0.0330, 0.0324]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2024556  0.19859391 0.19951494 0.2023075  0.19712806]
np_weight_alpha[1] [0.20155936 0.20277698 0.1999625  0.19836003 0.1973412 ]
np_weight_alpha[2] [0.19903871 0.19996908 0.20218116 0.19984233 0.19896866]
np_weight_alpha[3] [0.19857033 0.19935262 0.19907023 0.20217273 0.20083408]
np_weight_alpha[4] [0.19662982 0.19732215 0.19894528 0.20135674 0.20574602]
-------------Round number:  15  -------------
client Accurancy:  0.0873015873015873
client Accurancy:  0.25
client Accurancy:  0.29365079365079366
client Accurancy:  0.26587301587301587
client Accurancy:  0.1984126984126984
Average Global Accurancy:  0.21904761904761905
Average Global Trainning Accurancy:  0.23265306122448978
Average Global Trainning Loss:  2.2026991656037413
All users are selected
model: 0 tensor([0.2025, 0.1986, 0.1995, 0.2023, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0075, 0.0068, 0.0110, 0.0153, 0.0109],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2016, 0.2028, 0.2000, 0.1984, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(9.9517e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0162, -0.0160, -0.0156, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1990, 0.2000, 0.2022, 0.1998, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(3.3855e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0249, -0.0250, -0.0251, -0.0247],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1986, 0.1994, 0.1991, 0.2022, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(4.3720e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0036, -0.0034, -0.0059, -0.0054, -0.0057],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1966, 0.1973, 0.1989, 0.2014, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0354, 0.0356, 0.0354, 0.0349, 0.0351]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20535511 0.20205228 0.19876455 0.19732788 0.19650024]
np_weight_alpha[1] [0.20204271 0.2030257  0.19996092 0.19797678 0.19699387]
np_weight_alpha[2] [0.19879045 0.19996965 0.20229654 0.20011887 0.19882442]
np_weight_alpha[3] [0.19252111 0.19250123 0.20429282 0.205181   0.20550385]
np_weight_alpha[4] [0.19652548 0.19697964 0.19879766 0.20173782 0.20595941]
-------------Round number:  16  -------------
client Accurancy:  0.11904761904761904
client Accurancy:  0.2777777777777778
client Accurancy:  0.31746031746031744
client Accurancy:  0.2857142857142857
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.23333333333333334
Average Global Trainning Accurancy:  0.23843537414965987
Average Global Trainning Loss:  2.195561124840561
All users are selected
model: 0 tensor([0.2054, 0.2021, 0.1988, 0.1973, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0101, 0.0103, 0.0104, 0.0105, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2020, 0.2030, 0.2000, 0.1980, 0.1970], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0016, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0194, -0.0195, -0.0195, -0.0191, -0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1988, 0.2000, 0.2023, 0.2001, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(4.0671e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0270, -0.0272, -0.0272, -0.0270, -0.0269],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1925, 0.1925, 0.2043, 0.2052, 0.2055], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-8.9440e-03, -9.5113e-03,  5.3092e-05, -2.0354e-03, -4.9836e-04],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1965, 0.1970, 0.1988, 0.2017, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0403, 0.0403, 0.0403, 0.0400, 0.0398]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2056571  0.20207503 0.19867584 0.19720434 0.19638765]
np_weight_alpha[1] [0.20208998 0.20323324 0.20009956 0.19777803 0.1967992 ]
np_weight_alpha[2] [0.19870083 0.20011014 0.20247975 0.20005836 0.1986509 ]
np_weight_alpha[3] [0.2163803  0.21944955 0.18327166 0.19395408 0.18694437]
np_weight_alpha[4] [0.19638193 0.19678047 0.19862245 0.20184681 0.20636828]
-------------Round number:  17  -------------
client Accurancy:  0.17063492063492064
client Accurancy:  0.2619047619047619
client Accurancy:  0.3134920634920635
client Accurancy:  0.2857142857142857
client Accurancy:  0.11904761904761904
Average Global Accurancy:  0.23015873015873015
Average Global Trainning Accurancy:  0.23809523809523808
Average Global Trainning Loss:  2.188502637383078
All users are selected
model: 0 tensor([0.2057, 0.2021, 0.1987, 0.1972, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0082, 0.0084, 0.0080, 0.0077, 0.0085],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2021, 0.2032, 0.2001, 0.1978, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0016, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0195, -0.0198, -0.0197, -0.0202, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1987, 0.2001, 0.2025, 0.2001, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(4.8363e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0291, -0.0288, -0.0291, -0.0287, -0.0290],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2164, 0.2194, 0.1833, 0.1940, 0.1869], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0145,  0.0169, -0.0211, -0.0135, -0.0193],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1964, 0.1968, 0.1986, 0.2018, 0.2064], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0458, 0.0455, 0.0453, 0.0458, 0.0448]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20569925 0.20076062 0.19945492 0.19946878 0.19461639]
np_weight_alpha[1] [0.20181076 0.20324525 0.19998777 0.1982015  0.19675477]
np_weight_alpha[2] [0.19883606 0.19999664 0.2026636  0.19978052 0.19872321]
np_weight_alpha[3] [0.19742236 0.19803572 0.19982027 0.20297351 0.20174815]
np_weight_alpha[4] [0.19602232 0.1967254  0.19868882 0.20147693 0.20708661]
-------------Round number:  18  -------------
client Accurancy:  0.1984126984126984
client Accurancy:  0.25
client Accurancy:  0.3134920634920635
client Accurancy:  0.2857142857142857
client Accurancy:  0.05952380952380952
Average Global Accurancy:  0.22142857142857142
Average Global Trainning Accurancy:  0.2282312925170068
Average Global Trainning Loss:  2.1805594308035716
All users are selected
model: 0 tensor([0.2057, 0.2008, 0.1995, 0.1995, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0097, 0.0086, 0.0114, 0.0131, 0.0094],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2018, 0.2032, 0.2000, 0.1982, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0019, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0231, -0.0228, -0.0224, -0.0216, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1988, 0.2000, 0.2027, 0.1998, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(5.0639e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0329, -0.0333, -0.0334, -0.0336, -0.0330],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1974, 0.1980, 0.1998, 0.2030, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047, -0.0048, -0.0057, -0.0057, -0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1960, 0.1967, 0.1987, 0.2015, 0.2071], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0509, 0.0512, 0.0508, 0.0498, 0.0501]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.20645528 0.2025741  0.1984995  0.19677518 0.19569601]
np_weight_alpha[1] [0.20259288 0.20376523 0.20000513 0.1975152  0.19612157]
np_weight_alpha[2] [0.19853586 0.20001948 0.20287815 0.20012715 0.19843939]
np_weight_alpha[3] [0.19431025 0.19547145 0.20134197 0.20488387 0.2039925 ]
np_weight_alpha[4] [0.19595455 0.19658941 0.19860159 0.20158479 0.20726962]
-------------Round number:  19  -------------
client Accurancy:  0.23809523809523808
client Accurancy:  0.25793650793650796
client Accurancy:  0.2777777777777778
client Accurancy:  0.2857142857142857
client Accurancy:  0.027777777777777776
Average Global Accurancy:  0.21746031746031746
Average Global Trainning Accurancy:  0.21462585034013607
Average Global Trainning Loss:  2.1723021630527213
All users are selected
model: 0 tensor([0.2065, 0.2026, 0.1985, 0.1968, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0100, 0.0103, 0.0106, 0.0107, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2026, 0.2038, 0.2000, 0.1975, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0283, -0.0287, -0.0284, -0.0278, -0.0276],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1985, 0.2000, 0.2029, 0.2001, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(6.4397e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0016, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0367, -0.0371, -0.0372, -0.0368, -0.0365],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1943, 0.1955, 0.2013, 0.2049, 0.2040], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0019, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060, -0.0055, -0.0025, -0.0027, -0.0022],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1960, 0.1966, 0.1986, 0.2016, 0.2073], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0004, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0588, 0.0593, 0.0588, 0.0574, 0.0571]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.20700505 0.20272183 0.19832115 0.19652475 0.19542728]
np_weight_alpha[1] [0.20274311 0.20426996 0.20022526 0.19715728 0.19560441]
np_weight_alpha[2] [0.19835952 0.20024414 0.20325139 0.20002644 0.1981185 ]
np_weight_alpha[3] [0.20567888 0.20406595 0.19481197 0.19940923 0.19603395]
np_weight_alpha[4] [0.19584352 0.19637401 0.19846474 0.2017178  0.20759997]
-------------Round number:  20  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25396825396825395
client Accurancy:  0.2777777777777778
client Accurancy:  0.003968253968253968
Average Global Accurancy:  0.20714285714285716
Average Global Trainning Accurancy:  0.2054421768707483
Average Global Trainning Loss:  2.1636433088860545
All users are selected
model: 0 tensor([0.2070, 0.2027, 0.1983, 0.1965, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0059, 0.0063, 0.0061, 0.0060, 0.0071],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2027, 0.2043, 0.2002, 0.1972, 0.1956], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0290, -0.0294, -0.0290, -0.0294, -0.0288],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1984, 0.2002, 0.2033, 0.2000, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(8.4315e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0398, -0.0395, -0.0401, -0.0393, -0.0396],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2057, 0.2041, 0.1948, 0.1994, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0045,  0.0022, -0.0094, -0.0091, -0.0108],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1958, 0.1964, 0.1985, 0.2017, 0.2076], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0687, 0.0686, 0.0679, 0.0669, 0.0652]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.20905775 0.2024704  0.19923498 0.19763021 0.19160672]
np_weight_alpha[1] [0.20267166 0.20455569 0.2000651  0.19740728 0.1953003 ]
np_weight_alpha[2] [0.1985159  0.20008457 0.203674   0.19966623 0.1980593 ]
np_weight_alpha[3] [0.16243456 0.17073067 0.2179918  0.22143176 0.22741123]
np_weight_alpha[4] [0.19559684 0.19613545 0.19833751 0.20177634 0.20815386]
-------------Round number:  21  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.26587301587301587
client Accurancy:  0.003968253968253968
Average Global Accurancy:  0.20396825396825397
Average Global Trainning Accurancy:  0.20136054421768707
Average Global Trainning Loss:  2.153310015412415
All users are selected
model: 0 tensor([0.2091, 0.2025, 0.1992, 0.1976, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0091, 0.0076, 0.0102, 0.0117, 0.0068],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2027, 0.2046, 0.2001, 0.1974, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0358, -0.0355, -0.0346, -0.0330, -0.0332],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1985, 0.2001, 0.2037, 0.1997, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(9.7928e-05, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0463, -0.0469, -0.0472, -0.0471, -0.0461],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1624, 0.1707, 0.2180, 0.2214, 0.2274], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0391, -0.0317,  0.0121,  0.0107,  0.0186],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1956, 0.1961, 0.1983, 0.2018, 0.2082], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0784, 0.0788, 0.0776, 0.0749, 0.0737]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2088854  0.21012451 0.19331989 0.1848319  0.20283836]
np_weight_alpha[1] [0.20401455 0.20569412 0.20018035 0.19600943 0.19410159]
np_weight_alpha[2] [0.19807972 0.20021597 0.20423122 0.20006019 0.19741294]
np_weight_alpha[3] [0.19569373 0.19652495 0.19997016 0.20489803 0.20291309]
np_weight_alpha[4] [0.19523928 0.19570266 0.19809741 0.20208861 0.20887205]
-------------Round number:  22  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.142624129730017
All users are selected
model: 0 tensor([0.2089, 0.2101, 0.1933, 0.1848, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0083,  0.0152,  0.0052, -0.0006,  0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2040, 0.2057, 0.2002, 0.1960, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0446, -0.0453, -0.0446, -0.0438, -0.0428],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1981, 0.2002, 0.2042, 0.2001, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0001, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0530, -0.0539, -0.0544, -0.0534, -0.0529],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1957, 0.1965, 0.2000, 0.2049, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0016, -0.0016, -0.0025, -0.0035, -0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1952, 0.1957, 0.1981, 0.2021, 0.2089], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0006, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0925, 0.0934, 0.0917, 0.0885, 0.0858]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.21286613 0.18051867 0.2131699  0.23571979 0.1577255 ]
np_weight_alpha[1] [0.20439963 0.20676827 0.20052528 0.19552918 0.19277763]
np_weight_alpha[2] [0.19796976 0.20027605 0.20444626 0.2000163  0.19729166]
np_weight_alpha[3] [0.19112174 0.19162683 0.19956075 0.20971087 0.20797981]
np_weight_alpha[4] [0.1948139  0.19507912 0.19776817 0.20239556 0.20994322]
-------------Round number:  23  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.1303309018920067
All users are selected
model: 0 tensor([0.2129, 0.1805, 0.2132, 0.2357, 0.1577], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0053, -0.0203,  0.0195,  0.0453, -0.0298],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2044, 0.2068, 0.2005, 0.1955, 0.1928], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0007, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0470, -0.0478, -0.0466, -0.0464, -0.0456],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1980, 0.2003, 0.2044, 0.2000, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0579, -0.0581, -0.0597, -0.0572, -0.0570],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1911, 0.1916, 0.1996, 0.2097, 0.2080], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0078, -0.0079, -0.0040, -0.0012, -0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1948, 0.1951, 0.1978, 0.2024, 0.2099], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0008, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1121, 0.1118, 0.1099, 0.1067, 0.1017]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.21180987 0.20470941 0.19756262 0.1943401  0.19157797]
np_weight_alpha[1] [0.20467818 0.20794281 0.20032233 0.19522095 0.19183578]
np_weight_alpha[2] [0.19794212 0.20028703 0.20482364 0.19985215 0.19709508]
np_weight_alpha[3] [0.20923604 0.21035063 0.19810164 0.19428612 0.18802558]
np_weight_alpha[4] [0.19406547 0.1943736  0.19738466 0.20266284 0.21151349]
-------------Round number:  24  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.1162429913371597
All users are selected
model: 0 tensor([0.2118, 0.2047, 0.1976, 0.1943, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0038, 0.0047, 0.0081, 0.0089, 0.0092],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2047, 0.2079, 0.2003, 0.1952, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0009, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0586, -0.0584, -0.0564, -0.0548, -0.0535],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1979, 0.2003, 0.2048, 0.1999, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0691, -0.0708, -0.0737, -0.0710, -0.0688],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2092, 0.2104, 0.1981, 0.1943, 0.1880], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0019, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0148,  0.0146, -0.0047, -0.0168, -0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1941, 0.1944, 0.1974, 0.2027, 0.2115], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1308, 0.1314, 0.1281, 0.1230, 0.1165]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.22837658 0.21547489 0.19110452 0.18451731 0.1805268 ]
np_weight_alpha[1] [0.20509294 0.20842956 0.20022917 0.19488806 0.19136022]
np_weight_alpha[2] [0.19762366 0.2002777  0.2054707  0.19990204 0.1967259 ]
np_weight_alpha[3] [0.19185935 0.19320597 0.20008886 0.20851259 0.20633322]
np_weight_alpha[4] [0.19307135 0.19324687 0.19682898 0.2031422  0.21371056]
-------------Round number:  25  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.099344474117772
All users are selected
model: 0 tensor([0.2284, 0.2155, 0.1911, 0.1845, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0164,  0.0134,  0.0023,  0.0012, -0.0004],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2051, 0.2084, 0.2002, 0.1949, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0010, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0774, -0.0780, -0.0741, -0.0694, -0.0674],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1976, 0.2003, 0.2055, 0.1999, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0002, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0792, -0.0823, -0.0860, -0.0815, -0.0785],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1919, 0.1932, 0.2001, 0.2085, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0011, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0030,  0.0028,  0.0008, -0.0023, -0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1931, 0.1932, 0.1968, 0.2031, 0.2137], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1559, 0.1573, 0.1526, 0.1444, 0.1373]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.1798367  0.18175988 0.21229854 0.21092016 0.2151847 ]
np_weight_alpha[1] [0.20587882 0.20947604 0.2002672  0.19407411 0.19030382]
np_weight_alpha[2] [0.19715567 0.20040245 0.20644556 0.19986896 0.19612736]
np_weight_alpha[3] [0.1802341  0.18264422 0.19841431 0.22378653 0.21492083]
np_weight_alpha[4] [0.1917491  0.19164456 0.19602685 0.20398647 0.21659312]
-------------Round number:  26  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.084182344812925
All users are selected
model: 0 tensor([0.1798, 0.1818, 0.2123, 0.2109, 0.2152], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0434, -0.0302,  0.0159,  0.0219,  0.0313],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2059, 0.2095, 0.2003, 0.1941, 0.1903], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0838, -0.0879, -0.0806, -0.0756, -0.0723],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1972, 0.2004, 0.2064, 0.1999, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0003, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0874, -0.0894, -0.0949, -0.0876, -0.0851],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1802, 0.1826, 0.1984, 0.2238, 0.2149], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0189, -0.0169, -0.0095,  0.0011, -0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1917, 0.1916, 0.1960, 0.2040, 0.2166], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1790, 0.1811, 0.1755, 0.1674, 0.1565]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2230433  0.21077889 0.1950322  0.18797791 0.18316777]
np_weight_alpha[1] [0.20657742 0.21117225 0.20021768 0.19313122 0.18890144]
np_weight_alpha[2] [0.19682963 0.20045318 0.20775765 0.1995762  0.19538331]
np_weight_alpha[3] [0.2294428  0.22066936 0.19864845 0.17310031 0.1781391 ]
np_weight_alpha[4] [0.19025688 0.18976328 0.19504014 0.2046235  0.22031617]
-------------Round number:  27  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.0666454081632653
All users are selected
model: 0 tensor([0.2230, 0.2108, 0.1950, 0.1880, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0015, 0.0056, 0.0116, 0.0122, 0.0129],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2066, 0.2112, 0.2002, 0.1931, 0.1889], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0961, -0.0981, -0.0882, -0.0822, -0.0772],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1968, 0.2005, 0.2078, 0.1996, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0005, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0963, -0.1005, -0.1091, -0.1021, -0.0970],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2294, 0.2207, 0.1986, 0.1731, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0460,  0.0339, -0.0041, -0.0474, -0.0386],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1903, 0.1898, 0.1950, 0.2046, 0.2203], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2033, 0.2036, 0.1952, 0.1844, 0.1708]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.26439366 0.22458774 0.17860152 0.16966838 0.16274872]
np_weight_alpha[1] [0.20805211 0.21329944 0.19993994 0.19183566 0.1868729 ]
np_weight_alpha[2] [0.19586593 0.20029564 0.2095314  0.19972527 0.19458173]
np_weight_alpha[3] [0.18170239 0.18476854 0.20015463 0.21874374 0.21463074]
np_weight_alpha[4] [0.18777339 0.18726744 0.19389382 0.20561488 0.22545043]
-------------Round number:  28  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.04465714019983
All users are selected
model: 0 tensor([0.2644, 0.2246, 0.1786, 0.1697, 0.1627], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0376, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0329,  0.0145, -0.0040, -0.0003, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2081, 0.2133, 0.1999, 0.1918, 0.1869], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1156, -0.1163, -0.1043, -0.0924, -0.0886],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1959, 0.2003, 0.2095, 0.1997, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0007, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1008, -0.1075, -0.1171, -0.1077, -0.1018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1817, 0.1848, 0.2002, 0.2187, 0.2146], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0016, -0.0040, -0.0076, -0.0140, -0.0094],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1878, 0.1873, 0.1939, 0.2056, 0.2255], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2284, 0.2280, 0.2172, 0.2008, 0.1894]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24135111 0.21680512 0.1890171  0.17742242 0.17540424]
np_weight_alpha[1] [0.21037419 0.21611871 0.19975327 0.18955185 0.18420196]
np_weight_alpha[2] [0.1946007  0.20029314 0.21178904 0.19976445 0.1935527 ]
np_weight_alpha[3] [0.15553144 0.16796556 0.19811635 0.25540343 0.22298321]
np_weight_alpha[4] [0.1845031  0.18412398 0.1923809  0.2073751  0.23161691]
-------------Round number:  29  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.027150596566752
All users are selected
model: 0 tensor([0.2414, 0.2168, 0.1890, 0.1774, 0.1754], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0012,  0.0018,  0.0043,  0.0088,  0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2104, 0.2161, 0.1998, 0.1896, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1141, -0.1189, -0.1028, -0.0922, -0.0870],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1946, 0.2003, 0.2118, 0.1998, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0010, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0963, -0.1002, -0.1128, -0.0993, -0.0965],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1555, 0.1680, 0.1981, 0.2554, 0.2230], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0330, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0489, -0.0413, -0.0276, -0.0014, -0.0196],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1845, 0.1841, 0.1924, 0.2074, 0.2316], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0275, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2410, 0.2384, 0.2259, 0.2116, 0.1961]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.28118572 0.23048842 0.18838738 0.1588893  0.14104916]
np_weight_alpha[1] [0.21243565 0.21968043 0.19918819 0.18728514 0.18141064]
np_weight_alpha[2] [0.19360709 0.19998986 0.21449637 0.19926652 0.19264016]
np_weight_alpha[3] [0.17710412 0.18147564 0.19698893 0.23012716 0.2143042 ]
np_weight_alpha[4] [0.18067646 0.1807879  0.1907844  0.2085912  0.23916   ]
-------------Round number:  30  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.0
Average Global Accurancy:  0.2
Average Global Trainning Accurancy:  0.2
Average Global Trainning Loss:  2.00874787414966
All users are selected
model: 0 tensor([0.2812, 0.2305, 0.1884, 0.1589, 0.1410], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0641, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0462, 0.0314, 0.0261, 0.0147, 0.0023],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2124, 0.2197, 0.1992, 0.1873, 0.1814], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1166, -0.1191, -0.1006, -0.0887, -0.0825],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1936, 0.2000, 0.2145, 0.1993, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0937, -0.0996, -0.1137, -0.1034, -0.0969],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1771, 0.1815, 0.1970, 0.2301, 0.2143], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0216, -0.0273, -0.0376, -0.0395, -0.0415],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1807, 0.1808, 0.1908, 0.2086, 0.2392], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0325, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2431, 0.2372, 0.2217, 0.2041, 0.1884]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.26427165 0.22080803 0.18374392 0.16785048 0.16332592]
np_weight_alpha[1] [0.21525693 0.22374882 0.19825779 0.18459086 0.17814563]
np_weight_alpha[2] [0.19200966 0.19941239 0.21745269 0.19943933 0.19168594]
np_weight_alpha[3] [0.16653286 0.17516947 0.19928782 0.23745061 0.2215593 ]
np_weight_alpha[4] [0.1756972  0.17683686 0.18881007 0.21005017 0.24860571]
-------------Round number:  31  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25396825396825395
client Accurancy:  0.0
Average Global Accurancy:  0.2007936507936508
Average Global Trainning Accurancy:  0.20034013605442177
Average Global Trainning Loss:  1.991991191007653
All users are selected
model: 0 tensor([0.2643, 0.2208, 0.1837, 0.1679, 0.1633], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0360, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0304, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0218, 0.0168, 0.0254, 0.0353, 0.0342],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2153, 0.2237, 0.1983, 0.1846, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1210, -0.1209, -0.1060, -0.0879, -0.0811],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1920, 0.1994, 0.2175, 0.1994, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0883, -0.0971, -0.1088, -0.0963, -0.0880],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1665, 0.1752, 0.1993, 0.2375, 0.2216], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0353, -0.0383, -0.0434, -0.0493, -0.0469],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1757, 0.1768, 0.1888, 0.2101, 0.2486], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0361, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2349, 0.2330, 0.2170, 0.1945, 0.1823]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.27572572 0.22751984 0.1810878  0.15918481 0.15648185]
np_weight_alpha[1] [0.21852106 0.22798282 0.1977271  0.18136129 0.17440777]
np_weight_alpha[2] [0.19046453 0.19939859 0.2207858  0.19926038 0.19009069]
np_weight_alpha[3] [0.16102728 0.170643   0.19746672 0.2462098  0.22465312]
np_weight_alpha[4] [0.17098755 0.17228407 0.18586601 0.21138382 0.25947857]
-------------Round number:  32  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.26587301587301587
client Accurancy:  0.011904761904761904
Average Global Accurancy:  0.20555555555555555
Average Global Trainning Accurancy:  0.20476190476190476
Average Global Trainning Loss:  1.9691738414115647
All users are selected
model: 0 tensor([0.2757, 0.2275, 0.1811, 0.1592, 0.1565], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0520, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0332, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0302, 0.0306, 0.0264, 0.0299, 0.0407],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2185, 0.2280, 0.1977, 0.1814, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1044, -0.1091, -0.0936, -0.0819, -0.0710],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1905, 0.1994, 0.2208, 0.1993, 0.1901], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0721, -0.0766, -0.0909, -0.0737, -0.0704],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1610, 0.1706, 0.1975, 0.2462, 0.2247], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0571, -0.0597, -0.0558, -0.0570, -0.0550],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1710, 0.1723, 0.1859, 0.2114, 0.2595], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0274, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0420, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2185, 0.2097, 0.1927, 0.1763, 0.1573]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.28566447 0.22400306 0.18136321 0.15967703 0.14929217]
np_weight_alpha[1] [0.22062896 0.2323951  0.19669247 0.17914437 0.1711392 ]
np_weight_alpha[2] [0.1894268  0.19896871 0.2246152  0.19824663 0.18874264]
np_weight_alpha[3] [0.16253144 0.1709737  0.19475195 0.24881297 0.22292992]
np_weight_alpha[4] [0.16522892 0.16777107 0.1826515  0.21094042 0.27340803]
-------------Round number:  33  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.24603174603174602
client Accurancy:  0.2777777777777778
client Accurancy:  0.047619047619047616
Average Global Accurancy:  0.21428571428571427
Average Global Trainning Accurancy:  0.21292517006802722
Average Global Trainning Loss:  1.947814858365221
All users are selected
model: 0 tensor([0.2857, 0.2240, 0.1814, 0.1597, 0.1493], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0623, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0366, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0515, 0.0480, 0.0478, 0.0539, 0.0591],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 0.2
model: 1 tensor([0.2206, 0.2324, 0.1967, 0.1791, 0.1711], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0940, -0.1019, -0.0863, -0.0755, -0.0639],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1894, 0.1990, 0.2246, 0.1982, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0655, -0.0693, -0.0803, -0.0718, -0.0617],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1625, 0.1710, 0.1948, 0.2488, 0.2229], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0538, -0.0596, -0.0643, -0.0569, -0.0579],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1652, 0.1678, 0.1827, 0.2109, 0.2734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0403, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0462, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1832, 0.1730, 0.1576, 0.1418, 0.1252]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.29705903 0.21902102 0.17699488 0.15784374 0.1490814 ]
np_weight_alpha[1] [0.22198847 0.23729956 0.19543265 0.17709224 0.1681871 ]
np_weight_alpha[2] [0.18840694 0.1983704  0.22800425 0.1981618  0.18705662]
np_weight_alpha[3] [0.16290572 0.17091133 0.19339512 0.251555   0.2212328 ]
np_weight_alpha[4] [0.15942475 0.16312891 0.17844574 0.2088261  0.29017454]
-------------Round number:  34  -------------
client Accurancy:  0.25
client Accurancy:  0.25396825396825395
client Accurancy:  0.25793650793650796
client Accurancy:  0.2976190476190476
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.24523809523809523
Average Global Trainning Accurancy:  0.24625850340136055
Average Global Trainning Loss:  1.92352751647534
All users are selected
model: 0 tensor([0.2971, 0.2190, 0.1770, 0.1578, 0.1491], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0734, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0389, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0507, 0.0328, 0.0391, 0.0534, 0.0567],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2220, 0.2373, 0.1954, 0.1771, 0.1682], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0826, -0.0795, -0.0789, -0.0614, -0.0474],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1884, 0.1984, 0.2280, 0.1982, 0.1871], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0496, -0.0600, -0.0619, -0.0568, -0.0413],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1629, 0.1709, 0.1934, 0.2516, 0.2212], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0380, -0.0496, -0.0590, -0.0506, -0.0570],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1594, 0.1631, 0.1784, 0.2088, 0.2902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0584, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0485, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1454, 0.1385, 0.1247, 0.1014, 0.0995]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.3051672  0.22594951 0.1774297  0.15009151 0.14136206]
np_weight_alpha[1] [0.22378428 0.24084798 0.19523549 0.17503951 0.16509263]
np_weight_alpha[2] [0.18730783 0.19892468 0.23115262 0.19809836 0.18451653]
np_weight_alpha[3] [0.16170217 0.17027546 0.19232823 0.25508067 0.22061343]
np_weight_alpha[4] [0.15385842 0.15781924 0.17275949 0.20584182 0.30972102]
-------------Round number:  35  -------------
client Accurancy:  0.25
client Accurancy:  0.25793650793650796
client Accurancy:  0.2857142857142857
client Accurancy:  0.2896825396825397
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.2642857142857143
Average Global Trainning Accurancy:  0.25952380952380955
Average Global Trainning Loss:  1.8927887170493198
All users are selected
model: 0 tensor([0.3052, 0.2259, 0.1774, 0.1501, 0.1414], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0909, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0396, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0456, 0.0347, 0.0296, 0.0304, 0.0446],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2238, 0.2408, 0.1952, 0.1750, 0.1651], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0627, -0.0633, -0.0617, -0.0544, -0.0399],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1873, 0.1989, 0.2312, 0.1981, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0274, -0.0319, -0.0387, -0.0296, -0.0245],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1617, 0.1703, 0.1923, 0.2551, 0.2206], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0293, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0386, -0.0483, -0.0499, -0.0408, -0.0450],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1539, 0.1578, 0.1728, 0.2058, 0.3097], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0836, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0491, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1125, 0.0972, 0.0819, 0.0714, 0.0816]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.3102795  0.22054155 0.17748097 0.15417477 0.13752326]
np_weight_alpha[1] [0.22411746 0.24421282 0.19411637 0.17419766 0.16335572]
np_weight_alpha[2] [0.18379985 0.1992244  0.24215205 0.19615589 0.17866784]
np_weight_alpha[3] [0.15799776 0.17316331 0.19486593 0.25486773 0.21910524]
np_weight_alpha[4] [0.14774895 0.15301752 0.16743329 0.19962811 0.33217213]
-------------Round number:  36  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.2619047619047619
client Accurancy:  0.3055555555555556
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.2611111111111111
Average Global Trainning Accurancy:  0.2564625850340136
Average Global Trainning Loss:  1.8679084622130102
All users are selected
model: 0 tensor([0.3103, 0.2205, 0.1775, 0.1542, 0.1375], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0955, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0402, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0536, 0.0394, 0.0335, 0.0352, 0.0444],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2241, 0.2442, 0.1941, 0.1742, 0.1634], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0484, -0.0569, -0.0519, -0.0487, -0.0404],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1838, 0.1992, 0.2422, 0.1962, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0266, -0.0230, -0.0199, -0.0323, -0.0289],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1580, 0.1732, 0.1949, 0.2549, 0.2191], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0294, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0299, -0.0360, -0.0201, -0.0267],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1477, 0.1530, 0.1674, 0.1996, 0.3322], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.1173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0447, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0726, 0.0549, 0.0434, 0.0387, 0.0801]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.3127015  0.2143438  0.1779309  0.15700886 0.13801499]
np_weight_alpha[1] [0.22132064 0.25525892 0.19385739 0.17266099 0.15690202]
np_weight_alpha[2] [0.18397185 0.19520524 0.23813327 0.20131215 0.18137753]
np_weight_alpha[3] [0.16186556 0.17387341 0.19978873 0.24917965 0.21529257]
np_weight_alpha[4] [0.14249597 0.14891352 0.16189525 0.19106016 0.35563502]
-------------Round number:  37  -------------
client Accurancy:  0.25
client Accurancy:  0.2619047619047619
client Accurancy:  0.2777777777777778
client Accurancy:  0.2976190476190476
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.2698412698412698
Average Global Trainning Accurancy:  0.2646258503401361
Average Global Trainning Loss:  1.8496861049107143
All users are selected
model: 0 tensor([0.3127, 0.2143, 0.1779, 0.1570, 0.1380], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0954, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0412, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0420, 0.0164, 0.0238, 0.0360, 0.0303],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2213, 0.2553, 0.1939, 0.1727, 0.1569], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0308, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0453, -0.0258, -0.0501, -0.0401, -0.0341],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1840, 0.1952, 0.2381, 0.2013, 0.1814], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0246, -0.0092, -0.0149, -0.0100],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1619, 0.1739, 0.1998, 0.2492, 0.2153], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0172, -0.0205, -0.0162, -0.0333],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1425, 0.1489, 0.1619, 0.1911, 0.3556], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.1584, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0387, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0417, 0.0326, 0.0204, 0.0012, 0.0944]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.3155404  0.21930696 0.17617808 0.1492581  0.13971639]
np_weight_alpha[1] [0.2263966  0.243385   0.20214984 0.17294654 0.15512203]
np_weight_alpha[2] [0.18376805 0.20426676 0.23429589 0.20053563 0.17713377]
np_weight_alpha[3] [0.15211019 0.17164774 0.19862175 0.24886857 0.22875172]
np_weight_alpha[4] [0.14089589 0.15222092 0.17264481 0.21996002 0.3142783 ]
-------------Round number:  38  -------------
client Accurancy:  0.2619047619047619
client Accurancy:  0.26587301587301587
client Accurancy:  0.31746031746031744
client Accurancy:  0.25396825396825395
client Accurancy:  0.25
Average Global Accurancy:  0.2698412698412698
Average Global Trainning Accurancy:  0.26904761904761904
Average Global Trainning Loss:  1.8478298057504252
All users are selected
model: 0 tensor([0.3155, 0.2193, 0.1762, 0.1493, 0.1397], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.1025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0385, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0280,  0.0005, -0.0012, -0.0019,  0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2264, 0.2434, 0.2021, 0.1729, 0.1551], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0368, -0.0357, -0.0345, -0.0398, -0.0383],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1838, 0.2043, 0.2343, 0.2005, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0022,  0.0070,  0.0012,  0.0060, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1521, 0.1716, 0.1986, 0.2489, 0.2288], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0316, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0252, -0.0183, -0.0199, -0.0123],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1409, 0.1522, 0.1726, 0.2200, 0.3143], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0999, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0413, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0525, 0.0424, 0.0341, 0.0450, 0.0603]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20777172 0.2552011  0.21474701 0.19096793 0.13131225]
np_weight_alpha[1] [0.22521575 0.24374905 0.19719419 0.17497966 0.15886126]
np_weight_alpha[2] [0.18175791 0.178885   0.24033707 0.17996548 0.2190545 ]
np_weight_alpha[3] [0.16072012 0.1753922  0.19389616 0.25123218 0.21875933]
np_weight_alpha[4] [0.13838157 0.1539945  0.17775396 0.21326117 0.31660882]
-------------Round number:  39  -------------
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.28174603174603174
client Accurancy:  0.31746031746031744
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.2706349206349206
Average Global Trainning Accurancy:  0.26360544217687076
Average Global Trainning Loss:  1.873884426817602
All users are selected
model: 0 tensor([0.2078, 0.2552, 0.2147, 0.1910, 0.1313], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0406, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0459, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0607,  0.0641,  0.0606,  0.0588,  0.0260],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 0.2
model: 1 tensor([0.2252, 0.2437, 0.1972, 0.1750, 0.1589], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0356, -0.0459, -0.0385, -0.0412, -0.0467],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1818, 0.1789, 0.2403, 0.1800, 0.2191], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0201, -0.0303, -0.0041, -0.0351,  0.0237],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1607, 0.1754, 0.1939, 0.2512, 0.2188], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0180, -0.0118, -0.0209, -0.0027, -0.0083],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1384, 0.1540, 0.1778, 0.2133, 0.3166], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.1009, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0381, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0359, 0.0276, 0.0291, 0.0364, 0.0619]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22332631 0.2498896  0.2048509  0.18221085 0.13972232]
np_weight_alpha[1] [0.21758631 0.25135204 0.19189154 0.17408046 0.1650897 ]
np_weight_alpha[2] [0.18827423 0.19532393 0.23301865 0.20112015 0.182263  ]
np_weight_alpha[3] [0.1674837  0.17475869 0.20056708 0.24390583 0.21328478]
np_weight_alpha[4] [0.14331412 0.1615319  0.18050024 0.207921   0.30673277]
-------------Round number:  40  -------------
client Accurancy:  0.25
client Accurancy:  0.2619047619047619
client Accurancy:  0.2698412698412698
client Accurancy:  0.29365079365079366
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.26666666666666666
Average Global Trainning Accurancy:  0.26564625850340134
Average Global Trainning Loss:  1.8801922233737245
All users are selected
model: 0 tensor([0.2233, 0.2499, 0.2049, 0.1822, 0.1397], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0350, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0463, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0548,  0.0476,  0.0439,  0.0539,  0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2176, 0.2514, 0.1919, 0.1741, 0.1651], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0449, -0.0239, -0.0512, -0.0424, -0.0324],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1883, 0.1953, 0.2330, 0.2011, 0.1823], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0008, -0.0109,  0.0026, -0.0021, -0.0008],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1675, 0.1748, 0.2006, 0.2439, 0.2133], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0037, -0.0127, -0.0114, -0.0077, -0.0259],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1433, 0.1615, 0.1805, 0.2079, 0.3067], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0826, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0368, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0308, 0.0341, 0.0307, 0.0131, 0.0503]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.3160914  0.21640779 0.17599781 0.14951123 0.14199176]
np_weight_alpha[1] [0.22267537 0.23734914 0.20214002 0.17694028 0.16089517]
np_weight_alpha[2] [0.17420806 0.24162483 0.2084004  0.19988681 0.17587987]
np_weight_alpha[3] [0.15605845 0.17569028 0.19864859 0.24209474 0.22750796]
np_weight_alpha[4] [0.14611058 0.15741336 0.17600623 0.22048931 0.29998052]
-------------Round number:  41  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.2976190476190476
client Accurancy:  0.3055555555555556
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.2753968253968254
Average Global Trainning Accurancy:  0.2724489795918367
Average Global Trainning Loss:  1.862870861235119
All users are selected
model: 0 tensor([0.3161, 0.2164, 0.1760, 0.1495, 0.1420], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.1012, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0343, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0232, -0.0161, -0.0187, -0.0230, -0.0086],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2227, 0.2373, 0.2021, 0.1769, 0.1609], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0399, -0.0382, -0.0346, -0.0378, -0.0375],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1742, 0.2416, 0.2084, 0.1999, 0.1759], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0075,  0.0617, -0.0069,  0.0218,  0.0029],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1561, 0.1757, 0.1986, 0.2421, 0.2275], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0253, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0151, -0.0091, -0.0175, -0.0030],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1461, 0.1574, 0.1760, 0.2205, 0.3000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0785, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0382, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0493, 0.0395, 0.0304, 0.0452, 0.0522]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2949661  0.21812747 0.18056647 0.16155024 0.14478974]
np_weight_alpha[1] [0.22429588 0.23932983 0.19708149 0.17661281 0.16267999]
np_weight_alpha[2] [0.18402322 0.19661132 0.23469159 0.19477917 0.18989466]
np_weight_alpha[3] [0.1646994  0.17704152 0.19267868 0.24968755 0.2158929 ]
np_weight_alpha[4] [0.14297916 0.15888987 0.18242063 0.21166138 0.30404902]
-------------Round number:  42  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.3055555555555556
client Accurancy:  0.25
Average Global Accurancy:  0.2626984126984127
Average Global Trainning Accurancy:  0.2564625850340136
Average Global Trainning Loss:  1.8529383237670067
All users are selected
model: 0 tensor([0.2950, 0.2181, 0.1806, 0.1616, 0.1448], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0713, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0341, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0180,  0.0051, -0.0033, -0.0051,  0.0037],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2243, 0.2393, 0.1971, 0.1766, 0.1627], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0309, -0.0430, -0.0362, -0.0383, -0.0458],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1840, 0.1966, 0.2347, 0.1948, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0017,  0.0030, -0.0125, -0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1647, 0.1770, 0.1927, 0.2497, 0.2159], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0040,  0.0026, -0.0090,  0.0139,  0.0053],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1430, 0.1589, 0.1824, 0.2117, 0.3040], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0811, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0355, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0338, 0.0252, 0.0309, 0.0350, 0.0555]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22264467 0.20939006 0.21395917 0.2037933  0.15021284]
np_weight_alpha[1] [0.21501009 0.24627471 0.19268698 0.17577316 0.17025505]
np_weight_alpha[2] [0.19940096 0.18494748 0.1989003  0.24036297 0.17638835]
np_weight_alpha[3] [0.1919036  0.17346084 0.25019988 0.18762437 0.19681132]
np_weight_alpha[4] [0.14759439 0.16686521 0.1823863  0.20685418 0.2962999 ]
-------------Round number:  43  -------------
client Accurancy:  0.25
client Accurancy:  0.2619047619047619
client Accurancy:  0.25396825396825395
client Accurancy:  0.3055555555555556
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.26666666666666666
Average Global Trainning Accurancy:  0.2605442176870748
Average Global Trainning Loss:  1.9236542370854592
All users are selected
model: 0 tensor([0.2226, 0.2094, 0.2140, 0.2038, 0.1502], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0449, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0587, -0.0007,  0.0422,  0.0629,  0.0203],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2150, 0.2463, 0.1927, 0.1758, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0489, -0.0299, -0.0544, -0.0480, -0.0357],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1994, 0.1849, 0.1989, 0.2404, 0.1764], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0190, -0.0130, -0.0209,  0.0467,  0.0008],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1919, 0.1735, 0.2502, 0.1876, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0336, -0.0093,  0.0446, -0.0574, -0.0389],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1476, 0.1669, 0.1824, 0.2069, 0.2963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0674, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0344, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0276, 0.0324, 0.0276, 0.0117, 0.0441]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.3083293  0.21597731 0.1782922  0.15280029 0.14460088]
np_weight_alpha[1] [0.21980953 0.2337566  0.20208389 0.17985085 0.16449915]
np_weight_alpha[2] [0.18672223 0.20389444 0.22743051 0.1995988  0.18235406]
np_weight_alpha[3] [0.1559847  0.17622592 0.19753529 0.24058339 0.22967073]
np_weight_alpha[4] [0.15018705 0.16149725 0.1787069  0.21872213 0.29088664]
-------------Round number:  44  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.2976190476190476
client Accurancy:  0.3055555555555556
client Accurancy:  0.25396825396825395
client Accurancy:  0.25
Average Global Accurancy:  0.2785714285714286
Average Global Trainning Accurancy:  0.27789115646258505
Average Global Trainning Loss:  1.878280784970238
All users are selected
model: 0 tensor([0.3083, 0.2160, 0.1783, 0.1528, 0.1446], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0888, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0320, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0154, -0.0219, -0.0239, -0.0297, -0.0168],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2198, 0.2338, 0.2021, 0.1799, 0.1645], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0438, -0.0416, -0.0358, -0.0385, -0.0392],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1867, 0.2039, 0.2274, 0.1996, 0.1824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0247, 0.0297, 0.0201, 0.0292, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1560, 0.1762, 0.1975, 0.2406, 0.2297], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0207, -0.0127, -0.0056, -0.0143,  0.0067],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1502, 0.1615, 0.1787, 0.2187, 0.2909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0651, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0362, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0467, 0.0378, 0.0282, 0.0440, 0.0469]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28661758 0.21768181 0.18208027 0.16507049 0.14854985]
np_weight_alpha[1] [0.22331591 0.23683359 0.1963415  0.17803423 0.1654747 ]
np_weight_alpha[2] [0.18548474 0.19717526 0.23272453 0.19346604 0.19114946]
np_weight_alpha[3] [0.16826257 0.17888504 0.19205566 0.24876828 0.21202841]
np_weight_alpha[4] [0.14665292 0.16229996 0.18551797 0.20942558 0.29610354]
-------------Round number:  45  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.25
client Accurancy:  0.25
client Accurancy:  0.29365079365079366
client Accurancy:  0.24603174603174602
Average Global Accurancy:  0.2619047619047619
Average Global Trainning Accurancy:  0.25476190476190474
Average Global Trainning Loss:  1.861111387914541
All users are selected
model: 0 tensor([0.2866, 0.2177, 0.1821, 0.1651, 0.1485], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0600, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0322, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0127,  0.0040, -0.0050, -0.0076,  0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2233, 0.2368, 0.1963, 0.1780, 0.1655], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0315, -0.0447, -0.0392, -0.0398, -0.0478],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1855, 0.1972, 0.2327, 0.1935, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0015,  0.0033, -0.0139, -0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1683, 0.1789, 0.1921, 0.2488, 0.2120], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0066, 0.0136, 0.0007, 0.0258, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1467, 0.1623, 0.1855, 0.2094, 0.2961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0690, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0337, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0282, 0.0203, 0.0276, 0.0293, 0.0476]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22827655 0.2010042  0.21037433 0.20660974 0.15373525]
np_weight_alpha[1] [0.21305075 0.24346302 0.19344963 0.17702115 0.17301543]
np_weight_alpha[2] [0.19569956 0.18459067 0.19602749 0.24712853 0.17655379]
np_weight_alpha[3] [0.17421746 0.17742227 0.20215358 0.23677889 0.2094278 ]
np_weight_alpha[4] [0.15107453 0.16991092 0.18399131 0.20559642 0.28942683]
-------------Round number:  46  -------------
client Accurancy:  0.25396825396825395
client Accurancy:  0.2777777777777778
client Accurancy:  0.25396825396825395
client Accurancy:  0.31746031746031744
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.2722222222222222
Average Global Trainning Accurancy:  0.26598639455782314
Average Global Trainning Loss:  1.9199937885310374
All users are selected
model: 0 tensor([0.2283, 0.2010, 0.2104, 0.2066, 0.1537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0423, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0489, -0.0087,  0.0362,  0.0626,  0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2131, 0.2435, 0.1934, 0.1770, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0513, -0.0323, -0.0551, -0.0498, -0.0367],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1957, 0.1846, 0.1960, 0.2471, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0194, -0.0077, -0.0167,  0.0598,  0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1742, 0.1774, 0.2022, 0.2368, 0.2094], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0098, -0.0091, -0.0043, -0.0033, -0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1511, 0.1699, 0.1840, 0.2056, 0.2894], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0579, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0328, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0255, 0.0306, 0.0258, 0.0087, 0.0391]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.3016149  0.21528292 0.18024004 0.1549993  0.14786285]
np_weight_alpha[1] [0.21863939 0.23156802 0.20209603 0.1812622  0.16643432]
np_weight_alpha[2] [0.18829098 0.20398246 0.2259306  0.19903703 0.18275899]
np_weight_alpha[3] [0.11501216 0.18780315 0.18835527 0.21850368 0.29032582]
np_weight_alpha[4] [0.15285182 0.16371861 0.17993434 0.21831147 0.28518376]
-------------Round number:  47  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.2896825396825397
client Accurancy:  0.3055555555555556
client Accurancy:  0.25
client Accurancy:  0.25
Average Global Accurancy:  0.2753968253968254
Average Global Trainning Accurancy:  0.28197278911564627
Average Global Trainning Loss:  1.883292477147109
All users are selected
model: 0 tensor([0.3016, 0.2153, 0.1802, 0.1550, 0.1479], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0785, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0310, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0097, -0.0242, -0.0245, -0.0309, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2186, 0.2316, 0.2021, 0.1813, 0.1664], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0441, -0.0422, -0.0351, -0.0378, -0.0391],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1883, 0.2040, 0.2259, 0.1990, 0.1828], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0290, 0.0334, 0.0220, 0.0320, 0.0165],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1150, 0.1878, 0.1884, 0.2185, 0.2903], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0800, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0704, -0.0058, -0.0155, -0.0355,  0.0753],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1529, 0.1637, 0.1799, 0.2183, 0.2852], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0577, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0346, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0438, 0.0353, 0.0256, 0.0423, 0.0431]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28260583 0.21747659 0.18276985 0.16634426 0.15080352]
np_weight_alpha[1] [0.22264698 0.23519917 0.19592652 0.17896853 0.16725883]
np_weight_alpha[2] [0.1857442  0.19658296 0.23219162 0.19309379 0.19238746]
np_weight_alpha[3] [0.17520574 0.18256886 0.19209157 0.24692889 0.20320499]
np_weight_alpha[4] [0.14928155 0.16446345 0.18720414 0.20867562 0.29037523]
-------------Round number:  48  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.25793650793650796
client Accurancy:  0.25396825396825395
client Accurancy:  0.2777777777777778
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.25952380952380955
Average Global Trainning Accurancy:  0.2537414965986395
Average Global Trainning Loss:  1.8667022082270408
All users are selected
model: 0 tensor([0.2826, 0.2175, 0.1828, 0.1663, 0.1508], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0549, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0310, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0120,  0.0050, -0.0047, -0.0083,  0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2226, 0.2352, 0.1959, 0.1790, 0.1673], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0320, -0.0461, -0.0410, -0.0407, -0.0485],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1857, 0.1966, 0.2322, 0.1931, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0031,  0.0031, -0.0148, -0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1752, 0.1826, 0.1921, 0.2469, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0194, 0.0238, 0.0078, 0.0318, 0.0117],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1493, 0.1645, 0.1872, 0.2087, 0.2904], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0612, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0328, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0244, 0.0167, 0.0243, 0.0253, 0.0405]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22769411 0.19551489 0.20973557 0.21161254 0.15544283]
np_weight_alpha[1] [0.2118566  0.24198858 0.19383925 0.17786233 0.17445327]
np_weight_alpha[2] [0.19717781 0.18818374 0.1925674  0.24717322 0.17489788]
np_weight_alpha[3] [0.17515074 0.17779608 0.20194751 0.23566863 0.20943709]
np_weight_alpha[4] [0.15294556 0.17148717 0.18496773 0.2048934  0.2857062 ]
-------------Round number:  49  -------------
client Accurancy:  0.2619047619047619
client Accurancy:  0.2896825396825397
client Accurancy:  0.25396825396825395
client Accurancy:  0.32142857142857145
client Accurancy:  0.25
Average Global Accurancy:  0.2753968253968254
Average Global Trainning Accurancy:  0.2680272108843537
Average Global Trainning Loss:  1.925307916135204
All users are selected
model: 0 tensor([0.2277, 0.1955, 0.2097, 0.2116, 0.1554], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0412, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0458, -0.0124,  0.0357,  0.0669,  0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2119, 0.2420, 0.1938, 0.1779, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0518, -0.0330, -0.0551, -0.0502, -0.0370],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1972, 0.1882, 0.1926, 0.2472, 0.1749], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0230, -0.0016, -0.0171,  0.0620,  0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1752, 0.1778, 0.2019, 0.2357, 0.2094], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0087, -0.0102, -0.0049, -0.0038, -0.0194],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1529, 0.1715, 0.1850, 0.2049, 0.2857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0531, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0320, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0236, 0.0288, 0.0243, 0.0070, 0.0357]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2979646  0.21468957 0.18124105 0.15653616 0.14956868]
np_weight_alpha[1] [0.21765435 0.2303304  0.20217583 0.18214293 0.16769648]
np_weight_alpha[2] [0.18845904 0.2037321  0.2251033  0.19917135 0.18353419]
np_weight_alpha[3] [0.11810551 0.19192101 0.18955342 0.2180003  0.28241983]
np_weight_alpha[4] [0.15441683 0.1651109  0.18058227 0.21752885 0.28236112]
-------------Round number:  50  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.28174603174603174
client Accurancy:  0.3134920634920635
client Accurancy:  0.25396825396825395
client Accurancy:  0.25
Average Global Accurancy:  0.276984126984127
Average Global Trainning Accurancy:  0.2857142857142857
Average Global Trainning Loss:  1.8863809390943878
All users are selected
model: 0 tensor([0.2980, 0.2147, 0.1812, 0.1565, 0.1496], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0730, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0303, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0075, -0.0250, -0.0242, -0.0316, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2177, 0.2303, 0.2022, 0.1821, 0.1677], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0437, -0.0417, -0.0340, -0.0369, -0.0380],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1885, 0.2037, 0.2251, 0.1992, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0298, 0.0340, 0.0221, 0.0329, 0.0172],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1181, 0.1919, 0.1896, 0.2180, 0.2824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0700, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0670, -0.0010, -0.0129, -0.0346,  0.0688],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1544, 0.1651, 0.1806, 0.2175, 0.2824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0538, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0341, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0427, 0.0346, 0.0244, 0.0418, 0.0406]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27995428 0.21714161 0.18301211 0.16783425 0.15205772]
np_weight_alpha[1] [0.22203688 0.23429483 0.19577305 0.17977177 0.16812351]
np_weight_alpha[2] [0.18578629 0.19638297 0.23187557 0.19293588 0.19301932]
np_weight_alpha[3] [0.17586744 0.1828699  0.19187768 0.24656153 0.20282348]
np_weight_alpha[4] [0.1505555  0.16544823 0.188075   0.20743129 0.2884899 ]
-------------Round number:  51  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.2619047619047619
client Accurancy:  0.25396825396825395
client Accurancy:  0.27380952380952384
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.25952380952380955
Average Global Trainning Accurancy:  0.25918367346938775
Average Global Trainning Loss:  1.8640176578443877
All users are selected
model: 0 tensor([0.2800, 0.2171, 0.1830, 0.1678, 0.1521], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0515, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0303, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0112,  0.0053, -0.0048, -0.0085,  0.0007],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2220, 0.2343, 0.1958, 0.1798, 0.1681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0327, -0.0469, -0.0419, -0.0414, -0.0493],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1858, 0.1964, 0.2319, 0.1929, 0.1930], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0077, -0.0037,  0.0028, -0.0150, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1759, 0.1829, 0.1919, 0.2466, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0263, 0.0108, 0.0356, 0.0153],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1506, 0.1654, 0.1881, 0.2074, 0.2885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0583, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0322, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0227, 0.0152, 0.0230, 0.0232, 0.0387]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22804835 0.1931709  0.20937313 0.212915   0.15649262]
np_weight_alpha[1] [0.21114728 0.24111298 0.19392943 0.17853256 0.17527774]
np_weight_alpha[2] [0.1978229  0.18908167 0.19160718 0.2466536  0.17483461]
np_weight_alpha[3] [0.17663671 0.17856297 0.2018429  0.23444979 0.20850766]
np_weight_alpha[4] [0.15410323 0.1724247  0.18565229 0.20427711 0.28354263]
-------------Round number:  52  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.29365079365079366
client Accurancy:  0.25396825396825395
client Accurancy:  0.32936507936507936
client Accurancy:  0.24603174603174602
Average Global Accurancy:  0.2777777777777778
Average Global Trainning Accurancy:  0.2693877551020408
Average Global Trainning Loss:  1.924084555697279
All users are selected
model: 0 tensor([0.2280, 0.1932, 0.2094, 0.2129, 0.1565], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0402, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0435, -0.0142,  0.0348,  0.0669,  0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2111, 0.2411, 0.1939, 0.1785, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0512, -0.0324, -0.0542, -0.0495, -0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1978, 0.1891, 0.1916, 0.2467, 0.1748], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0248,  0.0007, -0.0165,  0.0626,  0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1766, 0.1786, 0.2018, 0.2344, 0.2085], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0082, -0.0113, -0.0061, -0.0054, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1541, 0.1724, 0.1857, 0.2043, 0.2835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0504, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0315, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0230, 0.0285, 0.0244, 0.0067, 0.0348]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.29527545 0.21425517 0.18181942 0.15761475 0.15103525]
np_weight_alpha[1] [0.21702877 0.22955745 0.20216766 0.182809   0.16843712]
np_weight_alpha[2] [0.1885728  0.2035785  0.22474772 0.19925061 0.18385042]
np_weight_alpha[3] [0.16350725 0.1819645  0.1992459  0.23363894 0.22164337]
np_weight_alpha[4] [0.15566583 0.16596489 0.18096836 0.21703416 0.28036678]
-------------Round number:  53  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.28174603174603174
client Accurancy:  0.3134920634920635
client Accurancy:  0.2777777777777778
client Accurancy:  0.25
Average Global Accurancy:  0.28174603174603174
Average Global Trainning Accurancy:  0.2969387755102041
Average Global Trainning Loss:  1.892283329347364
All users are selected
model: 0 tensor([0.2953, 0.2143, 0.1818, 0.1576, 0.1510], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0690, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0297, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0064, -0.0250, -0.0235, -0.0326, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2170, 0.2296, 0.2022, 0.1828, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0426, -0.0410, -0.0327, -0.0361, -0.0369],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1886, 0.2036, 0.2247, 0.1993, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0302, 0.0339, 0.0218, 0.0328, 0.0168],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1635, 0.1820, 0.1992, 0.2336, 0.2216], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0148, -0.0067, -0.0010, -0.0175,  0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1557, 0.1660, 0.1810, 0.2170, 0.2804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0512, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0342, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0430, 0.0348, 0.0242, 0.0431, 0.0389]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27773684 0.21675794 0.18292609 0.16961604 0.15296306]
np_weight_alpha[1] [0.22138828 0.23373458 0.19561005 0.18052757 0.16873953]
np_weight_alpha[2] [0.18545298 0.1961476  0.2317358  0.19304822 0.19361544]
np_weight_alpha[3] [0.19698925 0.1762302  0.1667694  0.29873094 0.16128017]
np_weight_alpha[4] [0.1513654  0.16604972 0.18871413 0.20561965 0.28825107]
-------------Round number:  54  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.26587301587301587
client Accurancy:  0.25793650793650796
client Accurancy:  0.25
client Accurancy:  0.21825396825396826
Average Global Accurancy:  0.25476190476190474
Average Global Trainning Accurancy:  0.25612244897959185
Average Global Trainning Loss:  1.864148862670068
All users are selected
model: 0 tensor([0.2777, 0.2168, 0.1829, 0.1696, 0.1530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0488, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0296, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0104,  0.0052, -0.0055, -0.0081, -0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2214, 0.2337, 0.1956, 0.1805, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0323, -0.0465, -0.0418, -0.0409, -0.0493],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1855, 0.1961, 0.2317, 0.1930, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0081, -0.0039,  0.0033, -0.0147, -0.0007],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1970, 0.1762, 0.1668, 0.2987, 0.1613], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0646, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0442,  0.0192, -0.0145,  0.0888, -0.0284],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1514, 0.1660, 0.1887, 0.2056, 0.2883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0573, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0318, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0144, 0.0229, 0.0223, 0.0391]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2276857  0.19140258 0.21104488 0.2106574  0.15920945]
np_weight_alpha[1] [0.21047498 0.24037498 0.19401968 0.17905822 0.17607208]
np_weight_alpha[2] [0.20064598 0.19025138 0.18995509 0.24572796 0.17341955]
np_weight_alpha[3] [0.175209   0.17893662 0.2020311  0.23312765 0.21069556]
np_weight_alpha[4] [0.15537424 0.17332388 0.18603405 0.20306419 0.2822036 ]
-------------Round number:  55  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.29365079365079366
client Accurancy:  0.25396825396825395
client Accurancy:  0.31746031746031744
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.27380952380952384
Average Global Trainning Accurancy:  0.2707482993197279
Average Global Trainning Loss:  1.9210351230335885
All users are selected
model: 0 tensor([0.2277, 0.1914, 0.2110, 0.2107, 0.1592], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0394, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0433, -0.0167,  0.0347,  0.0620,  0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2105, 0.2404, 0.1940, 0.1791, 0.1761], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0499, -0.0312, -0.0526, -0.0480, -0.0346],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2006, 0.1903, 0.1900, 0.2457, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0285,  0.0030, -0.0169,  0.0623,  0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1752, 0.1789, 0.2020, 0.2331, 0.2107], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0032, -0.0136, -0.0079, -0.0076, -0.0194],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1554, 0.1733, 0.1860, 0.2031, 0.2822], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0483, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0315, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0248, 0.0299, 0.0258, 0.0072, 0.0346]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.29292196 0.21393621 0.18250023 0.15892424 0.15171741]
np_weight_alpha[1] [0.21655566 0.22906049 0.20218974 0.18333359 0.16886057]
np_weight_alpha[2] [0.18859491 0.20338546 0.22434242 0.19947726 0.1842    ]
np_weight_alpha[3] [0.16487256 0.1827345  0.19936569 0.23250584 0.2205214 ]
np_weight_alpha[4] [0.15605764 0.16637424 0.18103199 0.21635358 0.28018257]
-------------Round number:  56  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.27380952380952384
client Accurancy:  0.3134920634920635
client Accurancy:  0.28174603174603174
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.28174603174603174
Average Global Trainning Accurancy:  0.29523809523809524
Average Global Trainning Loss:  1.8888734986181972
All users are selected
model: 0 tensor([0.2929, 0.2139, 0.1825, 0.1589, 0.1517], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0658, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0293, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0053, -0.0251, -0.0229, -0.0321, -0.0186],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2166, 0.2291, 0.2022, 0.1833, 0.1689], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0418, -0.0402, -0.0316, -0.0349, -0.0357],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1886, 0.2034, 0.2243, 0.1995, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0296, 0.0333, 0.0208, 0.0326, 0.0166],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1649, 0.1827, 0.1994, 0.2325, 0.2205], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0148, -0.0069, -0.0014, -0.0187,  0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1561, 0.1664, 0.1810, 0.2164, 0.2802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0506, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0339, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0426, 0.0350, 0.0242, 0.0431, 0.0394]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27623403 0.21664126 0.18307772 0.1704033  0.15364365]
np_weight_alpha[1] [0.22110102 0.23345394 0.19557382 0.18089068 0.1689806 ]
np_weight_alpha[2] [0.18552633 0.19610879 0.23172477 0.19295156 0.19368854]
np_weight_alpha[3] [0.19502372 0.17475037 0.16588195 0.30167183 0.16267215]
np_weight_alpha[4] [0.1521067  0.16639063 0.18892778 0.20508556 0.28748932]
-------------Round number:  57  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.26587301587301587
client Accurancy:  0.2619047619047619
client Accurancy:  0.25
client Accurancy:  0.21825396825396826
Average Global Accurancy:  0.2563492063492063
Average Global Trainning Accurancy:  0.2585034013605442
Average Global Trainning Loss:  1.8565599091198979
All users are selected
model: 0 tensor([0.2762, 0.2166, 0.1831, 0.1704, 0.1536], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0470, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0291, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0095,  0.0048, -0.0063, -0.0085, -0.0010],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2211, 0.2335, 0.1956, 0.1809, 0.1690], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0326, -0.0468, -0.0422, -0.0411, -0.0499],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1855, 0.1961, 0.2317, 0.1930, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0075, -0.0031,  0.0046, -0.0140,  0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1950, 0.1748, 0.1659, 0.3017, 0.1627], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0678, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0411,  0.0171, -0.0155,  0.0922, -0.0263],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1521, 0.1664, 0.1889, 0.2051, 0.2875], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0561, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0314, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0216, 0.0144, 0.0231, 0.0223, 0.0393]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22749345 0.18997152 0.21203545 0.21030037 0.16019918]
np_weight_alpha[1] [0.2100864  0.23996033 0.19407237 0.17934823 0.17653258]
np_weight_alpha[2] [0.20193857 0.19047767 0.18792269 0.24616055 0.17350058]
np_weight_alpha[3] [0.17615674 0.17948052 0.20207569 0.23246127 0.20982574]
np_weight_alpha[4] [0.15608697 0.17383617 0.18622924 0.20271242 0.2811352 ]
-------------Round number:  58  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.2976190476190476
client Accurancy:  0.25793650793650796
client Accurancy:  0.31746031746031744
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.2753968253968254
Average Global Trainning Accurancy:  0.272108843537415
Average Global Trainning Loss:  1.9181524367559524
All users are selected
model: 0 tensor([0.2275, 0.1900, 0.2120, 0.2103, 0.1602], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0386, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0431, -0.0188,  0.0342,  0.0592,  0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2101, 0.2400, 0.1941, 0.1793, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0485, -0.0300, -0.0513, -0.0471, -0.0334],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2019, 0.1905, 0.1879, 0.2462, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0307,  0.0044, -0.0176,  0.0638,  0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1762, 0.1795, 0.2021, 0.2325, 0.2098], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0018, -0.0150, -0.0092, -0.0088, -0.0210],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1561, 0.1738, 0.1862, 0.2027, 0.2811], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0470, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0313, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0254, 0.0304, 0.0262, 0.0079, 0.0346]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.29097977 0.21353938 0.18297544 0.1600553  0.15245011]
np_weight_alpha[1] [0.21601675 0.22859009 0.202142   0.18391588 0.16933525]
np_weight_alpha[2] [0.18872604 0.20325892 0.22402042 0.19952556 0.18446913]
np_weight_alpha[3] [0.16577435 0.1833409  0.19941293 0.23158543 0.21988645]
np_weight_alpha[4] [0.15659335 0.16686574 0.18130477 0.21574438 0.27949184]
-------------Round number:  59  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.2857142857142857
client Accurancy:  0.30952380952380953
client Accurancy:  0.28174603174603174
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.2841269841269841
Average Global Trainning Accurancy:  0.2969387755102041
Average Global Trainning Loss:  1.884801332642432
All users are selected
model: 0 tensor([0.2910, 0.2135, 0.1830, 0.1601, 0.1525], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0630, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0048, -0.0250, -0.0225, -0.0312, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2160, 0.2286, 0.2021, 0.1839, 0.1693], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0407, -0.0392, -0.0304, -0.0332, -0.0342],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1887, 0.2033, 0.2240, 0.1995, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0296, 0.0333, 0.0211, 0.0330, 0.0170],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1658, 0.1833, 0.1994, 0.2316, 0.2199], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0073, -0.0022, -0.0203,  0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1566, 0.1669, 0.1813, 0.2157, 0.2795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0495, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0336, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0414, 0.0343, 0.0235, 0.0421, 0.0387]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27475974 0.2164891  0.18344572 0.1709281  0.15437736]
np_weight_alpha[1] [0.2207977  0.233263   0.19562988 0.18110473 0.16920464]
np_weight_alpha[2] [0.18583275 0.19617258 0.23133448 0.19287956 0.1937806 ]
np_weight_alpha[3] [0.19336015 0.17320876 0.16519023 0.30514407 0.16309674]
np_weight_alpha[4] [0.15288708 0.16673182 0.18914886 0.20478995 0.28644222]
-------------Round number:  60  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.2619047619047619
client Accurancy:  0.26587301587301587
client Accurancy:  0.25
client Accurancy:  0.21031746031746032
Average Global Accurancy:  0.25476190476190474
Average Global Trainning Accurancy:  0.2578231292517007
Average Global Trainning Loss:  1.8487729857568027
All users are selected
model: 0 tensor([0.2748, 0.2165, 0.1834, 0.1709, 0.1544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0453, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0287, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0082,  0.0042, -0.0070, -0.0095, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2208, 0.2333, 0.1956, 0.1811, 0.1692], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0323, -0.0466, -0.0420, -0.0411, -0.0502],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1858, 0.1962, 0.2313, 0.1929, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060, -0.0016,  0.0057, -0.0125,  0.0015],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1934, 0.1732, 0.1652, 0.3051, 0.1631], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0720, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0379,  0.0144, -0.0167,  0.0955, -0.0256],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1529, 0.1667, 0.1891, 0.2048, 0.2864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0547, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0310, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0140, 0.0231, 0.0225, 0.0395]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2278044  0.18824342 0.21133415 0.21117072 0.16144727]
np_weight_alpha[1] [0.20959261 0.23960899 0.19405523 0.17958392 0.17715925]
np_weight_alpha[2] [0.20148234 0.1899828  0.1887579  0.24565287 0.17412409]
np_weight_alpha[3] [0.17703697 0.17993699 0.2019571  0.23203538 0.20903358]
np_weight_alpha[4] [0.15692054 0.17453907 0.18655121 0.20237166 0.27961746]
-------------Round number:  61  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.2976190476190476
client Accurancy:  0.27380952380952384
client Accurancy:  0.30158730158730157
client Accurancy:  0.23412698412698413
Average Global Accurancy:  0.2753968253968254
Average Global Trainning Accurancy:  0.27414965986394557
Average Global Trainning Loss:  1.9133368874893708
All users are selected
model: 0 tensor([0.2278, 0.1882, 0.2113, 0.2112, 0.1614], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0380, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0433, -0.0218,  0.0315,  0.0576,  0.0175],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2096, 0.2396, 0.1941, 0.1796, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0471, -0.0285, -0.0497, -0.0458, -0.0319],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2015, 0.1900, 0.1888, 0.2457, 0.1741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0316,  0.0056, -0.0149,  0.0650,  0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1770, 0.1799, 0.2020, 0.2320, 0.2090], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-3.8354e-05, -1.6988e-02, -1.1365e-02, -1.0920e-02, -2.3382e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1569, 0.1745, 0.1866, 0.2024, 0.2796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0451, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0310, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0264, 0.0314, 0.0271, 0.0090, 0.0349]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2893405  0.21325763 0.18336782 0.1608057  0.15322843]
np_weight_alpha[1] [0.21558823 0.2282474  0.20203263 0.18426822 0.1698635 ]
np_weight_alpha[2] [0.1889589  0.20313601 0.22374624 0.19944252 0.18471628]
np_weight_alpha[3] [0.1663355  0.18369116 0.19938545 0.23122923 0.21935879]
np_weight_alpha[4] [0.15728068 0.16745593 0.18167605 0.21531759 0.27826974]
-------------Round number:  62  -------------
client Accurancy:  0.2896825396825397
client Accurancy:  0.29365079365079366
client Accurancy:  0.30952380952380953
client Accurancy:  0.2896825396825397
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.2873015873015873
Average Global Trainning Accurancy:  0.2969387755102041
Average Global Trainning Loss:  1.8815067628613946
All users are selected
model: 0 tensor([0.2893, 0.2133, 0.1834, 0.1608, 0.1532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0608, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0285, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0043, -0.0248, -0.0220, -0.0311, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2156, 0.2282, 0.2020, 0.1843, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0397, -0.0381, -0.0293, -0.0324, -0.0329],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1890, 0.2031, 0.2237, 0.1994, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0292, 0.0327, 0.0204, 0.0321, 0.0164],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1663, 0.1837, 0.1994, 0.2312, 0.2194], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0085, -0.0034, -0.0209,  0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1573, 0.1675, 0.1817, 0.2153, 0.2783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0479, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0335, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0416, 0.0351, 0.0242, 0.0428, 0.0384]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2734195  0.21620448 0.18358764 0.17166129 0.1551271 ]
np_weight_alpha[1] [0.22035709 0.23296109 0.19553411 0.18167639 0.16947135]
np_weight_alpha[2] [0.18585554 0.19604306 0.23110808 0.1930462  0.19394709]
np_weight_alpha[3] [0.17363696 0.18206912 0.19190258 0.24566753 0.20672381]
np_weight_alpha[4] [0.15360543 0.16702664 0.18937594 0.20408878 0.28590322]
-------------Round number:  63  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.26587301587301587
client Accurancy:  0.27380952380952384
client Accurancy:  0.30952380952380953
client Accurancy:  0.1984126984126984
Average Global Accurancy:  0.26666666666666666
Average Global Trainning Accurancy:  0.26632653061224487
Average Global Trainning Loss:  1.8414675342793367
All users are selected
model: 0 tensor([0.2734, 0.2162, 0.1836, 0.1717, 0.1551], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0437, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0282, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0066,  0.0027, -0.0089, -0.0106, -0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2204, 0.2330, 0.1955, 0.1817, 0.1695], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0322, -0.0464, -0.0418, -0.0407, -0.0501],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1859, 0.1960, 0.2311, 0.1930, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047,  0.0002,  0.0075, -0.0104,  0.0034],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1736, 0.1821, 0.1919, 0.2457, 0.2067], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0147, 0.0224, 0.0099, 0.0351, 0.0210],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1536, 0.1670, 0.1894, 0.2041, 0.2859], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0537, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0305, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0146, 0.0239, 0.0223, 0.0407]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22716944 0.18790677 0.21315522 0.20993395 0.16183455]
np_weight_alpha[1] [0.20931675 0.23927319 0.19394971 0.17997877 0.17748152]
np_weight_alpha[2] [0.20391157 0.1899764  0.18849728 0.24404512 0.17356963]
np_weight_alpha[3] [0.17971615 0.18035561 0.20171677 0.23271498 0.2054965 ]
np_weight_alpha[4] [0.15758693 0.17495574 0.18670297 0.20260423 0.27815014]
-------------Round number:  64  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.2896825396825397
client Accurancy:  0.27380952380952384
client Accurancy:  0.30158730158730157
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.2706349206349206
Average Global Trainning Accurancy:  0.27755102040816326
Average Global Trainning Loss:  1.908498086734694
All users are selected
model: 0 tensor([0.2272, 0.1879, 0.2132, 0.2099, 0.1618], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0375, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0439, -0.0228,  0.0319,  0.0541,  0.0159],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2093, 0.2393, 0.1939, 0.1800, 0.1775], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0456, -0.0271, -0.0483, -0.0445, -0.0310],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2039, 0.1900, 0.1885, 0.2440, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0355,  0.0073, -0.0135,  0.0644,  0.0089],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1797, 0.1804, 0.2017, 0.2327, 0.2055], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-3.9934e-05, -1.9023e-02, -1.3780e-02, -1.1872e-02, -2.8649e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1576, 0.1750, 0.1867, 0.2026, 0.2782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0436, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0307, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0275, 0.0322, 0.0280, 0.0110, 0.0354]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28778037 0.21286134 0.1836752  0.16174024 0.15394288]
np_weight_alpha[1] [0.21512559 0.22777478 0.20185491 0.18472084 0.1705238 ]
np_weight_alpha[2] [0.18883458 0.20279986 0.22336963 0.19970116 0.18529482]
np_weight_alpha[3] [0.16682999 0.1840276  0.19947314 0.23070222 0.21896705]
np_weight_alpha[4] [0.1578079  0.16813909 0.18209419 0.21470118 0.27725765]
-------------Round number:  65  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.29365079365079366
client Accurancy:  0.31746031746031744
client Accurancy:  0.2976190476190476
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.28888888888888886
Average Global Trainning Accurancy:  0.29897959183673467
Average Global Trainning Loss:  1.8771451158588435
All users are selected
model: 0 tensor([0.2878, 0.2129, 0.1837, 0.1617, 0.1539], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0586, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0038, -0.0250, -0.0220, -0.0310, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2151, 0.2278, 0.2019, 0.1847, 0.1705], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0389, -0.0375, -0.0284, -0.0314, -0.0319],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1888, 0.2028, 0.2234, 0.1997, 0.1853], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0288, 0.0325, 0.0201, 0.0323, 0.0167],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1668, 0.1840, 0.1995, 0.2307, 0.2190], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0097, -0.0044, -0.0222,  0.0008],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1578, 0.1681, 0.1821, 0.2147, 0.2773], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0465, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0331, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0418, 0.0357, 0.0249, 0.0434, 0.0390]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27197966 0.2159734  0.1838196  0.17232434 0.15590304]
np_weight_alpha[1] [0.21998392 0.23273784 0.1953213  0.18199876 0.16995817]
np_weight_alpha[2] [0.18602194 0.19583292 0.23095772 0.19304511 0.19414228]
np_weight_alpha[3] [0.1742569  0.18241102 0.19196633 0.24524927 0.20611659]
np_weight_alpha[4] [0.15442756 0.16762057 0.18975545 0.20361225 0.28458416]
-------------Round number:  66  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.2698412698412698
client Accurancy:  0.28174603174603174
client Accurancy:  0.3055555555555556
client Accurancy:  0.1984126984126984
Average Global Accurancy:  0.26746031746031745
Average Global Trainning Accurancy:  0.2673469387755102
Average Global Trainning Loss:  1.8362298044217686
All users are selected
model: 0 tensor([0.2720, 0.2160, 0.1838, 0.1723, 0.1559], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0420, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0043,  0.0015, -0.0099, -0.0118, -0.0046],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2200, 0.2327, 0.1953, 0.1820, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0322, -0.0462, -0.0419, -0.0407, -0.0501],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1860, 0.1958, 0.2310, 0.1930, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0031,  0.0014,  0.0088, -0.0090,  0.0046],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1743, 0.1824, 0.1920, 0.2452, 0.2061], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0144, 0.0221, 0.0096, 0.0345, 0.0205],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1544, 0.1676, 0.1898, 0.2036, 0.2846], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0520, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0229, 0.0152, 0.0244, 0.0227, 0.0406]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2303878  0.18699573 0.21169508 0.20983112 0.1610903 ]
np_weight_alpha[1] [0.20895915 0.23891234 0.19391124 0.18028826 0.177929  ]
np_weight_alpha[2] [0.20291735 0.1904483  0.18855278 0.24364728 0.17443427]
np_weight_alpha[3] [0.1802285  0.18065412 0.20166263 0.23241588 0.20503885]
np_weight_alpha[4] [0.15802662 0.17542955 0.1870918  0.20221572 0.27723637]
-------------Round number:  67  -------------
client Accurancy:  0.2619047619047619
client Accurancy:  0.2976190476190476
client Accurancy:  0.28174603174603174
client Accurancy:  0.30952380952380953
client Accurancy:  0.21031746031746032
Average Global Accurancy:  0.2722222222222222
Average Global Trainning Accurancy:  0.27993197278911564
Average Global Trainning Loss:  1.9011034491921768
All users are selected
model: 0 tensor([0.2304, 0.1870, 0.2117, 0.2098, 0.1611], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0364, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0411, -0.0254,  0.0280,  0.0508,  0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2389, 0.1939, 0.1803, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0438, -0.0255, -0.0463, -0.0429, -0.0294],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2029, 0.1904, 0.1886, 0.2436, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0360,  0.0096, -0.0117,  0.0656,  0.0111],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1807, 0.2017, 0.2324, 0.2050], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019, -0.0209, -0.0156, -0.0135, -0.0302],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1580, 0.1754, 0.1871, 0.2022, 0.2772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0425, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0301, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0277, 0.0330, 0.0290, 0.0121, 0.0368]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28550193 0.21249017 0.1840279  0.16266404 0.15531597]
np_weight_alpha[1] [0.21468452 0.2274851  0.20162296 0.18512827 0.17107908]
np_weight_alpha[2] [0.18897931 0.20253484 0.22322376 0.19969518 0.18556693]
np_weight_alpha[3] [0.16739209 0.18445867 0.19953398 0.23030011 0.2183152 ]
np_weight_alpha[4] [0.15885793 0.16882205 0.18256404 0.2142225  0.27553347]
-------------Round number:  68  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.2976190476190476
client Accurancy:  0.3134920634920635
client Accurancy:  0.29365079365079366
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.2857142857142857
Average Global Trainning Accurancy:  0.3013605442176871
Average Global Trainning Loss:  1.8746105375744047
All users are selected
model: 0 tensor([0.2855, 0.2125, 0.1840, 0.1627, 0.1553], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0556, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0277, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0024, -0.0253, -0.0218, -0.0307, -0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2147, 0.2275, 0.2016, 0.1851, 0.1711], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0377, -0.0363, -0.0272, -0.0300, -0.0301],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1890, 0.2025, 0.2232, 0.1997, 0.1856], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0279, 0.0314, 0.0193, 0.0312, 0.0160],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1674, 0.1845, 0.1995, 0.2303, 0.2183], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0101, -0.0051, -0.0224,  0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1589, 0.1688, 0.1826, 0.2142, 0.2755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0444, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0331, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0423, 0.0364, 0.0254, 0.0435, 0.0377]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27076003 0.215868   0.1840002  0.17290072 0.15647112]
np_weight_alpha[1] [0.219716   0.2326111  0.19524445 0.18236527 0.17006312]
np_weight_alpha[2] [0.1861373  0.1957515  0.23065637 0.1932301  0.19422475]
np_weight_alpha[3] [0.17484431 0.18282099 0.19220097 0.24448173 0.20565198]
np_weight_alpha[4] [0.15498294 0.16773605 0.18988615 0.20318703 0.2842078 ]
-------------Round number:  69  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.27380952380952384
client Accurancy:  0.28174603174603174
client Accurancy:  0.2976190476190476
client Accurancy:  0.1865079365079365
Average Global Accurancy:  0.2642857142857143
Average Global Trainning Accurancy:  0.27448979591836736
Average Global Trainning Loss:  1.8299980734481291
All users are selected
model: 0 tensor([0.2708, 0.2159, 0.1840, 0.1729, 0.1565], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0407, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0275, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 2.6728e-03, -1.3243e-06, -1.1693e-02, -1.3693e-02, -6.7254e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2197, 0.2326, 0.1952, 0.1824, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0316, -0.0455, -0.0414, -0.0401, -0.0499],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1861, 0.1958, 0.2307, 0.1932, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0011,  0.0034,  0.0108, -0.0067,  0.0065],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1748, 0.1828, 0.1922, 0.2445, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0135, 0.0213, 0.0090, 0.0331, 0.0196],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1550, 0.1677, 0.1899, 0.2032, 0.2842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0514, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0298, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0226, 0.0149, 0.0245, 0.0230, 0.0414]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22842337 0.18560013 0.21198948 0.2108302  0.16315685]
np_weight_alpha[1] [0.20857555 0.23857239 0.19389312 0.18059269 0.17836627]
np_weight_alpha[2] [0.20343912 0.19060871 0.18856354 0.24232346 0.17506514]
np_weight_alpha[3] [0.18080477 0.18094398 0.20161085 0.23211761 0.20452271]
np_weight_alpha[4] [0.15889294 0.17595658 0.18739925 0.2017855  0.27596572]
-------------Round number:  70  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.30158730158730157
client Accurancy:  0.2857142857142857
client Accurancy:  0.3055555555555556
client Accurancy:  0.21428571428571427
Average Global Accurancy:  0.2746031746031746
Average Global Trainning Accurancy:  0.28469387755102044
Average Global Trainning Loss:  1.896928644504677
All users are selected
model: 0 tensor([0.2284, 0.1856, 0.2120, 0.2108, 0.1632], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0361, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0433, -0.0276,  0.0271,  0.0500,  0.0114],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2386, 0.1939, 0.1806, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0421, -0.0238, -0.0444, -0.0414, -0.0281],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2034, 0.1906, 0.1886, 0.2423, 0.1751], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0384,  0.0120, -0.0097,  0.0662,  0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1808, 0.1809, 0.2016, 0.2321, 0.2045], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0043, -0.0234, -0.0179, -0.0158, -0.0322],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1589, 0.1760, 0.1874, 0.2018, 0.2760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0410, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0296, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0279, 0.0330, 0.0291, 0.0126, 0.0369]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28426996 0.21219462 0.18418919 0.16327451 0.15607175]
np_weight_alpha[1] [0.21421178 0.22713561 0.20135283 0.18559314 0.17170662]
np_weight_alpha[2] [0.18892865 0.20217994 0.2231346  0.19974644 0.18601044]
np_weight_alpha[3] [0.16798861 0.18494229 0.19957368 0.22999899 0.21749647]
np_weight_alpha[4] [0.15969998 0.16952099 0.18306488 0.21358182 0.2741323 ]
-------------Round number:  71  -------------
client Accurancy:  0.25
client Accurancy:  0.2976190476190476
client Accurancy:  0.31746031746031744
client Accurancy:  0.2976190476190476
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.2833333333333333
Average Global Trainning Accurancy:  0.2969387755102041
Average Global Trainning Loss:  1.8710844494047618
All users are selected
model: 0 tensor([0.2843, 0.2122, 0.1842, 0.1633, 0.1561], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0539, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0272, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0029, -0.0248, -0.0217, -0.0304, -0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2142, 0.2271, 0.2014, 0.1856, 0.1717], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0361, -0.0349, -0.0258, -0.0283, -0.0286],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1889, 0.2022, 0.2231, 0.1997, 0.1860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0274, 0.0310, 0.0194, 0.0310, 0.0164],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1680, 0.1849, 0.1996, 0.2300, 0.2175], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0195, -0.0113, -0.0065, -0.0237, -0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1597, 0.1695, 0.1831, 0.2136, 0.2741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0426, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0327, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0416, 0.0363, 0.0257, 0.0432, 0.0372]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.268972   0.21550487 0.18441717 0.17351681 0.15758914]
np_weight_alpha[1] [0.21918896 0.23232052 0.1951832  0.18267514 0.17063224]
np_weight_alpha[2] [0.18646711 0.1956906  0.23033214 0.19337441 0.19413571]
np_weight_alpha[3] [0.17530286 0.18310852 0.19239618 0.24408495 0.20510752]
np_weight_alpha[4] [0.15608415 0.16839808 0.19000097 0.20274453 0.28277224]
-------------Round number:  72  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.27380952380952384
client Accurancy:  0.29365079365079366
client Accurancy:  0.29365079365079366
client Accurancy:  0.18253968253968253
Average Global Accurancy:  0.2650793650793651
Average Global Trainning Accurancy:  0.2761904761904762
Average Global Trainning Loss:  1.8249133051658164
All users are selected
model: 0 tensor([0.2690, 0.2155, 0.1844, 0.1735, 0.1576], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0387, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0272, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0002, -0.0019, -0.0134, -0.0157, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2192, 0.2323, 0.1952, 0.1827, 0.1706], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0448, -0.0407, -0.0393, -0.0490],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1865, 0.1957, 0.2303, 0.1934, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0014,  0.0055,  0.0128, -0.0044,  0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1753, 0.1831, 0.1924, 0.2441, 0.2051], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0126, 0.0205, 0.0085, 0.0322, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1561, 0.1684, 0.1900, 0.2027, 0.2828], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0494, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0294, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0225, 0.0151, 0.0245, 0.0231, 0.0410]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23059206 0.18420689 0.21021952 0.21088731 0.1640942 ]
np_weight_alpha[1] [0.20799972 0.23838267 0.19392765 0.18090492 0.17878498]
np_weight_alpha[2] [0.20209347 0.19089474 0.1892668  0.24174914 0.17599593]
np_weight_alpha[3] [0.18130258 0.1812587  0.20163535 0.23187062 0.20393279]
np_weight_alpha[4] [0.15990287 0.17647208 0.18762021 0.201321   0.27468383]
-------------Round number:  73  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.30158730158730157
client Accurancy:  0.3055555555555556
client Accurancy:  0.3055555555555556
client Accurancy:  0.20238095238095238
Average Global Accurancy:  0.2761904761904762
Average Global Trainning Accurancy:  0.28537414965986396
Average Global Trainning Loss:  1.8899181547619048
All users are selected
model: 0 tensor([0.2306, 0.1842, 0.2102, 0.2109, 0.1641], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0355, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0420, -0.0304,  0.0233,  0.0472,  0.0094],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2080, 0.2384, 0.1939, 0.1809, 0.1788], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0406, -0.0223, -0.0426, -0.0400, -0.0268],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2021, 0.1909, 0.1893, 0.2417, 0.1760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0393,  0.0147, -0.0068,  0.0678,  0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1813, 0.1813, 0.2016, 0.2319, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0261, -0.0206, -0.0182, -0.0349],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1599, 0.1765, 0.1876, 0.2013, 0.2747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0395, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0293, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0293, 0.0341, 0.0302, 0.0139, 0.0378]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28295192 0.21172284 0.18428251 0.1641279  0.15691483]
np_weight_alpha[1] [0.21367258 0.22692543 0.20115377 0.18598795 0.17226025]
np_weight_alpha[2] [0.18888633 0.20195793 0.22314712 0.19975728 0.18625134]
np_weight_alpha[3] [0.16864915 0.18537095 0.19965777 0.22943407 0.21688807]
np_weight_alpha[4] [0.1603742  0.17012581 0.18346138 0.21311371 0.27292493]
-------------Round number:  74  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3055555555555556
client Accurancy:  0.32142857142857145
client Accurancy:  0.2896825396825397
client Accurancy:  0.25
Average Global Accurancy:  0.28253968253968254
Average Global Trainning Accurancy:  0.2931972789115646
Average Global Trainning Loss:  1.8669642857142856
All users are selected
model: 0 tensor([0.2830, 0.2117, 0.1843, 0.1641, 0.1569], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0520, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0021, -0.0257, -0.0225, -0.0309, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2137, 0.2269, 0.2012, 0.1860, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0340, -0.0328, -0.0236, -0.0261, -0.0259],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1889, 0.2020, 0.2231, 0.1998, 0.1863], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0270, 0.0307, 0.0194, 0.0306, 0.0165],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1686, 0.1854, 0.1997, 0.2294, 0.2169], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0207, -0.0126, -0.0079, -0.0250, -0.0027],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1604, 0.1701, 0.1835, 0.2131, 0.2729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0411, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0325, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0412, 0.0368, 0.0261, 0.0434, 0.0367]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2674341  0.2151991  0.18466696 0.17411579 0.15858412]
np_weight_alpha[1] [0.21872646 0.23235108 0.19507027 0.18309991 0.17075236]
np_weight_alpha[2] [0.1866153  0.19557564 0.23012505 0.1935601  0.19412392]
np_weight_alpha[3] [0.1758163  0.18356268 0.19263455 0.24342595 0.20456047]
np_weight_alpha[4] [0.15704787 0.16860127 0.19009525 0.20224814 0.2820075 ]
-------------Round number:  75  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.2896825396825397
client Accurancy:  0.30158730158730157
client Accurancy:  0.2896825396825397
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.26825396825396824
Average Global Trainning Accurancy:  0.2795918367346939
Average Global Trainning Loss:  1.8201733232355441
All users are selected
model: 0 tensor([0.2674, 0.2152, 0.1847, 0.1741, 0.1586], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0370, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0032, -0.0044, -0.0160, -0.0177, -0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2187, 0.2324, 0.1951, 0.1831, 0.1708], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0444, -0.0403, -0.0389, -0.0489],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1866, 0.1956, 0.2301, 0.1936, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0031,  0.0077,  0.0147, -0.0022,  0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1758, 0.1836, 0.1926, 0.2434, 0.2046], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0127, 0.0204, 0.0084, 0.0314, 0.0185],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1570, 0.1686, 0.1901, 0.2022, 0.2820], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0483, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0294, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0155, 0.0252, 0.0235, 0.0410]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26615915 0.20621076 0.18761213 0.1795121  0.16050586]
np_weight_alpha[1] [0.20775098 0.23822263 0.19372599 0.1812251  0.17907524]
np_weight_alpha[2] [0.20378739 0.19035229 0.18966405 0.24088727 0.17530896]
np_weight_alpha[3] [0.18148634 0.18155499 0.20166428 0.23178251 0.20351191]
np_weight_alpha[4] [0.1604294  0.17677136 0.18752874 0.20092535 0.2743451 ]
-------------Round number:  76  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.29365079365079366
client Accurancy:  0.32142857142857145
client Accurancy:  0.31746031746031744
client Accurancy:  0.21031746031746032
Average Global Accurancy:  0.28253968253968254
Average Global Trainning Accurancy:  0.2925170068027211
Average Global Trainning Loss:  1.8567107116284014
All users are selected
model: 0 tensor([0.2662, 0.2062, 0.1876, 0.1795, 0.1605], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0327, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0306, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0067, -0.0124, -0.0062,  0.0060, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2078, 0.2382, 0.1937, 0.1812, 0.1791], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0379, -0.0193, -0.0399, -0.0374, -0.0244],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2038, 0.1904, 0.1897, 0.2409, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0452,  0.0185, -0.0024,  0.0708,  0.0189],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1815, 0.1816, 0.2017, 0.2318, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0093, -0.0277, -0.0219, -0.0188, -0.0359],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1604, 0.1768, 0.1875, 0.2009, 0.2743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0389, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0290, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0313, 0.0358, 0.0317, 0.0161, 0.0401]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.28219596 0.24125053 0.18837714 0.13304967 0.15512665]
np_weight_alpha[1] [0.2133895  0.22639619 0.20095074 0.1864602  0.17280342]
np_weight_alpha[2] [0.18869862 0.20163302 0.22312045 0.19988516 0.1866627 ]
np_weight_alpha[3] [0.16952284 0.18589185 0.19973221 0.22866105 0.216192  ]
np_weight_alpha[4] [0.16085494 0.17070444 0.1837869  0.21251695 0.27213675]
-------------Round number:  77  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.30952380952380953
client Accurancy:  0.31746031746031744
client Accurancy:  0.29365079365079366
client Accurancy:  0.24603174603174602
Average Global Accurancy:  0.2865079365079365
Average Global Trainning Accurancy:  0.29897959183673467
Average Global Trainning Loss:  1.8546639163477892
All users are selected
model: 0 tensor([0.2822, 0.2413, 0.1884, 0.1330, 0.1551], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0754, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0249, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0035,  0.0047, -0.0193, -0.0648, -0.0241],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2134, 0.2264, 0.2010, 0.1865, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0324, -0.0311, -0.0217, -0.0238, -0.0233],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1887, 0.2016, 0.2231, 0.1999, 0.1867], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0309, 0.0198, 0.0312, 0.0175],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1695, 0.1859, 0.1997, 0.2287, 0.2162], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0208, -0.0132, -0.0088, -0.0267, -0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1609, 0.1707, 0.1838, 0.2125, 0.2721], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0401, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0324, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0407, 0.0370, 0.0262, 0.0426, 0.0357]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2640804  0.21391454 0.18512696 0.17628828 0.1605898 ]
np_weight_alpha[1] [0.21886761 0.23215906 0.19497028 0.18329307 0.17071001]
np_weight_alpha[2] [0.18702531 0.19551234 0.23005518 0.19347927 0.19392791]
np_weight_alpha[3] [0.17590013 0.18374051 0.1925933  0.2434094  0.2043566 ]
np_weight_alpha[4] [0.15755507 0.16861054 0.18999314 0.20201355 0.28182766]
-------------Round number:  78  -------------
client Accurancy:  0.2777777777777778
client Accurancy:  0.30158730158730157
client Accurancy:  0.32936507936507936
client Accurancy:  0.2896825396825397
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.2746031746031746
Average Global Trainning Accurancy:  0.28435374149659864
Average Global Trainning Loss:  1.8143149447278912
All users are selected
model: 0 tensor([0.2641, 0.2139, 0.1851, 0.1763, 0.1606], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0332, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0081, -0.0075, -0.0174, -0.0177, -0.0111],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2189, 0.2322, 0.1950, 0.1833, 0.1707], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0297, -0.0438, -0.0396, -0.0385, -0.0488],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1870, 0.1955, 0.2301, 0.1935, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0061, 0.0103, 0.0173, 0.0002, 0.0125],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1759, 0.1837, 0.1926, 0.2434, 0.2044], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0110, 0.0189, 0.0071, 0.0304, 0.0173],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1576, 0.1686, 0.1900, 0.2020, 0.2818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0479, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0151, 0.0247, 0.0237, 0.0420]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26569426 0.20614919 0.1876002  0.17975418 0.16080208]
np_weight_alpha[1] [0.20747638 0.2379889  0.19353877 0.18149352 0.17950244]
np_weight_alpha[2] [0.20176478 0.18948635 0.1891208  0.24142458 0.17820339]
np_weight_alpha[3] [0.18187158 0.18182425 0.20168152 0.2314289  0.20319374]
np_weight_alpha[4] [0.16103823 0.17727402 0.18804705 0.20072012 0.27292055]
-------------Round number:  79  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.2976190476190476
client Accurancy:  0.32142857142857145
client Accurancy:  0.32142857142857145
client Accurancy:  0.20634920634920634
Average Global Accurancy:  0.2833333333333333
Average Global Trainning Accurancy:  0.29489795918367345
Average Global Trainning Loss:  1.8532249813988095
All users are selected
model: 0 tensor([0.2657, 0.2061, 0.1876, 0.1798, 0.1608], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0323, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0078, -0.0136, -0.0079,  0.0040, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2075, 0.2380, 0.1935, 0.1815, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0370, -0.0185, -0.0392, -0.0370, -0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2018, 0.1895, 0.1891, 0.2414, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0456,  0.0205, -0.0002,  0.0740,  0.0245],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1819, 0.1818, 0.2017, 0.2314, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0122, -0.0305, -0.0247, -0.0213, -0.0381],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1610, 0.1773, 0.1880, 0.2007, 0.2729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0375, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0287, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0368, 0.0331, 0.0177, 0.0407]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2788199  0.23928434 0.1887623  0.1350086  0.15812483]
np_weight_alpha[1] [0.21291545 0.22601151 0.20073669 0.18696205 0.17337431]
np_weight_alpha[2] [0.18891966 0.20150124 0.22302341 0.19988745 0.18666829]
np_weight_alpha[3] [0.17013259 0.18642159 0.19991373 0.22812206 0.21541008]
np_weight_alpha[4] [0.16160783 0.17131896 0.18415664 0.21188153 0.271035  ]
-------------Round number:  80  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.30952380952380953
client Accurancy:  0.32142857142857145
client Accurancy:  0.2976190476190476
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.2849206349206349
Average Global Trainning Accurancy:  0.2972789115646258
Average Global Trainning Loss:  1.853092115752551
All users are selected
model: 0 tensor([0.2788, 0.2393, 0.1888, 0.1350, 0.1581], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0693, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0005,  0.0024, -0.0193, -0.0637, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2129, 0.2260, 0.2007, 0.1870, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0313, -0.0299, -0.0205, -0.0225, -0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1889, 0.2015, 0.2230, 0.1999, 0.1867], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0270, 0.0309, 0.0200, 0.0311, 0.0174],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1701, 0.1864, 0.1999, 0.2281, 0.2154], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0218, -0.0140, -0.0096, -0.0273, -0.0053],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1616, 0.1713, 0.1842, 0.2119, 0.2710], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0387, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0322, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0406, 0.0370, 0.0263, 0.0423, 0.0350]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2631744  0.21394826 0.18525408 0.17677696 0.16084626]
np_weight_alpha[1] [0.21859798 0.23172423 0.19485301 0.18374471 0.17108002]
np_weight_alpha[2] [0.1870943  0.19535938 0.22979712 0.19366825 0.19408095]
np_weight_alpha[3] [0.17658079 0.1842126  0.19282393 0.24248855 0.20389408]
np_weight_alpha[4] [0.15813752 0.1690109  0.19019665 0.20158565 0.28106934]
-------------Round number:  81  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.3055555555555556
client Accurancy:  0.31746031746031744
client Accurancy:  0.2896825396825397
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.2722222222222222
Average Global Trainning Accurancy:  0.2863945578231292
Average Global Trainning Loss:  1.8091728781356293
All users are selected
model: 0 tensor([0.2632, 0.2139, 0.1853, 0.1768, 0.1608], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0324, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0112, -0.0103, -0.0209, -0.0209, -0.0151],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2186, 0.2317, 0.1949, 0.1837, 0.1711], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0435, -0.0390, -0.0376, -0.0480],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1871, 0.1954, 0.2298, 0.1937, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0085, 0.0128, 0.0198, 0.0031, 0.0152],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1766, 0.1842, 0.1928, 0.2425, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0112, 0.0190, 0.0072, 0.0294, 0.0172],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1581, 0.1690, 0.1902, 0.2016, 0.2811], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0469, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0287, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0155, 0.0251, 0.0239, 0.0421]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26440534 0.2057827  0.18798177 0.18022837 0.1616018 ]
np_weight_alpha[1] [0.2070474  0.2379724  0.19348617 0.18178299 0.17971101]
np_weight_alpha[2] [0.19039164 0.19415867 0.22272204 0.2020891  0.19063847]
np_weight_alpha[3] [0.18221177 0.1821041  0.20160282 0.2313189  0.20276238]
np_weight_alpha[4] [0.16175754 0.17755313 0.18814923 0.20033246 0.27220768]
-------------Round number:  82  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.3055555555555556
client Accurancy:  0.35714285714285715
client Accurancy:  0.32936507936507936
client Accurancy:  0.20238095238095238
Average Global Accurancy:  0.2904761904761905
Average Global Trainning Accurancy:  0.29523809523809524
Average Global Trainning Loss:  1.8434229844281462
All users are selected
model: 0 tensor([0.2644, 0.2058, 0.1880, 0.1802, 0.1616], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0310, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0298, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0104, -0.0160, -0.0098,  0.0013, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2070, 0.2380, 0.1935, 0.1818, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0359, -0.0172, -0.0379, -0.0359, -0.0230],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1904, 0.1942, 0.2227, 0.2021, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0245, 0.0332, 0.0333, 0.0356],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1822, 0.1821, 0.2016, 0.2313, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0324, -0.0264, -0.0228, -0.0397],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1618, 0.1776, 0.1881, 0.2003, 0.2722], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0366, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0282, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0337, 0.0382, 0.0343, 0.0195, 0.0426]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27866444 0.23873691 0.18736938 0.13653257 0.15869671]
np_weight_alpha[1] [0.21248893 0.22586857 0.20056297 0.18729027 0.17378925]
np_weight_alpha[2] [0.18926315 0.20113546 0.22221054 0.20035028 0.1870406 ]
np_weight_alpha[3] [0.17090307 0.18679056 0.19982669 0.22769624 0.21478342]
np_weight_alpha[4] [0.16233045 0.17180972 0.18467389 0.21139057 0.26979542]
-------------Round number:  83  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.30952380952380953
client Accurancy:  0.32142857142857145
client Accurancy:  0.3055555555555556
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.2833333333333333
Average Global Trainning Accurancy:  0.2938775510204082
Average Global Trainning Loss:  1.8491174399447279
All users are selected
model: 0 tensor([0.2787, 0.2387, 0.1874, 0.1365, 0.1587], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0679, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0009,  0.0016, -0.0214, -0.0632, -0.0222],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2125, 0.2259, 0.2006, 0.1873, 0.1738], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0310, -0.0296, -0.0198, -0.0220, -0.0210],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1893, 0.2011, 0.2222, 0.2004, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0273, 0.0310, 0.0191, 0.0318, 0.0179],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1709, 0.1868, 0.1998, 0.2277, 0.2148], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0222, -0.0145, -0.0102, -0.0279, -0.0062],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1623, 0.1718, 0.1847, 0.2114, 0.2698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0372, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0322, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0413, 0.0379, 0.0273, 0.0427, 0.0346]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2619059  0.21382184 0.1855508  0.17731152 0.1614099 ]
np_weight_alpha[1] [0.21835741 0.23181072 0.19456394 0.18406163 0.17120627]
np_weight_alpha[2] [0.18724094 0.19507138 0.23005748 0.19354786 0.19408235]
np_weight_alpha[3] [0.17708413 0.184544   0.19277593 0.24202909 0.20356679]
np_weight_alpha[4] [0.15862821 0.16915944 0.19027533 0.2012687  0.2806683 ]
-------------Round number:  84  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.3055555555555556
client Accurancy:  0.3492063492063492
client Accurancy:  0.29365079365079366
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.2785714285714286
Average Global Trainning Accurancy:  0.2894557823129252
Average Global Trainning Loss:  1.8031984082695578
All users are selected
model: 0 tensor([0.2619, 0.2138, 0.1856, 0.1773, 0.1614], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0312, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0134, -0.0121, -0.0228, -0.0235, -0.0171],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2184, 0.2318, 0.1946, 0.1841, 0.1712], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0289, -0.0434, -0.0395, -0.0379, -0.0485],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1872, 0.1951, 0.2301, 0.1935, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0111, 0.0152, 0.0229, 0.0057, 0.0176],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1771, 0.1845, 0.1928, 0.2420, 0.2036], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0100, 0.0182, 0.0066, 0.0292, 0.0166],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1586, 0.1692, 0.1903, 0.2013, 0.2807], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0463, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0284, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0237, 0.0157, 0.0254, 0.0244, 0.0428]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2629676  0.20549047 0.18819888 0.18125342 0.16208968]
np_weight_alpha[1] [0.20665796 0.23763256 0.19347271 0.18215026 0.18008655]
np_weight_alpha[2] [0.19050674 0.19412409 0.22252308 0.2020148  0.19083126]
np_weight_alpha[3] [0.18320672 0.18250175 0.2015754  0.2303338  0.20238227]
np_weight_alpha[4] [0.16221167 0.1779494  0.18839201 0.20000297 0.27144396]
-------------Round number:  85  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.30158730158730157
client Accurancy:  0.3531746031746032
client Accurancy:  0.32936507936507936
client Accurancy:  0.20634920634920634
Average Global Accurancy:  0.2896825396825397
Average Global Trainning Accurancy:  0.29489795918367345
Average Global Trainning Loss:  1.837844454187925
All users are selected
model: 0 tensor([0.2630, 0.2055, 0.1882, 0.1813, 0.1621], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0296, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0295, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0128, -0.0176, -0.0117,  0.0001, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2067, 0.2376, 0.1935, 0.1822, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0357, -0.0172, -0.0377, -0.0357, -0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1905, 0.1941, 0.2225, 0.2020, 0.1908], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0348, 0.0266, 0.0353, 0.0354, 0.0375],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1825, 0.2016, 0.2303, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0336, -0.0276, -0.0250, -0.0411],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1622, 0.1779, 0.1884, 0.2000, 0.2714], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0358, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0278, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0346, 0.0393, 0.0354, 0.0206, 0.0439]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2722697  0.20927325 0.18635105 0.16961755 0.16248842]
np_weight_alpha[1] [0.21206248 0.22570306 0.20052828 0.18756974 0.17413639]
np_weight_alpha[2] [0.18957916 0.20109387 0.22189601 0.20014231 0.18728861]
np_weight_alpha[3] [0.17119347 0.18705457 0.1996333  0.22760816 0.21451055]
np_weight_alpha[4] [0.16297662 0.17223677 0.1850052  0.21117549 0.26860595]
-------------Round number:  86  -------------
client Accurancy:  0.1984126984126984
client Accurancy:  0.30952380952380953
client Accurancy:  0.3253968253968254
client Accurancy:  0.30158730158730157
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.2714285714285714
Average Global Trainning Accurancy:  0.2904761904761905
Average Global Trainning Loss:  1.856034923735119
All users are selected
model: 0 tensor([0.2723, 0.2093, 0.1864, 0.1696, 0.1625], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0391, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0055, -0.0284, -0.0220, -0.0280, -0.0166],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2121, 0.2257, 0.2005, 0.1876, 0.1741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0302, -0.0289, -0.0189, -0.0212, -0.0203],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1896, 0.2011, 0.2219, 0.2001, 0.1873], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0270, 0.0308, 0.0187, 0.0312, 0.0177],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1712, 0.1871, 0.1996, 0.2276, 0.2145], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0245, -0.0164, -0.0124, -0.0292, -0.0080],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1630, 0.1722, 0.1850, 0.2112, 0.2686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0360, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0319, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0414, 0.0381, 0.0276, 0.0430, 0.0343]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26280195 0.21506728 0.18573906 0.17599429 0.16039746]
np_weight_alpha[1] [0.2179066  0.23178677 0.19441766 0.18430826 0.17158069]
np_weight_alpha[2] [0.18752806 0.19491303 0.22974148 0.1936157  0.19420174]
np_weight_alpha[3] [0.1777534  0.18482102 0.19287641 0.24130818 0.20324098]
np_weight_alpha[4] [0.15921363 0.16957742 0.19047713 0.20102172 0.27971008]
-------------Round number:  87  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.3134920634920635
client Accurancy:  0.3531746031746032
client Accurancy:  0.3055555555555556
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.2849206349206349
Average Global Trainning Accurancy:  0.2931972789115646
Average Global Trainning Loss:  1.7981740938562925
All users are selected
model: 0 tensor([0.2628, 0.2151, 0.1857, 0.1760, 0.1604], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0326, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0253, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0115, -0.0105, -0.0230, -0.0256, -0.0194],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2179, 0.2318, 0.1944, 0.1843, 0.1716], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0293, -0.0436, -0.0399, -0.0384, -0.0489],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1875, 0.1949, 0.2297, 0.1936, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0128, 0.0167, 0.0242, 0.0074, 0.0191],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1778, 0.1848, 0.1929, 0.2413, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0098, 0.0177, 0.0063, 0.0283, 0.0160],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1592, 0.1696, 0.1905, 0.2010, 0.2797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0452, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0280, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0155, 0.0253, 0.0243, 0.0426]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2616056  0.20503078 0.18846048 0.18186513 0.163038  ]
np_weight_alpha[1] [0.2062587  0.2374511  0.19336392 0.18248406 0.18044227]
np_weight_alpha[2] [0.19062811 0.19399847 0.22243686 0.20194647 0.19099014]
np_weight_alpha[3] [0.18359253 0.18282598 0.20152995 0.22992507 0.20212649]
np_weight_alpha[4] [0.1629412  0.17838807 0.18863711 0.1998165  0.27021712]
-------------Round number:  88  -------------
client Accurancy:  0.25396825396825395
client Accurancy:  0.3055555555555556
client Accurancy:  0.3492063492063492
client Accurancy:  0.32936507936507936
client Accurancy:  0.1984126984126984
Average Global Accurancy:  0.2873015873015873
Average Global Trainning Accurancy:  0.2972789115646258
Average Global Trainning Loss:  1.834713973480017
All users are selected
model: 0 tensor([0.2616, 0.2050, 0.1885, 0.1819, 0.1630], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0282, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0291, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0138, -0.0185, -0.0123, -0.0005, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2063, 0.2375, 0.1934, 0.1825, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0362, -0.0174, -0.0378, -0.0360, -0.0235],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1906, 0.1940, 0.2224, 0.2019, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0364, 0.0285, 0.0369, 0.0369, 0.0393],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1836, 0.1828, 0.2015, 0.2299, 0.2021], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0175, -0.0356, -0.0297, -0.0267, -0.0428],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1629, 0.1784, 0.1886, 0.1998, 0.2702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0345, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0277, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0362, 0.0403, 0.0368, 0.0221, 0.0444]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2711181  0.2091281  0.18662792 0.17029418 0.16283168]
np_weight_alpha[1] [0.21181746 0.22536427 0.2001966  0.18793121 0.17469051]
np_weight_alpha[2] [0.1897598  0.2007282  0.22186063 0.20027253 0.18737885]
np_weight_alpha[3] [0.17188664 0.18745749 0.19980162 0.22686376 0.21399051]
np_weight_alpha[4] [0.16330205 0.17279094 0.18514039 0.2107327  0.26803395]
-------------Round number:  89  -------------
client Accurancy:  0.1984126984126984
client Accurancy:  0.3134920634920635
client Accurancy:  0.32936507936507936
client Accurancy:  0.30158730158730157
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.273015873015873
Average Global Trainning Accurancy:  0.29183673469387755
Average Global Trainning Loss:  1.8535348905187075
All users are selected
model: 0 tensor([0.2711, 0.2091, 0.1866, 0.1703, 0.1628], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0379, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0050, -0.0279, -0.0216, -0.0270, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2118, 0.2254, 0.2002, 0.1879, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0302, -0.0291, -0.0189, -0.0208, -0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1898, 0.2007, 0.2219, 0.2003, 0.1874], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0263, 0.0302, 0.0182, 0.0308, 0.0175],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1719, 0.1875, 0.1998, 0.2269, 0.2140], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0243, -0.0164, -0.0126, -0.0303, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1633, 0.1728, 0.1851, 0.2107, 0.2680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0353, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0315, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0411, 0.0384, 0.0281, 0.0430, 0.0349]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2613991  0.21501148 0.18616106 0.17625329 0.16117516]
np_weight_alpha[1] [0.21775587 0.23176526 0.19417554 0.18438855 0.17191479]
np_weight_alpha[2] [0.18788256 0.19467212 0.22971915 0.1936534  0.19407274]
np_weight_alpha[3] [0.17785458 0.18486834 0.19293071 0.24130303 0.20304331]
np_weight_alpha[4] [0.16000265 0.17001756 0.1904802  0.20086257 0.27863705]
-------------Round number:  90  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.31746031746031744
client Accurancy:  0.3531746031746032
client Accurancy:  0.30952380952380953
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.2865079365079365
Average Global Trainning Accurancy:  0.2979591836734694
Average Global Trainning Loss:  1.7933563855229593
All users are selected
model: 0 tensor([0.2614, 0.2150, 0.1862, 0.1763, 0.1612], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0313, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0122, -0.0104, -0.0232, -0.0261, -0.0193],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2178, 0.2318, 0.1942, 0.1844, 0.1719], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0295, -0.0439, -0.0404, -0.0392, -0.0495],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1879, 0.1947, 0.2297, 0.1937, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0146, 0.0184, 0.0261, 0.0093, 0.0206],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1779, 0.1849, 0.1929, 0.2413, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0086, 0.0165, 0.0057, 0.0282, 0.0153],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1600, 0.1700, 0.1905, 0.2009, 0.2786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0439, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0277, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0153, 0.0249, 0.0241, 0.0421]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2605211  0.20466149 0.18888384 0.18238759 0.16354594]
np_weight_alpha[1] [0.2058049  0.23720801 0.19322072 0.1828975  0.18086891]
np_weight_alpha[2] [0.19097263 0.19383827 0.2222154  0.20185721 0.1911165 ]
np_weight_alpha[3] [0.18410395 0.18325242 0.20146523 0.22928545 0.20189287]
np_weight_alpha[4] [0.16344069 0.17883718 0.18881908 0.19967172 0.26923135]
-------------Round number:  91  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.30952380952380953
client Accurancy:  0.3531746031746032
client Accurancy:  0.3333333333333333
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.2873015873015873
Average Global Trainning Accurancy:  0.29897959183673467
Average Global Trainning Loss:  1.8313491509885205
All users are selected
model: 0 tensor([0.2605, 0.2047, 0.1889, 0.1824, 0.1635], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0272, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0288, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0147, -0.0191, -0.0127, -0.0010, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2058, 0.2372, 0.1932, 0.1829, 0.1809], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0368, -0.0179, -0.0383, -0.0364, -0.0241],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1910, 0.1938, 0.2222, 0.2019, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0377, 0.0298, 0.0381, 0.0381, 0.0403],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1833, 0.2015, 0.2293, 0.2019], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0180, -0.0362, -0.0304, -0.0278, -0.0433],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1634, 0.1788, 0.1888, 0.1997, 0.2692], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0335, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0273, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0366, 0.0409, 0.0374, 0.0229, 0.0450]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2700988  0.20885484 0.18693101 0.1706676  0.16344772]
np_weight_alpha[1] [0.21147484 0.22510432 0.2000113  0.1882405  0.17516913]
np_weight_alpha[2] [0.18997127 0.20051757 0.22165982 0.20023087 0.18762045]
np_weight_alpha[3] [0.17219827 0.18777062 0.199767   0.22666052 0.21360357]
np_weight_alpha[4] [0.16393884 0.17334318 0.1854552  0.21044497 0.26681787]
-------------Round number:  92  -------------
client Accurancy:  0.1984126984126984
client Accurancy:  0.3134920634920635
client Accurancy:  0.32936507936507936
client Accurancy:  0.30952380952380953
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.2753968253968254
Average Global Trainning Accurancy:  0.29285714285714287
Average Global Trainning Loss:  1.8488527051445578
All users are selected
model: 0 tensor([0.2701, 0.2089, 0.1869, 0.1707, 0.1634], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0368, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0044, -0.0274, -0.0212, -0.0269, -0.0163],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2115, 0.2251, 0.2000, 0.1882, 0.1752], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0303, -0.0295, -0.0190, -0.0210, -0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1900, 0.2005, 0.2217, 0.2002, 0.1876], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0307, 0.0186, 0.0312, 0.0182],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1722, 0.1878, 0.1998, 0.2267, 0.2136], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0257, -0.0175, -0.0138, -0.0311, -0.0097],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1639, 0.1733, 0.1855, 0.2104, 0.2668], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0340, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0313, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0415, 0.0391, 0.0288, 0.0436, 0.0348]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25997144 0.21473631 0.1864871  0.17691876 0.16188638]
np_weight_alpha[1] [0.21736284 0.23170638 0.19397303 0.18468443 0.17227331]
np_weight_alpha[2] [0.18811683 0.19445673 0.22963643 0.19371715 0.19407277]
np_weight_alpha[3] [0.17846242 0.18518743 0.19303633 0.24068648 0.20262735]
np_weight_alpha[4] [0.1606657  0.1704166  0.19057564 0.20051475 0.27782735]
-------------Round number:  93  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.3253968253968254
client Accurancy:  0.35714285714285715
client Accurancy:  0.3134920634920635
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.28809523809523807
Average Global Trainning Accurancy:  0.29965986394557825
Average Global Trainning Loss:  1.7901739211309524
All users are selected
model: 0 tensor([0.2600, 0.2147, 0.1865, 0.1769, 0.1619], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0299, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0131, -0.0104, -0.0235, -0.0261, -0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2174, 0.2317, 0.1940, 0.1847, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0303, -0.0448, -0.0412, -0.0401, -0.0506],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1881, 0.1945, 0.2296, 0.1937, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0162, 0.0202, 0.0280, 0.0112, 0.0222],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1785, 0.1852, 0.1930, 0.2407, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0083, 0.0162, 0.0055, 0.0276, 0.0148],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1607, 0.1704, 0.1906, 0.2005, 0.2778], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0428, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0274, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0234, 0.0149, 0.0245, 0.0237, 0.0418]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25962892 0.20427004 0.18933778 0.18291937 0.16384389]
np_weight_alpha[1] [0.2053423  0.23717639 0.19295138 0.18317118 0.18135877]
np_weight_alpha[2] [0.19137597 0.1935665  0.22200312 0.20172873 0.19132565]
np_weight_alpha[3] [0.18459924 0.18352391 0.20135929 0.2288299  0.20168765]
np_weight_alpha[4] [0.16376388 0.17936233 0.18908364 0.19951038 0.2682798 ]
-------------Round number:  94  -------------
client Accurancy:  0.24206349206349206
client Accurancy:  0.3134920634920635
client Accurancy:  0.3611111111111111
client Accurancy:  0.3412698412698413
client Accurancy:  0.19047619047619047
Average Global Accurancy:  0.2896825396825397
Average Global Trainning Accurancy:  0.30272108843537415
Average Global Trainning Loss:  1.8268655997555272
All users are selected
model: 0 tensor([0.2596, 0.2043, 0.1893, 0.1829, 0.1638], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0285, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0153, -0.0197, -0.0129, -0.0010, -0.0121],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2053, 0.2372, 0.1930, 0.1832, 0.1814], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0375, -0.0183, -0.0388, -0.0368, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1936, 0.2220, 0.2017, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0395, 0.0313, 0.0395, 0.0396, 0.0420],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1846, 0.1835, 0.2014, 0.2288, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0185, -0.0369, -0.0312, -0.0293, -0.0442],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1638, 0.1794, 0.1891, 0.1995, 0.2683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0326, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0365, 0.0412, 0.0378, 0.0233, 0.0455]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2692185  0.20863709 0.18721431 0.17082988 0.16410026]
np_weight_alpha[1] [0.21120177 0.22495833 0.19982614 0.18836334 0.17565045]
np_weight_alpha[2] [0.1901785  0.20031233 0.22164802 0.20012327 0.1877379 ]
np_weight_alpha[3] [0.17227736 0.18787748 0.1996553  0.22681157 0.2133782 ]
np_weight_alpha[4] [0.16462743 0.17391092 0.1856668  0.21032451 0.26547033]
-------------Round number:  95  -------------
client Accurancy:  0.20238095238095238
client Accurancy:  0.31746031746031744
client Accurancy:  0.3412698412698413
client Accurancy:  0.30952380952380953
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.2785714285714286
Average Global Trainning Accurancy:  0.29523809523809524
Average Global Trainning Loss:  1.8435440582482994
All users are selected
model: 0 tensor([0.2692, 0.2086, 0.1872, 0.1708, 0.1641], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0358, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0037, -0.0268, -0.0206, -0.0264, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2112, 0.2250, 0.1998, 0.1884, 0.1757], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0299, -0.0289, -0.0186, -0.0205, -0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1902, 0.2003, 0.2216, 0.2001, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0266, 0.0305, 0.0188, 0.0312, 0.0185],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1723, 0.1879, 0.1997, 0.2268, 0.2134], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0189, -0.0151, -0.0316, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1646, 0.1739, 0.1857, 0.2103, 0.2655], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0327, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0313, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0418, 0.0396, 0.0291, 0.0435, 0.0335]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25881627 0.21466984 0.1869247  0.17735271 0.1622365 ]
np_weight_alpha[1] [0.21721323 0.2315392  0.19401777 0.1849566  0.17227323]
np_weight_alpha[2] [0.18851858 0.19450758 0.22938998 0.1936333  0.19395056]
np_weight_alpha[3] [0.17887467 0.18549432 0.19298676 0.24008049 0.20256379]
np_weight_alpha[4] [0.1609161  0.1703989  0.19048016 0.2004693  0.27773556]
-------------Round number:  96  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.3333333333333333
client Accurancy:  0.3611111111111111
client Accurancy:  0.32142857142857145
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.29285714285714287
Average Global Trainning Accurancy:  0.30272108843537415
Average Global Trainning Loss:  1.7834605521896258
All users are selected
model: 0 tensor([0.2588, 0.2147, 0.1869, 0.1774, 0.1622], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0129, -0.0095, -0.0226, -0.0251, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2172, 0.2315, 0.1940, 0.1850, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0304, -0.0450, -0.0415, -0.0404, -0.0513],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1885, 0.1945, 0.2294, 0.1936, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0221, 0.0298, 0.0130, 0.0238],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1789, 0.1855, 0.1930, 0.2401, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0072, 0.0148, 0.0040, 0.0255, 0.0133],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1609, 0.1704, 0.1905, 0.2005, 0.2777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0427, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0138, 0.0238, 0.0232, 0.0424]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2587205  0.20398428 0.18962298 0.1830272  0.16464508]
np_weight_alpha[1] [0.20498629 0.23686221 0.19295181 0.18338706 0.18181258]
np_weight_alpha[2] [0.19158013 0.19354561 0.22179691 0.2016985  0.19137889]
np_weight_alpha[3] [0.18461937 0.18370035 0.20132771 0.22877105 0.20158145]
np_weight_alpha[4] [0.16464756 0.17992118 0.18923624 0.19948912 0.26670584]
-------------Round number:  97  -------------
client Accurancy:  0.24206349206349206
client Accurancy:  0.3134920634920635
client Accurancy:  0.36507936507936506
client Accurancy:  0.34523809523809523
client Accurancy:  0.19047619047619047
Average Global Accurancy:  0.2912698412698413
Average Global Trainning Accurancy:  0.3047619047619048
Average Global Trainning Loss:  1.8231950201955782
All users are selected
model: 0 tensor([0.2587, 0.2040, 0.1896, 0.1830, 0.1646], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0155, -0.0199, -0.0131, -0.0018, -0.0119],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2050, 0.2369, 0.1930, 0.1834, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0377, -0.0183, -0.0387, -0.0370, -0.0247],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1935, 0.2218, 0.2017, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0412, 0.0331, 0.0411, 0.0412, 0.0435],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1846, 0.1837, 0.2013, 0.2288, 0.2016], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0206, -0.0385, -0.0327, -0.0300, -0.0452],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1646, 0.1799, 0.1892, 0.1995, 0.2667], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0311, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0371, 0.0413, 0.0378, 0.0237, 0.0446]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26810282 0.20843668 0.18746676 0.17148307 0.1645107 ]
np_weight_alpha[1] [0.21092586 0.22460455 0.1996702  0.18869619 0.17610317]
np_weight_alpha[2] [0.19032915 0.20012788 0.22143179 0.20018084 0.18793032]
np_weight_alpha[3] [0.17294708 0.18826132 0.19973889 0.22609852 0.2129542 ]
np_weight_alpha[4] [0.16497388 0.17437042 0.18588924 0.21001494 0.26475152]
-------------Round number:  98  -------------
client Accurancy:  0.20634920634920634
client Accurancy:  0.32142857142857145
client Accurancy:  0.3412698412698413
client Accurancy:  0.3134920634920635
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.28095238095238095
Average Global Trainning Accurancy:  0.29625850340136056
Average Global Trainning Loss:  1.8392054966517857
All users are selected
model: 0 tensor([0.2681, 0.2084, 0.1875, 0.1715, 0.1645], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0347, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0030, -0.0261, -0.0199, -0.0256, -0.0153],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2109, 0.2246, 0.1997, 0.1887, 0.1761], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0293, -0.0284, -0.0182, -0.0198, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1903, 0.2001, 0.2214, 0.2002, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0270, 0.0309, 0.0193, 0.0317, 0.0191],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1729, 0.1883, 0.1997, 0.2261, 0.2130], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0282, -0.0199, -0.0163, -0.0333, -0.0125],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1650, 0.1744, 0.1859, 0.2100, 0.2648], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0319, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0308, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0409, 0.0391, 0.0289, 0.0432, 0.0338]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2574362  0.214472   0.18723796 0.17778471 0.16306908]
np_weight_alpha[1] [0.2169151  0.23118794 0.1939199  0.18508443 0.1728927 ]
np_weight_alpha[2] [0.18875504 0.19439328 0.22919564 0.19367276 0.19398332]
np_weight_alpha[3] [0.1791811  0.18557754 0.19304359 0.23983826 0.20235953]
np_weight_alpha[4] [0.1618108  0.17112829 0.19067821 0.20034383 0.27603886]
-------------Round number:  99  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.3253968253968254
client Accurancy:  0.36507936507936506
client Accurancy:  0.31746031746031744
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.2912698412698413
Average Global Trainning Accurancy:  0.30612244897959184
Average Global Trainning Loss:  1.7808849516369047
All users are selected
model: 0 tensor([0.2574, 0.2145, 0.1872, 0.1778, 0.1631], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0276, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0132, -0.0088, -0.0221, -0.0247, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2169, 0.2312, 0.1939, 0.1851, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0304, -0.0451, -0.0417, -0.0408, -0.0515],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1888, 0.1944, 0.2292, 0.1937, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0193, 0.0232, 0.0308, 0.0143, 0.0247],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1792, 0.1856, 0.1930, 0.2398, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0063, 0.0137, 0.0034, 0.0248, 0.0126],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1618, 0.1711, 0.1907, 0.2003, 0.2760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0408, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0220, 0.0135, 0.0234, 0.0229, 0.0413]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25790283 0.20358825 0.18988119 0.18344429 0.16518342]
np_weight_alpha[1] [0.20453821 0.23645803 0.19288026 0.18374023 0.18238333]
np_weight_alpha[2] [0.19177674 0.1934488  0.22161251 0.20158248 0.19157942]
np_weight_alpha[3] [0.18501586 0.18404883 0.20122682 0.22840695 0.20130152]
np_weight_alpha[4] [0.16520107 0.18052919 0.18950823 0.1993108  0.26545075]
-------------Round number:  100  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3134920634920635
client Accurancy:  0.36904761904761907
client Accurancy:  0.3492063492063492
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.29444444444444445
Average Global Trainning Accurancy:  0.30714285714285716
Average Global Trainning Loss:  1.8208944515306122
All users are selected
model: 0 tensor([0.2579, 0.2036, 0.1899, 0.1834, 0.1652], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0248, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0278, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0163, -0.0207, -0.0136, -0.0026, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2045, 0.2365, 0.1929, 0.1837, 0.1824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0385, -0.0192, -0.0392, -0.0375, -0.0254],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1934, 0.2216, 0.2016, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0426, 0.0345, 0.0420, 0.0424, 0.0449],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1840, 0.2012, 0.2284, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0214, -0.0391, -0.0335, -0.0308, -0.0459],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1652, 0.1805, 0.1895, 0.1993, 0.2655], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0299, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0263, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0380, 0.0423, 0.0390, 0.0248, 0.0451]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26712656 0.2082218  0.18759845 0.17197408 0.1650791 ]
np_weight_alpha[1] [0.21065843 0.22435533 0.19946519 0.18893746 0.1765836 ]
np_weight_alpha[2] [0.19036265 0.19989084 0.22160669 0.20015314 0.18798667]
np_weight_alpha[3] [0.17339776 0.18852516 0.19973423 0.22572786 0.21261503]
np_weight_alpha[4] [0.16552472 0.1749048  0.1860173  0.20976192 0.26379123]
-------------Round number:  101  -------------
client Accurancy:  0.20634920634920634
client Accurancy:  0.3253968253968254
client Accurancy:  0.3412698412698413
client Accurancy:  0.32142857142857145
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.2833333333333333
Average Global Trainning Accurancy:  0.29931972789115646
Average Global Trainning Loss:  1.835171363467262
All users are selected
model: 0 tensor([0.2671, 0.2082, 0.1876, 0.1720, 0.1651], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0337, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0022, -0.0253, -0.0195, -0.0245, -0.0146],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2107, 0.2244, 0.1995, 0.1889, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0296, -0.0290, -0.0184, -0.0199, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1904, 0.1999, 0.2216, 0.2002, 0.1880], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0262, 0.0305, 0.0193, 0.0314, 0.0188],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1734, 0.1885, 0.1997, 0.2257, 0.2126], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0291, -0.0209, -0.0174, -0.0349, -0.0138],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1655, 0.1749, 0.1860, 0.2098, 0.2638], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0309, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0305, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0418, 0.0404, 0.0301, 0.0442, 0.0346]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25623983 0.21431196 0.18771385 0.17807087 0.16366349]
np_weight_alpha[1] [0.21666189 0.23127408 0.19375025 0.18518715 0.1731266 ]
np_weight_alpha[2] [0.18918857 0.19423212 0.22897902 0.1936128  0.19398753]
np_weight_alpha[3] [0.17936544 0.18566673 0.19299483 0.23981728 0.20215568]
np_weight_alpha[4] [0.16239123 0.17142332 0.1907692  0.20018867 0.2752276 ]
-------------Round number:  102  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.32936507936507936
client Accurancy:  0.3611111111111111
client Accurancy:  0.3253968253968254
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.2920634920634921
Average Global Trainning Accurancy:  0.3085034013605442
Average Global Trainning Loss:  1.7768182663690477
All users are selected
model: 0 tensor([0.2562, 0.2143, 0.1877, 0.1781, 0.1637], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0127, -0.0076, -0.0210, -0.0238, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2167, 0.2313, 0.1938, 0.1852, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0313, -0.0461, -0.0426, -0.0420, -0.0527],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1892, 0.1942, 0.2290, 0.1936, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0208, 0.0246, 0.0320, 0.0157, 0.0259],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1794, 0.1857, 0.1930, 0.2398, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0047, 0.0121, 0.0020, 0.0236, 0.0112],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1624, 0.1714, 0.1908, 0.2002, 0.2752], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0399, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0136, 0.0235, 0.0232, 0.0416]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25698262 0.20321694 0.19020867 0.1838092  0.16578254]
np_weight_alpha[1] [0.20409797 0.236509   0.19267045 0.18399549 0.18272713]
np_weight_alpha[2] [0.19202444 0.19323035 0.22155403 0.20146102 0.19173025]
np_weight_alpha[3] [0.18534146 0.1843107  0.20111458 0.22815014 0.20108311]
np_weight_alpha[4] [0.16581453 0.18094043 0.18972148 0.19917338 0.26435018]
-------------Round number:  103  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3253968253968254
client Accurancy:  0.36904761904761907
client Accurancy:  0.3412698412698413
client Accurancy:  0.19047619047619047
Average Global Accurancy:  0.29444444444444445
Average Global Trainning Accurancy:  0.31054421768707485
Average Global Trainning Loss:  1.8170001594387755
All users are selected
model: 0 tensor([0.2570, 0.2032, 0.1902, 0.1838, 0.1658], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0276, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0167, -0.0211, -0.0136, -0.0028, -0.0123],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2041, 0.2365, 0.1927, 0.1840, 0.1827], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0389, -0.0191, -0.0393, -0.0376, -0.0257],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1932, 0.2216, 0.2015, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0432, 0.0352, 0.0426, 0.0430, 0.0454],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1853, 0.1843, 0.2011, 0.2282, 0.2011], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0224, -0.0398, -0.0343, -0.0317, -0.0467],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1658, 0.1809, 0.1897, 0.1992, 0.2644], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0391, 0.0428, 0.0395, 0.0254, 0.0451]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2664159  0.20812379 0.18787403 0.17238268 0.16520359]
np_weight_alpha[1] [0.21051566 0.22418131 0.19917978 0.18907464 0.17704858]
np_weight_alpha[2] [0.19058488 0.19958854 0.2215817  0.20000377 0.18824118]
np_weight_alpha[3] [0.17379701 0.18867393 0.19959363 0.22555149 0.21238402]
np_weight_alpha[4] [0.16564742 0.17538445 0.18630326 0.20959842 0.26306647]
-------------Round number:  104  -------------
client Accurancy:  0.21031746031746032
client Accurancy:  0.32142857142857145
client Accurancy:  0.35714285714285715
client Accurancy:  0.3333333333333333
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.2904761904761905
Average Global Trainning Accurancy:  0.3003401360544218
Average Global Trainning Loss:  1.8294269172512756
All users are selected
model: 0 tensor([0.2664, 0.2081, 0.1879, 0.1724, 0.1652], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0330, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0013, -0.0244, -0.0185, -0.0234, -0.0137],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2105, 0.2242, 0.1992, 0.1891, 0.1770], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0297, -0.0291, -0.0186, -0.0200, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1906, 0.1996, 0.2216, 0.2000, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0261, 0.0302, 0.0192, 0.0312, 0.0190],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1738, 0.1887, 0.1996, 0.2256, 0.2124], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0301, -0.0220, -0.0186, -0.0360, -0.0149],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1656, 0.1754, 0.1863, 0.2096, 0.2631], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0305, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0420, 0.0410, 0.0307, 0.0445, 0.0342]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2555515  0.21424429 0.18796584 0.17833221 0.16390617]
np_weight_alpha[1] [0.21655108 0.23124185 0.19362    0.18537527 0.17321178]
np_weight_alpha[2] [0.18941677 0.19410096 0.22894186 0.19356076 0.19397967]
np_weight_alpha[3] [0.17959322 0.18585946 0.19296135 0.23963158 0.2019545 ]
np_weight_alpha[4] [0.16259286 0.1715192  0.19078928 0.19999246 0.2751062 ]
-------------Round number:  105  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.3333333333333333
client Accurancy:  0.36507936507936506
client Accurancy:  0.3253968253968254
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.29365079365079366
Average Global Trainning Accurancy:  0.30986394557823127
Average Global Trainning Loss:  1.7719665112138605
All users are selected
model: 0 tensor([0.2556, 0.2142, 0.1880, 0.1783, 0.1639], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0124, -0.0068, -0.0203, -0.0234, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2166, 0.2312, 0.1936, 0.1854, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0312, -0.0463, -0.0428, -0.0423, -0.0533],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1894, 0.1941, 0.2289, 0.1936, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0220, 0.0257, 0.0328, 0.0167, 0.0269],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1796, 0.1859, 0.1930, 0.2396, 0.2020], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0035, 0.0110, 0.0011, 0.0228, 0.0102],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1626, 0.1715, 0.1908, 0.2000, 0.2751], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0397, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0216, 0.0130, 0.0233, 0.0230, 0.0420]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25645518 0.2028629  0.19032508 0.18419765 0.16615924]
np_weight_alpha[1] [0.2036978  0.23634939 0.19248636 0.18427463 0.18319179]
np_weight_alpha[2] [0.19208294 0.19302236 0.22180106 0.20133224 0.19176142]
np_weight_alpha[3] [0.20939761 0.17919445 0.23808293 0.17488895 0.19843602]
np_weight_alpha[4] [0.16622989 0.18143724 0.18981582 0.19905826 0.2634588 ]
-------------Round number:  106  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3253968253968254
client Accurancy:  0.373015873015873
client Accurancy:  0.3492063492063492
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.2976190476190476
Average Global Trainning Accurancy:  0.31258503401360543
Average Global Trainning Loss:  1.8258933553890306
All users are selected
model: 0 tensor([0.2565, 0.2029, 0.1903, 0.1842, 0.1662], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0272, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0176, -0.0224, -0.0148, -0.0042, -0.0137],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2037, 0.2363, 0.1925, 0.1843, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0400, -0.0200, -0.0401, -0.0384, -0.0266],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1921, 0.1930, 0.2218, 0.2013, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0447, 0.0367, 0.0443, 0.0441, 0.0467],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2094, 0.1792, 0.2381, 0.1749, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010, -0.0472,  0.0002, -0.0892, -0.0539],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1662, 0.1814, 0.1898, 0.1991, 0.2635], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0394, 0.0432, 0.0399, 0.0261, 0.0453]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26541257 0.20798312 0.18798253 0.17294116 0.1656806 ]
np_weight_alpha[1] [0.21032096 0.22399943 0.19891633 0.18928745 0.17747574]
np_weight_alpha[2] [0.1906016  0.1992979  0.22151272 0.20021582 0.18837196]
np_weight_alpha[3] [0.17182887 0.18799736 0.19912064 0.22701442 0.21403867]
np_weight_alpha[4] [0.16609415 0.17585818 0.18647681 0.20923968 0.2623312 ]
-------------Round number:  107  -------------
client Accurancy:  0.21428571428571427
client Accurancy:  0.3253968253968254
client Accurancy:  0.3611111111111111
client Accurancy:  0.3373015873015873
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.29365079365079366
Average Global Trainning Accurancy:  0.30374149659863947
Average Global Trainning Loss:  1.8230726177189627
All users are selected
model: 0 tensor([0.2654, 0.2080, 0.1880, 0.1729, 0.1657], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0320, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0011, -0.0235, -0.0179, -0.0225, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2103, 0.2240, 0.1989, 0.1893, 0.1775], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0300, -0.0295, -0.0192, -0.0205, -0.0187],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1906, 0.1993, 0.2215, 0.2002, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0259, 0.0301, 0.0196, 0.0316, 0.0194],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1718, 0.1880, 0.1991, 0.2270, 0.2140], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0345, -0.0249, -0.0210, -0.0358, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1661, 0.1759, 0.1865, 0.2092, 0.2623], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0294, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0305, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0434, 0.0424, 0.0320, 0.0456, 0.0347]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25489038 0.21402395 0.18832205 0.1786967  0.16406685]
np_weight_alpha[1] [0.21626487 0.2309966  0.19360135 0.18564564 0.17349154]
np_weight_alpha[2] [0.18977399 0.19408308 0.22863151 0.19359136 0.19392002]
np_weight_alpha[3] [0.18021315 0.18628387 0.19304955 0.23907731 0.20137611]
np_weight_alpha[4] [0.1627244  0.17176688 0.1907583  0.1996996  0.27505082]
-------------Round number:  108  -------------
client Accurancy:  0.27380952380952384
client Accurancy:  0.3333333333333333
client Accurancy:  0.36904761904761907
client Accurancy:  0.32936507936507936
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.29603174603174603
Average Global Trainning Accurancy:  0.31394557823129254
Average Global Trainning Loss:  1.7661325467687075
All users are selected
model: 0 tensor([0.2549, 0.2140, 0.1883, 0.1787, 0.1641], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0125, -0.0067, -0.0205, -0.0233, -0.0178],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2163, 0.2310, 0.1936, 0.1856, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0312, -0.0464, -0.0429, -0.0426, -0.0539],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1898, 0.1941, 0.2286, 0.1936, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0227, 0.0265, 0.0333, 0.0176, 0.0274],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1863, 0.1930, 0.2391, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0035, 0.0106, 0.0007, 0.0219, 0.0091],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1627, 0.1718, 0.1908, 0.1997, 0.2751], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0395, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0253, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0213, 0.0129, 0.0233, 0.0230, 0.0433]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25573373 0.20243427 0.19074188 0.18440104 0.16668908]
np_weight_alpha[1] [0.20322736 0.23602378 0.19238335 0.18461873 0.18374683]
np_weight_alpha[2] [0.19244729 0.19290398 0.22157156 0.20121284 0.19186433]
np_weight_alpha[3] [0.20751023 0.1791617  0.23701976 0.17600925 0.20029902]
np_weight_alpha[4] [0.16681464 0.18205833 0.18999909 0.19899651 0.26213142]
-------------Round number:  109  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3333333333333333
client Accurancy:  0.36904761904761907
client Accurancy:  0.3531746031746032
client Accurancy:  0.19047619047619047
Average Global Accurancy:  0.2984126984126984
Average Global Trainning Accurancy:  0.3153061224489796
Average Global Trainning Loss:  1.8211334436118198
All users are selected
model: 0 tensor([0.2557, 0.2024, 0.1907, 0.1844, 0.1667], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0189, -0.0242, -0.0163, -0.0060, -0.0151],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2032, 0.2360, 0.1924, 0.1846, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0405, -0.0203, -0.0403, -0.0384, -0.0265],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1924, 0.1929, 0.2216, 0.2012, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0464, 0.0384, 0.0460, 0.0457, 0.0485],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2075, 0.1792, 0.2370, 0.1760, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0027, -0.0486, -0.0019, -0.0886, -0.0526],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1668, 0.1821, 0.1900, 0.1990, 0.2621], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0406, 0.0446, 0.0411, 0.0272, 0.0454]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2641858  0.20783015 0.18843195 0.1734285  0.16612358]
np_weight_alpha[1] [0.2101097  0.22382647 0.19882768 0.18949075 0.17774542]
np_weight_alpha[2] [0.19096541 0.1991998  0.22128065 0.20016667 0.18838744]
np_weight_alpha[3] [0.1725307  0.18837044 0.19912131 0.22642578 0.2135517 ]
np_weight_alpha[4] [0.16646083 0.17615972 0.18652351 0.20908725 0.26176873]
-------------Round number:  110  -------------
client Accurancy:  0.21428571428571427
client Accurancy:  0.32142857142857145
client Accurancy:  0.36507936507936506
client Accurancy:  0.3412698412698413
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.29444444444444445
Average Global Trainning Accurancy:  0.3054421768707483
Average Global Trainning Loss:  1.8186408840880102
All users are selected
model: 0 tensor([0.2642, 0.2078, 0.1884, 0.1734, 0.1661], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0308, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0015, -0.0235, -0.0178, -0.0221, -0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2101, 0.2238, 0.1988, 0.1895, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0300, -0.0296, -0.0192, -0.0205, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1910, 0.1992, 0.2213, 0.2002, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0266, 0.0308, 0.0202, 0.0320, 0.0199],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1725, 0.1884, 0.1991, 0.2264, 0.2136], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0344, -0.0254, -0.0218, -0.0370, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1665, 0.1762, 0.1865, 0.2091, 0.2618], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0301, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0433, 0.0426, 0.0323, 0.0459, 0.0353]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25391367 0.21390434 0.18865451 0.17879328 0.1647342 ]
np_weight_alpha[1] [0.21605839 0.2308637  0.19342537 0.18587385 0.17377862]
np_weight_alpha[2] [0.19005318 0.19389454 0.22833909 0.19372849 0.1939847 ]
np_weight_alpha[3] [0.1801954  0.18646918 0.19318677 0.23891316 0.20123541]
np_weight_alpha[4] [0.1634467  0.17213021 0.19090554 0.19957703 0.2739406 ]
-------------Round number:  111  -------------
client Accurancy:  0.2777777777777778
client Accurancy:  0.32936507936507936
client Accurancy:  0.36904761904761907
client Accurancy:  0.3412698412698413
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.2984126984126984
Average Global Trainning Accurancy:  0.31394557823129254
Average Global Trainning Loss:  1.761514136904762
All users are selected
model: 0 tensor([0.2539, 0.2139, 0.1887, 0.1788, 0.1647], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0126, -0.0062, -0.0204, -0.0234, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2161, 0.2309, 0.1934, 0.1859, 0.1738], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0458, -0.0428, -0.0424, -0.0539],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1901, 0.1939, 0.2283, 0.1937, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0237, 0.0274, 0.0344, 0.0188, 0.0287],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1865, 0.1932, 0.2389, 0.2012], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0016,  0.0089, -0.0007,  0.0204,  0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1634, 0.1721, 0.1909, 0.1996, 0.2739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0383, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0127, 0.0237, 0.0233, 0.0429]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25480333 0.20200586 0.19115189 0.18475652 0.16728245]
np_weight_alpha[1] [0.20274365 0.23555206 0.19243248 0.18491167 0.18436018]
np_weight_alpha[2] [0.19280693 0.1929424  0.2212694  0.2012386  0.19174264]
np_weight_alpha[3] [0.20931253 0.17978294 0.23650126 0.17546423 0.19893901]
np_weight_alpha[4] [0.16739433 0.18267794 0.1899526  0.19871058 0.26126462]
-------------Round number:  112  -------------
client Accurancy:  0.25
client Accurancy:  0.3253968253968254
client Accurancy:  0.36904761904761907
client Accurancy:  0.3492063492063492
client Accurancy:  0.1865079365079365
Average Global Accurancy:  0.29603174603174603
Average Global Trainning Accurancy:  0.3142857142857143
Average Global Trainning Loss:  1.8171154203869047
All users are selected
model: 0 tensor([0.2548, 0.2020, 0.1912, 0.1848, 0.1673], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0205, -0.0258, -0.0173, -0.0073, -0.0161],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2027, 0.2356, 0.1924, 0.1849, 0.1844], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0412, -0.0209, -0.0403, -0.0386, -0.0264],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1929, 0.2213, 0.2012, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0482, 0.0402, 0.0473, 0.0474, 0.0498],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2093, 0.1798, 0.2365, 0.1755, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0015, -0.0486, -0.0027, -0.0893, -0.0541],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1674, 0.1827, 0.1900, 0.1987, 0.2613], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0414, 0.0453, 0.0413, 0.0277, 0.0454]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2634911  0.20776951 0.1885775  0.17376992 0.16639195]
np_weight_alpha[1] [0.21002856 0.22364397 0.1986352  0.18969157 0.1780007 ]
np_weight_alpha[2] [0.19103673 0.19898114 0.22134691 0.20011815 0.18851706]
np_weight_alpha[3] [0.17275044 0.18856157 0.19907635 0.22625338 0.21335824]
np_weight_alpha[4] [0.16671026 0.17645416 0.18666506 0.20884272 0.26132774]
-------------Round number:  113  -------------
client Accurancy:  0.21825396825396826
client Accurancy:  0.3253968253968254
client Accurancy:  0.3611111111111111
client Accurancy:  0.3412698412698413
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.29444444444444445
Average Global Trainning Accurancy:  0.30714285714285716
Average Global Trainning Loss:  1.8134656010841836
All users are selected
model: 0 tensor([0.2635, 0.2078, 0.1886, 0.1738, 0.1664], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0016, -0.0236, -0.0180, -0.0220, -0.0133],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2100, 0.2236, 0.1986, 0.1897, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0294, -0.0290, -0.0188, -0.0200, -0.0182],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1910, 0.1990, 0.2213, 0.2001, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0264, 0.0306, 0.0205, 0.0317, 0.0201],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1728, 0.1886, 0.1991, 0.2263, 0.2134], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0353, -0.0263, -0.0229, -0.0376, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1667, 0.1765, 0.1867, 0.2088, 0.2613], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0284, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0300, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0436, 0.0432, 0.0330, 0.0463, 0.0358]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2531181  0.21386316 0.18887883 0.17901208 0.1651278 ]
np_weight_alpha[1] [0.215964   0.23062523 0.19339268 0.18606113 0.17395692]
np_weight_alpha[2] [0.19025108 0.19386141 0.22805539 0.19391257 0.19391954]
np_weight_alpha[3] [0.1803832  0.18666142 0.19339068 0.23841926 0.20114541]
np_weight_alpha[4] [0.16383505 0.17233385 0.19089288 0.1995091  0.27342913]
-------------Round number:  114  -------------
client Accurancy:  0.2777777777777778
client Accurancy:  0.3373015873015873
client Accurancy:  0.38095238095238093
client Accurancy:  0.3492063492063492
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.30317460317460315
Average Global Trainning Accurancy:  0.3149659863945578
Average Global Trainning Loss:  1.75625
All users are selected
model: 0 tensor([0.2531, 0.2139, 0.1889, 0.1790, 0.1651], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0128, -0.0058, -0.0204, -0.0236, -0.0175],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2160, 0.2306, 0.1934, 0.1861, 0.1740], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0301, -0.0456, -0.0425, -0.0423, -0.0536],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1903, 0.1939, 0.2281, 0.1939, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0249, 0.0286, 0.0355, 0.0204, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1804, 0.1867, 0.1934, 0.2384, 0.2011], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0003,  0.0076, -0.0014,  0.0192,  0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1638, 0.1723, 0.1909, 0.1995, 0.2734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0377, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0211, 0.0123, 0.0232, 0.0230, 0.0421]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2541682  0.20170489 0.19145437 0.18513355 0.16753902]
np_weight_alpha[1] [0.2024071  0.2353842  0.1924035  0.18529187 0.18451335]
np_weight_alpha[2] [0.1930734  0.19290948 0.22118023 0.20109694 0.19173992]
np_weight_alpha[3] [0.21057454 0.18094851 0.2347957  0.17565346 0.19802777]
np_weight_alpha[4] [0.16761719 0.18282123 0.18996412 0.19848171 0.26111573]
-------------Round number:  115  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3253968253968254
client Accurancy:  0.38095238095238093
client Accurancy:  0.35714285714285715
client Accurancy:  0.19047619047619047
Average Global Accurancy:  0.3
Average Global Trainning Accurancy:  0.3173469387755102
Average Global Trainning Loss:  1.8118964578018708
All users are selected
model: 0 tensor([0.2542, 0.2017, 0.1915, 0.1851, 0.1675], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0263, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0219, -0.0273, -0.0184, -0.0088, -0.0174],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2024, 0.2354, 0.1924, 0.1853, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0412, -0.0208, -0.0401, -0.0383, -0.0262],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1929, 0.2212, 0.2011, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0499, 0.0418, 0.0488, 0.0489, 0.0512],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2106, 0.1809, 0.2348, 0.1757, 0.1980], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013, -0.0482, -0.0048, -0.0892, -0.0554],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1676, 0.1828, 0.1900, 0.1985, 0.2611], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0254, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0417, 0.0456, 0.0415, 0.0279, 0.0458]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26275367 0.20765975 0.18875052 0.17426074 0.16657539]
np_weight_alpha[1] [0.2098804  0.22352478 0.19853361 0.18994114 0.17812008]
np_weight_alpha[2] [0.19114314 0.19886836 0.22128707 0.1999913  0.18871011]
np_weight_alpha[3] [0.17317393 0.18882062 0.19898912 0.22579241 0.21322392]
np_weight_alpha[4] [0.16687575 0.17660299 0.1868655  0.20866638 0.2609894 ]
-------------Round number:  116  -------------
client Accurancy:  0.2222222222222222
client Accurancy:  0.3333333333333333
client Accurancy:  0.373015873015873
client Accurancy:  0.3412698412698413
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3
Average Global Trainning Accurancy:  0.3085034013605442
Average Global Trainning Loss:  1.8061599835246598
All users are selected
model: 0 tensor([0.2628, 0.2077, 0.1888, 0.1743, 0.1666], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0295, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0022, -0.0239, -0.0186, -0.0221, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2099, 0.2235, 0.1985, 0.1899, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0287, -0.0285, -0.0180, -0.0193, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1911, 0.1989, 0.2213, 0.2000, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0271, 0.0317, 0.0214, 0.0324, 0.0212],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1732, 0.1888, 0.1990, 0.2258, 0.2132], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0353, -0.0266, -0.0234, -0.0383, -0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1669, 0.1766, 0.1869, 0.2087, 0.2610], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0296, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0426, 0.0424, 0.0326, 0.0458, 0.0357]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25237015 0.2136232  0.18924953 0.17911533 0.16564183]
np_weight_alpha[1] [0.21565267 0.23058894 0.19313465 0.18625385 0.1743699 ]
np_weight_alpha[2] [0.19059044 0.19359581 0.22797732 0.19395198 0.19388448]
np_weight_alpha[3] [0.18041344 0.18682277 0.19344097 0.23830439 0.20101842]
np_weight_alpha[4] [0.16439828 0.17280181 0.19095998 0.19942975 0.27241018]
-------------Round number:  117  -------------
client Accurancy:  0.2777777777777778
client Accurancy:  0.3373015873015873
client Accurancy:  0.38492063492063494
client Accurancy:  0.3492063492063492
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.30317460317460315
Average Global Trainning Accurancy:  0.31768707482993197
Average Global Trainning Loss:  1.7506314439838435
All users are selected
model: 0 tensor([0.2524, 0.2136, 0.1892, 0.1791, 0.1656], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0134, -0.0062, -0.0205, -0.0240, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2157, 0.2306, 0.1931, 0.1863, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0295, -0.0448, -0.0420, -0.0417, -0.0528],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1906, 0.1936, 0.2280, 0.1940, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0258, 0.0292, 0.0363, 0.0213, 0.0305],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1804, 0.1868, 0.1934, 0.2383, 0.2010], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0010,  0.0064, -0.0024,  0.0182,  0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1644, 0.1728, 0.1910, 0.1994, 0.2724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0367, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0125, 0.0232, 0.0231, 0.0418]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25359902 0.20151527 0.19165052 0.18539554 0.16783959]
np_weight_alpha[1] [0.20219626 0.23515165 0.1923196  0.18551816 0.18481426]
np_weight_alpha[2] [0.19322518 0.19281565 0.22107346 0.20098072 0.191905  ]
np_weight_alpha[3] [0.21180175 0.18141143 0.23386222 0.1748853  0.19803925]
np_weight_alpha[4] [0.16792104 0.18315516 0.19016212 0.19845197 0.26030976]
-------------Round number:  118  -------------
client Accurancy:  0.25
client Accurancy:  0.3253968253968254
client Accurancy:  0.38492063492063494
client Accurancy:  0.3531746031746032
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.30158730158730157
Average Global Trainning Accurancy:  0.32006802721088434
Average Global Trainning Loss:  1.8070682862988945
All users are selected
model: 0 tensor([0.2536, 0.2015, 0.1917, 0.1854, 0.1678], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0230, -0.0283, -0.0195, -0.0096, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2022, 0.2352, 0.1923, 0.1855, 0.1848], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0412, -0.0208, -0.0399, -0.0382, -0.0261],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1932, 0.1928, 0.2211, 0.2010, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0511, 0.0433, 0.0504, 0.0502, 0.0524],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2118, 0.1814, 0.2339, 0.1749, 0.1980], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004, -0.0481, -0.0059, -0.0900, -0.0556],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1679, 0.1832, 0.1902, 0.1985, 0.2603], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0417, 0.0454, 0.0411, 0.0277, 0.0453]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26222605 0.20759442 0.18909666 0.17444888 0.166634  ]
np_weight_alpha[1] [0.20979267 0.22337477 0.19832452 0.19014573 0.17836231]
np_weight_alpha[2] [0.19147094 0.1986576  0.22090939 0.19992332 0.18903871]
np_weight_alpha[3] [0.17328222 0.1890342  0.19894527 0.22555554 0.21318278]
np_weight_alpha[4] [0.16693865 0.17686929 0.18720892 0.20865372 0.2603295 ]
-------------Round number:  119  -------------
client Accurancy:  0.2222222222222222
client Accurancy:  0.3412698412698413
client Accurancy:  0.38095238095238093
client Accurancy:  0.3373015873015873
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.30238095238095236
Average Global Trainning Accurancy:  0.3108843537414966
Average Global Trainning Loss:  1.800115593112245
All users are selected
model: 0 tensor([0.2622, 0.2076, 0.1891, 0.1744, 0.1666], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0291, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0032, -0.0249, -0.0194, -0.0230, -0.0157],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2098, 0.2234, 0.1983, 0.1901, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0280, -0.0278, -0.0175, -0.0184, -0.0174],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1915, 0.1987, 0.2209, 0.1999, 0.1890], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0273, 0.0315, 0.0211, 0.0323, 0.0216],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1733, 0.1890, 0.1989, 0.2256, 0.2132], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0345, -0.0256, -0.0228, -0.0379, -0.0161],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1669, 0.1769, 0.1872, 0.2087, 0.2603], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0275, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0293, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0417, 0.0419, 0.0326, 0.0455, 0.0354]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2517286  0.21356519 0.18938646 0.179183   0.16613674]
np_weight_alpha[1] [0.21555875 0.23041871 0.1931043  0.1862129  0.17470533]
np_weight_alpha[2] [0.19069609 0.19355862 0.22788155 0.19402313 0.19384058]
np_weight_alpha[3] [0.18041117 0.18675625 0.19350687 0.238429   0.20089673]
np_weight_alpha[4] [0.16492285 0.17319505 0.19100423 0.19936486 0.27151304]
-------------Round number:  120  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.3373015873015873
client Accurancy:  0.38492063492063494
client Accurancy:  0.34523809523809523
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.30396825396825394
Average Global Trainning Accurancy:  0.319047619047619
Average Global Trainning Loss:  1.7452370987457484
All users are selected
model: 0 tensor([0.2517, 0.2136, 0.1894, 0.1792, 0.1661], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0144, -0.0067, -0.0215, -0.0249, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2156, 0.2304, 0.1931, 0.1862, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0285, -0.0440, -0.0414, -0.0415, -0.0522],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1907, 0.1936, 0.2279, 0.1940, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0274, 0.0309, 0.0380, 0.0231, 0.0321],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1804, 0.1868, 0.1935, 0.2384, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0016,  0.0055, -0.0027,  0.0180,  0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1649, 0.1732, 0.1910, 0.1994, 0.2715], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0357, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0202, 0.0116, 0.0223, 0.0225, 0.0411]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25287917 0.2010698  0.19190833 0.18548565 0.16865706]
np_weight_alpha[1] [0.20170748 0.23479247 0.19234824 0.18594866 0.18520312]
np_weight_alpha[2] [0.1934282  0.19282752 0.22087727 0.20091265 0.19195436]
np_weight_alpha[3] [0.2120735  0.18367364 0.23316748 0.17399941 0.19708595]
np_weight_alpha[4] [0.1687512  0.18360306 0.19029203 0.1982605  0.25909323]
-------------Round number:  121  -------------
client Accurancy:  0.25
client Accurancy:  0.3253968253968254
client Accurancy:  0.3968253968253968
client Accurancy:  0.3611111111111111
client Accurancy:  0.1984126984126984
Average Global Accurancy:  0.30634920634920637
Average Global Trainning Accurancy:  0.32108843537414966
Average Global Trainning Loss:  1.8038373259460034
All users are selected
model: 0 tensor([0.2529, 0.2011, 0.1919, 0.1855, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0246, -0.0301, -0.0206, -0.0113, -0.0189],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2348, 0.1923, 0.1859, 0.1852], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0419, -0.0213, -0.0399, -0.0381, -0.0261],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1928, 0.2209, 0.2009, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0536, 0.0456, 0.0523, 0.0522, 0.0544],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2121, 0.1837, 0.2332, 0.1740, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0007, -0.0462, -0.0070, -0.0909, -0.0566],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1688, 0.1836, 0.1903, 0.1983, 0.2591], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0251, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0422, 0.0455, 0.0409, 0.0275, 0.0443]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2616629  0.20756459 0.18907125 0.1748175  0.16688375]
np_weight_alpha[1] [0.20974255 0.22332112 0.19818345 0.1902146  0.17853834]
np_weight_alpha[2] [0.19287026 0.19381918 0.22152801 0.20049016 0.19129243]
np_weight_alpha[3] [0.1736114  0.18908097 0.19903997 0.22522607 0.21304154]
np_weight_alpha[4] [0.16715853 0.17707175 0.18735424 0.20849651 0.25991896]
-------------Round number:  122  -------------
client Accurancy:  0.2261904761904762
client Accurancy:  0.3412698412698413
client Accurancy:  0.38492063492063494
client Accurancy:  0.3492063492063492
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.30634920634920637
Average Global Trainning Accurancy:  0.3112244897959184
Average Global Trainning Loss:  1.792577294589711
All users are selected
model: 0 tensor([0.2617, 0.2076, 0.1891, 0.1748, 0.1669], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0285, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0040, -0.0260, -0.0207, -0.0241, -0.0175],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2097, 0.2233, 0.1982, 0.1902, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0268, -0.0264, -0.0165, -0.0175, -0.0167],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1938, 0.2215, 0.2005, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0302, 0.0283, 0.0235, 0.0345, 0.0257],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1736, 0.1891, 0.1990, 0.2252, 0.2130], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0354, -0.0268, -0.0238, -0.0392, -0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1672, 0.1771, 0.1874, 0.2085, 0.2599], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0405, 0.0410, 0.0321, 0.0452, 0.0355]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2506524  0.21339701 0.18953802 0.17950898 0.16690357]
np_weight_alpha[1] [0.21531121 0.23006551 0.19301488 0.18641153 0.17519686]
np_weight_alpha[2] [0.19088493 0.19363476 0.22772951 0.19405134 0.19369946]
np_weight_alpha[3] [0.1806604  0.18692632 0.19360329 0.2382923  0.2005176 ]
np_weight_alpha[4] [0.1657276  0.17375031 0.19119178 0.19906951 0.27026078]
-------------Round number:  123  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.3373015873015873
client Accurancy:  0.38095238095238093
client Accurancy:  0.3412698412698413
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.30158730158730157
Average Global Trainning Accurancy:  0.3187074829931973
Average Global Trainning Loss:  1.7409797512755103
All users are selected
model: 0 tensor([0.2507, 0.2134, 0.1895, 0.1795, 0.1669], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0150, -0.0068, -0.0217, -0.0248, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2153, 0.2301, 0.1930, 0.1864, 0.1752], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0286, -0.0441, -0.0415, -0.0416, -0.0520],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1909, 0.1936, 0.2277, 0.1941, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0288, 0.0325, 0.0395, 0.0246, 0.0334],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1807, 0.1869, 0.1936, 0.2383, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0021,  0.0046, -0.0034,  0.0172,  0.0046],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1657, 0.1738, 0.1912, 0.1991, 0.2703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0344, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0200, 0.0114, 0.0220, 0.0219, 0.0396]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2521901  0.20091881 0.1921695  0.18558456 0.16913703]
np_weight_alpha[1] [0.20153272 0.23452643 0.19233207 0.18621346 0.18539532]
np_weight_alpha[2] [0.19364177 0.19279847 0.22069374 0.20093395 0.19193202]
np_weight_alpha[3] [0.21135794 0.18431762 0.23284097 0.17421839 0.19726509]
np_weight_alpha[4] [0.1692049  0.18381573 0.19029021 0.19802825 0.25866088]
-------------Round number:  124  -------------
client Accurancy:  0.25396825396825395
client Accurancy:  0.32936507936507936
client Accurancy:  0.3888888888888889
client Accurancy:  0.376984126984127
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.30873015873015874
Average Global Trainning Accurancy:  0.32108843537414966
Average Global Trainning Loss:  1.7972779150722789
All users are selected
model: 0 tensor([0.2522, 0.2009, 0.1922, 0.1856, 0.1691], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0262, -0.0317, -0.0220, -0.0128, -0.0206],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2015, 0.2345, 0.1923, 0.1862, 0.1854], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0420, -0.0214, -0.0397, -0.0381, -0.0264],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1928, 0.2207, 0.2009, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0559, 0.0481, 0.0545, 0.0545, 0.0565],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2114, 0.1843, 0.2328, 0.1742, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013, -0.0455, -0.0071, -0.0903, -0.0558],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1692, 0.1838, 0.1903, 0.1980, 0.2587], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0412, 0.0444, 0.0399, 0.0267, 0.0438]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2609099  0.20753193 0.18924561 0.17488816 0.16742444]
np_weight_alpha[1] [0.20966211 0.22304073 0.19796596 0.19042386 0.17890738]
np_weight_alpha[2] [0.19306156 0.19375378 0.22134376 0.20052618 0.19131467]
np_weight_alpha[3] [0.17372023 0.18932205 0.19912338 0.22517197 0.21266234]
np_weight_alpha[4] [0.16772968 0.17750031 0.18759154 0.2083029  0.25887558]
-------------Round number:  125  -------------
client Accurancy:  0.23015873015873015
client Accurancy:  0.3373015873015873
client Accurancy:  0.373015873015873
client Accurancy:  0.3531746031746032
client Accurancy:  0.23412698412698413
Average Global Accurancy:  0.3055555555555556
Average Global Trainning Accurancy:  0.31360544217687075
Average Global Trainning Loss:  1.7866207615858845
All users are selected
model: 0 tensor([0.2609, 0.2075, 0.1892, 0.1749, 0.1674], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0279, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0062, -0.0277, -0.0229, -0.0259, -0.0193],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2097, 0.2230, 0.1980, 0.1904, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0251, -0.0250, -0.0153, -0.0159, -0.0150],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1938, 0.2213, 0.2005, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0312, 0.0293, 0.0250, 0.0355, 0.0273],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1737, 0.1893, 0.1991, 0.2252, 0.2127], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0359, -0.0273, -0.0246, -0.0397, -0.0177],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1677, 0.1775, 0.1876, 0.2083, 0.2589], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0406, 0.0412, 0.0326, 0.0450, 0.0342]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.250077   0.21321067 0.189936   0.17950933 0.16726701]
np_weight_alpha[1] [0.21507901 0.2298764  0.19316222 0.18655226 0.17533013]
np_weight_alpha[2] [0.19128224 0.19378245 0.22732867 0.1942853  0.19332127]
np_weight_alpha[3] [0.18060943 0.1870506  0.19384545 0.23811595 0.20037861]
np_weight_alpha[4] [0.16604105 0.17385305 0.19082521 0.19892281 0.27035785]
-------------Round number:  126  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.3373015873015873
client Accurancy:  0.38492063492063494
client Accurancy:  0.35714285714285715
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.30714285714285716
Average Global Trainning Accurancy:  0.32006802721088434
Average Global Trainning Loss:  1.7339021643813775
All users are selected
model: 0 tensor([0.2501, 0.2132, 0.1899, 0.1795, 0.1673], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0165, -0.0081, -0.0229, -0.0263, -0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2151, 0.2299, 0.1932, 0.1866, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0265, -0.0422, -0.0393, -0.0398, -0.0502],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1913, 0.1938, 0.2273, 0.1943, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0312, 0.0346, 0.0411, 0.0268, 0.0350],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1806, 0.1871, 0.1938, 0.2381, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0029,  0.0038, -0.0038,  0.0164,  0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1660, 0.1739, 0.1908, 0.1989, 0.2704], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0344, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0177, 0.0095, 0.0199, 0.0202, 0.0391]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25155395 0.20060982 0.19226713 0.18565018 0.16991892]
np_weight_alpha[1] [0.20118934 0.23433228 0.19230422 0.18644437 0.18572976]
np_weight_alpha[2] [0.1936624  0.19274983 0.22065724 0.20095474 0.19197576]
np_weight_alpha[3] [0.21170834 0.18496065 0.23183623 0.1745298  0.19696492]
np_weight_alpha[4] [0.17003705 0.18424098 0.1903987  0.19793333 0.2573899 ]
-------------Round number:  127  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.3373015873015873
client Accurancy:  0.3968253968253968
client Accurancy:  0.376984126984127
client Accurancy:  0.1865079365079365
Average Global Accurancy:  0.3111111111111111
Average Global Trainning Accurancy:  0.322108843537415
Average Global Trainning Loss:  1.7919013406143707
All users are selected
model: 0 tensor([0.2516, 0.2006, 0.1923, 0.1857, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0256, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0272, -0.0326, -0.0227, -0.0135, -0.0204],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2012, 0.2343, 0.1923, 0.1864, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0430, -0.0221, -0.0402, -0.0386, -0.0270],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1927, 0.2207, 0.2010, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0574, 0.0499, 0.0562, 0.0561, 0.0580],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2117, 0.1850, 0.2318, 0.1745, 0.1970], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0008, -0.0447, -0.0079, -0.0897, -0.0558],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1700, 0.1842, 0.1904, 0.1979, 0.2574], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0415, 0.0441, 0.0393, 0.0261, 0.0423]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26058084 0.2075603  0.18941008 0.1750015  0.16744731]
np_weight_alpha[1] [0.20968103 0.2228569  0.19781509 0.19050504 0.17914195]
np_weight_alpha[2] [0.19310848 0.19368589 0.22129041 0.20054142 0.19137372]
np_weight_alpha[3] [0.17382765 0.18941012 0.19913715 0.22505349 0.21257162]
np_weight_alpha[4] [0.16773401 0.17773022 0.18772411 0.20826147 0.25855023]
-------------Round number:  128  -------------
client Accurancy:  0.23809523809523808
client Accurancy:  0.3412698412698413
client Accurancy:  0.38492063492063494
client Accurancy:  0.35714285714285715
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3103174603174603
Average Global Trainning Accurancy:  0.31564625850340133
Average Global Trainning Loss:  1.7788225446428572
All users are selected
model: 0 tensor([0.2606, 0.2076, 0.1894, 0.1750, 0.1674], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0276, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0070, -0.0284, -0.0236, -0.0267, -0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2097, 0.2229, 0.1978, 0.1905, 0.1791], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0240, -0.0243, -0.0142, -0.0147, -0.0137],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1937, 0.2213, 0.2005, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0320, 0.0303, 0.0260, 0.0364, 0.0282],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1738, 0.1894, 0.1991, 0.2251, 0.2126], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0363, -0.0277, -0.0252, -0.0400, -0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1677, 0.1777, 0.1877, 0.2083, 0.2586], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0288, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0397, 0.0406, 0.0319, 0.0442, 0.0335]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24967828 0.21318944 0.19009258 0.17963393 0.1674058 ]
np_weight_alpha[1] [0.21503718 0.23002155 0.19302738 0.18655041 0.17536351]
np_weight_alpha[2] [0.191428   0.19365439 0.22711131 0.19438684 0.1934194 ]
np_weight_alpha[3] [0.18071736 0.18706377 0.19395249 0.23780328 0.20046306]
np_weight_alpha[4] [0.16617788 0.17392573 0.19094111 0.19901365 0.26994172]
-------------Round number:  129  -------------
client Accurancy:  0.29365079365079366
client Accurancy:  0.3492063492063492
client Accurancy:  0.39285714285714285
client Accurancy:  0.3611111111111111
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.3134920634920635
Average Global Trainning Accurancy:  0.32142857142857145
Average Global Trainning Loss:  1.727056428039966
All users are selected
model: 0 tensor([0.2497, 0.2132, 0.1901, 0.1796, 0.1674], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0162, -0.0076, -0.0227, -0.0260, -0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2150, 0.2300, 0.1930, 0.1866, 0.1754], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0262, -0.0414, -0.0393, -0.0398, -0.0503],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1937, 0.2271, 0.1944, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0317, 0.0352, 0.0421, 0.0278, 0.0357],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1807, 0.1871, 0.1940, 0.2378, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034,  0.0031, -0.0041,  0.0158,  0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1662, 0.1739, 0.1909, 0.1990, 0.2699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0340, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0171, 0.0085, 0.0190, 0.0195, 0.0381]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2512033  0.20049469 0.19263445 0.18581036 0.16985716]
np_weight_alpha[1] [0.20105651 0.23389396 0.19234386 0.18668623 0.18601944]
np_weight_alpha[2] [0.19403584 0.19278798 0.22026508 0.2008002  0.19211091]
np_weight_alpha[3] [0.21218207 0.18603252 0.23049393 0.17481972 0.1964718 ]
np_weight_alpha[4] [0.16998039 0.18450141 0.19054516 0.19791813 0.25705492]
-------------Round number:  130  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.3373015873015873
client Accurancy:  0.40476190476190477
client Accurancy:  0.376984126984127
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.3142857142857143
Average Global Trainning Accurancy:  0.3231292517006803
Average Global Trainning Loss:  1.7861494207057824
All users are selected
model: 0 tensor([0.2512, 0.2005, 0.1926, 0.1858, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0254, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0276, -0.0330, -0.0228, -0.0142, -0.0214],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2011, 0.2339, 0.1923, 0.1867, 0.1860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0426, -0.0221, -0.0396, -0.0383, -0.0268],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1928, 0.2203, 0.2008, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0590, 0.0514, 0.0570, 0.0571, 0.0589],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2122, 0.1860, 0.2305, 0.1748, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0007, -0.0439, -0.0092, -0.0890, -0.0559],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1700, 0.1845, 0.1905, 0.1979, 0.2571], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0401, 0.0431, 0.0383, 0.0256, 0.0420]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25999916 0.20735696 0.18941782 0.17536533 0.16786069]
np_weight_alpha[1] [0.20944868 0.22277491 0.19752212 0.19073921 0.17951505]
np_weight_alpha[2] [0.19339229 0.19366258 0.22094107 0.2004378  0.1915663 ]
np_weight_alpha[3] [0.17416693 0.18966682 0.19922675 0.22474599 0.21219346]
np_weight_alpha[4] [0.16817708 0.1781735  0.1881595  0.20796965 0.25752032]
-------------Round number:  131  -------------
client Accurancy:  0.24603174603174602
client Accurancy:  0.3333333333333333
client Accurancy:  0.38492063492063494
client Accurancy:  0.35714285714285715
client Accurancy:  0.23412698412698413
Average Global Accurancy:  0.3111111111111111
Average Global Trainning Accurancy:  0.31802721088435376
Average Global Trainning Loss:  1.7736990792410714
All users are selected
model: 0 tensor([0.2600, 0.2074, 0.1894, 0.1754, 0.1679], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0074, -0.0290, -0.0241, -0.0264, -0.0204],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2228, 0.1975, 0.1907, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0235, -0.0137, -0.0139, -0.0126],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1937, 0.2209, 0.2004, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0305, 0.0256, 0.0363, 0.0287],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1742, 0.1897, 0.1992, 0.2247, 0.2122], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0363, -0.0280, -0.0256, -0.0408, -0.0192],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1682, 0.1782, 0.1882, 0.2080, 0.2575], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0288, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0398, 0.0411, 0.0325, 0.0439, 0.0325]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2491409  0.21336281 0.19027573 0.17949077 0.16772969]
np_weight_alpha[1] [0.21519215 0.22990835 0.19289705 0.18668644 0.17531604]
np_weight_alpha[2] [0.19158034 0.1935131  0.22722766 0.1944386  0.19324026]
np_weight_alpha[3] [0.18051217 0.18718761 0.19400087 0.2378309  0.20046851]
np_weight_alpha[4] [0.16647227 0.17388666 0.19078103 0.19900766 0.2698524 ]
-------------Round number:  132  -------------
client Accurancy:  0.2976190476190476
client Accurancy:  0.3492063492063492
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.31666666666666665
Average Global Trainning Accurancy:  0.32448979591836735
Average Global Trainning Loss:  1.7217977718431123
All users are selected
model: 0 tensor([0.2491, 0.2134, 0.1903, 0.1795, 0.1677], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0166, -0.0073, -0.0225, -0.0262, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2152, 0.2299, 0.1929, 0.1867, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0252, -0.0407, -0.0386, -0.0392, -0.0499],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1935, 0.2272, 0.1944, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0363, 0.0433, 0.0289, 0.0363],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1805, 0.1872, 0.1940, 0.2378, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0045,  0.0022, -0.0048,  0.0154,  0.0028],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1665, 0.1739, 0.1908, 0.1990, 0.2699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0339, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0163, 0.0072, 0.0177, 0.0185, 0.0376]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25111926 0.20041294 0.19264066 0.1859216  0.16990553]
np_weight_alpha[1] [0.20096093 0.23367111 0.19223529 0.18690385 0.18622884]
np_weight_alpha[2] [0.19402058 0.19266604 0.22016792 0.2008073  0.19233817]
np_weight_alpha[3] [0.21370694 0.186543   0.23021144 0.1730112  0.19652747]
np_weight_alpha[4] [0.1700749  0.1847204  0.19078144 0.19799356 0.2564297 ]
-------------Round number:  133  -------------
client Accurancy:  0.2619047619047619
client Accurancy:  0.3373015873015873
client Accurancy:  0.40476190476190477
client Accurancy:  0.376984126984127
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.31507936507936507
Average Global Trainning Accurancy:  0.3251700680272109
Average Global Trainning Loss:  1.7814908189838434
All users are selected
model: 0 tensor([0.2511, 0.2004, 0.1926, 0.1859, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0291, -0.0349, -0.0250, -0.0163, -0.0234],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2337, 0.1922, 0.1869, 0.1862], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0422, -0.0220, -0.0392, -0.0377, -0.0262],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1927, 0.2202, 0.2008, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0605, 0.0531, 0.0589, 0.0589, 0.0608],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2137, 0.1865, 0.2302, 0.1730, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010, -0.0431, -0.0092, -0.0904, -0.0556],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1701, 0.1847, 0.1908, 0.1980, 0.2564], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0396, 0.0428, 0.0379, 0.0252, 0.0411]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25938466 0.20727737 0.18968746 0.17561366 0.16803688]
np_weight_alpha[1] [0.20934086 0.2228712  0.19744834 0.19079825 0.1795414 ]
np_weight_alpha[2] [0.19343309 0.19355847 0.22080407 0.20043577 0.19176865]
np_weight_alpha[3] [0.17428213 0.18971437 0.19920102 0.22458757 0.21221484]
np_weight_alpha[4] [0.16831313 0.17822386 0.18830647 0.20795327 0.25720325]
-------------Round number:  134  -------------
client Accurancy:  0.25
client Accurancy:  0.3373015873015873
client Accurancy:  0.38095238095238093
client Accurancy:  0.34523809523809523
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.30873015873015874
Average Global Trainning Accurancy:  0.32006802721088434
Average Global Trainning Loss:  1.7667374176232993
All users are selected
model: 0 tensor([0.2594, 0.2073, 0.1897, 0.1756, 0.1680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0079, -0.0293, -0.0244, -0.0268, -0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2093, 0.2229, 0.1974, 0.1908, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0224, -0.0223, -0.0124, -0.0130, -0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1936, 0.2208, 0.2004, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0307, 0.0260, 0.0364, 0.0289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1743, 0.1897, 0.1992, 0.2246, 0.2122], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0363, -0.0282, -0.0257, -0.0405, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1683, 0.1782, 0.1883, 0.2080, 0.2572], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0248, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0286, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0388, 0.0401, 0.0316, 0.0431, 0.0318]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24861394 0.21319062 0.19052407 0.17968452 0.16798693]
np_weight_alpha[1] [0.21496245 0.22985879 0.1927233  0.18698484 0.17547068]
np_weight_alpha[2] [0.19181888 0.19334011 0.22690482 0.19456737 0.19336876]
np_weight_alpha[3] [0.18071318 0.18749942 0.19414777 0.2372791  0.20036046]
np_weight_alpha[4] [0.16674557 0.17405662 0.19094639 0.19892794 0.26932347]
-------------Round number:  135  -------------
client Accurancy:  0.30158730158730157
client Accurancy:  0.3531746031746032
client Accurancy:  0.3968253968253968
client Accurancy:  0.36904761904761907
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.31825396825396823
Average Global Trainning Accurancy:  0.3261904761904762
Average Global Trainning Loss:  1.7147538996067178
All users are selected
model: 0 tensor([0.2486, 0.2132, 0.1905, 0.1797, 0.1680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0172, -0.0073, -0.0223, -0.0260, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2150, 0.2299, 0.1927, 0.1870, 0.1755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0245, -0.0397, -0.0382, -0.0385, -0.0493],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1933, 0.2269, 0.1946, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0342, 0.0371, 0.0443, 0.0301, 0.0376],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1807, 0.1875, 0.1941, 0.2373, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0044,  0.0022, -0.0048,  0.0149,  0.0027],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1667, 0.1741, 0.1909, 0.1989, 0.2693], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0333, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0149, 0.0055, 0.0162, 0.0169, 0.0356]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25115043 0.20022056 0.19273467 0.18591143 0.1699829 ]
np_weight_alpha[1] [0.20076886 0.23326918 0.19230191 0.18715161 0.18650846]
np_weight_alpha[2] [0.1941215  0.19272354 0.21997517 0.20085996 0.19231984]
np_weight_alpha[3] [0.2128519  0.18651403 0.2298982  0.1742893  0.1964466 ]
np_weight_alpha[4] [0.17017417 0.18498376 0.19078088 0.19789396 0.2561672 ]
-------------Round number:  136  -------------
client Accurancy:  0.25396825396825395
client Accurancy:  0.3373015873015873
client Accurancy:  0.4007936507936508
client Accurancy:  0.38095238095238093
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.3134920634920635
Average Global Trainning Accurancy:  0.3268707482993197
Average Global Trainning Loss:  1.7737650138180272
All users are selected
model: 0 tensor([0.2512, 0.2002, 0.1927, 0.1859, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0293, -0.0359, -0.0256, -0.0170, -0.0242],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2008, 0.2333, 0.1923, 0.1872, 0.1865], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0432, -0.0229, -0.0396, -0.0382, -0.0267],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1927, 0.2200, 0.2009, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0617, 0.0546, 0.0598, 0.0601, 0.0618],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2129, 0.1865, 0.2299, 0.1743, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0013, -0.0419, -0.0082, -0.0876, -0.0541],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1702, 0.1850, 0.1908, 0.1979, 0.2562], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0385, 0.0419, 0.0367, 0.0241, 0.0401]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25886783 0.20744826 0.18977386 0.17571983 0.16819018]
np_weight_alpha[1] [0.20951395 0.22274934 0.19723147 0.19085921 0.17964604]
np_weight_alpha[2] [0.19352433 0.1935621  0.220653   0.2004823  0.19177826]
np_weight_alpha[3] [0.1744548  0.18982908 0.19920531 0.22444585 0.21206489]
np_weight_alpha[4] [0.16844802 0.17836644 0.18842117 0.20789598 0.25686833]
-------------Round number:  137  -------------
client Accurancy:  0.25
client Accurancy:  0.3333333333333333
client Accurancy:  0.3888888888888889
client Accurancy:  0.3492063492063492
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3103174603174603
Average Global Trainning Accurancy:  0.32346938775510203
Average Global Trainning Loss:  1.760594872714711
All users are selected
model: 0 tensor([0.2589, 0.2074, 0.1898, 0.1757, 0.1682], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0089, -0.0297, -0.0249, -0.0269, -0.0212],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2095, 0.2227, 0.1972, 0.1909, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0212, -0.0111, -0.0117, -0.0102],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1936, 0.2207, 0.2005, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0311, 0.0264, 0.0362, 0.0286],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1745, 0.1898, 0.1992, 0.2244, 0.2121], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0365, -0.0287, -0.0266, -0.0411, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1684, 0.1784, 0.1884, 0.2079, 0.2569], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0284, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0386, 0.0399, 0.0311, 0.0427, 0.0316]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24862619 0.21327992 0.19065492 0.17947285 0.16796617]
np_weight_alpha[1] [0.21504265 0.22998905 0.192472   0.18698098 0.17551532]
np_weight_alpha[2] [0.19196211 0.19309378 0.22638057 0.19483843 0.19372505]
np_weight_alpha[3] [0.18049136 0.18748972 0.19440039 0.23714575 0.20047271]
np_weight_alpha[4] [0.1667771  0.17413647 0.19129576 0.19904974 0.2687409 ]
-------------Round number:  138  -------------
client Accurancy:  0.3055555555555556
client Accurancy:  0.3531746031746032
client Accurancy:  0.4007936507936508
client Accurancy:  0.36507936507936506
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.319047619047619
Average Global Trainning Accurancy:  0.32857142857142857
Average Global Trainning Loss:  1.7060525284332484
All users are selected
model: 0 tensor([0.2486, 0.2133, 0.1907, 0.1795, 0.1680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0170, -0.0070, -0.0223, -0.0264, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2150, 0.2300, 0.1925, 0.1870, 0.1755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0227, -0.0378, -0.0368, -0.0371, -0.0479],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1931, 0.2264, 0.1948, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0344, 0.0371, 0.0440, 0.0306, 0.0381],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1805, 0.1875, 0.1944, 0.2371, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060,  0.0010, -0.0056,  0.0141,  0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1668, 0.1741, 0.1913, 0.1990, 0.2687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0329, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0142, 0.0046, 0.0157, 0.0162, 0.0344]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25092283 0.20009111 0.19282374 0.18618718 0.16997518]
np_weight_alpha[1] [0.20062844 0.23305309 0.19229224 0.18731906 0.18670717]
np_weight_alpha[2] [0.19420747 0.19271111 0.21991019 0.20081548 0.19235577]
np_weight_alpha[3] [0.21538913 0.1873287  0.22846293 0.17314665 0.19567254]
np_weight_alpha[4] [0.170144   0.18515897 0.19083498 0.19786403 0.25599796]
-------------Round number:  139  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.34523809523809523
client Accurancy:  0.3968253968253968
client Accurancy:  0.38492063492063494
client Accurancy:  0.1984126984126984
Average Global Accurancy:  0.31666666666666665
Average Global Trainning Accurancy:  0.3268707482993197
Average Global Trainning Loss:  1.7680076132015305
All users are selected
model: 0 tensor([0.2509, 0.2001, 0.1928, 0.1862, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0248, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0293, -0.0362, -0.0259, -0.0171, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2006, 0.2331, 0.1923, 0.1873, 0.1867], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0436, -0.0236, -0.0399, -0.0385, -0.0268],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1927, 0.2199, 0.2008, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0629, 0.0559, 0.0612, 0.0613, 0.0630],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2154, 0.1873, 0.2285, 0.1731, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0041, -0.0410, -0.0095, -0.0885, -0.0548],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1701, 0.1852, 0.1908, 0.1979, 0.2560], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0375, 0.0413, 0.0359, 0.0234, 0.0394]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25842157 0.20740049 0.18996102 0.17586057 0.16835636]
np_weight_alpha[1] [0.20944874 0.22281043 0.19712335 0.19099456 0.17962298]
np_weight_alpha[2] [0.19362539 0.19353344 0.22055659 0.20044918 0.19183542]
np_weight_alpha[3] [0.17439823 0.18991971 0.19924822 0.224314   0.21211982]
np_weight_alpha[4] [0.16860378 0.17837533 0.18856597 0.20783693 0.25661796]
-------------Round number:  140  -------------
client Accurancy:  0.25793650793650796
client Accurancy:  0.3373015873015873
client Accurancy:  0.39285714285714285
client Accurancy:  0.3531746031746032
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3142857142857143
Average Global Trainning Accurancy:  0.32448979591836735
Average Global Trainning Loss:  1.7536562965029763
All users are selected
model: 0 tensor([0.2584, 0.2074, 0.1900, 0.1759, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0091, -0.0299, -0.0253, -0.0274, -0.0215],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2228, 0.1971, 0.1910, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0194, -0.0196, -0.0097, -0.0103, -0.0090],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1935, 0.2206, 0.2004, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0319, 0.0310, 0.0262, 0.0361, 0.0287],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1744, 0.1899, 0.1992, 0.2243, 0.2121], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0369, -0.0288, -0.0265, -0.0408, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1686, 0.1784, 0.1886, 0.2078, 0.2566], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0284, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0377, 0.0388, 0.0305, 0.0417, 0.0305]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24791062 0.21315627 0.19096719 0.17982514 0.16814075]
np_weight_alpha[1] [0.21486267 0.22991735 0.19240604 0.1871559  0.17565803]
np_weight_alpha[2] [0.1922484  0.19302121 0.22636248 0.19480728 0.19356066]
np_weight_alpha[3] [0.180848   0.18768586 0.19439657 0.23660895 0.20046061]
np_weight_alpha[4] [0.16691849 0.17426524 0.19115652 0.19904847 0.26861128]
-------------Round number:  141  -------------
client Accurancy:  0.3134920634920635
client Accurancy:  0.3611111111111111
client Accurancy:  0.40476190476190477
client Accurancy:  0.36904761904761907
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.3238095238095238
Average Global Trainning Accurancy:  0.3299319727891156
Average Global Trainning Loss:  1.7005316286670917
All users are selected
model: 0 tensor([0.2479, 0.2132, 0.1910, 0.1798, 0.1681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0174, -0.0067, -0.0217, -0.0257, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2149, 0.2299, 0.1924, 0.1872, 0.1757], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0218, -0.0365, -0.0360, -0.0361, -0.0468],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1922, 0.1930, 0.2264, 0.1948, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0353, 0.0377, 0.0449, 0.0314, 0.0385],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1808, 0.1877, 0.1944, 0.2366, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0068, -0.0003, -0.0067,  0.0125,  0.0005],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1669, 0.1743, 0.1912, 0.1990, 0.2686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0327, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0136, 0.0038, 0.0146, 0.0153, 0.0336]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25104257 0.20001763 0.19293651 0.1861523  0.16985099]
np_weight_alpha[1] [0.20056123 0.23273703 0.19237499 0.18754297 0.18678384]
np_weight_alpha[2] [0.19432975 0.19278625 0.21970299 0.20068368 0.19249727]
np_weight_alpha[3] [0.21379323 0.18766393 0.22780526 0.1743259  0.1964116 ]
np_weight_alpha[4] [0.17006066 0.18522808 0.19096583 0.19798651 0.25575888]
-------------Round number:  142  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.3492063492063492
client Accurancy:  0.40476190476190477
client Accurancy:  0.38492063492063494
client Accurancy:  0.20634920634920634
Average Global Accurancy:  0.32222222222222224
Average Global Trainning Accurancy:  0.32857142857142857
Average Global Trainning Loss:  1.7601763459289965
All users are selected
model: 0 tensor([0.2510, 0.2000, 0.1929, 0.1862, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0295, -0.0369, -0.0263, -0.0178, -0.0255],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2006, 0.2327, 0.1924, 0.1875, 0.1868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0442, -0.0242, -0.0400, -0.0388, -0.0273],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1928, 0.2197, 0.2007, 0.1925], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0643, 0.0574, 0.0624, 0.0623, 0.0641],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2138, 0.1877, 0.2278, 0.1743, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0029, -0.0402, -0.0096, -0.0864, -0.0531],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1701, 0.1852, 0.1910, 0.1980, 0.2558], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0364, 0.0405, 0.0350, 0.0229, 0.0388]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25803214 0.20748004 0.18996523 0.17593673 0.16858588]
np_weight_alpha[1] [0.20952472 0.22271709 0.19692941 0.19110073 0.17972808]
np_weight_alpha[2] [0.19371864 0.19355746 0.22034921 0.20037721 0.19199741]
np_weight_alpha[3] [0.17459802 0.19009548 0.19941363 0.22407275 0.2118201 ]
np_weight_alpha[4] [0.16883665 0.17852198 0.18882087 0.20771083 0.25610968]
-------------Round number:  143  -------------
client Accurancy:  0.2619047619047619
client Accurancy:  0.34523809523809523
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.31587301587301586
Average Global Trainning Accurancy:  0.32755102040816325
Average Global Trainning Loss:  1.746064685639881
All users are selected
model: 0 tensor([0.2580, 0.2075, 0.1900, 0.1759, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0097, -0.0302, -0.0262, -0.0283, -0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2095, 0.2227, 0.1969, 0.1911, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0187, -0.0085, -0.0091, -0.0076],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1936, 0.2203, 0.2004, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0317, 0.0312, 0.0262, 0.0359, 0.0288],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1746, 0.1901, 0.1994, 0.2241, 0.2118], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0370, -0.0289, -0.0265, -0.0406, -0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1688, 0.1785, 0.1888, 0.2077, 0.2561], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0284, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0372, 0.0385, 0.0302, 0.0412, 0.0295]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2474689  0.21295182 0.1912053  0.18007283 0.16830106]
np_weight_alpha[1] [0.21461017 0.23014395 0.19225706 0.18734911 0.1756397 ]
np_weight_alpha[2] [0.19246389 0.19287422 0.22609039 0.19492686 0.19364458]
np_weight_alpha[3] [0.18108116 0.1878937  0.19452286 0.23613945 0.20036282]
np_weight_alpha[4] [0.16704157 0.17424211 0.19123614 0.19893415 0.26854607]
-------------Round number:  144  -------------
client Accurancy:  0.31746031746031744
client Accurancy:  0.373015873015873
client Accurancy:  0.3968253968253968
client Accurancy:  0.373015873015873
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.326984126984127
Average Global Trainning Accurancy:  0.33197278911564626
Average Global Trainning Loss:  1.6906444316007654
All users are selected
model: 0 tensor([0.2475, 0.2130, 0.1912, 0.1801, 0.1683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0179, -0.0067, -0.0216, -0.0255, -0.0192],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2146, 0.2301, 0.1923, 0.1873, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0346, -0.0349, -0.0349, -0.0459],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1929, 0.2261, 0.1949, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0362, 0.0381, 0.0456, 0.0323, 0.0393],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1879, 0.1945, 0.2361, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0076, -0.0012, -0.0075,  0.0113, -0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1670, 0.1742, 0.1912, 0.1989, 0.2685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0326, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0125, 0.0025, 0.0137, 0.0142, 0.0333]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25099176 0.19976506 0.1930231  0.18617256 0.1700475 ]
np_weight_alpha[1] [0.20029792 0.23224717 0.19251284 0.18777843 0.1871636 ]
np_weight_alpha[2] [0.19441736 0.19291146 0.21942064 0.2006961  0.19255447]
np_weight_alpha[3] [0.21289201 0.18790823 0.22732592 0.17479633 0.19707747]
np_weight_alpha[4] [0.17031842 0.18562178 0.1910676  0.19806859 0.25492358]
-------------Round number:  145  -------------
client Accurancy:  0.28174603174603174
client Accurancy:  0.34523809523809523
client Accurancy:  0.40476190476190477
client Accurancy:  0.38095238095238093
client Accurancy:  0.20634920634920634
Average Global Accurancy:  0.3238095238095238
Average Global Trainning Accurancy:  0.3306122448979592
Average Global Trainning Loss:  1.7512024340986394
All users are selected
model: 0 tensor([0.2510, 0.1998, 0.1930, 0.1862, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0300, -0.0377, -0.0268, -0.0182, -0.0259],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2003, 0.2322, 0.1925, 0.1878, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0455, -0.0256, -0.0408, -0.0396, -0.0281],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1929, 0.2194, 0.2007, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0653, 0.0586, 0.0630, 0.0634, 0.0650],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2129, 0.1879, 0.2273, 0.1748, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0034, -0.0386, -0.0086, -0.0848, -0.0510],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1703, 0.1856, 0.1911, 0.1981, 0.2549], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0360, 0.0399, 0.0343, 0.0223, 0.0376]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25799668 0.20748934 0.1900299  0.17587295 0.16861112]
np_weight_alpha[1] [0.20956393 0.22255002 0.19688381 0.19109018 0.17991206]
np_weight_alpha[2] [0.1938045  0.19364987 0.22011276 0.20036925 0.19206354]
np_weight_alpha[3] [0.17459957 0.19011529 0.1992911  0.22426574 0.21172826]
np_weight_alpha[4] [0.16886437 0.17872614 0.18891509 0.20774113 0.25575328]
-------------Round number:  146  -------------
client Accurancy:  0.26587301587301587
client Accurancy:  0.3531746031746032
client Accurancy:  0.40476190476190477
client Accurancy:  0.3611111111111111
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.32142857142857145
Average Global Trainning Accurancy:  0.33129251700680273
Average Global Trainning Loss:  1.7374001846832483
All users are selected
model: 0 tensor([0.2580, 0.2075, 0.1900, 0.1759, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0254, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0100, -0.0307, -0.0268, -0.0287, -0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2096, 0.2226, 0.1969, 0.1911, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0168, -0.0175, -0.0075, -0.0084, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1936, 0.2201, 0.2004, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0318, 0.0267, 0.0363, 0.0294],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1746, 0.1901, 0.1993, 0.2243, 0.2117], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0368, -0.0290, -0.0266, -0.0401, -0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1689, 0.1787, 0.1889, 0.2077, 0.2558], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0282, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0359, 0.0375, 0.0292, 0.0402, 0.0285]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24716811 0.21288054 0.19138633 0.17999305 0.16857196]
np_weight_alpha[1] [0.21452986 0.22980322 0.19226652 0.18763496 0.17576544]
np_weight_alpha[2] [0.19263579 0.19286865 0.2258472  0.19498524 0.1936631 ]
np_weight_alpha[3] [0.18097842 0.18816556 0.19458677 0.2359163  0.200353  ]
np_weight_alpha[4] [0.16732027 0.17438222 0.1912855  0.19894464 0.26806733]
-------------Round number:  147  -------------
client Accurancy:  0.32936507936507936
client Accurancy:  0.376984126984127
client Accurancy:  0.39285714285714285
client Accurancy:  0.376984126984127
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.32936507936507936
Average Global Trainning Accurancy:  0.33537414965986395
Average Global Trainning Loss:  1.6830345517113094
All users are selected
model: 0 tensor([0.2472, 0.2129, 0.1914, 0.1800, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0181, -0.0067, -0.0216, -0.0256, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2145, 0.2298, 0.1923, 0.1876, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0186, -0.0330, -0.0331, -0.0328, -0.0439],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1929, 0.2258, 0.1950, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0365, 0.0384, 0.0459, 0.0328, 0.0395],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1882, 0.1946, 0.2359, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0023, -0.0085,  0.0100, -0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1673, 0.1744, 0.1913, 0.1989, 0.2681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0322, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0119, 0.0016, 0.0126, 0.0132, 0.0320]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25091657 0.19967458 0.19317122 0.18624668 0.16999094]
np_weight_alpha[1] [0.20021011 0.2321449  0.19258441 0.18787906 0.18718147]
np_weight_alpha[2] [0.1945687  0.19298834 0.21917488 0.20058517 0.19268289]
np_weight_alpha[3] [0.21379101 0.187382   0.22639538 0.17506483 0.19736671]
np_weight_alpha[4] [0.17025885 0.18563782 0.19118953 0.19812866 0.25478515]
-------------Round number:  148  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.3531746031746032
client Accurancy:  0.4087301587301587
client Accurancy:  0.38492063492063494
client Accurancy:  0.20634920634920634
Average Global Accurancy:  0.3277777777777778
Average Global Trainning Accurancy:  0.3333333333333333
Average Global Trainning Loss:  1.7431564227253402
All users are selected
model: 0 tensor([0.2509, 0.1997, 0.1932, 0.1862, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0299, -0.0380, -0.0272, -0.0190, -0.0265],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2002, 0.2321, 0.1926, 0.1879, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0463, -0.0266, -0.0414, -0.0405, -0.0290],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1930, 0.2192, 0.2006, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0664, 0.0599, 0.0640, 0.0642, 0.0660],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2138, 0.1874, 0.2264, 0.1751, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0047, -0.0385, -0.0088, -0.0829, -0.0496],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1703, 0.1856, 0.1912, 0.1981, 0.2548], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0351, 0.0393, 0.0336, 0.0219, 0.0369]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25727174 0.20740037 0.19020541 0.17630777 0.16881469]
np_weight_alpha[1] [0.20943017 0.22261955 0.19669707 0.19130658 0.17994659]
np_weight_alpha[2] [0.19395201 0.19367802 0.2198598  0.20031638 0.19219379]
np_weight_alpha[3] [0.1750324  0.19040449 0.19949523 0.22354192 0.21152598]
np_weight_alpha[4] [0.1690276  0.17877701 0.18904701 0.2075757  0.2555727 ]
-------------Round number:  149  -------------
client Accurancy:  0.2698412698412698
client Accurancy:  0.35714285714285715
client Accurancy:  0.4007936507936508
client Accurancy:  0.36507936507936506
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3246031746031746
Average Global Trainning Accurancy:  0.3346938775510204
Average Global Trainning Loss:  1.729580377072704
All users are selected
model: 0 tensor([0.2573, 0.2074, 0.1902, 0.1763, 0.1688], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0248, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0101, -0.0304, -0.0263, -0.0279, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2226, 0.1967, 0.1913, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0158, -0.0164, -0.0063, -0.0070, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1937, 0.2199, 0.2003, 0.1922], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0325, 0.0322, 0.0266, 0.0363, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1750, 0.1904, 0.1995, 0.2235, 0.2115], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0360, -0.0285, -0.0263, -0.0406, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1690, 0.1788, 0.1890, 0.2076, 0.2556], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0339, 0.0355, 0.0273, 0.0381, 0.0266]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24682818 0.21296616 0.1914464  0.17999026 0.16876903]
np_weight_alpha[1] [0.21458417 0.22992009 0.19207022 0.18761411 0.17581141]
np_weight_alpha[2] [0.19267479 0.19266838 0.22581373 0.19514784 0.19369517]
np_weight_alpha[3] [0.18093622 0.18813466 0.1947396  0.2358902  0.20029932]
np_weight_alpha[4] [0.16754334 0.17445838 0.19133583 0.19888201 0.2677804 ]
-------------Round number:  150  -------------
client Accurancy:  0.3373015873015873
client Accurancy:  0.38095238095238093
client Accurancy:  0.3968253968253968
client Accurancy:  0.38095238095238093
client Accurancy:  0.17063492063492064
Average Global Accurancy:  0.3333333333333333
Average Global Trainning Accurancy:  0.3377551020408163
Average Global Trainning Loss:  1.674072265625
All users are selected
model: 0 tensor([0.2468, 0.2130, 0.1914, 0.1800, 0.1688], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0182, -0.0060, -0.0211, -0.0253, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2146, 0.2299, 0.1921, 0.1876, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0172, -0.0316, -0.0322, -0.0319, -0.0429],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1927, 0.2258, 0.1951, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0364, 0.0381, 0.0458, 0.0328, 0.0393],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1809, 0.1881, 0.1947, 0.2359, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0089, -0.0025, -0.0083,  0.0103, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1675, 0.1745, 0.1913, 0.1989, 0.2678], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0319, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [1.0478e-02, 4.8260e-05, 1.1128e-02, 1.1651e-02, 3.0498e-02]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2510938  0.19942644 0.19316383 0.18624042 0.1700755 ]
np_weight_alpha[1] [0.19995517 0.23200995 0.19256033 0.18811946 0.18735512]
np_weight_alpha[2] [0.19456638 0.19295774 0.2191035  0.20062427 0.19274808]
np_weight_alpha[3] [0.21402776 0.1886258  0.2259143  0.17410399 0.19732817]
np_weight_alpha[4] [0.17037193 0.18580702 0.19127168 0.19810788 0.25444144]
-------------Round number:  151  -------------
client Accurancy:  0.2896825396825397
client Accurancy:  0.3492063492063492
client Accurancy:  0.4126984126984127
client Accurancy:  0.3888888888888889
client Accurancy:  0.20238095238095238
Average Global Accurancy:  0.32857142857142857
Average Global Trainning Accurancy:  0.3377551020408163
Average Global Trainning Loss:  1.7343999123086735
All users are selected
model: 0 tensor([0.2511, 0.1994, 0.1932, 0.1862, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0301, -0.0391, -0.0282, -0.0198, -0.0277],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2000, 0.2320, 0.1926, 0.1881, 0.1874], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0466, -0.0267, -0.0414, -0.0404, -0.0289],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1930, 0.2191, 0.2006, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0673, 0.0609, 0.0651, 0.0652, 0.0670],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2140, 0.1886, 0.2259, 0.1741, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0067, -0.0356, -0.0077, -0.0823, -0.0478],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1704, 0.1858, 0.1913, 0.1981, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0377, 0.0320, 0.0204, 0.0354]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2567096  0.2074167  0.1903516  0.17634805 0.16917406]
np_weight_alpha[1] [0.20943299 0.22252928 0.19663988 0.19135053 0.18004736]
np_weight_alpha[2] [0.19397499 0.19364475 0.21975957 0.20036069 0.19225997]
np_weight_alpha[3] [0.17499395 0.19042242 0.19957061 0.22364458 0.21136846]
np_weight_alpha[4] [0.16937138 0.17891905 0.18915166 0.20744996 0.2551079 ]
-------------Round number:  152  -------------
client Accurancy:  0.2857142857142857
client Accurancy:  0.3611111111111111
client Accurancy:  0.40476190476190477
client Accurancy:  0.373015873015873
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.33015873015873015
Average Global Trainning Accurancy:  0.33877551020408164
Average Global Trainning Loss:  1.7214370416135205
All users are selected
model: 0 tensor([0.2567, 0.2074, 0.1904, 0.1763, 0.1692], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0103, -0.0302, -0.0260, -0.0278, -0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2225, 0.1966, 0.1914, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0159, -0.0165, -0.0064, -0.0075, -0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1936, 0.2198, 0.2004, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0327, 0.0268, 0.0363, 0.0302],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1750, 0.1904, 0.1996, 0.2236, 0.2114], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0358, -0.0282, -0.0261, -0.0394, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1789, 0.1892, 0.2074, 0.2551], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0333, 0.0348, 0.0269, 0.0374, 0.0256]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24658516 0.21292466 0.19145149 0.18012172 0.168917  ]
np_weight_alpha[1] [0.2145132  0.2297118  0.19189261 0.18785028 0.1760322 ]
np_weight_alpha[2] [0.19266179 0.19247495 0.22585745 0.19548698 0.19351879]
np_weight_alpha[3] [0.1811017  0.188388   0.1951053  0.23518817 0.20021681]
np_weight_alpha[4] [0.16769294 0.17465563 0.19117907 0.19880545 0.26766688]
-------------Round number:  153  -------------
client Accurancy:  0.3373015873015873
client Accurancy:  0.38492063492063494
client Accurancy:  0.40476190476190477
client Accurancy:  0.38492063492063494
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.3357142857142857
Average Global Trainning Accurancy:  0.3401360544217687
Average Global Trainning Loss:  1.6651202766262756
All users are selected
model: 0 tensor([0.2466, 0.2129, 0.1915, 0.1801, 0.1689], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0174, -0.0052, -0.0203, -0.0244, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2145, 0.2297, 0.1919, 0.1879, 0.1760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0165, -0.0307, -0.0316, -0.0311, -0.0420],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1925, 0.2259, 0.1955, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0369, 0.0383, 0.0464, 0.0336, 0.0396],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1884, 0.1951, 0.2352, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0093, -0.0029, -0.0085,  0.0091, -0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1677, 0.1747, 0.1912, 0.1988, 0.2677], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0317, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0089, -0.0013,  0.0095,  0.0102,  0.0293]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2508133  0.19942498 0.1931823  0.18628412 0.17029527]
np_weight_alpha[1] [0.19995332 0.23168565 0.19261765 0.18828712 0.18745625]
np_weight_alpha[2] [0.19456807 0.1930083  0.21907301 0.20055076 0.19279982]
np_weight_alpha[3] [0.21352334 0.1885156  0.22401133 0.1762948  0.1976549 ]
np_weight_alpha[4] [0.17060134 0.1859305  0.19134584 0.19810377 0.25401857]
-------------Round number:  154  -------------
client Accurancy:  0.29365079365079366
client Accurancy:  0.35714285714285715
client Accurancy:  0.4126984126984127
client Accurancy:  0.3888888888888889
client Accurancy:  0.21428571428571427
Average Global Accurancy:  0.3333333333333333
Average Global Trainning Accurancy:  0.34217687074829933
Average Global Trainning Loss:  1.7249116443452381
All users are selected
model: 0 tensor([0.2508, 0.1994, 0.1932, 0.1863, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0291, -0.0380, -0.0268, -0.0186, -0.0263],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2000, 0.2317, 0.1926, 0.1883, 0.1875], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0481, -0.0284, -0.0425, -0.0417, -0.0304],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1930, 0.2191, 0.2006, 0.1928], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0679, 0.0617, 0.0655, 0.0655, 0.0675],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2135, 0.1885, 0.2240, 0.1763, 0.1977], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0073, -0.0346, -0.0085, -0.0788, -0.0460],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1706, 0.1859, 0.1913, 0.1981, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0320, 0.0363, 0.0306, 0.0191, 0.0338]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25667232 0.20752865 0.19020888 0.17635791 0.16923226]
np_weight_alpha[1] [0.20954809 0.22251427 0.19639437 0.19139424 0.18014903]
np_weight_alpha[2] [0.19394475 0.19363439 0.21976598 0.20032234 0.19233261]
np_weight_alpha[3] [0.17510004 0.19051765 0.19971427 0.22354868 0.21111935]
np_weight_alpha[4] [0.16944349 0.17903602 0.18931496 0.20732947 0.25487602]
-------------Round number:  155  -------------
client Accurancy:  0.30158730158730157
client Accurancy:  0.36507936507936506
client Accurancy:  0.4087301587301587
client Accurancy:  0.373015873015873
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3357142857142857
Average Global Trainning Accurancy:  0.3438775510204082
Average Global Trainning Loss:  1.7119887994260203
All users are selected
model: 0 tensor([0.2567, 0.2075, 0.1902, 0.1764, 0.1692], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0090, -0.0289, -0.0252, -0.0264, -0.0206],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2095, 0.2225, 0.1964, 0.1914, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0154, -0.0054, -0.0062, -0.0047],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1936, 0.2198, 0.2003, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0318, 0.0321, 0.0267, 0.0353, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1751, 0.1905, 0.1997, 0.2235, 0.2111], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0358, -0.0284, -0.0265, -0.0397, -0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1790, 0.1893, 0.2073, 0.2549], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0323, 0.0334, 0.0256, 0.0359, 0.0240]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24658014 0.21294738 0.19173367 0.179994   0.16874486]
np_weight_alpha[1] [0.23587246 0.25615403 0.17523886 0.17430031 0.15843435]
np_weight_alpha[2] [0.19297333 0.19239315 0.22525395 0.19576693 0.19361264]
np_weight_alpha[3] [0.18096149 0.18832308 0.19536878 0.23511748 0.20022912]
np_weight_alpha[4] [0.1675189  0.17475171 0.19124946 0.1988003  0.2676796 ]
-------------Round number:  156  -------------
client Accurancy:  0.34523809523809523
client Accurancy:  0.38095238095238093
client Accurancy:  0.40476190476190477
client Accurancy:  0.3888888888888889
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.3373015873015873
Average Global Trainning Accurancy:  0.34591836734693876
Average Global Trainning Loss:  1.6439393335459183
All users are selected
model: 0 tensor([0.2466, 0.2129, 0.1917, 0.1800, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0163, -0.0038, -0.0187, -0.0232, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2359, 0.2562, 0.1752, 0.1743, 0.1584], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0372, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0093, -0.0006, -0.0464, -0.0435, -0.0591],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1924, 0.2253, 0.1958, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0374, 0.0384, 0.0462, 0.0340, 0.0396],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1883, 0.1954, 0.2351, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0106, -0.0042, -0.0093,  0.0086, -0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1675, 0.1748, 0.1912, 0.1988, 0.2677], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0318, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0082, -0.0018,  0.0085,  0.0092,  0.0285]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2510583  0.19938423 0.1931825  0.18629569 0.17007929]
np_weight_alpha[1] [0.19798261 0.2302087  0.19315784 0.18946294 0.18918796]
np_weight_alpha[2] [0.19458006 0.19298764 0.21873936 0.20065741 0.19303556]
np_weight_alpha[3] [0.21432397 0.18966798 0.22330399 0.17415635 0.1985477 ]
np_weight_alpha[4] [0.17039192 0.1857169  0.19155242 0.19830059 0.2540382 ]
-------------Round number:  157  -------------
client Accurancy:  0.30158730158730157
client Accurancy:  0.35714285714285715
client Accurancy:  0.42063492063492064
client Accurancy:  0.4007936507936508
client Accurancy:  0.21031746031746032
Average Global Accurancy:  0.3380952380952381
Average Global Trainning Accurancy:  0.3438775510204082
Average Global Trainning Loss:  1.716843876222364
All users are selected
model: 0 tensor([0.2511, 0.1994, 0.1932, 0.1863, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0276, -0.0368, -0.0254, -0.0171, -0.0251],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1980, 0.2302, 0.1932, 0.1895, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0519, -0.0314, -0.0431, -0.0418, -0.0298],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1930, 0.2187, 0.2007, 0.1930], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0694, 0.0634, 0.0666, 0.0670, 0.0689],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2143, 0.1897, 0.2233, 0.1742, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0082, -0.0335, -0.0094, -0.0810, -0.0453],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1704, 0.1857, 0.1916, 0.1983, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0304, 0.0346, 0.0290, 0.0177, 0.0326]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2567317  0.20768408 0.19018205 0.17627192 0.16913028]
np_weight_alpha[1] [0.20994353 0.22264913 0.19617277 0.19128731 0.17994724]
np_weight_alpha[2] [0.19395715 0.19358721 0.21946841 0.20041583 0.1925714 ]
np_weight_alpha[3] [0.17492636 0.19048499 0.19975133 0.22356658 0.21127075]
np_weight_alpha[4] [0.16937199 0.17905413 0.18957719 0.20745891 0.2545377 ]
-------------Round number:  158  -------------
client Accurancy:  0.29365079365079366
client Accurancy:  0.36904761904761907
client Accurancy:  0.4126984126984127
client Accurancy:  0.373015873015873
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3357142857142857
Average Global Trainning Accurancy:  0.34829931972789113
Average Global Trainning Loss:  1.7009705835459183
All users are selected
model: 0 tensor([0.2567, 0.2077, 0.1902, 0.1763, 0.1691], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0071, -0.0272, -0.0240, -0.0246, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2099, 0.2226, 0.1962, 0.1913, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0139, -0.0150, -0.0052, -0.0058, -0.0046],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1940, 0.1936, 0.2195, 0.2004, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0316, 0.0323, 0.0266, 0.0355, 0.0302],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1749, 0.1905, 0.1998, 0.2236, 0.2113], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0366, -0.0292, -0.0276, -0.0409, -0.0211],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1791, 0.1896, 0.2075, 0.2545], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0279, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0308, 0.0323, 0.0251, 0.0347, 0.0229]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24618095 0.2129954  0.1920758  0.17969513 0.16905269]
np_weight_alpha[1] [0.23422576 0.25627053 0.17576034 0.17415664 0.15958677]
np_weight_alpha[2] [0.19332644 0.19232625 0.22516213 0.19585232 0.1933329 ]
np_weight_alpha[3] [0.18059796 0.1881612  0.19545285 0.23531303 0.200475  ]
np_weight_alpha[4] [0.16782872 0.17485654 0.19103304 0.19907032 0.26721138]
-------------Round number:  159  -------------
client Accurancy:  0.3531746031746032
client Accurancy:  0.3888888888888889
client Accurancy:  0.3968253968253968
client Accurancy:  0.38492063492063494
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.3396825396825397
Average Global Trainning Accurancy:  0.3489795918367347
Average Global Trainning Loss:  1.632883915284864
All users are selected
model: 0 tensor([0.2462, 0.2130, 0.1921, 0.1797, 0.1691], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0165, -0.0032, -0.0181, -0.0230, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2342, 0.2563, 0.1758, 0.1742, 0.1596], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0361, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0106,  0.0023, -0.0430, -0.0409, -0.0548],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1923, 0.2252, 0.1959, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0362, 0.0369, 0.0449, 0.0327, 0.0377],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1806, 0.1882, 0.1955, 0.2353, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115, -0.0053, -0.0099,  0.0083, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1678, 0.1749, 0.1910, 0.1991, 0.2672], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0313, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0071, -0.0029,  0.0068,  0.0080,  0.0269]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25130448 0.19914728 0.19325112 0.18621163 0.17008547]
np_weight_alpha[1] [0.19787131 0.23031577 0.19314721 0.18965977 0.18900596]
np_weight_alpha[2] [0.19464348 0.19299476 0.21847841 0.20063284 0.19325048]
np_weight_alpha[3] [0.2155946  0.19140428 0.22267596 0.17236704 0.19795808]
np_weight_alpha[4] [0.17042004 0.18565178 0.19174524 0.19842553 0.2537574 ]
-------------Round number:  160  -------------
client Accurancy:  0.30952380952380953
client Accurancy:  0.3531746031746032
client Accurancy:  0.42063492063492064
client Accurancy:  0.4007936507936508
client Accurancy:  0.21031746031746032
Average Global Accurancy:  0.3388888888888889
Average Global Trainning Accurancy:  0.34829931972789113
Average Global Trainning Loss:  1.7045252378295068
All users are selected
model: 0 tensor([0.2513, 0.1991, 0.1933, 0.1862, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0274, -0.0377, -0.0260, -0.0180, -0.0262],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1979, 0.2303, 0.1931, 0.1897, 0.1890], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0526, -0.0319, -0.0438, -0.0423, -0.0308],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1930, 0.2185, 0.2006, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0703, 0.0642, 0.0673, 0.0677, 0.0700],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2156, 0.1914, 0.2227, 0.1724, 0.1980], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0115, -0.0297, -0.0081, -0.0807, -0.0439],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1704, 0.1857, 0.1917, 0.1984, 0.2538], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0287, 0.0332, 0.0280, 0.0167, 0.0314]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2560641  0.20767875 0.19024001 0.17645913 0.16955797]
np_weight_alpha[1] [0.20989256 0.22254893 0.19616869 0.19134025 0.18004958]
np_weight_alpha[2] [0.1940143  0.19359736 0.21923083 0.20042665 0.19273086]
np_weight_alpha[3] [0.17495058 0.19046558 0.19990948 0.2233941  0.21128024]
np_weight_alpha[4] [0.16977529 0.17917491 0.18955952 0.20739226 0.25409803]
-------------Round number:  161  -------------
client Accurancy:  0.2976190476190476
client Accurancy:  0.373015873015873
client Accurancy:  0.4126984126984127
client Accurancy:  0.38095238095238093
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3388888888888889
Average Global Trainning Accurancy:  0.35
Average Global Trainning Loss:  1.6904735331632652
All users are selected
model: 0 tensor([0.2561, 0.2077, 0.1902, 0.1765, 0.1696], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0054, -0.0249, -0.0218, -0.0222, -0.0170],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2099, 0.2225, 0.1962, 0.1913, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0132, -0.0144, -0.0043, -0.0051, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1940, 0.1936, 0.2192, 0.2004, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0304, 0.0313, 0.0251, 0.0341, 0.0292],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1750, 0.1905, 0.1999, 0.2234, 0.2113], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0365, -0.0292, -0.0275, -0.0408, -0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1698, 0.1792, 0.1896, 0.2074, 0.2541], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0279, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0292, 0.0304, 0.0233, 0.0329, 0.0207]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2460353  0.21297352 0.19210774 0.17973585 0.16914758]
np_weight_alpha[1] [0.23413281 0.25701928 0.17489928 0.17414598 0.15980269]
np_weight_alpha[2] [0.19334596 0.19214162 0.2252244  0.19601133 0.19327667]
np_weight_alpha[3] [0.180655   0.1882189  0.19561626 0.23514421 0.2003656 ]
np_weight_alpha[4] [0.16793905 0.17498213 0.19099937 0.19898206 0.26709732]
-------------Round number:  162  -------------
client Accurancy:  0.3531746031746032
client Accurancy:  0.38492063492063494
client Accurancy:  0.4007936507936508
client Accurancy:  0.4007936507936508
client Accurancy:  0.18253968253968253
Average Global Accurancy:  0.34444444444444444
Average Global Trainning Accurancy:  0.3574829931972789
Average Global Trainning Loss:  1.6216059470663264
All users are selected
model: 0 tensor([0.2460, 0.2130, 0.1921, 0.1797, 0.1691], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0155, -0.0020, -0.0167, -0.0216, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2341, 0.2570, 0.1749, 0.1741, 0.1598], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0367, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0114,  0.0042, -0.0428, -0.0402, -0.0539],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1921, 0.2252, 0.1960, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0362, 0.0366, 0.0448, 0.0324, 0.0374],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1807, 0.1882, 0.1956, 0.2351, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0119, -0.0059, -0.0105,  0.0078, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1679, 0.1750, 0.1910, 0.1990, 0.2671], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0312, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0057, -0.0044,  0.0054,  0.0065,  0.0258]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25140855 0.19917533 0.19310713 0.18606193 0.17024708]
np_weight_alpha[1] [0.19790009 0.23009701 0.19305858 0.18976553 0.18917888]
np_weight_alpha[2] [0.19448945 0.19286442 0.21850723 0.20088129 0.19325763]
np_weight_alpha[3] [0.21447732 0.19157687 0.22331889 0.17214048 0.19848639]
np_weight_alpha[4] [0.17856845 0.23791873 0.20198564 0.20436603 0.17716119]
-------------Round number:  163  -------------
client Accurancy:  0.30952380952380953
client Accurancy:  0.3611111111111111
client Accurancy:  0.42063492063492064
client Accurancy:  0.3968253968253968
client Accurancy:  0.1626984126984127
Average Global Accurancy:  0.33015873015873015
Average Global Trainning Accurancy:  0.341156462585034
Average Global Trainning Loss:  1.7515385841836735
All users are selected
model: 0 tensor([0.2514, 0.1992, 0.1931, 0.1861, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0282, -0.0385, -0.0271, -0.0193, -0.0266],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1979, 0.2301, 0.1931, 0.1898, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0553, -0.0347, -0.0465, -0.0449, -0.0336],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1929, 0.2185, 0.2009, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0687, 0.0628, 0.0659, 0.0665, 0.0684],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2145, 0.1916, 0.2233, 0.1721, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0085, -0.0311, -0.0091, -0.0822, -0.0449],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1786, 0.2379, 0.2020, 0.2044, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0283, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0519,  0.0994,  0.0501,  0.0326, -0.0392]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.25609812 0.20767814 0.19025916 0.17662941 0.16933516]
np_weight_alpha[1] [0.20990509 0.2224344  0.19603503 0.19132437 0.18030104]
np_weight_alpha[2] [0.19389907 0.19346744 0.21924612 0.20062877 0.19275858]
np_weight_alpha[3] [0.17521591 0.19048412 0.19994074 0.22310275 0.21125644]
np_weight_alpha[4] [0.17677167 0.22682583 0.19909248 0.20502743 0.1922826 ]
-------------Round number:  164  -------------
client Accurancy:  0.3055555555555556
client Accurancy:  0.38492063492063494
client Accurancy:  0.4126984126984127
client Accurancy:  0.376984126984127
client Accurancy:  0.17857142857142858
Average Global Accurancy:  0.33174603174603173
Average Global Trainning Accurancy:  0.3438775510204082
Average Global Trainning Loss:  1.7318040497448979
All users are selected
model: 0 tensor([0.2561, 0.2077, 0.1903, 0.1766, 0.1693], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0038, -0.0232, -0.0201, -0.0202, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2099, 0.2224, 0.1960, 0.1913, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0149, -0.0163, -0.0058, -0.0067, -0.0057],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1935, 0.2192, 0.2006, 0.1928], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0278, 0.0290, 0.0227, 0.0315, 0.0269],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1752, 0.1905, 0.1999, 0.2231, 0.2113], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0376, -0.0306, -0.0292, -0.0423, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1768, 0.2268, 0.1991, 0.2050, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0332, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0459,  0.0870,  0.0392,  0.0355, -0.0403]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24623942 0.21297592 0.19217548 0.17958525 0.16902395]
np_weight_alpha[1] [0.23412167 0.25791186 0.17380796 0.17395493 0.16020359]
np_weight_alpha[2] [0.1934362  0.19181423 0.22521542 0.196319   0.1932151 ]
np_weight_alpha[3] [0.18050806 0.18816887 0.19593869 0.23488945 0.20049493]
np_weight_alpha[4] [0.16456738 0.17204888 0.1901883  0.19958293 0.27361253]
-------------Round number:  165  -------------
client Accurancy:  0.35714285714285715
client Accurancy:  0.3888888888888889
client Accurancy:  0.4087301587301587
client Accurancy:  0.3968253968253968
client Accurancy:  0.19444444444444445
Average Global Accurancy:  0.3492063492063492
Average Global Trainning Accurancy:  0.36428571428571427
Average Global Trainning Loss:  1.6032691592261905
All users are selected
model: 0 tensor([0.2462, 0.2130, 0.1922, 0.1796, 0.1690], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0147, -0.0006, -0.0151, -0.0202, -0.0128],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2341, 0.2579, 0.1738, 0.1740, 0.1602], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0373, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0133,  0.0069, -0.0421, -0.0387, -0.0516],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1918, 0.2252, 0.1963, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0357, 0.0356, 0.0440, 0.0319, 0.0364],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1805, 0.1882, 0.1959, 0.2349, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0132, -0.0074, -0.0116,  0.0063, -0.0062],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1646, 0.1720, 0.1902, 0.1996, 0.2736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0378, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010, -0.0088,  0.0030,  0.0057,  0.0313]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25231197 0.19910277 0.19288994 0.18584614 0.1698492 ]
np_weight_alpha[1] [0.1978358  0.2301317  0.19304265 0.1898947  0.18909511]
np_weight_alpha[2] [0.19431424 0.19281587 0.21852948 0.20092197 0.19341844]
np_weight_alpha[3] [0.21430561 0.1923772  0.22215861 0.172621   0.19853757]
np_weight_alpha[4] [0.1898091  0.25124395 0.20482697 0.20068966 0.1534303 ]
-------------Round number:  166  -------------
client Accurancy:  0.3134920634920635
client Accurancy:  0.35714285714285715
client Accurancy:  0.4126984126984127
client Accurancy:  0.3968253968253968
client Accurancy:  0.15079365079365079
Average Global Accurancy:  0.3261904761904762
Average Global Trainning Accurancy:  0.3414965986394558
Average Global Trainning Loss:  1.7607511559311224
All users are selected
model: 0 tensor([0.2523, 0.1991, 0.1929, 0.1858, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0271, -0.0385, -0.0270, -0.0194, -0.0269],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1978, 0.2301, 0.1930, 0.1899, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0565, -0.0356, -0.0474, -0.0457, -0.0348],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1928, 0.2185, 0.2009, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0677, 0.0619, 0.0650, 0.0656, 0.0676],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2143, 0.1924, 0.2222, 0.1726, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0082, -0.0304, -0.0105, -0.0819, -0.0449],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1898, 0.2512, 0.2048, 0.2007, 0.1534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0304, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0687,  0.1174,  0.0568,  0.0322, -0.0610]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.25603917 0.20778272 0.1901202  0.17667247 0.16938545]
np_weight_alpha[1] [0.21003295 0.2223818  0.19594514 0.19126235 0.18037775]
np_weight_alpha[2] [0.1937332  0.19341223 0.21927522 0.20067357 0.1929058 ]
np_weight_alpha[3] [0.17523941 0.19040616 0.200042   0.22320685 0.21110556]
np_weight_alpha[4] [0.18415953 0.2384738  0.20089921 0.20167792 0.17478958]
-------------Round number:  167  -------------
client Accurancy:  0.30952380952380953
client Accurancy:  0.3888888888888889
client Accurancy:  0.4126984126984127
client Accurancy:  0.373015873015873
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.33015873015873015
Average Global Trainning Accurancy:  0.3476190476190476
Average Global Trainning Loss:  1.7387180458120748
All users are selected
model: 0 tensor([0.2560, 0.2078, 0.1901, 0.1767, 0.1694], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0018, -0.0208, -0.0179, -0.0174, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2100, 0.2224, 0.1959, 0.1913, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0146, -0.0161, -0.0056, -0.0068, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1937, 0.1934, 0.2193, 0.2007, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0259, 0.0275, 0.0213, 0.0298, 0.0253],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1752, 0.1904, 0.2000, 0.2232, 0.2111], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0374, -0.0310, -0.0295, -0.0424, -0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1842, 0.2385, 0.2009, 0.2017, 0.1748], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0349, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0544,  0.0995,  0.0409,  0.0316, -0.0595]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24650837 0.2129847  0.19221847 0.17927852 0.16900994]
np_weight_alpha[1] [0.23365535 0.25770274 0.1736333  0.17485666 0.16015196]
np_weight_alpha[2] [0.19351068 0.191708   0.22497387 0.19651563 0.19329178]
np_weight_alpha[3] [0.18020728 0.18829778 0.19612767 0.23485617 0.20051104]
np_weight_alpha[4] [0.18043254 0.2262914  0.198851   0.20148736 0.19293766]
-------------Round number:  168  -------------
client Accurancy:  0.3611111111111111
client Accurancy:  0.39285714285714285
client Accurancy:  0.4087301587301587
client Accurancy:  0.3968253968253968
client Accurancy:  0.1349206349206349
Average Global Accurancy:  0.3388888888888889
Average Global Trainning Accurancy:  0.354421768707483
Average Global Trainning Loss:  1.665072777157738
All users are selected
model: 0 tensor([0.2465, 0.2130, 0.1922, 0.1793, 0.1690], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0156, -0.0015, -0.0160, -0.0219, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2337, 0.2577, 0.1736, 0.1749, 0.1602], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0369, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0123,  0.0062, -0.0429, -0.0385, -0.0527],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1917, 0.2250, 0.1965, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0320, 0.0318, 0.0401, 0.0283, 0.0325],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1883, 0.1961, 0.2349, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0175, -0.0111, -0.0151,  0.0030, -0.0099],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1804, 0.2263, 0.1989, 0.2015, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0327,  0.0599,  0.0237,  0.0187, -0.0428]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25246692 0.19894385 0.19282997 0.18610232 0.16965696]
np_weight_alpha[1] [0.1977129  0.22983675 0.19302088 0.18996228 0.18946716]
np_weight_alpha[2] [0.19425708 0.19278276 0.21840751 0.20093448 0.19361812]
np_weight_alpha[3] [0.18764958 0.18916363 0.20073771 0.22257288 0.19987622]
np_weight_alpha[4] [0.16700417 0.18331636 0.19152664 0.1989422  0.25921062]
-------------Round number:  169  -------------
client Accurancy:  0.31746031746031744
client Accurancy:  0.3611111111111111
client Accurancy:  0.4246031746031746
client Accurancy:  0.4087301587301587
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.3476190476190476
Average Global Trainning Accurancy:  0.3663265306122449
Average Global Trainning Loss:  1.649763333067602
All users are selected
model: 0 tensor([0.2525, 0.1989, 0.1928, 0.1861, 0.1697], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0233, -0.0348, -0.0230, -0.0150, -0.0228],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1977, 0.2298, 0.1930, 0.1900, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0539, -0.0332, -0.0445, -0.0430, -0.0313],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1928, 0.2184, 0.2009, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0694, 0.0636, 0.0666, 0.0673, 0.0692],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1876, 0.1892, 0.2007, 0.2226, 0.1999], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0162, -0.0297, -0.0272, -0.0254, -0.0369],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1670, 0.1833, 0.1915, 0.1989, 0.2592], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0223, 0.0274, 0.0241, 0.0143, 0.0340]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2564727  0.20784473 0.19006552 0.17650913 0.16910793]
np_weight_alpha[1] [0.21015345 0.22251436 0.19585401 0.19138822 0.18008998]
np_weight_alpha[2] [0.1936882  0.1933735  0.21915129 0.20068735 0.19309966]
np_weight_alpha[3] [0.17753102 0.19140781 0.20032    0.22140267 0.2093385 ]
np_weight_alpha[4] [0.16969709 0.17947344 0.19003038 0.20711379 0.2536853 ]
-------------Round number:  170  -------------
client Accurancy:  0.3134920634920635
client Accurancy:  0.3888888888888889
client Accurancy:  0.4166666666666667
client Accurancy:  0.38492063492063494
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.3484126984126984
Average Global Trainning Accurancy:  0.35918367346938773
Average Global Trainning Loss:  1.662640007174745
All users are selected
model: 0 tensor([0.2565, 0.2078, 0.1901, 0.1765, 0.1691], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0034, -0.0160, -0.0131, -0.0128, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2102, 0.2225, 0.1959, 0.1914, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0129, -0.0142, -0.0041, -0.0053, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1937, 0.1934, 0.2192, 0.2007, 0.1931], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0273, 0.0286, 0.0226, 0.0308, 0.0267],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1775, 0.1914, 0.2003, 0.2214, 0.2093], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0334, -0.0288, -0.0280, -0.0426, -0.0235],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1697, 0.1795, 0.1900, 0.2071, 0.2537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0278, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0249, 0.0179, 0.0268, 0.0150]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24648905 0.21295673 0.19207609 0.17922774 0.16925037]
np_weight_alpha[1] [0.23307258 0.25646588 0.17432924 0.17582953 0.16030274]
np_weight_alpha[2] [0.1933615  0.19176799 0.2248067  0.19670278 0.193361  ]
np_weight_alpha[3] [0.17993745 0.18845801 0.19631118 0.23458233 0.200711  ]
np_weight_alpha[4] [0.1680606  0.17510642 0.19111346 0.19910462 0.26661485]
-------------Round number:  171  -------------
client Accurancy:  0.376984126984127
client Accurancy:  0.3968253968253968
client Accurancy:  0.4007936507936508
client Accurancy:  0.3968253968253968
client Accurancy:  0.1865079365079365
Average Global Accurancy:  0.3515873015873016
Average Global Trainning Accurancy:  0.3741496598639456
Average Global Trainning Loss:  1.58921280426233
All users are selected
model: 0 tensor([0.2465, 0.2130, 0.1921, 0.1792, 0.1693], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0126,  0.0016, -0.0130, -0.0187, -0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2331, 0.2565, 0.1743, 0.1758, 0.1603], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0355, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0164,  0.0095, -0.0376, -0.0328, -0.0475],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1918, 0.2248, 0.1967, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0334, 0.0331, 0.0415, 0.0300, 0.0339],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1799, 0.1885, 0.1963, 0.2346, 0.2007], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0167, -0.0101, -0.0140,  0.0037, -0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1681, 0.1751, 0.1911, 0.1991, 0.2666], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0308, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0036, -0.0068,  0.0025,  0.0037,  0.0235]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25249925 0.19886354 0.19276603 0.18593942 0.16993175]
np_weight_alpha[1] [0.19768783 0.23004732 0.19313899 0.18997505 0.18915081]
np_weight_alpha[2] [0.19419903 0.19293931 0.21826896 0.20086922 0.19372351]
np_weight_alpha[3] [0.18748854 0.18921307 0.20067322 0.22240353 0.20022164]
np_weight_alpha[4] [0.17672497 0.23733705 0.20376717 0.20620582 0.17596503]
-------------Round number:  172  -------------
client Accurancy:  0.3253968253968254
client Accurancy:  0.376984126984127
client Accurancy:  0.4246031746031746
client Accurancy:  0.42063492063492064
client Accurancy:  0.15873015873015872
Average Global Accurancy:  0.3412698412698413
Average Global Trainning Accurancy:  0.3578231292517007
Average Global Trainning Loss:  1.6997140066964285
All users are selected
model: 0 tensor([0.2525, 0.1989, 0.1928, 0.1859, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0236, -0.0352, -0.0234, -0.0158, -0.0224],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1977, 0.2300, 0.1931, 0.1900, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0570, -0.0362, -0.0473, -0.0460, -0.0349],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1929, 0.2183, 0.2009, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0663, 0.0610, 0.0633, 0.0644, 0.0663],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1875, 0.1892, 0.2007, 0.2224, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0308, -0.0284, -0.0266, -0.0379],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1767, 0.2373, 0.2038, 0.2062, 0.1760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0285, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0488,  0.0968,  0.0495,  0.0326, -0.0428]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2565167  0.20784214 0.19010718 0.17680621 0.16872782]
np_weight_alpha[1] [0.2101382  0.22260794 0.19567104 0.19131573 0.180267  ]
np_weight_alpha[2] [0.19365469 0.19346094 0.21907622 0.20060813 0.19320004]
np_weight_alpha[3] [0.17787206 0.19134991 0.20018522 0.22117028 0.2094225 ]
np_weight_alpha[4] [0.17531894 0.22625259 0.20055577 0.20647256 0.19140022]
-------------Round number:  173  -------------
client Accurancy:  0.31746031746031744
client Accurancy:  0.39285714285714285
client Accurancy:  0.4166666666666667
client Accurancy:  0.39285714285714285
client Accurancy:  0.1865079365079365
Average Global Accurancy:  0.3412698412698413
Average Global Trainning Accurancy:  0.35612244897959183
Average Global Trainning Loss:  1.700963442017432
All users are selected
model: 0 tensor([0.2565, 0.2078, 0.1901, 0.1768, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0057, -0.0134, -0.0107, -0.0098, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2101, 0.2226, 0.1957, 0.1913, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0140, -0.0154, -0.0051, -0.0063, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1937, 0.1935, 0.2191, 0.2006, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0234, 0.0254, 0.0193, 0.0269, 0.0231],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1779, 0.1913, 0.2002, 0.2212, 0.2094], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0345, -0.0303, -0.0300, -0.0443, -0.0251],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1753, 0.2263, 0.2006, 0.2065, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0331, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0381,  0.0800,  0.0340,  0.0305, -0.0475]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19214632 0.24311922 0.20803607 0.19014491 0.16655347]
np_weight_alpha[1] [0.23322655 0.25749007 0.17368558 0.1753595  0.16023828]
np_weight_alpha[2] [0.19361454 0.19150592 0.2244281  0.1969793  0.19347213]
np_weight_alpha[3] [0.17980102 0.18830815 0.19658266 0.23444806 0.20086004]
np_weight_alpha[4] [0.16445735 0.17205016 0.19043577 0.1996136  0.27344316]
-------------Round number:  174  -------------
client Accurancy:  0.36507936507936506
client Accurancy:  0.4087301587301587
client Accurancy:  0.40476190476190477
client Accurancy:  0.39285714285714285
client Accurancy:  0.21031746031746032
Average Global Accurancy:  0.35634920634920636
Average Global Trainning Accurancy:  0.37551020408163266
Average Global Trainning Loss:  1.590386672247024
All users are selected
model: 0 tensor([0.1921, 0.2431, 0.2080, 0.1901, 0.1666], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0253, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0649,  0.0375,  0.0083, -0.0022, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2332, 0.2575, 0.1737, 0.1754, 0.1602], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0364, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0176,  0.0116, -0.0374, -0.0325, -0.0468],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1915, 0.2244, 0.1970, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0311, 0.0304, 0.0385, 0.0279, 0.0315],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1798, 0.1883, 0.1966, 0.2344, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0184, -0.0116, -0.0149,  0.0025, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1645, 0.1721, 0.1904, 0.1996, 0.2734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0376, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0027, -0.0126, -0.0007,  0.0017,  0.0283]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25605714 0.19797608 0.19217078 0.18527292 0.16852312]
np_weight_alpha[1] [0.19762371 0.22983135 0.19314723 0.19009672 0.18930098]
np_weight_alpha[2] [0.19421288 0.19292638 0.21840763 0.2007276  0.1937255 ]
np_weight_alpha[3] [0.18767945 0.18932898 0.20054233 0.22217971 0.20026958]
np_weight_alpha[4] [0.18949571 0.25242105 0.2051486  0.2024005  0.15053414]
-------------Round number:  175  -------------
client Accurancy:  0.3333333333333333
client Accurancy:  0.38492063492063494
client Accurancy:  0.4246031746031746
client Accurancy:  0.4246031746031746
client Accurancy:  0.15476190476190477
Average Global Accurancy:  0.34444444444444444
Average Global Trainning Accurancy:  0.3598639455782313
Average Global Trainning Loss:  1.711190110809949
All users are selected
model: 0 tensor([0.2561, 0.1980, 0.1922, 0.1853, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0191, -0.0352, -0.0231, -0.0159, -0.0227],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1976, 0.2298, 0.1931, 0.1901, 0.1893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0589, -0.0383, -0.0489, -0.0478, -0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1929, 0.2184, 0.2007, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0647, 0.0595, 0.0616, 0.0626, 0.0645],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1877, 0.1893, 0.2005, 0.2222, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0306, -0.0282, -0.0262, -0.0375],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1895, 0.2524, 0.2051, 0.2024, 0.1505], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0311, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0684,  0.1176,  0.0553,  0.0326, -0.0665]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2563642  0.20784964 0.19006954 0.17715122 0.1685654 ]
np_weight_alpha[1] [0.2102105  0.22269474 0.19552325 0.19144674 0.1801247 ]
np_weight_alpha[2] [0.19364597 0.19341931 0.21922794 0.20048465 0.19322221]
np_weight_alpha[3] [0.17813008 0.19150764 0.20016119 0.22082718 0.20937389]
np_weight_alpha[4] [0.18359219 0.2393951  0.20114481 0.20296219 0.1729057 ]
-------------Round number:  176  -------------
client Accurancy:  0.32936507936507936
client Accurancy:  0.3968253968253968
client Accurancy:  0.4166666666666667
client Accurancy:  0.3888888888888889
client Accurancy:  0.17857142857142858
Average Global Accurancy:  0.34206349206349207
Average Global Trainning Accurancy:  0.3564625850340136
Average Global Trainning Loss:  1.7101391435480442
All users are selected
model: 0 tensor([0.2564, 0.2078, 0.1901, 0.1772, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0079, -0.0110, -0.0082, -0.0069, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2102, 0.2227, 0.1955, 0.1914, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0159, -0.0057, -0.0070, -0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1936, 0.1934, 0.2192, 0.2005, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0219, 0.0239, 0.0179, 0.0250, 0.0213],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1781, 0.1915, 0.2002, 0.2208, 0.2094], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0340, -0.0302, -0.0301, -0.0444, -0.0249],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1836, 0.2394, 0.2011, 0.2030, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0351, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0477,  0.0944,  0.0345,  0.0268, -0.0677]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.19335936 0.24319345 0.20771234 0.18815881 0.16757599]
np_weight_alpha[1] [0.23296961 0.25682163 0.17364612 0.17601633 0.16054636]
np_weight_alpha[2] [0.19351009 0.19136357 0.22433287 0.19717696 0.19361655]
np_weight_alpha[3] [0.1796665  0.18852936 0.19677585 0.23432724 0.20070103]
np_weight_alpha[4] [0.17995742 0.22703025 0.19907796 0.2024565  0.19147786]
-------------Round number:  177  -------------
client Accurancy:  0.373015873015873
client Accurancy:  0.4166666666666667
client Accurancy:  0.40476190476190477
client Accurancy:  0.39285714285714285
client Accurancy:  0.15079365079365079
Average Global Accurancy:  0.3476190476190476
Average Global Trainning Accurancy:  0.3653061224489796
Average Global Trainning Loss:  1.6536355362457482
All users are selected
model: 0 tensor([0.1934, 0.2432, 0.2077, 0.1882, 0.1676], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0256, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0656,  0.0365,  0.0065, -0.0053, -0.0071],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2330, 0.2568, 0.1736, 0.1760, 0.1605], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0357, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0174,  0.0109, -0.0375, -0.0321, -0.0472],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1914, 0.2243, 0.1972, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0264, 0.0258, 0.0341, 0.0234, 0.0272],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1797, 0.1885, 0.1968, 0.2343, 0.2007], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0219, -0.0150, -0.0185, -0.0015, -0.0139],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1800, 0.2270, 0.1991, 0.2025, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0283,  0.0564,  0.0200,  0.0157, -0.0472]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25665605 0.19767462 0.19226044 0.18499912 0.16840976]
np_weight_alpha[1] [0.19737706 0.22967687 0.19305915 0.19008057 0.1898064 ]
np_weight_alpha[2] [0.19432117 0.1928467  0.21821475 0.20092638 0.19369106]
np_weight_alpha[3] [0.18739097 0.18928756 0.20073189 0.22250241 0.20008712]
np_weight_alpha[4] [0.16710946 0.18376653 0.19166693 0.19920377 0.25825334]
-------------Round number:  178  -------------
client Accurancy:  0.35714285714285715
client Accurancy:  0.3888888888888889
client Accurancy:  0.4246031746031746
client Accurancy:  0.4365079365079365
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.36904761904761907
Average Global Trainning Accurancy:  0.3843537414965986
Average Global Trainning Loss:  1.6110457855017006
All users are selected
model: 0 tensor([0.2567, 0.1977, 0.1923, 0.1850, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0157, -0.0326, -0.0201, -0.0130, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1974, 0.2297, 0.1931, 0.1901, 0.1898], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0570, -0.0360, -0.0467, -0.0455, -0.0333],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1928, 0.2182, 0.2009, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0667, 0.0613, 0.0636, 0.0648, 0.0663],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1874, 0.1893, 0.2007, 0.2225, 0.2001], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0134, -0.0263, -0.0236, -0.0216, -0.0333],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1671, 0.1838, 0.1917, 0.1992, 0.2583], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0218, 0.0262, 0.0222, 0.0127, 0.0304]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25664997 0.20794705 0.19017512 0.17693712 0.16829073]
np_weight_alpha[1] [0.2103772  0.22264211 0.19554496 0.19150603 0.17992973]
np_weight_alpha[2] [0.1937609  0.1933662  0.21900976 0.20064418 0.19321895]
np_weight_alpha[3] [0.1779284  0.1915802  0.20013082 0.22096042 0.20940016]
np_weight_alpha[4] [0.16862018 0.17924573 0.19021933 0.20712024 0.25479454]
-------------Round number:  179  -------------
client Accurancy:  0.32936507936507936
client Accurancy:  0.4007936507936508
client Accurancy:  0.42063492063492064
client Accurancy:  0.3888888888888889
client Accurancy:  0.24603174603174602
Average Global Accurancy:  0.35714285714285715
Average Global Trainning Accurancy:  0.3683673469387755
Average Global Trainning Loss:  1.629075321534864
All users are selected
model: 0 tensor([0.2566, 0.2079, 0.1902, 0.1769, 0.1683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0127, -0.0067, -0.0037, -0.0028, -0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2104, 0.2226, 0.1955, 0.1915, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0125, -0.0144, -0.0035, -0.0053, -0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1938, 0.1934, 0.2190, 0.2006, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0225, 0.0244, 0.0180, 0.0251, 0.0214],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1779, 0.1916, 0.2001, 0.2210, 0.2094], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0322, -0.0284, -0.0285, -0.0420, -0.0228],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1686, 0.1792, 0.1902, 0.2071, 0.2548], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0275, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0169, 0.0197, 0.0126, 0.0219, 0.0114]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19097658 0.24277145 0.20637685 0.18886708 0.17100807]
np_weight_alpha[1] [0.23207365 0.2592898  0.17226389 0.17656505 0.15980764]
np_weight_alpha[2] [0.1932916  0.19109309 0.22429469 0.19746137 0.19385923]
np_weight_alpha[3] [0.17962855 0.18874387 0.19706771 0.23394403 0.20061578]
np_weight_alpha[4] [0.16832292 0.17499664 0.19158864 0.19899085 0.26610103]
-------------Round number:  180  -------------
client Accurancy:  0.38095238095238093
client Accurancy:  0.42857142857142855
client Accurancy:  0.40476190476190477
client Accurancy:  0.39285714285714285
client Accurancy:  0.20634920634920634
Average Global Accurancy:  0.3626984126984127
Average Global Trainning Accurancy:  0.3836734693877551
Average Global Trainning Loss:  1.5776363865858845
All users are selected
model: 0 tensor([0.1910, 0.2428, 0.2064, 0.1889, 0.1710], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0633,  0.0408,  0.0102,  0.0007,  0.0012],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2321, 0.2593, 0.1723, 0.1766, 0.1598], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0374, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0202,  0.0173, -0.0352, -0.0277, -0.0440],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1911, 0.2243, 0.1975, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0270, 0.0261, 0.0351, 0.0243, 0.0278],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1796, 0.1887, 0.1971, 0.2339, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.9719e-02, -1.2937e-02, -1.6404e-02,  3.0383e-05, -1.2429e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1683, 0.1750, 0.1916, 0.1990, 0.2661], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0303, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0003, -0.0115, -0.0015, -0.0007,  0.0198]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25692782 0.19779053 0.19216135 0.1846524  0.16846791]
np_weight_alpha[1] [0.19747299 0.22955789 0.19318521 0.19013599 0.18964793]
np_weight_alpha[2] [0.19423762 0.19295517 0.21777692 0.20100196 0.1940283 ]
np_weight_alpha[3] [0.18710965 0.1893056  0.20080139 0.22241062 0.20037268]
np_weight_alpha[4] [0.1758593  0.2405725  0.20323361 0.20714001 0.17319456]
-------------Round number:  181  -------------
client Accurancy:  0.3611111111111111
client Accurancy:  0.4007936507936508
client Accurancy:  0.4246031746031746
client Accurancy:  0.4246031746031746
client Accurancy:  0.16666666666666666
Average Global Accurancy:  0.35555555555555557
Average Global Trainning Accurancy:  0.37244897959183676
Average Global Trainning Loss:  1.6639900882227892
All users are selected
model: 0 tensor([0.2569, 0.1978, 0.1922, 0.1847, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0166, -0.0332, -0.0208, -0.0143, -0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1975, 0.2296, 0.1932, 0.1901, 0.1896], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0595, -0.0388, -0.0491, -0.0481, -0.0363],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1930, 0.2178, 0.2010, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0640, 0.0588, 0.0605, 0.0620, 0.0636],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1871, 0.1893, 0.2008, 0.2224, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0274, -0.0248, -0.0226, -0.0341],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1759, 0.2406, 0.2032, 0.2071, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0290, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0472,  0.0984,  0.0466,  0.0317, -0.0482]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.25708336 0.20786217 0.18993413 0.17705074 0.16806965]
np_weight_alpha[1] [0.21031496 0.22264682 0.1954314  0.19148067 0.18012619]
np_weight_alpha[2] [0.19365807 0.19343604 0.21862163 0.20073678 0.19354746]
np_weight_alpha[3] [0.17809494 0.19156621 0.20025426 0.22070648 0.20937811]
np_weight_alpha[4] [0.17441422 0.22901088 0.20012487 0.20712133 0.1893287 ]
-------------Round number:  182  -------------
client Accurancy:  0.3373015873015873
client Accurancy:  0.40476190476190477
client Accurancy:  0.42063492063492064
client Accurancy:  0.3968253968253968
client Accurancy:  0.1865079365079365
Average Global Accurancy:  0.3492063492063492
Average Global Trainning Accurancy:  0.36462585034013606
Average Global Trainning Loss:  1.6720889136904762
All users are selected
model: 0 tensor([0.2571, 0.2079, 0.1899, 0.1771, 0.1681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0248, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0141, -0.0055, -0.0026, -0.0012,  0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2103, 0.2226, 0.1954, 0.1915, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0167, -0.0058, -0.0076, -0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1934, 0.2186, 0.2007, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0195, 0.0217, 0.0146, 0.0222, 0.0187],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1781, 0.1916, 0.2003, 0.2207, 0.2094], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0321, -0.0286, -0.0287, -0.0427, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1744, 0.2290, 0.2001, 0.2071, 0.1893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0331, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0323,  0.0784,  0.0284,  0.0268, -0.0540]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19099963 0.24386138 0.20723379 0.18752567 0.1703795 ]
np_weight_alpha[1] [0.21467862 0.23029809 0.19030043 0.18827808 0.17644475]
np_weight_alpha[2] [0.19328092 0.19091497 0.22433189 0.19752261 0.19394961]
np_weight_alpha[3] [0.17944264 0.1886539  0.19712174 0.23414569 0.20063604]
np_weight_alpha[4] [0.16470605 0.17180927 0.19099234 0.19935061 0.27314174]
-------------Round number:  183  -------------
client Accurancy:  0.38095238095238093
client Accurancy:  0.42857142857142855
client Accurancy:  0.40476190476190477
client Accurancy:  0.3968253968253968
client Accurancy:  0.21428571428571427
Average Global Accurancy:  0.36507936507936506
Average Global Trainning Accurancy:  0.3891156462585034
Average Global Trainning Loss:  1.570504158694728
All users are selected
model: 0 tensor([0.1910, 0.2439, 0.2072, 0.1875, 0.1704], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0625,  0.0432,  0.0122,  0.0006,  0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2147, 0.2303, 0.1903, 0.1883, 0.1764], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0017, -0.0125, -0.0159, -0.0146, -0.0251],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1909, 0.2243, 0.1975, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0255, 0.0246, 0.0336, 0.0229, 0.0261],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1794, 0.1887, 0.1971, 0.2341, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0196, -0.0130, -0.0162,  0.0003, -0.0124],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1647, 0.1718, 0.1910, 0.1994, 0.2731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0374, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0055, -0.0162, -0.0034, -0.0015,  0.0265]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2573899  0.19764161 0.19211994 0.18447433 0.16837417]
np_weight_alpha[1] [0.19911216 0.23111439 0.19244164 0.18930821 0.18802361]
np_weight_alpha[2] [0.19422558 0.19281623 0.21777223 0.20095432 0.19423166]
np_weight_alpha[3] [0.1869418  0.18939824 0.20074974 0.22247918 0.200431  ]
np_weight_alpha[4] [0.17082605 0.18678719 0.19286768 0.1991668  0.2503523 ]
-------------Round number:  184  -------------
client Accurancy:  0.36507936507936506
client Accurancy:  0.4007936507936508
client Accurancy:  0.4166666666666667
client Accurancy:  0.4246031746031746
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.3674603174603175
Average Global Trainning Accurancy:  0.3921768707482993
Average Global Trainning Loss:  1.5971799266581632
All users are selected
model: 0 tensor([0.2574, 0.1976, 0.1921, 0.1845, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0133, -0.0309, -0.0184, -0.0122, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1991, 0.2311, 0.1924, 0.1893, 0.1880], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0555, -0.0353, -0.0478, -0.0472, -0.0361],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1928, 0.2178, 0.2010, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0658, 0.0604, 0.0623, 0.0636, 0.0653],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1869, 0.1894, 0.2007, 0.2225, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0109, -0.0231, -0.0205, -0.0181, -0.0295],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1868, 0.1929, 0.1992, 0.2504], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0232, 0.0269, 0.0205, 0.0102, 0.0202]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25654566 0.20775795 0.18991023 0.17717098 0.16861516]
np_weight_alpha[1] [0.20996898 0.2226706  0.19538985 0.19173545 0.18023512]
np_weight_alpha[2] [0.19363418 0.1933158  0.21860415 0.20070073 0.19374512]
np_weight_alpha[3] [0.17817813 0.19174115 0.20026922 0.22059266 0.20921886]
np_weight_alpha[4] [0.16848435 0.17911951 0.19067629 0.20718043 0.2545394 ]
-------------Round number:  185  -------------
client Accurancy:  0.3531746031746032
client Accurancy:  0.40476190476190477
client Accurancy:  0.4166666666666667
client Accurancy:  0.40476190476190477
client Accurancy:  0.25
Average Global Accurancy:  0.36587301587301585
Average Global Trainning Accurancy:  0.37755102040816324
Average Global Trainning Loss:  1.6084945990114796
All users are selected
model: 0 tensor([0.2565, 0.2078, 0.1899, 0.1772, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0172, -0.0020,  0.0015,  0.0029,  0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2100, 0.2227, 0.1954, 0.1917, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0142, -0.0156, -0.0043, -0.0061, -0.0045],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1936, 0.1933, 0.2186, 0.2007, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0188, 0.0208, 0.0135, 0.0209, 0.0177],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1782, 0.1917, 0.2003, 0.2206, 0.2092], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0294, -0.0261, -0.0266, -0.0403, -0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1685, 0.1791, 0.1907, 0.2072, 0.2545], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0273, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0143, 0.0171, 0.0105, 0.0196, 0.0094]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19358139 0.24505644 0.20543921 0.18607186 0.1698511 ]
np_weight_alpha[1] [0.2352828  0.25967953 0.1708339  0.17519897 0.1590048 ]
np_weight_alpha[2] [0.19291365 0.19069237 0.22446813 0.19781344 0.19411248]
np_weight_alpha[3] [0.179255   0.18865758 0.19740848 0.23401679 0.20066214]
np_weight_alpha[4] [0.16842963 0.17515685 0.19188142 0.1990377  0.26549444]
-------------Round number:  186  -------------
client Accurancy:  0.38492063492063494
client Accurancy:  0.45634920634920634
client Accurancy:  0.4126984126984127
client Accurancy:  0.4087301587301587
client Accurancy:  0.21428571428571427
Average Global Accurancy:  0.3753968253968254
Average Global Trainning Accurancy:  0.39387755102040817
Average Global Trainning Loss:  1.553807763339711
All users are selected
model: 0 tensor([0.1936, 0.2451, 0.2054, 0.1861, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0588,  0.0456,  0.0115,  0.0002,  0.0020],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2353, 0.2597, 0.1708, 0.1752, 0.1590], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0398, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0274,  0.0213, -0.0329, -0.0258, -0.0414],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1907, 0.2245, 0.1978, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0227, 0.0219, 0.0314, 0.0208, 0.0235],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1793, 0.1887, 0.1974, 0.2340, 0.2007], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.9894e-02, -1.3207e-02, -1.5928e-02,  6.5856e-05, -1.2653e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1684, 0.1752, 0.1919, 0.1990, 0.2655], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0299, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0021, -0.0133, -0.0036, -0.0028,  0.0182]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25724873 0.19752783 0.19210911 0.18451093 0.16860338]
np_weight_alpha[1] [0.19711027 0.2295844  0.1930652  0.19037053 0.18986967]
np_weight_alpha[2] [0.19417147 0.19278853 0.21767639 0.20083238 0.19453126]
np_weight_alpha[3] [0.18689336 0.18944755 0.20063263 0.2224152  0.20061131]
np_weight_alpha[4] [0.17547622 0.24022354 0.20457673 0.20812085 0.17160267]
-------------Round number:  187  -------------
client Accurancy:  0.373015873015873
client Accurancy:  0.4007936507936508
client Accurancy:  0.4166666666666667
client Accurancy:  0.4246031746031746
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.35793650793650794
Average Global Trainning Accurancy:  0.38095238095238093
Average Global Trainning Loss:  1.6461141780931123
All users are selected
model: 0 tensor([0.2572, 0.1975, 0.1921, 0.1845, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0172, -0.0343, -0.0220, -0.0156, -0.0211],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1971, 0.2296, 0.1931, 0.1904, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0602, -0.0394, -0.0498, -0.0485, -0.0367],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1928, 0.2177, 0.2008, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0626, 0.0574, 0.0593, 0.0606, 0.0627],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1869, 0.1894, 0.2006, 0.2224, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0116, -0.0236, -0.0210, -0.0187, -0.0299],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1755, 0.2402, 0.2046, 0.2081, 0.1716], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0290, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0457,  0.0971,  0.0468,  0.0319, -0.0506]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.25691223 0.20764673 0.1900415  0.1772171  0.16818243]
np_weight_alpha[1] [0.21010204 0.2227315  0.19542727 0.19160943 0.18012975]
np_weight_alpha[2] [0.19363146 0.193312   0.21850148 0.20058458 0.1939705 ]
np_weight_alpha[3] [0.17826991 0.19172186 0.20017251 0.22058345 0.20925222]
np_weight_alpha[4] [0.1741541  0.22867192 0.20121329 0.20788607 0.18807456]
-------------Round number:  188  -------------
client Accurancy:  0.3531746031746032
client Accurancy:  0.40476190476190477
client Accurancy:  0.4246031746031746
client Accurancy:  0.3968253968253968
client Accurancy:  0.19047619047619047
Average Global Accurancy:  0.353968253968254
Average Global Trainning Accurancy:  0.3741496598639456
Average Global Trainning Loss:  1.6534961933992347
All users are selected
model: 0 tensor([0.2569, 0.2076, 0.1900, 0.1772, 0.1682], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0178, -0.0017,  0.0017,  0.0033,  0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2101, 0.2227, 0.1954, 0.1916, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0160, -0.0176, -0.0064, -0.0082, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1933, 0.2185, 0.2006, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0172, 0.0193, 0.0123, 0.0192, 0.0165],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1783, 0.1917, 0.2002, 0.2206, 0.2093], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0299, -0.0267, -0.0275, -0.0409, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.2287, 0.2012, 0.2079, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0328, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0290,  0.0753,  0.0265,  0.0247, -0.0573]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19250655 0.24518427 0.20581749 0.18554917 0.17094249]
np_weight_alpha[1] [0.21472703 0.2304592  0.19011787 0.18822925 0.17646658]
np_weight_alpha[2] [0.19310912 0.19074717 0.22409047 0.19793779 0.19411553]
np_weight_alpha[3] [0.1791726  0.18860462 0.19752862 0.23385857 0.20083547]
np_weight_alpha[4] [0.16499364 0.17190596 0.19120991 0.19954573 0.27234477]
-------------Round number:  189  -------------
client Accurancy:  0.3888888888888889
client Accurancy:  0.4444444444444444
client Accurancy:  0.4126984126984127
client Accurancy:  0.40476190476190477
client Accurancy:  0.2261904761904762
Average Global Accurancy:  0.3753968253968254
Average Global Trainning Accurancy:  0.39727891156462586
Average Global Trainning Loss:  1.5510964737457482
All users are selected
model: 0 tensor([0.1925, 0.2452, 0.2058, 0.1855, 0.1709], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0595,  0.0465,  0.0126,  0.0006,  0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2147, 0.2305, 0.1901, 0.1882, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0046, -0.0093, -0.0134, -0.0121, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1907, 0.2241, 0.1979, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0220, 0.0210, 0.0302, 0.0203, 0.0225],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1792, 0.1886, 0.1975, 0.2339, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0194, -0.0129, -0.0151,  0.0004, -0.0123],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1650, 0.1719, 0.1912, 0.1995, 0.2723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0366, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0066, -0.0178, -0.0052, -0.0032,  0.0252]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2577474  0.19744368 0.19214086 0.1843275  0.16834055]
np_weight_alpha[1] [0.19898488 0.23079997 0.19250865 0.18951912 0.1881873 ]
np_weight_alpha[2] [0.1942366  0.19287463 0.21759866 0.20063189 0.19465819]
np_weight_alpha[3] [0.18676461 0.1895834  0.20042929 0.22237322 0.2008494 ]
np_weight_alpha[4] [0.17082815 0.18696792 0.1933271  0.19962446 0.24925235]
-------------Round number:  190  -------------
client Accurancy:  0.376984126984127
client Accurancy:  0.4007936507936508
client Accurancy:  0.4246031746031746
client Accurancy:  0.42857142857142855
client Accurancy:  0.23015873015873015
Average Global Accurancy:  0.37222222222222223
Average Global Trainning Accurancy:  0.39931972789115644
Average Global Trainning Loss:  1.5787677375637754
All users are selected
model: 0 tensor([0.2577, 0.1974, 0.1921, 0.1843, 0.1683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0147, -0.0326, -0.0202, -0.0140, -0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1990, 0.2308, 0.1925, 0.1895, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0561, -0.0362, -0.0485, -0.0476, -0.0366],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1929, 0.2176, 0.2006, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0646, 0.0592, 0.0612, 0.0623, 0.0645],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1868, 0.1896, 0.2004, 0.2224, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0079, -0.0197, -0.0175, -0.0151, -0.0258],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1870, 0.1933, 0.1996, 0.2493], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0234, 0.0271, 0.0209, 0.0108, 0.0194]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25661963 0.20758395 0.19000639 0.17718858 0.16860147]
np_weight_alpha[1] [0.20981479 0.22263005 0.19550958 0.19172475 0.18032083]
np_weight_alpha[2] [0.19366989 0.19339186 0.21840547 0.20042431 0.19410846]
np_weight_alpha[3] [0.17820086 0.19173677 0.20015511 0.2207369  0.20917034]
np_weight_alpha[4] [0.1684534  0.1792046  0.19081545 0.20717421 0.2543524 ]
-------------Round number:  191  -------------
client Accurancy:  0.3611111111111111
client Accurancy:  0.40476190476190477
client Accurancy:  0.4246031746031746
client Accurancy:  0.39285714285714285
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.36904761904761907
Average Global Trainning Accurancy:  0.38639455782312926
Average Global Trainning Loss:  1.5898387675382653
All users are selected
model: 0 tensor([0.2566, 0.2076, 0.1900, 0.1772, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0202, 0.0010, 0.0050, 0.0064, 0.0084],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2098, 0.2226, 0.1955, 0.1917, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0155, -0.0167, -0.0051, -0.0073, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1937, 0.1934, 0.2184, 0.2004, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0175, 0.0196, 0.0122, 0.0189, 0.0165],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1782, 0.1917, 0.2002, 0.2207, 0.2092], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0281, -0.0252, -0.0259, -0.0388, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1685, 0.1792, 0.1908, 0.2072, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0275, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0126, 0.0155, 0.0084, 0.0176, 0.0068]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19513457 0.24673061 0.2046367  0.18491861 0.16857958]
np_weight_alpha[1] [0.23678173 0.25999552 0.16977985 0.17595394 0.15748893]
np_weight_alpha[2] [0.19285974 0.19058253 0.22418025 0.19810744 0.19427006]
np_weight_alpha[3] [0.17908263 0.18885705 0.19769204 0.2337132  0.20065513]
np_weight_alpha[4] [0.1681468  0.17487708 0.19199273 0.19899498 0.26598844]
-------------Round number:  192  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.4087301587301587
client Accurancy:  0.2222222222222222
Average Global Accurancy:  0.3825396825396825
Average Global Trainning Accurancy:  0.4030612244897959
Average Global Trainning Loss:  1.5340353621917517
All users are selected
model: 0 tensor([0.1951, 0.2467, 0.2046, 0.1849, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0556,  0.0492,  0.0126,  0.0010,  0.0026],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2368, 0.2600, 0.1698, 0.1760, 0.1575], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0413, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0306,  0.0232, -0.0324, -0.0237, -0.0416],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1906, 0.2242, 0.1981, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0207, 0.0198, 0.0291, 0.0192, 0.0212],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1791, 0.1889, 0.1977, 0.2337, 0.2007], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.9919e-02, -1.3152e-02, -1.5490e-02, -5.6393e-05, -1.2912e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1681, 0.1749, 0.1920, 0.1990, 0.2660], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0303, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0037, -0.0150, -0.0052, -0.0045,  0.0179]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25756913 0.19738501 0.1920457  0.1844214  0.1685788 ]
np_weight_alpha[1] [0.19692232 0.22947025 0.19301286 0.1905558  0.19003871]
np_weight_alpha[2] [0.19409634 0.19270067 0.21760948 0.20069599 0.19489752]
np_weight_alpha[3] [0.18677539 0.18960468 0.20049818 0.22223717 0.20088458]
np_weight_alpha[4] [0.17593643 0.24167745 0.20577501 0.2093943  0.16721681]
-------------Round number:  193  -------------
client Accurancy:  0.376984126984127
client Accurancy:  0.40476190476190477
client Accurancy:  0.42857142857142855
client Accurancy:  0.42857142857142855
client Accurancy:  0.1746031746031746
Average Global Accurancy:  0.3626984126984127
Average Global Trainning Accurancy:  0.38945578231292516
Average Global Trainning Loss:  1.6316808168579933
All users are selected
model: 0 tensor([0.2576, 0.1974, 0.1920, 0.1844, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0173, -0.0347, -0.0225, -0.0162, -0.0214],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1969, 0.2295, 0.1930, 0.1906, 0.1900], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0614, -0.0406, -0.0509, -0.0495, -0.0377],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1927, 0.2176, 0.2007, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0612, 0.0560, 0.0582, 0.0594, 0.0615],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1868, 0.1896, 0.2005, 0.2222, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0091, -0.0209, -0.0184, -0.0162, -0.0268],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1759, 0.2417, 0.2058, 0.2094, 0.1672], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0292, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0467,  0.0988,  0.0479,  0.0335, -0.0549]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2570508  0.2074821  0.19010265 0.17728488 0.16807957]
np_weight_alpha[1] [0.2099629  0.22267903 0.19542526 0.19171482 0.18021792]
np_weight_alpha[2] [0.19359155 0.19324721 0.2183962  0.20045705 0.19430797]
np_weight_alpha[3] [0.17835449 0.19183706 0.20007816 0.22064129 0.209089  ]
np_weight_alpha[4] [0.17435236 0.22991039 0.20214678 0.20883702 0.18475348]
-------------Round number:  194  -------------
client Accurancy:  0.373015873015873
client Accurancy:  0.4087301587301587
client Accurancy:  0.42063492063492064
client Accurancy:  0.39285714285714285
client Accurancy:  0.20238095238095238
Average Global Accurancy:  0.3595238095238095
Average Global Trainning Accurancy:  0.3812925170068027
Average Global Trainning Loss:  1.6378398038903061
All users are selected
model: 0 tensor([0.2571, 0.2075, 0.1901, 0.1773, 0.1681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0208, 0.0013, 0.0053, 0.0067, 0.0077],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2100, 0.2227, 0.1954, 0.1917, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0176, -0.0188, -0.0075, -0.0099, -0.0082],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1932, 0.2184, 0.2005, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0159, 0.0179, 0.0104, 0.0171, 0.0150],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1784, 0.1918, 0.2001, 0.2206, 0.2091], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0278, -0.0251, -0.0261, -0.0386, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1744, 0.2299, 0.2021, 0.2088, 0.1848], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0330, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0271,  0.0745,  0.0253,  0.0239, -0.0627]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19354182 0.2459453  0.20384257 0.18468915 0.17198119]
np_weight_alpha[1] [0.21472345 0.23025487 0.18984583 0.1885972  0.17657866]
np_weight_alpha[2] [0.19276068 0.19045426 0.22424977 0.19827147 0.19426388]
np_weight_alpha[3] [0.1790725  0.18897863 0.19787166 0.23344721 0.20062996]
np_weight_alpha[4] [0.16505279 0.17194124 0.191368   0.19928703 0.27235094]
-------------Round number:  195  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.4722222222222222
client Accurancy:  0.4087301587301587
client Accurancy:  0.4126984126984127
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.3873015873015873
Average Global Trainning Accurancy:  0.40714285714285714
Average Global Trainning Loss:  1.5350929727359695
All users are selected
model: 0 tensor([0.1935, 0.2459, 0.2038, 0.1847, 0.1720], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0570,  0.0491,  0.0124,  0.0018,  0.0067],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2147, 0.2303, 0.1898, 0.1886, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0051, -0.0092, -0.0130, -0.0115, -0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1905, 0.2242, 0.1983, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0198, 0.0189, 0.0285, 0.0188, 0.0203],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1791, 0.1890, 0.1979, 0.2334, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0188, -0.0123, -0.0143,  0.0002, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1651, 0.1719, 0.1914, 0.1993, 0.2724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0366, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0181, -0.0058, -0.0040,  0.0254]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25810352 0.19732572 0.19205081 0.1840535  0.16846645]
np_weight_alpha[1] [0.1989225  0.23096757 0.19234635 0.18965659 0.18810703]
np_weight_alpha[2] [0.19412856 0.192719   0.21758632 0.20051008 0.19505602]
np_weight_alpha[3] [0.1864694  0.18970667 0.2003085  0.22252102 0.20099439]
np_weight_alpha[4] [0.1710209  0.186953   0.19375272 0.19978817 0.24848521]
-------------Round number:  196  -------------
client Accurancy:  0.373015873015873
client Accurancy:  0.4087301587301587
client Accurancy:  0.42857142857142855
client Accurancy:  0.42063492063492064
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.3738095238095238
Average Global Trainning Accurancy:  0.4064625850340136
Average Global Trainning Loss:  1.5621907552083334
All users are selected
model: 0 tensor([0.2581, 0.1973, 0.1921, 0.1841, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0152, -0.0328, -0.0211, -0.0148, -0.0204],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1989, 0.2310, 0.1923, 0.1897, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0563, -0.0366, -0.0495, -0.0482, -0.0374],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1927, 0.2176, 0.2005, 0.1951], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0633, 0.0578, 0.0606, 0.0614, 0.0639],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1865, 0.1897, 0.2003, 0.2225, 0.2010], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0052, -0.0167, -0.0144, -0.0120, -0.0226],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1870, 0.1938, 0.1998, 0.2485], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0229, 0.0263, 0.0206, 0.0102, 0.0176]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25702304 0.2071111  0.19021553 0.17714943 0.1685009 ]
np_weight_alpha[1] [0.20934595 0.22262056 0.19577092 0.19189395 0.18036862]
np_weight_alpha[2] [0.19363981 0.19332685 0.21832682 0.20029454 0.19441201]
np_weight_alpha[3] [0.17818666 0.19190052 0.1999953  0.22080743 0.20911014]
np_weight_alpha[4] [0.16832711 0.17920426 0.19078611 0.20713091 0.2545516 ]
-------------Round number:  197  -------------
client Accurancy:  0.376984126984127
client Accurancy:  0.4126984126984127
client Accurancy:  0.42857142857142855
client Accurancy:  0.39285714285714285
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.3746031746031746
Average Global Trainning Accurancy:  0.39421768707482996
Average Global Trainning Loss:  1.5699959475977892
All users are selected
model: 0 tensor([0.2570, 0.2071, 0.1902, 0.1771, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0234, 0.0033, 0.0081, 0.0089, 0.0106],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2093, 0.2226, 0.1958, 0.1919, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0170, -0.0177, -0.0058, -0.0086, -0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1933, 0.2183, 0.2003, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0163, 0.0183, 0.0106, 0.0172, 0.0151],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1782, 0.1919, 0.2000, 0.2208, 0.2091], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0259, -0.0230, -0.0238, -0.0359, -0.0174],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1683, 0.1792, 0.1908, 0.2071, 0.2546], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0272, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0096, 0.0129, 0.0057, 0.0153, 0.0052]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24746573 0.21317388 0.19132814 0.1785002  0.16953206]
np_weight_alpha[1] [0.21481669 0.23038422 0.18982771 0.18877313 0.17619829]
np_weight_alpha[2] [0.19260854 0.19045135 0.22421347 0.19821797 0.19450864]
np_weight_alpha[3] [0.17926638 0.18921544 0.19781902 0.23317897 0.20052022]
np_weight_alpha[4] [0.16743264 0.16263585 0.206331   0.17617086 0.2874297 ]
-------------Round number:  198  -------------
client Accurancy:  0.4365079365079365
client Accurancy:  0.4722222222222222
client Accurancy:  0.4166666666666667
client Accurancy:  0.4126984126984127
client Accurancy:  0.25
Average Global Accurancy:  0.3976190476190476
Average Global Trainning Accurancy:  0.41802721088435374
Average Global Trainning Loss:  1.502251740539966
All users are selected
model: 0 tensor([0.2475, 0.2132, 0.1913, 0.1785, 0.1695], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0023,  0.0140, -0.0019, -0.0066,  0.0010],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2148, 0.2304, 0.1898, 0.1888, 0.1762], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0070, -0.0076, -0.0113, -0.0097, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1905, 0.2242, 0.1982, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0208, 0.0200, 0.0291, 0.0197, 0.0213],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1793, 0.1892, 0.1978, 0.2332, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0116, -0.0138,  0.0003, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1674, 0.1626, 0.2063, 0.1762, 0.2874], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0535, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0301,  0.0071, -0.0298,  0.0396]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26872402 0.15068668 0.20095254 0.21198316 0.16765358]
np_weight_alpha[1] [0.19871809 0.23106052 0.19222696 0.18969281 0.18830168]
np_weight_alpha[2] [0.19386727 0.19258612 0.21783447 0.20047133 0.19524078]
np_weight_alpha[3] [0.18624584 0.18971662 0.20026858 0.22265738 0.20111158]
np_weight_alpha[4] [0.17129219 0.18752468 0.19378096 0.20037031 0.24703185]
-------------Round number:  199  -------------
client Accurancy:  0.38492063492063494
client Accurancy:  0.4087301587301587
client Accurancy:  0.4365079365079365
client Accurancy:  0.4246031746031746
client Accurancy:  0.23809523809523808
Average Global Accurancy:  0.37857142857142856
Average Global Trainning Accurancy:  0.41020408163265304
Average Global Trainning Loss:  1.557622834289966
All users are selected
model: 0 tensor([0.2687, 0.1507, 0.2010, 0.2120, 0.1677], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0417, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0073, -0.0829, -0.0145,  0.0110, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1987, 0.2311, 0.1922, 0.1897, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0570, -0.0373, -0.0503, -0.0488, -0.0379],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1926, 0.2178, 0.2005, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0627, 0.0576, 0.0607, 0.0613, 0.0640],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1862, 0.1897, 0.2003, 0.2227, 0.2011], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047, -0.0157, -0.0133, -0.0106, -0.0214],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1875, 0.1938, 0.2004, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0232, 0.0269, 0.0207, 0.0109, 0.0164]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25722632 0.20809597 0.18998936 0.17675658 0.1679317 ]
np_weight_alpha[1] [0.20912823 0.22279562 0.1957367  0.19189905 0.1804404 ]
np_weight_alpha[2] [0.19345763 0.19321434 0.21854435 0.20023367 0.19454995]
np_weight_alpha[3] [0.17851569 0.19193117 0.1998913  0.22061318 0.2090487 ]
np_weight_alpha[4] [0.16842696 0.1792607  0.19080617 0.20710808 0.25439805]
-------------Round number:  200  -------------
client Accurancy:  0.376984126984127
client Accurancy:  0.4126984126984127
client Accurancy:  0.42857142857142855
client Accurancy:  0.39285714285714285
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.3738095238095238
Average Global Trainning Accurancy:  0.39727891156462586
Average Global Trainning Loss:  1.5618406542304422
All users are selected
model: 0 tensor([0.2572, 0.2081, 0.1900, 0.1768, 0.1679], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0238, 0.0044, 0.0079, 0.0084, 0.0096],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2091, 0.2228, 0.1957, 0.1919, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0172, -0.0177, -0.0057, -0.0087, -0.0064],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1932, 0.2185, 0.2002, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0153, 0.0174, 0.0099, 0.0160, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1785, 0.1919, 0.1999, 0.2206, 0.2090], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0217, -0.0228, -0.0346, -0.0159],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1684, 0.1793, 0.1908, 0.2071, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0090, 0.0125, 0.0053, 0.0151, 0.0049]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24723001 0.2130847  0.19123822 0.17858945 0.1698576 ]
np_weight_alpha[1] [0.21477428 0.23050788 0.18961118 0.18882586 0.17628086]
np_weight_alpha[2] [0.19247943 0.19023782 0.22425917 0.19845779 0.19456579]
np_weight_alpha[3] [0.17929496 0.18927178 0.1980693  0.23306313 0.20030075]
np_weight_alpha[4] [0.16834535 0.16290636 0.20663683 0.17528419 0.28682727]
-------------Round number:  201  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.4801587301587302
client Accurancy:  0.4166666666666667
client Accurancy:  0.4166666666666667
client Accurancy:  0.25
Average Global Accurancy:  0.4007936507936508
Average Global Trainning Accurancy:  0.42142857142857143
Average Global Trainning Loss:  1.4962193080357142
All users are selected
model: 0 tensor([0.2472, 0.2131, 0.1912, 0.1786, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0026,  0.0138, -0.0022, -0.0064,  0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2148, 0.2305, 0.1896, 0.1888, 0.1763], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0076, -0.0071, -0.0109, -0.0091, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1902, 0.2243, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0196, 0.0189, 0.0283, 0.0192, 0.0204],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1793, 0.1893, 0.1981, 0.2331, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.7589e-02, -1.1534e-02, -1.3427e-02,  8.0960e-05, -1.2327e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1683, 0.1629, 0.2066, 0.1753, 0.2868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0529, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060, -0.0292,  0.0077, -0.0305,  0.0395]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2696465  0.1508797  0.20187524 0.21048073 0.16711783]
np_weight_alpha[1] [0.19870655 0.23129712 0.1921814  0.18970221 0.18811274]
np_weight_alpha[2] [0.19399956 0.1925587  0.21779025 0.20033956 0.19531192]
np_weight_alpha[3] [0.18603615 0.18971968 0.20013708 0.22283487 0.20127222]
np_weight_alpha[4] [0.1713567  0.18735558 0.19386269 0.2005571  0.246868  ]
-------------Round number:  202  -------------
client Accurancy:  0.38095238095238093
client Accurancy:  0.42063492063492064
client Accurancy:  0.44047619047619047
client Accurancy:  0.42857142857142855
client Accurancy:  0.25
Average Global Accurancy:  0.38412698412698415
Average Global Trainning Accurancy:  0.4166666666666667
Average Global Trainning Loss:  1.547689134247449
All users are selected
model: 0 tensor([0.2696, 0.1509, 0.2019, 0.2105, 0.1671], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0423, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0076, -0.0830, -0.0144,  0.0086, -0.0245],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1987, 0.2313, 0.1922, 0.1897, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0569, -0.0374, -0.0510, -0.0495, -0.0388],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1926, 0.2178, 0.2003, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0624, 0.0568, 0.0603, 0.0607, 0.0636],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1860, 0.1897, 0.2001, 0.2228, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0031, -0.0140, -0.0115, -0.0083, -0.0192],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1874, 0.1939, 0.2006, 0.2469], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0231, 0.0264, 0.0207, 0.0110, 0.0161]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25770012 0.20747256 0.18998826 0.17684126 0.16799782]
np_weight_alpha[1] [0.20853642 0.22266918 0.19598868 0.19214435 0.18066134]
np_weight_alpha[2] [0.19356339 0.19324253 0.21846774 0.20013659 0.19458976]
np_weight_alpha[3] [0.17857757 0.19216825 0.19992779 0.22039059 0.20893583]
np_weight_alpha[4] [0.16842666 0.17944174 0.19072144 0.2070139  0.2543963 ]
-------------Round number:  203  -------------
client Accurancy:  0.376984126984127
client Accurancy:  0.42857142857142855
client Accurancy:  0.4246031746031746
client Accurancy:  0.3968253968253968
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.37777777777777777
Average Global Trainning Accurancy:  0.40272108843537413
Average Global Trainning Loss:  1.552799313084609
All users are selected
model: 0 tensor([0.2577, 0.2075, 0.1900, 0.1768, 0.1680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0235, 0.0030, 0.0071, 0.0075, 0.0086],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2085, 0.2227, 0.1960, 0.1921, 0.1807], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0173, -0.0173, -0.0050, -0.0082, -0.0057],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1932, 0.2185, 0.2001, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0151, 0.0172, 0.0095, 0.0156, 0.0139],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1786, 0.1922, 0.1999, 0.2204, 0.2089], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0228, -0.0202, -0.0214, -0.0333, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1684, 0.1794, 0.1907, 0.2070, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0082, 0.0120, 0.0045, 0.0145, 0.0044]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.1889066  0.24510033 0.20308928 0.18789203 0.1750117 ]
np_weight_alpha[1] [0.21466865 0.23046657 0.18960436 0.18900463 0.17625575]
np_weight_alpha[2] [0.1924717  0.19023347 0.22416966 0.1984762  0.19464906]
np_weight_alpha[3] [0.17934223 0.18946487 0.19808649 0.23290733 0.20019907]
np_weight_alpha[4] [0.16907518 0.16232951 0.20744866 0.17515239 0.2859943 ]
-------------Round number:  204  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.48412698412698413
client Accurancy:  0.4166666666666667
client Accurancy:  0.4166666666666667
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.39444444444444443
Average Global Trainning Accurancy:  0.41768707482993195
Average Global Trainning Loss:  1.512642830569728
All users are selected
model: 0 tensor([0.1889, 0.2451, 0.2031, 0.1879, 0.1750], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0615,  0.0488,  0.0124,  0.0059,  0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2147, 0.2305, 0.1896, 0.1890, 0.1763], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0073, -0.0070, -0.0108, -0.0088, -0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1902, 0.2242, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0183, 0.0177, 0.0270, 0.0179, 0.0190],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1793, 0.1895, 0.1981, 0.2329, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0118, -0.0139, -0.0003, -0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1691, 0.1623, 0.2074, 0.1752, 0.2860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0522, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0056, -0.0303,  0.0079, -0.0311,  0.0385]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2586224  0.1973594  0.19188945 0.18374467 0.16838403]
np_weight_alpha[1] [0.19888747 0.23118946 0.1921016  0.18967009 0.18815137]
np_weight_alpha[2] [0.19402051 0.19247684 0.21770912 0.20031604 0.19547755]
np_weight_alpha[3] [0.18629818 0.18970002 0.20012107 0.22254565 0.20133515]
np_weight_alpha[4] [0.17131531 0.18741602 0.19400866 0.2006171  0.24664289]
-------------Round number:  205  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.4365079365079365
client Accurancy:  0.44047619047619047
client Accurancy:  0.43253968253968256
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.39206349206349206
Average Global Trainning Accurancy:  0.42210884353741496
Average Global Trainning Loss:  1.5363649952168368
All users are selected
model: 0 tensor([0.2586, 0.1974, 0.1919, 0.1837, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0181, -0.0349, -0.0240, -0.0185, -0.0237],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1989, 0.2312, 0.1921, 0.1897, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0572, -0.0380, -0.0518, -0.0503, -0.0394],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1925, 0.2177, 0.2003, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0631, 0.0571, 0.0604, 0.0611, 0.0643],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1863, 0.1897, 0.2001, 0.2225, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0007, -0.0121, -0.0095, -0.0065, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1713, 0.1874, 0.1940, 0.2006, 0.2466], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0231, 0.0266, 0.0210, 0.0112, 0.0161]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25754848 0.20621969 0.19005047 0.17746773 0.1687136 ]
np_weight_alpha[1] [0.20844057 0.22254816 0.19607627 0.19222595 0.18070906]
np_weight_alpha[2] [0.19352229 0.19319591 0.21845052 0.20011695 0.1947143 ]
np_weight_alpha[3] [0.1493096  0.20180511 0.1993142  0.20695162 0.24261947]
np_weight_alpha[4] [0.16850097 0.17948338 0.19070555 0.20702974 0.25428033]
-------------Round number:  206  -------------
client Accurancy:  0.39285714285714285
client Accurancy:  0.4365079365079365
client Accurancy:  0.4246031746031746
client Accurancy:  0.3888888888888889
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.37936507936507935
Average Global Trainning Accurancy:  0.4091836734693878
Average Global Trainning Loss:  1.5370725047831633
All users are selected
model: 0 tensor([0.2575, 0.2062, 0.1901, 0.1775, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0232, 0.0020, 0.0070, 0.0085, 0.0095],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2084, 0.2225, 0.1961, 0.1922, 0.1807], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0177, -0.0055, -0.0088, -0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1932, 0.2185, 0.2001, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0150, 0.0170, 0.0100, 0.0156, 0.0141],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1493, 0.2018, 0.1993, 0.2070, 0.2426], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0535, -0.0112, -0.0215, -0.0461,  0.0227],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1685, 0.1795, 0.1907, 0.2070, 0.2543], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0079, 0.0116, 0.0041, 0.0142, 0.0040]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24744222 0.21281742 0.19140244 0.17839445 0.16994348]
np_weight_alpha[1] [0.21447699 0.23018073 0.1897626  0.1892042  0.17637542]
np_weight_alpha[2] [0.19268486 0.19039631 0.22377957 0.19848922 0.19465008]
np_weight_alpha[3] [0.18109898 0.19057252 0.1981926  0.23281217 0.19732374]
np_weight_alpha[4] [0.16894805 0.16263178 0.20754607 0.17483869 0.28603536]
-------------Round number:  207  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.4801587301587302
client Accurancy:  0.42063492063492064
client Accurancy:  0.4007936507936508
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.4023809523809524
Average Global Trainning Accurancy:  0.42959183673469387
Average Global Trainning Loss:  1.4843128853103742
All users are selected
model: 0 tensor([0.2474, 0.2128, 0.1914, 0.1784, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0040,  0.0116, -0.0039, -0.0087, -0.0005],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2145, 0.2302, 0.1898, 0.1892, 0.1764], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0081, -0.0062, -0.0098, -0.0078, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1904, 0.2238, 0.1985, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0192, 0.0184, 0.0273, 0.0188, 0.0197],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1906, 0.1982, 0.2328, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0094, -0.0123,  0.0006, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1689, 0.1626, 0.2075, 0.1748, 0.2860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0523, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0045, -0.0289,  0.0090, -0.0303,  0.0392]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26707327 0.15242305 0.2016254  0.21275255 0.16612573]
np_weight_alpha[1] [0.1988915  0.23108415 0.19222    0.18975067 0.18805362]
np_weight_alpha[2] [0.19404177 0.19259222 0.21770154 0.20014183 0.1955226 ]
np_weight_alpha[3] [0.1860716  0.1897062  0.1999401  0.22281706 0.20146503]
np_weight_alpha[4] [0.17112634 0.18729098 0.19402331 0.20054196 0.24701743]
-------------Round number:  208  -------------
client Accurancy:  0.39285714285714285
client Accurancy:  0.4365079365079365
client Accurancy:  0.44841269841269843
client Accurancy:  0.42063492063492064
client Accurancy:  0.25793650793650796
Average Global Accurancy:  0.39126984126984127
Average Global Trainning Accurancy:  0.42448979591836733
Average Global Trainning Loss:  1.531765684789541
All users are selected
model: 0 tensor([0.2671, 0.1524, 0.2016, 0.2128, 0.1661], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0404, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0137, -0.0845, -0.0181,  0.0072, -0.0294],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1989, 0.2311, 0.1922, 0.1898, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0577, -0.0389, -0.0526, -0.0511, -0.0404],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1926, 0.2177, 0.2001, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0634, 0.0575, 0.0612, 0.0615, 0.0648],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1861, 0.1897, 0.1999, 0.2228, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0008, -0.0103, -0.0076, -0.0042, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1711, 0.1873, 0.1940, 0.2005, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0223, 0.0261, 0.0208, 0.0110, 0.0164]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.257766   0.20704041 0.18993947 0.17693771 0.16831638]
np_weight_alpha[1] [0.2081039  0.22249703 0.19624121 0.19238743 0.18077047]
np_weight_alpha[2] [0.19358635 0.19331941 0.218388   0.19995749 0.19474873]
np_weight_alpha[3] [0.15090281 0.20280306 0.19965173 0.20571676 0.24092565]
np_weight_alpha[4] [0.1688057  0.1795612  0.19071737 0.20685509 0.25406063]
-------------Round number:  209  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.44047619047619047
client Accurancy:  0.4246031746031746
client Accurancy:  0.3888888888888889
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.38095238095238093
Average Global Trainning Accurancy:  0.4139455782312925
Average Global Trainning Loss:  1.5298803212691328
All users are selected
model: 0 tensor([0.2578, 0.2070, 0.1899, 0.1769, 0.1683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0251, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0228, 0.0017, 0.0054, 0.0063, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2081, 0.2225, 0.1962, 0.1924, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0176, -0.0175, -0.0051, -0.0084, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1933, 0.2184, 0.2000, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0153, 0.0176, 0.0102, 0.0159, 0.0148],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1509, 0.2028, 0.1997, 0.2057, 0.2409], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0511, -0.0092, -0.0203, -0.0462,  0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1688, 0.1796, 0.1907, 0.2069, 0.2541], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0076, 0.0113, 0.0042, 0.0139, 0.0038]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.18622407 0.24522363 0.2050886  0.18784411 0.17561948]
np_weight_alpha[1] [0.21434827 0.23015842 0.18972507 0.18924855 0.17651963]
np_weight_alpha[2] [0.19284786 0.19035503 0.22390689 0.19848923 0.194401  ]
np_weight_alpha[3] [0.18119724 0.19051763 0.19821775 0.23259656 0.19747077]
np_weight_alpha[4] [0.1695177  0.16307716 0.20632571 0.17527929 0.28580013]
-------------Round number:  210  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.49206349206349204
client Accurancy:  0.4166666666666667
client Accurancy:  0.4007936507936508
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.396031746031746
Average Global Trainning Accurancy:  0.42210884353741496
Average Global Trainning Loss:  1.5024560214710885
All users are selected
model: 0 tensor([0.1862, 0.2452, 0.2051, 0.1878, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0677,  0.0458,  0.0114,  0.0030,  0.0084],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2143, 0.2302, 0.1897, 0.1892, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0077, -0.0065, -0.0099, -0.0079, -0.0189],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1904, 0.2239, 0.1985, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0190, 0.0182, 0.0270, 0.0184, 0.0188],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1812, 0.1905, 0.1982, 0.2326, 0.1975], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0099, -0.0127,  0.0001, -0.0152],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1695, 0.1631, 0.2063, 0.1753, 0.2858], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0515, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0040, -0.0286,  0.0074, -0.0302,  0.0392]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25925025 0.19737668 0.1918261  0.1835092  0.16803779]
np_weight_alpha[1] [0.19894324 0.23118597 0.19205418 0.18973756 0.18807898]
np_weight_alpha[2] [0.194015   0.19242364 0.21769725 0.2001531  0.19571105]
np_weight_alpha[3] [0.18596072 0.1896974  0.19994819 0.22270817 0.20168553]
np_weight_alpha[4] [0.17108768 0.18733355 0.19422042 0.20076822 0.24659011]
-------------Round number:  211  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.44841269841269843
client Accurancy:  0.44841269841269843
client Accurancy:  0.4166666666666667
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.3968253968253968
Average Global Trainning Accurancy:  0.42925170068027213
Average Global Trainning Loss:  1.519192442602041
All users are selected
model: 0 tensor([0.2593, 0.1974, 0.1918, 0.1835, 0.1680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0202, -0.0382, -0.0279, -0.0226, -0.0284],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1989, 0.2312, 0.1921, 0.1897, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0577, -0.0386, -0.0529, -0.0512, -0.0405],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1924, 0.2177, 0.2002, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0639, 0.0578, 0.0614, 0.0621, 0.0656],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1860, 0.1897, 0.1999, 0.2227, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0029, -0.0080, -0.0052, -0.0021, -0.0123],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1711, 0.1873, 0.1942, 0.2008, 0.2466], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0256, 0.0206, 0.0108, 0.0159]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25652674 0.20599198 0.19031602 0.17778344 0.16938183]
np_weight_alpha[1] [0.20814429 0.22230363 0.19631816 0.19237058 0.18086337]
np_weight_alpha[2] [0.19356045 0.19320329 0.21842268 0.1999423  0.1948713 ]
np_weight_alpha[3] [0.15157703 0.20279877 0.1991369  0.20650865 0.2399787 ]
np_weight_alpha[4] [0.16912466 0.17966974 0.19064136 0.20689861 0.25366563]
-------------Round number:  212  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.44841269841269843
client Accurancy:  0.42857142857142855
client Accurancy:  0.39285714285714285
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.38412698412698415
Average Global Trainning Accurancy:  0.4153061224489796
Average Global Trainning Loss:  1.524610205410289
All users are selected
model: 0 tensor([0.2565, 0.2060, 0.1903, 0.1778, 0.1694], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0210, 0.0002, 0.0054, 0.0070, 0.0082],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2081, 0.2223, 0.1963, 0.1924, 0.1809], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0185, -0.0186, -0.0059, -0.0093, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1932, 0.2184, 0.1999, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0148, 0.0172, 0.0100, 0.0156, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1516, 0.2028, 0.1991, 0.2065, 0.2400], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0486, -0.0075, -0.0191, -0.0439,  0.0224],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1691, 0.1797, 0.1906, 0.2069, 0.2537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0080, 0.0114, 0.0039, 0.0139, 0.0032]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19172949 0.25055048 0.20335062 0.18368167 0.17068772]
np_weight_alpha[1] [0.21434583 0.23024297 0.18968853 0.18924944 0.17647329]
np_weight_alpha[2] [0.19290896 0.19033341 0.2238259  0.19845419 0.19447754]
np_weight_alpha[3] [0.18107423 0.1904853  0.19818614 0.23277687 0.19747742]
np_weight_alpha[4] [0.16774176 0.16224721 0.20679572 0.17465399 0.28856134]
-------------Round number:  213  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.4880952380952381
client Accurancy:  0.42063492063492064
client Accurancy:  0.4007936507936508
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.3984126984126984
Average Global Trainning Accurancy:  0.42925170068027213
Average Global Trainning Loss:  1.4887016036883503
All users are selected
model: 0 tensor([0.1917, 0.2506, 0.2034, 0.1837, 0.1707], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0628,  0.0504,  0.0084, -0.0025,  0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2143, 0.2302, 0.1897, 0.1892, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0082, -0.0059, -0.0093, -0.0076, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1929, 0.1903, 0.2238, 0.1985, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0191, 0.0183, 0.0268, 0.0185, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1905, 0.1982, 0.2328, 0.1975], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0092, -0.0118,  0.0012, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1677, 0.1622, 0.2068, 0.1747, 0.2886], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0550, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0063, -0.0298,  0.0076, -0.0312,  0.0420]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25862694 0.1971078  0.19198328 0.1837548  0.16852719]
np_weight_alpha[1] [0.1463063  0.22554523 0.20034702 0.19148391 0.23631756]
np_weight_alpha[2] [0.19402517 0.19228661 0.21787995 0.20007168 0.19573663]
np_weight_alpha[3] [0.18594328 0.18982396 0.19987042 0.22262226 0.20174012]
np_weight_alpha[4] [0.17129187 0.1874902  0.19425316 0.20081936 0.24614547]
-------------Round number:  214  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.4087301587301587
client Accurancy:  0.44841269841269843
client Accurancy:  0.4166666666666667
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.3896825396825397
Average Global Trainning Accurancy:  0.4217687074829932
Average Global Trainning Loss:  1.5391653047937925
All users are selected
model: 0 tensor([0.2586, 0.1971, 0.1920, 0.1838, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0223, -0.0400, -0.0296, -0.0243, -0.0297],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1463, 0.2255, 0.2003, 0.1915, 0.2363], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1159, -0.0470, -0.0453, -0.0486,  0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1940, 0.1923, 0.2179, 0.2001, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0617, 0.0557, 0.0596, 0.0602, 0.0637],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1859, 0.1898, 0.1999, 0.2226, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0040, -0.0065, -0.0038, -0.0009, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1713, 0.1875, 0.1943, 0.2008, 0.2461], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0213, 0.0255, 0.0205, 0.0108, 0.0152]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25625807 0.20580713 0.19047782 0.1779873  0.16946964]
np_weight_alpha[1] [0.16230111 0.22516178 0.19816032 0.19019419 0.22418262]
np_weight_alpha[2] [0.1935961  0.19308713 0.21857823 0.19985105 0.19488749]
np_weight_alpha[3] [0.15262574 0.20237039 0.19899707 0.2073964  0.23861045]
np_weight_alpha[4] [0.16921772 0.17975701 0.19064668 0.20671104 0.25366756]
-------------Round number:  215  -------------
client Accurancy:  0.39285714285714285
client Accurancy:  0.43253968253968256
client Accurancy:  0.42857142857142855
client Accurancy:  0.39285714285714285
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.38015873015873014
Average Global Trainning Accurancy:  0.41122448979591836
Average Global Trainning Loss:  1.5401500053146258
All users are selected
model: 0 tensor([0.2563, 0.2058, 0.1905, 0.1780, 0.1695], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0191, -0.0012,  0.0039,  0.0056,  0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1623, 0.2252, 0.1982, 0.1902, 0.2242], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0631, -0.0132,  0.0007, -0.0065,  0.0448],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1931, 0.2186, 0.1999, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0136, 0.0161, 0.0087, 0.0143, 0.0133],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1526, 0.2024, 0.1990, 0.2074, 0.2386], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0477, -0.0084, -0.0194, -0.0429,  0.0209],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1692, 0.1798, 0.1906, 0.2067, 0.2537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0064, 0.0098, 0.0025, 0.0124, 0.0021]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19328685 0.24910533 0.20309849 0.18324721 0.17126209]
np_weight_alpha[1] [0.21754922 0.23211266 0.18911979 0.1883971  0.17282128]
np_weight_alpha[2] [0.1929676  0.19007821 0.22406428 0.19841811 0.1944719 ]
np_weight_alpha[3] [0.1810915  0.19078976 0.19816835 0.23247136 0.19747905]
np_weight_alpha[4] [0.16846964 0.16310678 0.20699537 0.17497721 0.28645095]
-------------Round number:  216  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.5
client Accurancy:  0.4246031746031746
client Accurancy:  0.40476190476190477
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.4
Average Global Trainning Accurancy:  0.4302721088435374
Average Global Trainning Loss:  1.4827972204506803
All users are selected
model: 0 tensor([0.1933, 0.2491, 0.2031, 0.1832, 0.1713], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0597,  0.0498,  0.0092, -0.0018,  0.0032],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2175, 0.2321, 0.1891, 0.1884, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0111, -0.0044, -0.0104, -0.0091, -0.0230],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1901, 0.2241, 0.1984, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0184, 0.0174, 0.0265, 0.0178, 0.0182],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1908, 0.1982, 0.2325, 0.1975], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0089, -0.0118,  0.0009, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1685, 0.1631, 0.2070, 0.1750, 0.2865], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0525, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0055, -0.0287,  0.0080, -0.0307,  0.0402]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2581063  0.19727546 0.1921025  0.1837463  0.16876946]
np_weight_alpha[1] [0.19870815 0.2309981  0.19192147 0.1899772  0.18839505]
np_weight_alpha[2] [0.19410136 0.1922567  0.21779738 0.2000592  0.19578533]
np_weight_alpha[3] [0.18587592 0.18982033 0.19985998 0.22264013 0.20180358]
np_weight_alpha[4] [0.17139587 0.18740334 0.19430529 0.20089795 0.24599752]
-------------Round number:  217  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.45634920634920634
client Accurancy:  0.44841269841269843
client Accurancy:  0.4246031746031746
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.4007936507936508
Average Global Trainning Accurancy:  0.4357142857142857
Average Global Trainning Loss:  1.5071793951955783
All users are selected
model: 0 tensor([0.2581, 0.1973, 0.1921, 0.1837, 0.1688], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0224, -0.0397, -0.0297, -0.0243, -0.0295],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1987, 0.2310, 0.1919, 0.1900, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0587, -0.0400, -0.0542, -0.0520, -0.0411],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1923, 0.2178, 0.2001, 0.1958], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0617, 0.0556, 0.0600, 0.0605, 0.0638],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1859, 0.1898, 0.1999, 0.2226, 0.2018], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0069, -0.0036, -0.0006,  0.0022, -0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1714, 0.1874, 0.1943, 0.2009, 0.2460], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0216, 0.0258, 0.0207, 0.0111, 0.0155]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25586897 0.20575863 0.19070804 0.1780601  0.16960426]
np_weight_alpha[1] [0.2078543  0.22244819 0.1964311  0.1924468  0.18081966]
np_weight_alpha[2] [0.19370197 0.19309792 0.21845178 0.19980703 0.19494127]
np_weight_alpha[3] [0.15311755 0.20291473 0.19815072 0.2069677  0.23884921]
np_weight_alpha[4] [0.16935204 0.1796551  0.1907257  0.20681888 0.25344834]
-------------Round number:  218  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.46825396825396826
client Accurancy:  0.4246031746031746
client Accurancy:  0.39285714285714285
client Accurancy:  0.25
Average Global Accurancy:  0.3865079365079365
Average Global Trainning Accurancy:  0.4207482993197279
Average Global Trainning Loss:  1.5123339179421769
All users are selected
model: 0 tensor([0.2559, 0.2058, 0.1907, 0.1781, 0.1696], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0196, -0.0005,  0.0052,  0.0066,  0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2079, 0.2224, 0.1964, 0.1924, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0196, -0.0193, -0.0068, -0.0109, -0.0081],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1931, 0.2185, 0.1998, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0151, 0.0173, 0.0102, 0.0155, 0.0146],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1531, 0.2029, 0.1982, 0.2070, 0.2388], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0448, -0.0057, -0.0179, -0.0409,  0.0235],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1797, 0.1907, 0.2068, 0.2534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0076, 0.0108, 0.0033, 0.0134, 0.0025]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19505912 0.25049686 0.2018164  0.18269327 0.16993436]
np_weight_alpha[1] [0.21411593 0.22991075 0.18964566 0.18977332 0.17655432]
np_weight_alpha[2] [0.19293042 0.19027394 0.22372821 0.1984732  0.19459425]
np_weight_alpha[3] [0.1810431  0.19095881 0.19823655 0.2323093  0.19745226]
np_weight_alpha[4] [0.16704164 0.16242714 0.20694385 0.17426324 0.2893242 ]
-------------Round number:  219  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.503968253968254
client Accurancy:  0.4246031746031746
client Accurancy:  0.4126984126984127
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.40476190476190477
Average Global Trainning Accurancy:  0.4336734693877551
Average Global Trainning Loss:  1.474602731717687
All users are selected
model: 0 tensor([0.1951, 0.2505, 0.2018, 0.1827, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0598,  0.0493,  0.0060, -0.0042,  0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2141, 0.2299, 0.1896, 0.1898, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0071, -0.0066, -0.0098, -0.0076, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1903, 0.2237, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0190, 0.0183, 0.0267, 0.0187, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1910, 0.1982, 0.2323, 0.1975], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0138, -0.0082, -0.0111,  0.0013, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1670, 0.1624, 0.2069, 0.1743, 0.2893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0559, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0062, -0.0289,  0.0084, -0.0311,  0.0440]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25815266 0.1973723  0.19214173 0.18372433 0.16860901]
np_weight_alpha[1] [0.19919856 0.23090735 0.19186275 0.1898717  0.18815969]
np_weight_alpha[2] [0.19411299 0.19222239 0.21789    0.1999243  0.19585024]
np_weight_alpha[3] [0.20364259 0.1858485  0.20721337 0.18022156 0.22307396]
np_weight_alpha[4] [0.1713078  0.18752895 0.1943789  0.20112789 0.2456564 ]
-------------Round number:  220  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.45634920634920634
client Accurancy:  0.4523809523809524
client Accurancy:  0.42063492063492064
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.4015873015873016
Average Global Trainning Accurancy:  0.43979591836734694
Average Global Trainning Loss:  1.50464249176233
All users are selected
model: 0 tensor([0.2582, 0.1974, 0.1921, 0.1837, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0244, -0.0414, -0.0319, -0.0265, -0.0319],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1992, 0.2309, 0.1919, 0.1899, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0585, -0.0406, -0.0551, -0.0527, -0.0421],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1922, 0.2179, 0.1999, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0619, 0.0557, 0.0607, 0.0607, 0.0643],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2036, 0.1858, 0.2072, 0.1802, 0.2231], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0281, -0.0052,  0.0089, -0.0387,  0.0159],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1875, 0.1944, 0.2011, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0211, 0.0255, 0.0206, 0.0109, 0.0150]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2557822  0.205512   0.19088598 0.17815445 0.1696654 ]
np_weight_alpha[1] [0.20755818 0.2224034  0.19667219 0.19242747 0.18093869]
np_weight_alpha[2] [0.19374757 0.19311857 0.21847251 0.19969815 0.19496317]
np_weight_alpha[3] [0.178117   0.19246955 0.19953436 0.22123544 0.20864366]
np_weight_alpha[4] [0.16939785 0.17973754 0.19060028 0.2069888  0.25327554]
-------------Round number:  221  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.46825396825396826
client Accurancy:  0.4246031746031746
client Accurancy:  0.4087301587301587
client Accurancy:  0.25
Average Global Accurancy:  0.3896825396825397
Average Global Trainning Accurancy:  0.42108843537414964
Average Global Trainning Loss:  1.5124302455357144
All users are selected
model: 0 tensor([0.2558, 0.2055, 0.1909, 0.1782, 0.1697], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0185, -0.0017,  0.0042,  0.0055,  0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2076, 0.2224, 0.1967, 0.1924, 0.1809], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0198, -0.0073, -0.0114, -0.0086],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1931, 0.2185, 0.1997, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0153, 0.0174, 0.0107, 0.0157, 0.0149],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1781, 0.1925, 0.1995, 0.2212, 0.2086], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0165, -0.0137, -0.0148, -0.0250, -0.0074],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1797, 0.1906, 0.2070, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0075, 0.0107, 0.0031, 0.0135, 0.0023]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.1947214  0.25127319 0.20130849 0.18284854 0.16984837]
np_weight_alpha[1] [0.21405455 0.22984055 0.18976516 0.18971772 0.17662206]
np_weight_alpha[2] [0.19298841 0.1904009  0.22354697 0.1984667  0.19459704]
np_weight_alpha[3] [0.1795458  0.19018419 0.19808775 0.23233643 0.19984587]
np_weight_alpha[4] [0.16701016 0.16244058 0.20742473 0.17345954 0.28966498]
-------------Round number:  222  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.5079365079365079
client Accurancy:  0.42063492063492064
client Accurancy:  0.42063492063492064
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4095238095238095
Average Global Trainning Accurancy:  0.4377551020408163
Average Global Trainning Loss:  1.468661810427296
All users are selected
model: 0 tensor([0.1947, 0.2513, 0.2013, 0.1828, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0605,  0.0495,  0.0049, -0.0044, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2141, 0.2298, 0.1898, 0.1897, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0077, -0.0061, -0.0088, -0.0069, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1930, 0.1904, 0.2235, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0187, 0.0183, 0.0262, 0.0185, 0.0185],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1795, 0.1902, 0.1981, 0.2323, 0.1998], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0155, -0.0091, -0.0112,  0.0013, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1670, 0.1624, 0.2074, 0.1735, 0.2897], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0565, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0287,  0.0089, -0.0320,  0.0446]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25801444 0.19745845 0.19227387 0.18363746 0.16861577]
np_weight_alpha[1] [0.14878061 0.22734015 0.19919166 0.18987279 0.23481484]
np_weight_alpha[2] [0.19421196 0.19209439 0.21792376 0.19979024 0.1959796 ]
np_weight_alpha[3] [0.21030758 0.18917757 0.20728382 0.18010427 0.21312681]
np_weight_alpha[4] [0.17131111 0.18740682 0.19449419 0.20137516 0.24541265]
-------------Round number:  223  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.4246031746031746
client Accurancy:  0.4523809523809524
client Accurancy:  0.3968253968253968
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.3904761904761905
Average Global Trainning Accurancy:  0.42857142857142855
Average Global Trainning Loss:  1.5284895501169218
All users are selected
model: 0 tensor([0.2580, 0.1975, 0.1923, 0.1836, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0261, -0.0429, -0.0334, -0.0284, -0.0333],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1488, 0.2273, 0.1992, 0.1899, 0.2348], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1138, -0.0464, -0.0480, -0.0513,  0.0083],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1921, 0.2179, 0.1998, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0602, 0.0539, 0.0588, 0.0589, 0.0628],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2103, 0.1892, 0.2073, 0.1801, 0.2131], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0372,  0.0006,  0.0111, -0.0371,  0.0070],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1874, 0.1945, 0.2014, 0.2454], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0205, 0.0246, 0.0200, 0.0103, 0.0139]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25571665 0.20541687 0.19092496 0.17836565 0.16957583]
np_weight_alpha[1] [0.16383207 0.22684744 0.19737214 0.18901454 0.22293389]
np_weight_alpha[2] [0.19383085 0.19301258 0.21853654 0.19957305 0.195047  ]
np_weight_alpha[3] [0.17765036 0.19194476 0.1993946  0.22145057 0.20955966]
np_weight_alpha[4] [0.16928716 0.17973855 0.19051501 0.2070522  0.25340703]
-------------Round number:  224  -------------
client Accurancy:  0.3968253968253968
client Accurancy:  0.44841269841269843
client Accurancy:  0.42857142857142855
client Accurancy:  0.4126984126984127
client Accurancy:  0.25
Average Global Accurancy:  0.3873015873015873
Average Global Trainning Accurancy:  0.41768707482993195
Average Global Trainning Loss:  1.5228638525722789
All users are selected
model: 0 tensor([0.2557, 0.2054, 0.1909, 0.1784, 0.1696], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0168, -0.0031,  0.0026,  0.0039,  0.0052],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1638, 0.2268, 0.1974, 0.1890, 0.2229], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0628, -0.0128, -0.0019, -0.0097,  0.0417],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1930, 0.2185, 0.1996, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0142, 0.0163, 0.0095, 0.0144, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1777, 0.1919, 0.1994, 0.2215, 0.2096], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0148, -0.0153, -0.0249, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1693, 0.1797, 0.1905, 0.2071, 0.2534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0062, 0.0092, 0.0016, 0.0125, 0.0009]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19561599 0.24977721 0.201556   0.18330468 0.16974612]
np_weight_alpha[1] [0.21714048 0.23168124 0.1893378  0.1887998  0.17304067]
np_weight_alpha[2] [0.1930489  0.19024153 0.22358371 0.19847894 0.19464691]
np_weight_alpha[3] [0.17987873 0.19038959 0.19811104 0.23208356 0.19953716]
np_weight_alpha[4] [0.16693603 0.16307066 0.208051   0.17228636 0.28965595]
-------------Round number:  225  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5119047619047619
client Accurancy:  0.42857142857142855
client Accurancy:  0.42857142857142855
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4142857142857143
Average Global Trainning Accurancy:  0.4425170068027211
Average Global Trainning Loss:  1.4610501036352042
All users are selected
model: 0 tensor([0.1956, 0.2498, 0.2016, 0.1833, 0.1697], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0600,  0.0477,  0.0048, -0.0042, -0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2171, 0.2317, 0.1893, 0.1888, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0113, -0.0040, -0.0091, -0.0078, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1902, 0.2236, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0185, 0.0180, 0.0259, 0.0184, 0.0184],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1799, 0.1904, 0.1981, 0.2321, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0146, -0.0085, -0.0106,  0.0016, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1669, 0.1631, 0.2081, 0.1723, 0.2897], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0566, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0063, -0.0282,  0.0094, -0.0336,  0.0444]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25805694 0.19748962 0.19231541 0.18360418 0.16853386]
np_weight_alpha[1] [0.19899811 0.23098013 0.19172008 0.1900208  0.18828085]
np_weight_alpha[2] [0.19426627 0.19205526 0.21805455 0.19968016 0.19594377]
np_weight_alpha[3] [0.20863938 0.18857038 0.20664354 0.180674   0.21547262]
np_weight_alpha[4] [0.17121331 0.1873686  0.19445226 0.20155926 0.24540663]
-------------Round number:  226  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.46825396825396826
client Accurancy:  0.4523809523809524
client Accurancy:  0.4087301587301587
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.4023809523809524
Average Global Trainning Accurancy:  0.4421768707482993
Average Global Trainning Loss:  1.4949104153380102
All users are selected
model: 0 tensor([0.2581, 0.1975, 0.1923, 0.1836, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0262, -0.0430, -0.0335, -0.0287, -0.0338],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1990, 0.2310, 0.1917, 0.1900, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0586, -0.0408, -0.0552, -0.0528, -0.0421],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1921, 0.2181, 0.1997, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0620, 0.0555, 0.0607, 0.0604, 0.0643],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2086, 0.1886, 0.2066, 0.1807, 0.2155], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0367,  0.0010,  0.0118, -0.0349,  0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1874, 0.1945, 0.2016, 0.2454], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0203, 0.0247, 0.0200, 0.0108, 0.0140]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25563517 0.20534277 0.19087288 0.1784027  0.16974646]
np_weight_alpha[1] [0.20738707 0.22254503 0.19660388 0.1925394  0.18092465]
np_weight_alpha[2] [0.1938563  0.19297352 0.21862876 0.19949874 0.19504267]
np_weight_alpha[3] [0.17786722 0.19234176 0.19950083 0.22123729 0.20905295]
np_weight_alpha[4] [0.16946205 0.17973624 0.19063644 0.20677774 0.25338754]
-------------Round number:  227  -------------
client Accurancy:  0.4007936507936508
client Accurancy:  0.47619047619047616
client Accurancy:  0.43253968253968256
client Accurancy:  0.4087301587301587
client Accurancy:  0.25
Average Global Accurancy:  0.39365079365079364
Average Global Trainning Accurancy:  0.42346938775510207
Average Global Trainning Loss:  1.4994678730867348
All users are selected
model: 0 tensor([0.2556, 0.2053, 0.1909, 0.1784, 0.1697], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0175, -0.0025,  0.0032,  0.0049,  0.0059],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2074, 0.2225, 0.1966, 0.1925, 0.1809], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0200, -0.0074, -0.0117, -0.0086],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1930, 0.2186, 0.1995, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0153, 0.0173, 0.0111, 0.0155, 0.0150],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1779, 0.1923, 0.1995, 0.2212, 0.2091], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0157, -0.0129, -0.0137, -0.0239, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1695, 0.1797, 0.1906, 0.2068, 0.2534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0073, 0.0106, 0.0029, 0.0135, 0.0017]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19527873 0.25070366 0.20226906 0.18198803 0.16976051]
np_weight_alpha[1] [0.21379746 0.2300339  0.18974552 0.18991946 0.17650364]
np_weight_alpha[2] [0.19317181 0.19039331 0.22329107 0.198533   0.1946108 ]
np_weight_alpha[3] [0.17960002 0.19041723 0.1981442  0.23244338 0.1993952 ]
np_weight_alpha[4] [0.16679    0.16170797 0.20710443 0.17234099 0.2920566 ]
-------------Round number:  228  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5119047619047619
client Accurancy:  0.4365079365079365
client Accurancy:  0.42857142857142855
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.41825396825396827
Average Global Trainning Accurancy:  0.4445578231292517
Average Global Trainning Loss:  1.4546240566539115
All users are selected
model: 0 tensor([0.1953, 0.2507, 0.2023, 0.1820, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0608,  0.0480,  0.0047, -0.0063, -0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2138, 0.2300, 0.1897, 0.1899, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0085, -0.0050, -0.0077, -0.0057, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1932, 0.1904, 0.2233, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0180, 0.0177, 0.0250, 0.0180, 0.0178],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1796, 0.1904, 0.1981, 0.2324, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0081, -0.0102,  0.0021, -0.0119],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1668, 0.1617, 0.2071, 0.1723, 0.2921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0593, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0066, -0.0296,  0.0085, -0.0335,  0.0473]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25784966 0.19740087 0.19241275 0.18367532 0.16866145]
np_weight_alpha[1] [0.14933713 0.22736181 0.19860071 0.1891371  0.23556332]
np_weight_alpha[2] [0.19433878 0.19196133 0.21815012 0.19958165 0.19596812]
np_weight_alpha[3] [0.20993148 0.18823068 0.20594391 0.17963202 0.21626188]
np_weight_alpha[4] [0.17140737 0.1875016  0.19450338 0.20159836 0.24498929]
-------------Round number:  229  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.42857142857142855
client Accurancy:  0.4523809523809524
client Accurancy:  0.4007936507936508
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.39206349206349206
Average Global Trainning Accurancy:  0.4326530612244898
Average Global Trainning Loss:  1.5157708200467688
All users are selected
model: 0 tensor([0.2578, 0.1974, 0.1924, 0.1837, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0283, -0.0450, -0.0357, -0.0309, -0.0357],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1493, 0.2274, 0.1986, 0.1891, 0.2356], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1133, -0.0467, -0.0490, -0.0525,  0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1920, 0.2182, 0.1996, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0609, 0.0543, 0.0599, 0.0596, 0.0634],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2099, 0.1882, 0.2059, 0.1796, 0.2163], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0388,  0.0018,  0.0122, -0.0352,  0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1875, 0.1945, 0.2016, 0.2450], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0201, 0.0243, 0.0196, 0.0103, 0.0131]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25543147 0.20521168 0.19107686 0.17857845 0.1697015 ]
np_weight_alpha[1] [0.16414402 0.22684348 0.19692491 0.18848255 0.22360505]
np_weight_alpha[2] [0.19395244 0.19292913 0.21868767 0.19937345 0.1950573 ]
np_weight_alpha[3] [0.17798248 0.19216041 0.19928382 0.22147651 0.20909679]
np_weight_alpha[4] [0.16939001 0.17978474 0.19062194 0.20682889 0.2533744 ]
-------------Round number:  230  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.4523809523809524
client Accurancy:  0.43253968253968256
client Accurancy:  0.4126984126984127
client Accurancy:  0.25
Average Global Accurancy:  0.39126984126984127
Average Global Trainning Accurancy:  0.4197278911564626
Average Global Trainning Loss:  1.511147925967262
All users are selected
model: 0 tensor([0.2554, 0.2052, 0.1911, 0.1786, 0.1697], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0157, -0.0042,  0.0015,  0.0029,  0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1641, 0.2268, 0.1969, 0.1885, 0.2236], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0628, -0.0134, -0.0029, -0.0109,  0.0420],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1929, 0.2187, 0.1994, 0.1951], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0146, 0.0166, 0.0103, 0.0146, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1780, 0.1922, 0.1993, 0.2215, 0.2091], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0167, -0.0139, -0.0147, -0.0240, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1798, 0.1906, 0.2068, 0.2534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0064, 0.0096, 0.0021, 0.0127, 0.0009]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.1953019  0.24985792 0.20189625 0.18312214 0.16982177]
np_weight_alpha[1] [0.21693014 0.2317974  0.1894071  0.18895197 0.17291342]
np_weight_alpha[2] [0.19324695 0.19029512 0.22334945 0.19852929 0.19457921]
np_weight_alpha[3] [0.17998888 0.19049485 0.19816214 0.23198423 0.1993699 ]
np_weight_alpha[4] [0.16694567 0.16233127 0.20706806 0.17209153 0.29156348]
-------------Round number:  231  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.503968253968254
client Accurancy:  0.44047619047619047
client Accurancy:  0.43253968253968256
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.41984126984126985
Average Global Trainning Accurancy:  0.4459183673469388
Average Global Trainning Loss:  1.447555770355017
All users are selected
model: 0 tensor([0.1953, 0.2499, 0.2019, 0.1831, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0600,  0.0480,  0.0053, -0.0041, -0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2169, 0.2318, 0.1894, 0.1890, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0126, -0.0024, -0.0075, -0.0062, -0.0205],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1932, 0.1903, 0.2233, 0.1985, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0176, 0.0169, 0.0244, 0.0175, 0.0169],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1800, 0.1905, 0.1982, 0.2320, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0088, -0.0108,  0.0007, -0.0125],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1669, 0.1623, 0.2071, 0.1721, 0.2916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0586, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0069, -0.0290,  0.0083, -0.0337,  0.0474]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25778204 0.19740735 0.19226833 0.18345405 0.16908829]
np_weight_alpha[1] [0.13814269 0.21671703 0.19901529 0.1923853  0.25373968]
np_weight_alpha[2] [0.1941785  0.1920014  0.21815462 0.19951726 0.19614822]
np_weight_alpha[3] [0.20713866 0.1882531  0.20563775 0.1828247  0.21614581]
np_weight_alpha[4] [0.1718256  0.18757989 0.1947053  0.20157637 0.24431282]
-------------Round number:  232  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.40476190476190477
client Accurancy:  0.45634920634920634
client Accurancy:  0.40476190476190477
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.39126984126984127
Average Global Trainning Accurancy:  0.427891156462585
Average Global Trainning Loss:  1.5204820697810375
All users are selected
model: 0 tensor([0.2578, 0.1974, 0.1923, 0.1835, 0.1691], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0296, -0.0462, -0.0373, -0.0326, -0.0367],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1381, 0.2167, 0.1990, 0.1924, 0.2537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0353, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1263, -0.0587, -0.0493, -0.0493,  0.0280],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1920, 0.2182, 0.1995, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0594, 0.0530, 0.0587, 0.0584, 0.0624],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2071, 0.1883, 0.2056, 0.1828, 0.2161], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0371,  0.0032,  0.0135, -0.0303,  0.0143],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1718, 0.1876, 0.1947, 0.2016, 0.2443], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0207, 0.0247, 0.0200, 0.0104, 0.0127]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25525486 0.205099   0.19117217 0.17871422 0.16975978]
np_weight_alpha[1] [0.1566992  0.2169369  0.19670263 0.19028953 0.23937176]
np_weight_alpha[2] [0.19384737 0.19297826 0.21868828 0.1992946  0.19519147]
np_weight_alpha[3] [0.178324   0.19225313 0.19914266 0.22118616 0.20909405]
np_weight_alpha[4] [0.16941307 0.17969865 0.19060089 0.20695399 0.25333342]
-------------Round number:  233  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.44841269841269843
client Accurancy:  0.44047619047619047
client Accurancy:  0.4126984126984127
client Accurancy:  0.25
Average Global Accurancy:  0.39365079365079364
Average Global Trainning Accurancy:  0.42244897959183675
Average Global Trainning Loss:  1.5133407073767007
All users are selected
model: 0 tensor([0.2553, 0.2051, 0.1912, 0.1787, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0151, -0.0047,  0.0007,  0.0023,  0.0028],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1567, 0.2169, 0.1967, 0.1903, 0.2394], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0687, -0.0215, -0.0009, -0.0067,  0.0610],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1930, 0.2187, 0.1993, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0136, 0.0159, 0.0099, 0.0137, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1783, 0.1923, 0.1991, 0.2212, 0.2091], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0160, -0.0136, -0.0145, -0.0239, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1797, 0.1906, 0.2070, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0046, 0.0079, 0.0009, 0.0120, 0.0003]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19448043 0.2482777  0.20217189 0.18277925 0.17229073]
np_weight_alpha[1] [0.21755575 0.23229514 0.1893921  0.18879133 0.17196564]
np_weight_alpha[2] [0.19336985 0.19039291 0.22304451 0.19865456 0.19453816]
np_weight_alpha[3] [0.17997591 0.19067633 0.19828859 0.23201635 0.19904277]
np_weight_alpha[4] [0.16981564 0.16453393 0.20734347 0.17047752 0.2878294 ]
-------------Round number:  234  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.503968253968254
client Accurancy:  0.44047619047619047
client Accurancy:  0.43253968253968256
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.41904761904761906
Average Global Trainning Accurancy:  0.445578231292517
Average Global Trainning Loss:  1.4484527795493198
All users are selected
model: 0 tensor([0.1945, 0.2483, 0.2022, 0.1828, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0617,  0.0453,  0.0045, -0.0052,  0.0007],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2176, 0.2323, 0.1894, 0.1888, 0.1720], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0138, -0.0011, -0.0069, -0.0059, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1934, 0.1904, 0.2230, 0.1987, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0164, 0.0235, 0.0173, 0.0163],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1800, 0.1907, 0.1983, 0.2320, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0086, -0.0103,  0.0008, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1698, 0.1645, 0.2073, 0.1705, 0.2878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0540, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0030, -0.0260,  0.0092, -0.0351,  0.0441]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2577688  0.19759007 0.19242321 0.18328996 0.16892798]
np_weight_alpha[1] [0.13632372 0.21308292 0.19911835 0.19342926 0.25804576]
np_weight_alpha[2] [0.19435117 0.1920626  0.21825765 0.1992058  0.19612283]
np_weight_alpha[3] [0.20636314 0.18803215 0.20349377 0.18264195 0.21946895]
np_weight_alpha[4] [0.17152022 0.18734492 0.19467428 0.20200524 0.24445534]
-------------Round number:  235  -------------
client Accurancy:  0.4246031746031746
client Accurancy:  0.3888888888888889
client Accurancy:  0.4523809523809524
client Accurancy:  0.4166666666666667
client Accurancy:  0.2777777777777778
Average Global Accurancy:  0.39206349206349206
Average Global Trainning Accurancy:  0.42857142857142855
Average Global Trainning Loss:  1.5158555218962586
All users are selected
model: 0 tensor([0.2578, 0.1976, 0.1924, 0.1833, 0.1689], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0303, -0.0468, -0.0381, -0.0338, -0.0379],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1363, 0.2131, 0.1991, 0.1934, 0.2580], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0382, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1276, -0.0618, -0.0484, -0.0475,  0.0331],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1944, 0.1921, 0.2183, 0.1992, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0587, 0.0523, 0.0580, 0.0572, 0.0615],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2064, 0.1880, 0.2035, 0.1826, 0.2195], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0370,  0.0037,  0.0122, -0.0295,  0.0187],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1873, 0.1947, 0.2020, 0.2445], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0201, 0.0241, 0.0199, 0.0108, 0.0131]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2549768  0.20499127 0.19128458 0.17882454 0.16992278]
np_weight_alpha[1] [0.15546772 0.21367015 0.1966187  0.19092728 0.24331614]
np_weight_alpha[2] [0.19399711 0.19300552 0.2187817  0.19904277 0.19517294]
np_weight_alpha[3] [0.17855    0.19238357 0.1991832  0.22107412 0.20880903]
np_weight_alpha[4] [0.1696013  0.17992882 0.19062603 0.20690018 0.2529436 ]
-------------Round number:  236  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.4523809523809524
client Accurancy:  0.4444444444444444
client Accurancy:  0.4166666666666667
client Accurancy:  0.24603174603174602
Average Global Accurancy:  0.3952380952380952
Average Global Trainning Accurancy:  0.42346938775510207
Average Global Trainning Loss:  1.5095414142219388
All users are selected
model: 0 tensor([0.2550, 0.2050, 0.1913, 0.1788, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0138, -0.0058, -0.0008,  0.0010,  0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1555, 0.2137, 0.1966, 0.1909, 0.2433], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0691, -0.0241, -0.0005, -0.0054,  0.0660],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1930, 0.2188, 0.1990, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0131, 0.0154, 0.0099, 0.0133, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1786, 0.1924, 0.1992, 0.2211, 0.2088], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0154, -0.0132, -0.0139, -0.0237, -0.0053],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1696, 0.1799, 0.1906, 0.2069, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0051, 0.0085, 0.0013, 0.0123, 0.0004]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19437347 0.24732815 0.20333113 0.18270846 0.17225878]
np_weight_alpha[1] [0.21750249 0.2323685  0.1895676  0.18882403 0.17173736]
np_weight_alpha[2] [0.19369121 0.19057535 0.22281384 0.1984666  0.19445296]
np_weight_alpha[3] [0.1800204  0.19077116 0.19809146 0.23204125 0.19907571]
np_weight_alpha[4] [0.16953422 0.16396794 0.20668058 0.17060682 0.28921044]
-------------Round number:  237  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5
client Accurancy:  0.44841269841269843
client Accurancy:  0.43253968253968256
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.41984126984126985
Average Global Trainning Accurancy:  0.44693877551020406
Average Global Trainning Loss:  1.443045645992772
All users are selected
model: 0 tensor([0.1944, 0.2473, 0.2033, 0.1827, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-6.2307e-02,  4.3436e-02,  5.0090e-03, -5.8874e-03,  1.2804e-05],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2175, 0.2324, 0.1896, 0.1888, 0.1717], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0145, -0.0003, -0.0056, -0.0050, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1937, 0.1906, 0.2228, 0.1985, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0164, 0.0229, 0.0168, 0.0157],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1800, 0.1908, 0.1981, 0.2320, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0091, -0.0110,  0.0003, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1695, 0.1640, 0.2067, 0.1706, 0.2892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0555, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0028, -0.0257,  0.0088, -0.0344,  0.0459]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25759685 0.19783905 0.19240549 0.1832725  0.16888613]
np_weight_alpha[1] [0.13727808 0.21397385 0.19766273 0.19375476 0.25733054]
np_weight_alpha[2] [0.19431834 0.19188148 0.21823846 0.19922842 0.19633329]
np_weight_alpha[3] [0.20612143 0.18803732 0.2043779  0.18257655 0.21888682]
np_weight_alpha[4] [0.1715148  0.18708777 0.19485126 0.20190495 0.24464118]
-------------Round number:  238  -------------
client Accurancy:  0.42857142857142855
client Accurancy:  0.39285714285714285
client Accurancy:  0.44841269841269843
client Accurancy:  0.42063492063492064
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.396031746031746
Average Global Trainning Accurancy:  0.4306122448979592
Average Global Trainning Loss:  1.509294284119898
All users are selected
model: 0 tensor([0.2576, 0.1978, 0.1924, 0.1833, 0.1689], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0310, -0.0470, -0.0388, -0.0344, -0.0384],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1373, 0.2140, 0.1977, 0.1938, 0.2573], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0373, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1260, -0.0602, -0.0497, -0.0467,  0.0328],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1919, 0.2182, 0.1992, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0564, 0.0498, 0.0560, 0.0553, 0.0597],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2061, 0.1880, 0.2044, 0.1826, 0.2189], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0387,  0.0057,  0.0152, -0.0276,  0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1871, 0.1949, 0.2019, 0.2446], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0205, 0.0241, 0.0205, 0.0110, 0.0134]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25502852 0.20488285 0.19136272 0.17886618 0.16985977]
np_weight_alpha[1] [0.15606874 0.21444373 0.19557562 0.191227   0.24268495]
np_weight_alpha[2] [0.19399247 0.19291303 0.2187403  0.1990435  0.19531077]
np_weight_alpha[3] [0.1785967  0.19238521 0.19907765 0.22109482 0.20884556]
np_weight_alpha[4] [0.1695281  0.17990682 0.19050117 0.20689282 0.25317112]
-------------Round number:  239  -------------
client Accurancy:  0.42063492063492064
client Accurancy:  0.4603174603174603
client Accurancy:  0.4444444444444444
client Accurancy:  0.4166666666666667
client Accurancy:  0.24603174603174602
Average Global Accurancy:  0.3976190476190476
Average Global Trainning Accurancy:  0.42517006802721086
Average Global Trainning Loss:  1.5030431215454931
All users are selected
model: 0 tensor([0.2550, 0.2049, 0.1914, 0.1789, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0138, -0.0061, -0.0009,  0.0008,  0.0012],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1561, 0.2144, 0.1956, 0.1912, 0.2427], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0690, -0.0240, -0.0022, -0.0057,  0.0646],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1929, 0.2187, 0.1990, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0132, 0.0155, 0.0101, 0.0134, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1786, 0.1924, 0.1991, 0.2211, 0.2088], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0149, -0.0126, -0.0135, -0.0230, -0.0045],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1695, 0.1799, 0.1905, 0.2069, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0050, 0.0085, 0.0013, 0.0125, 0.0007]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19319591 0.247471   0.20337658 0.18301964 0.17293681]
np_weight_alpha[1] [0.21734881 0.23243472 0.18958627 0.18882915 0.1718011 ]
np_weight_alpha[2] [0.19377026 0.19056675 0.22268093 0.19853981 0.19444229]
np_weight_alpha[3] [0.18011263 0.1907542  0.19816937 0.23201582 0.19894794]
np_weight_alpha[4] [0.17029577 0.1641135  0.20728089 0.1701646  0.28814524]
-------------Round number:  240  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.5
client Accurancy:  0.44841269841269843
client Accurancy:  0.43253968253968256
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.41984126984126985
Average Global Trainning Accurancy:  0.44829931972789117
Average Global Trainning Loss:  1.4391133211096938
All users are selected
model: 0 tensor([0.1932, 0.2475, 0.2034, 0.1830, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-6.4446e-02,  4.2871e-02,  4.2544e-03, -6.2048e-03,  3.1286e-05],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2173, 0.2324, 0.1896, 0.1888, 0.1718], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0153,  0.0007, -0.0048, -0.0042, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1938, 0.1906, 0.2227, 0.1985, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0168, 0.0161, 0.0224, 0.0167, 0.0154],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1801, 0.1908, 0.1982, 0.2320, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0091, -0.0107,  0.0003, -0.0138],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1703, 0.1641, 0.2073, 0.1702, 0.2881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0544, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019, -0.0256,  0.0095, -0.0350,  0.0449]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2578457  0.19777977 0.19243596 0.18314438 0.16879416]
np_weight_alpha[1] [0.13756235 0.21359019 0.19765082 0.19397736 0.25721928]
np_weight_alpha[2] [0.1943652  0.19188616 0.21833445 0.19906247 0.19635178]
np_weight_alpha[3] [0.2051973  0.18826152 0.20321108 0.18281993 0.22051018]
np_weight_alpha[4] [0.1714334  0.18710248 0.1948581  0.20211484 0.24449119]
-------------Round number:  241  -------------
client Accurancy:  0.42857142857142855
client Accurancy:  0.3968253968253968
client Accurancy:  0.44841269841269843
client Accurancy:  0.42063492063492064
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.3976190476190476
Average Global Trainning Accurancy:  0.4326530612244898
Average Global Trainning Loss:  1.504167330994898
All users are selected
model: 0 tensor([0.2578, 0.1978, 0.1924, 0.1831, 0.1688], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0320, -0.0485, -0.0401, -0.0362, -0.0400],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1376, 0.2136, 0.1977, 0.1940, 0.2572], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0370, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1253, -0.0603, -0.0494, -0.0463,  0.0332],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1944, 0.1919, 0.2183, 0.1991, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0553, 0.0485, 0.0548, 0.0540, 0.0585],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2052, 0.1883, 0.2032, 0.1828, 0.2205], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0390,  0.0074,  0.0157, -0.0255,  0.0235],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1871, 0.1949, 0.2021, 0.2445], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0210, 0.0250, 0.0211, 0.0119, 0.0139]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25476602 0.20490417 0.19134563 0.17906114 0.16992301]
np_weight_alpha[1] [0.15625997 0.21414177 0.19559617 0.19143511 0.24256699]
np_weight_alpha[2] [0.19401908 0.19292516 0.21883328 0.19889069 0.19533178]
np_weight_alpha[3] [0.17888875 0.1925153  0.19901279 0.22085492 0.20872822]
np_weight_alpha[4] [0.16955642 0.17977114 0.19053037 0.20689216 0.2532499 ]
-------------Round number:  242  -------------
client Accurancy:  0.42857142857142855
client Accurancy:  0.4603174603174603
client Accurancy:  0.44841269841269843
client Accurancy:  0.4166666666666667
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.4015873015873016
Average Global Trainning Accurancy:  0.42551020408163265
Average Global Trainning Loss:  1.498372727997449
All users are selected
model: 0 tensor([0.2548, 0.2049, 0.1913, 0.1791, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0135, -0.0063, -0.0014,  0.0004,  0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1563, 0.2141, 0.1956, 0.1914, 0.2426], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0691, -0.0247, -0.0027, -0.0061,  0.0641],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1929, 0.2188, 0.1989, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0128, 0.0150, 0.0100, 0.0129, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1789, 0.1925, 0.1990, 0.2209, 0.2087], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0121, -0.0131, -0.0227, -0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1696, 0.1798, 0.1905, 0.2069, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0055, 0.0091, 0.0020, 0.0133, 0.0012]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19302976 0.24666479 0.20392755 0.18318042 0.17319745]
np_weight_alpha[1] [0.21718657 0.23234938 0.18968984 0.18900129 0.1717729 ]
np_weight_alpha[2] [0.19386041 0.19066319 0.22252524 0.198543   0.19440818]
np_weight_alpha[3] [0.18028192 0.1908983  0.19817592 0.23190437 0.19873951]
np_weight_alpha[4] [0.17059699 0.16434745 0.2069002  0.16917796 0.28897744]
-------------Round number:  243  -------------
client Accurancy:  0.4007936507936508
client Accurancy:  0.5079365079365079
client Accurancy:  0.44841269841269843
client Accurancy:  0.43253968253968256
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.41984126984126985
Average Global Trainning Accurancy:  0.45170068027210886
Average Global Trainning Loss:  1.4341119260204083
All users are selected
model: 0 tensor([0.1930, 0.2467, 0.2039, 0.1832, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0668,  0.0399,  0.0031, -0.0078, -0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2172, 0.2323, 0.1897, 0.1890, 0.1718], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0156,  0.0015, -0.0040, -0.0034, -0.0182],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1907, 0.2225, 0.1985, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0162, 0.0220, 0.0167, 0.0154],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1803, 0.1909, 0.1982, 0.2319, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.4577e-02, -9.2003e-03, -1.0918e-02,  9.1903e-05, -1.4199e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1706, 0.1643, 0.2069, 0.1692, 0.2890], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0553, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0002, -0.0240,  0.0104, -0.0347,  0.0469]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2581537  0.19800173 0.1921952  0.18301417 0.16863522]
np_weight_alpha[1] [0.13875145 0.21290179 0.19724962 0.19373932 0.2573579 ]
np_weight_alpha[2] [0.19415776 0.19185492 0.2185637  0.1991345  0.19628917]
np_weight_alpha[3] [0.2039428  0.18801321 0.20353413 0.18295428 0.22155558]
np_weight_alpha[4] [0.1713159  0.18706048 0.19479504 0.20213675 0.24469185]
-------------Round number:  244  -------------
client Accurancy:  0.42857142857142855
client Accurancy:  0.40476190476190477
client Accurancy:  0.44841269841269843
client Accurancy:  0.4166666666666667
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.3984126984126984
Average Global Trainning Accurancy:  0.4346938775510204
Average Global Trainning Loss:  1.4965121107036565
All users are selected
model: 0 tensor([0.2582, 0.1980, 0.1922, 0.1830, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0336, -0.0504, -0.0424, -0.0384, -0.0421],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1388, 0.2129, 0.1972, 0.1937, 0.2574], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0363, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1236, -0.0604, -0.0494, -0.0459,  0.0341],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1919, 0.2186, 0.1991, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0546, 0.0479, 0.0544, 0.0537, 0.0581],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2039, 0.1880, 0.2035, 0.1830, 0.2216], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0392,  0.0087,  0.0177, -0.0237,  0.0261],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1871, 0.1948, 0.2021, 0.2447], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0214, 0.0254, 0.0215, 0.0121, 0.0140]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2547093  0.20497906 0.19136633 0.17914183 0.1698035 ]
np_weight_alpha[1] [0.15704504 0.21358964 0.19535325 0.19129269 0.24271941]
np_weight_alpha[2] [0.1938599  0.19291963 0.21905965 0.19891793 0.19524291]
np_weight_alpha[3] [0.17907235 0.19253317 0.19889307 0.2207507  0.20875071]
np_weight_alpha[4] [0.16939485 0.17964457 0.19034827 0.20698218 0.25363016]
-------------Round number:  245  -------------
client Accurancy:  0.43253968253968256
client Accurancy:  0.4603174603174603
client Accurancy:  0.4523809523809524
client Accurancy:  0.42063492063492064
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.403968253968254
Average Global Trainning Accurancy:  0.4272108843537415
Average Global Trainning Loss:  1.4917370854591836
All users are selected
model: 0 tensor([0.2547, 0.2050, 0.1914, 0.1791, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0124, -0.0070, -0.0022, -0.0006,  0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1570, 0.2136, 0.1954, 0.1913, 0.2427], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0690, -0.0259, -0.0039, -0.0072,  0.0637],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1929, 0.2191, 0.1989, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0130, 0.0152, 0.0105, 0.0135, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1791, 0.1925, 0.1989, 0.2208, 0.2088], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0135, -0.0113, -0.0121, -0.0217, -0.0030],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1796, 0.1903, 0.2070, 0.2536], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0060, 0.0093, 0.0021, 0.0137, 0.0013]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19403881 0.24569951 0.20391403 0.1842561  0.17209154]
np_weight_alpha[1] [0.21707694 0.23222981 0.18986449 0.18916401 0.17166471]
np_weight_alpha[2] [0.1938804  0.1908273  0.22261609 0.1982981  0.19437812]
np_weight_alpha[3] [0.18057261 0.19103536 0.19795209 0.23171568 0.19872425]
np_weight_alpha[4] [0.16952258 0.16434358 0.20742871 0.16871122 0.28999394]
-------------Round number:  246  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5079365079365079
client Accurancy:  0.44047619047619047
client Accurancy:  0.4365079365079365
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.42142857142857143
Average Global Trainning Accurancy:  0.454421768707483
Average Global Trainning Loss:  1.4267480136585884
All users are selected
model: 0 tensor([0.1940, 0.2457, 0.2039, 0.1843, 0.1721], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0668,  0.0379,  0.0020, -0.0079, -0.0038],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2171, 0.2322, 0.1899, 0.1892, 0.1717], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0167,  0.0026, -0.0025, -0.0021, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1908, 0.2226, 0.1983, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0169, 0.0163, 0.0218, 0.0162, 0.0150],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1806, 0.1910, 0.1980, 0.2317, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0091, -0.0111, -0.0001, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1695, 0.1643, 0.2074, 0.1687, 0.2900], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0567, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0014, -0.0241,  0.0109, -0.0350,  0.0484]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2580469  0.19794257 0.1921561  0.18306302 0.16879134]
np_weight_alpha[1] [0.13870278 0.21334302 0.1959335  0.19328572 0.25873503]
np_weight_alpha[2] [0.19409782 0.19173744 0.21862674 0.1990918  0.19644625]
np_weight_alpha[3] [0.20295538 0.18774892 0.20423548 0.18363132 0.22142892]
np_weight_alpha[4] [0.1715102  0.18723777 0.19494341 0.20210683 0.2442018 ]
-------------Round number:  247  -------------
client Accurancy:  0.43253968253968256
client Accurancy:  0.4087301587301587
client Accurancy:  0.4523809523809524
client Accurancy:  0.42063492063492064
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.4015873015873016
Average Global Trainning Accurancy:  0.43639455782312925
Average Global Trainning Loss:  1.4916643415178572
All users are selected
model: 0 tensor([0.2580, 0.1979, 0.1922, 0.1831, 0.1688], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0344, -0.0513, -0.0433, -0.0393, -0.0432],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1387, 0.2133, 0.1959, 0.1933, 0.2587], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0372, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1234, -0.0596, -0.0506, -0.0462,  0.0354],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1941, 0.1917, 0.2186, 0.1991, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0533, 0.0465, 0.0531, 0.0523, 0.0568],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.2030, 0.1877, 0.2042, 0.1836, 0.2214], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0391,  0.0095,  0.0196, -0.0221,  0.0272],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1872, 0.1949, 0.2021, 0.2442], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0262, 0.0225, 0.0131, 0.0150]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2544131  0.20494854 0.19127227 0.17920287 0.17016321]
np_weight_alpha[1] [0.15694909 0.2138674  0.19426607 0.19088371 0.24403371]
np_weight_alpha[2] [0.19378738 0.19282667 0.2191205  0.19887899 0.19538644]
np_weight_alpha[3] [0.17917885 0.19253623 0.19885688 0.22088008 0.20854798]
np_weight_alpha[4] [0.16977468 0.17986597 0.19050066 0.2068726  0.2529861 ]
-------------Round number:  248  -------------
client Accurancy:  0.4365079365079365
client Accurancy:  0.45634920634920634
client Accurancy:  0.4523809523809524
client Accurancy:  0.42063492063492064
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.403968253968254
Average Global Trainning Accurancy:  0.42891156462585034
Average Global Trainning Loss:  1.4888166985544218
All users are selected
model: 0 tensor([0.2544, 0.2049, 0.1913, 0.1792, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0114, -0.0075, -0.0030, -0.0014, -0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1569, 0.2139, 0.1943, 0.1909, 0.2440], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0688, -0.0256, -0.0046, -0.0077,  0.0648],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1928, 0.2191, 0.1989, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0134, 0.0159, 0.0109, 0.0138, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1792, 0.1925, 0.1989, 0.2209, 0.2085], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0133, -0.0112, -0.0120, -0.0209, -0.0030],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1698, 0.1799, 0.1905, 0.2069, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0061, 0.0091, 0.0021, 0.0134, 0.0009]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19522917 0.24484143 0.20422368 0.18442564 0.17128012]
np_weight_alpha[1] [0.21689308 0.23231088 0.189628   0.18930696 0.17186101]
np_weight_alpha[2] [0.19385698 0.19055301 0.2228075  0.19845018 0.19433229]
np_weight_alpha[3] [0.18066876 0.1911659  0.1981248  0.23125203 0.19878852]
np_weight_alpha[4] [0.16857474 0.16451798 0.20653652 0.16921759 0.29115322]
-------------Round number:  249  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.5079365079365079
client Accurancy:  0.4444444444444444
client Accurancy:  0.4365079365079365
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.423015873015873
Average Global Trainning Accurancy:  0.454421768707483
Average Global Trainning Loss:  1.4233096168154762
All users are selected
model: 0 tensor([0.1952, 0.2448, 0.2042, 0.1844, 0.1713], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0668,  0.0358,  0.0012, -0.0091, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2169, 0.2323, 0.1896, 0.1893, 0.1719], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0170,  0.0030, -0.0023, -0.0015, -0.0166],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1906, 0.2228, 0.1985, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0178, 0.0168, 0.0227, 0.0172, 0.0157],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1807, 0.1912, 0.1981, 0.2313, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0149, -0.0096, -0.0115, -0.0013, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1686, 0.1645, 0.2065, 0.1692, 0.2912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0577, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019, -0.0234,  0.0105, -0.0339,  0.0504]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25797352 0.19791204 0.19205642 0.18312879 0.16892923]
np_weight_alpha[1] [0.13915013 0.2133556  0.19699809 0.19260818 0.25788796]
np_weight_alpha[2] [0.19400148 0.19175026 0.21870315 0.19903925 0.19650581]
np_weight_alpha[3] [0.18532771 0.19018601 0.19883342 0.22293825 0.20271453]
np_weight_alpha[4] [0.17167781 0.18728949 0.19502896 0.20205827 0.24394542]
-------------Round number:  250  -------------
client Accurancy:  0.43253968253968256
client Accurancy:  0.4087301587301587
client Accurancy:  0.45634920634920634
client Accurancy:  0.4365079365079365
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.40714285714285714
Average Global Trainning Accurancy:  0.44013605442176873
Average Global Trainning Loss:  1.4810420652636054
All users are selected
model: 0 tensor([0.2580, 0.1979, 0.1921, 0.1831, 0.1689], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0356, -0.0524, -0.0445, -0.0402, -0.0443],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1392, 0.2134, 0.1970, 0.1926, 0.2579], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0365, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1227, -0.0594, -0.0492, -0.0468,  0.0347],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1940, 0.1918, 0.2187, 0.1990, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0519, 0.0453, 0.0518, 0.0511, 0.0555],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1853, 0.1902, 0.1988, 0.2229, 0.2027], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0211, 0.0125, 0.0150, 0.0184, 0.0093],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1717, 0.1873, 0.1950, 0.2021, 0.2439], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0229, 0.0272, 0.0233, 0.0141, 0.0155]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25437132 0.20497903 0.19132759 0.17905155 0.17027058]
np_weight_alpha[1] [0.1572567  0.21392232 0.19512059 0.1904257  0.2432747 ]
np_weight_alpha[2] [0.19372323 0.19282347 0.21919326 0.19881766 0.19544238]
np_weight_alpha[3] [0.18006723 0.19261132 0.19866155 0.2202638  0.20839608]
np_weight_alpha[4] [0.16987997 0.17983852 0.19055818 0.20669262 0.25303075]
-------------Round number:  251  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.4642857142857143
client Accurancy:  0.4523809523809524
client Accurancy:  0.42063492063492064
client Accurancy:  0.25396825396825395
Average Global Accurancy:  0.40634920634920635
Average Global Trainning Accurancy:  0.43231292517006803
Average Global Trainning Loss:  1.4833173894557823
All users are selected
model: 0 tensor([0.2544, 0.2050, 0.1913, 0.1791, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0109, -0.0077, -0.0037, -0.0020, -0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1573, 0.2139, 0.1951, 0.1904, 0.2433], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0678, -0.0250, -0.0038, -0.0081,  0.0641],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1928, 0.2192, 0.1988, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0129, 0.0154, 0.0109, 0.0136, 0.0147],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1801, 0.1926, 0.1987, 0.2203, 0.2084], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0116, -0.0107, -0.0116, -0.0210, -0.0025],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1699, 0.1798, 0.1906, 0.2067, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0058, 0.0089, 0.0024, 0.0131, 0.0009]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19529736 0.24287224 0.20497558 0.18461552 0.17223926]
np_weight_alpha[1] [0.21648097 0.23197445 0.18993238 0.18954602 0.17206615]
np_weight_alpha[2] [0.19404972 0.19083352 0.2226802  0.19842    0.19401655]
np_weight_alpha[3] [0.1805094  0.19132155 0.19810376 0.23129049 0.19877487]
np_weight_alpha[4] [0.16954309 0.16516052 0.20484805 0.16972002 0.29072827]
-------------Round number:  252  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5079365079365079
client Accurancy:  0.44841269841269843
client Accurancy:  0.43253968253968256
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.423015873015873
Average Global Trainning Accurancy:  0.4554421768707483
Average Global Trainning Loss:  1.419875704187925
All users are selected
model: 0 tensor([0.1953, 0.2429, 0.2050, 0.1846, 0.1722], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0673,  0.0329,  0.0014, -0.0096, -0.0057],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2165, 0.2320, 0.1899, 0.1895, 0.1721], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0172,  0.0036, -0.0011, -0.0006, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1940, 0.1908, 0.2227, 0.1984, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0176, 0.0167, 0.0219, 0.0168, 0.0149],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1805, 0.1913, 0.1981, 0.2313, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0157, -0.0101, -0.0120, -0.0017, -0.0153],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1695, 0.1652, 0.2048, 0.1697, 0.2907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0566, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-3.3949e-05, -2.1765e-02,  9.6526e-03, -3.2554e-02,  5.0691e-02]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25784865 0.19819064 0.19194053 0.18314551 0.16887468]
np_weight_alpha[1] [0.14123987 0.21446314 0.19559433 0.19241728 0.25628534]
np_weight_alpha[2] [0.19388156 0.19164999 0.21901801 0.19891705 0.1965334 ]
np_weight_alpha[3] [0.1853794  0.1903056  0.19871217 0.2228648  0.20273802]
np_weight_alpha[4] [0.17160831 0.18715893 0.19505991 0.20208737 0.24408546]
-------------Round number:  253  -------------
client Accurancy:  0.43253968253968256
client Accurancy:  0.4166666666666667
client Accurancy:  0.45634920634920634
client Accurancy:  0.42857142857142855
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.40714285714285714
Average Global Trainning Accurancy:  0.44285714285714284
Average Global Trainning Loss:  1.4747213143069728
All users are selected
model: 0 tensor([0.2578, 0.1982, 0.1919, 0.1831, 0.1689], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0364, -0.0528, -0.0454, -0.0410, -0.0447],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1412, 0.2145, 0.1956, 0.1924, 0.2563], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0345, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1199, -0.0578, -0.0502, -0.0466,  0.0336],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1939, 0.1916, 0.2190, 0.1989, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0498, 0.0433, 0.0504, 0.0493, 0.0537],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1903, 0.1987, 0.2229, 0.2027], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0220, 0.0136, 0.0160, 0.0195, 0.0104],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1716, 0.1872, 0.1951, 0.2021, 0.2441], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0243, 0.0283, 0.0244, 0.0153, 0.0164]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25441447 0.20491308 0.1914515  0.17921306 0.17000787]
np_weight_alpha[1] [0.15862343 0.21497658 0.19414546 0.19040456 0.2418499 ]
np_weight_alpha[2] [0.19330467 0.19746588 0.21843663 0.19873391 0.19205889]
np_weight_alpha[3] [0.1802468  0.19266559 0.19855508 0.22014494 0.20838758]
np_weight_alpha[4] [0.1695889 0.1797256 0.1905722 0.2066522 0.2534611]
-------------Round number:  254  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.46825396825396826
client Accurancy:  0.4523809523809524
client Accurancy:  0.4166666666666667
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.40793650793650793
Average Global Trainning Accurancy:  0.4316326530612245
Average Global Trainning Loss:  1.4769735530931123
All users are selected
model: 0 tensor([0.2544, 0.2049, 0.1915, 0.1792, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0110, -0.0077, -0.0039, -0.0020, -0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1586, 0.2150, 0.1941, 0.1904, 0.2418], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0658, -0.0234, -0.0048, -0.0079,  0.0626],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1975, 0.2184, 0.1987, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0121, 0.0197, 0.0099, 0.0131, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1927, 0.1986, 0.2201, 0.2084], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0103, -0.0113, -0.0207, -0.0022],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1696, 0.1797, 0.1906, 0.2067, 0.2535], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0052, 0.0085, 0.0024, 0.0130, 0.0017]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19399    0.2417079  0.20536885 0.1843536  0.17457956]
np_weight_alpha[1] [0.2160389  0.23167706 0.19019784 0.18965493 0.17243126]
np_weight_alpha[2] [0.19406474 0.19082132 0.22247007 0.1984069  0.19423692]
np_weight_alpha[3] [0.18054637 0.19135283 0.19805962 0.23121011 0.19883104]
np_weight_alpha[4] [0.17235537 0.16679643 0.20489863 0.17041098 0.28553858]
-------------Round number:  255  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.5079365079365079
client Accurancy:  0.44841269841269843
client Accurancy:  0.43253968253968256
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.42063492063492064
Average Global Trainning Accurancy:  0.4527210884353742
Average Global Trainning Loss:  1.4223629490858845
All users are selected
model: 0 tensor([0.1940, 0.2417, 0.2054, 0.1844, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0694,  0.0311,  0.0011, -0.0104, -0.0037],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2160, 0.2317, 0.1902, 0.1897, 0.1724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0171,  0.0034, -0.0004, -0.0002, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1908, 0.2225, 0.1984, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0166, 0.0159, 0.0207, 0.0160, 0.0141],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1805, 0.1914, 0.1981, 0.2312, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0163, -0.0109, -0.0127, -0.0025, -0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1724, 0.1668, 0.2049, 0.1704, 0.2855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0504, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0050, -0.0181,  0.0114, -0.0302,  0.0469]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25808716 0.19819628 0.19200923 0.18307303 0.16863434]
np_weight_alpha[1] [0.1426335  0.21708481 0.19411632 0.19254965 0.2536158 ]
np_weight_alpha[2] [0.19398369 0.19153728 0.21903464 0.19885762 0.19658679]
np_weight_alpha[3] [0.18536301 0.19039355 0.19865803 0.22277938 0.20280598]
np_weight_alpha[4] [0.17122309 0.18690309 0.1950977  0.20218597 0.2445902 ]
-------------Round number:  256  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.4246031746031746
client Accurancy:  0.44841269841269843
client Accurancy:  0.42857142857142855
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.40793650793650793
Average Global Trainning Accurancy:  0.4445578231292517
Average Global Trainning Loss:  1.4667722948554422
All users are selected
model: 0 tensor([0.2581, 0.1982, 0.1920, 0.1831, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0368, -0.0534, -0.0464, -0.0420, -0.0461],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1426, 0.2171, 0.1941, 0.1925, 0.2536], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0327, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1174, -0.0545, -0.0512, -0.0460,  0.0313],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1940, 0.1915, 0.2190, 0.1989, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0482, 0.0416, 0.0492, 0.0479, 0.0523],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1904, 0.1987, 0.2228, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0236, 0.0153, 0.0177, 0.0210, 0.0121],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1869, 0.1951, 0.2022, 0.2446], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0241, 0.0284, 0.0248, 0.0158, 0.0174]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2541081  0.20469362 0.19168293 0.17930146 0.17021388]
np_weight_alpha[1] [0.15950578 0.21734257 0.19311275 0.19061184 0.23942704]
np_weight_alpha[2] [0.1935259  0.19758    0.21825302 0.19858095 0.19206016]
np_weight_alpha[3] [0.18030167 0.1927071  0.19840117 0.22021991 0.20837018]
np_weight_alpha[4] [0.16979975 0.17968711 0.19059065 0.20663306 0.2532894 ]
-------------Round number:  257  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.4722222222222222
client Accurancy:  0.4523809523809524
client Accurancy:  0.4126984126984127
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.4095238095238095
Average Global Trainning Accurancy:  0.43333333333333335
Average Global Trainning Loss:  1.4704011878188776
All users are selected
model: 0 tensor([0.2541, 0.2047, 0.1917, 0.1793, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0119, -0.0069, -0.0027, -0.0010, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1595, 0.2173, 0.1931, 0.1906, 0.2394], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0657, -0.0218, -0.0067, -0.0088,  0.0591],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1976, 0.2183, 0.1986, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0127, 0.0203, 0.0101, 0.0135, 0.0112],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1803, 0.1927, 0.1984, 0.2202, 0.2084], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0109, -0.0102, -0.0112, -0.0203, -0.0020],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1698, 0.1797, 0.1906, 0.2066, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0049, 0.0080, 0.0020, 0.0125, 0.0007]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19437304 0.24291185 0.2049563  0.18439053 0.17336829]
np_weight_alpha[1] [0.21590288 0.23156814 0.19016418 0.18980841 0.17255639]
np_weight_alpha[2] [0.19417459 0.19072148 0.22261527 0.19833903 0.19414963]
np_weight_alpha[3] [0.18064894 0.19146329 0.19799824 0.23110032 0.19878922]
np_weight_alpha[4] [0.17099538 0.16636746 0.20411642 0.17012708 0.28839362]
-------------Round number:  258  -------------
client Accurancy:  0.4087301587301587
client Accurancy:  0.5079365079365079
client Accurancy:  0.45634920634920634
client Accurancy:  0.4365079365079365
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4238095238095238
Average Global Trainning Accurancy:  0.4554421768707483
Average Global Trainning Loss:  1.4146021006058673
All users are selected
model: 0 tensor([0.1944, 0.2429, 0.2050, 0.1844, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0263, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0685,  0.0330,  0.0013, -0.0094, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2159, 0.2316, 0.1902, 0.1898, 0.1726], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0178,  0.0042,  0.0006,  0.0010, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1942, 0.1907, 0.2226, 0.1983, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0163, 0.0155, 0.0203, 0.0156, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1806, 0.1915, 0.1980, 0.2311, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0167, -0.0115, -0.0134, -0.0036, -0.0170],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1664, 0.2041, 0.1701, 0.2884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0535, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0031, -0.0190,  0.0102, -0.0310,  0.0495]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25825462 0.19821048 0.192042   0.18283656 0.16865638]
np_weight_alpha[1] [0.14337648 0.21769421 0.19401284 0.19168727 0.25322917]
np_weight_alpha[2] [0.19399992 0.19148071 0.21917035 0.19878949 0.1965595 ]
np_weight_alpha[3] [0.18509687 0.19031043 0.19858238 0.22311464 0.20289566]
np_weight_alpha[4] [0.17133795 0.18699706 0.195091   0.2022576  0.24431635]
-------------Round number:  259  -------------
client Accurancy:  0.4365079365079365
client Accurancy:  0.4246031746031746
client Accurancy:  0.4523809523809524
client Accurancy:  0.42857142857142855
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4087301587301587
Average Global Trainning Accurancy:  0.44693877551020406
Average Global Trainning Loss:  1.4619437911883504
All users are selected
model: 0 tensor([0.2583, 0.1982, 0.1920, 0.1828, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0367, -0.0535, -0.0466, -0.0425, -0.0461],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1434, 0.2177, 0.1940, 0.1917, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0323, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1160, -0.0534, -0.0508, -0.0463,  0.0317],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1940, 0.1915, 0.2192, 0.1988, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0461, 0.0395, 0.0472, 0.0457, 0.0504],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1903, 0.1986, 0.2231, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0153, 0.0178, 0.0217, 0.0123],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1870, 0.1951, 0.2023, 0.2443], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0256, 0.0300, 0.0263, 0.0171, 0.0181]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25404486 0.20468767 0.19170536 0.17939943 0.17016272]
np_weight_alpha[1] [0.15998459 0.21790561 0.19306408 0.18999013 0.23905565]
np_weight_alpha[2] [0.19354548 0.19761951 0.21832696 0.19863339 0.19187464]
np_weight_alpha[3] [0.1804241  0.19275714 0.19846275 0.21996774 0.20838831]
np_weight_alpha[4] [0.16969039 0.17952545 0.19038425 0.20664544 0.2537545 ]
-------------Round number:  260  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.4722222222222222
client Accurancy:  0.45634920634920634
client Accurancy:  0.4087301587301587
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.4111111111111111
Average Global Trainning Accurancy:  0.4391156462585034
Average Global Trainning Loss:  1.4628447863520408
All users are selected
model: 0 tensor([0.2540, 0.2047, 0.1917, 0.1794, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0125, -0.0065, -0.0027, -0.0012, -0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1600, 0.2179, 0.1931, 0.1900, 0.2391], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0656, -0.0219, -0.0077, -0.0106,  0.0576],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1976, 0.2183, 0.1986, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0137, 0.0214, 0.0113, 0.0146, 0.0124],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1804, 0.1928, 0.1985, 0.2200, 0.2084], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0120, -0.0110, -0.0118, -0.0205, -0.0026],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1697, 0.1795, 0.1904, 0.2066, 0.2538], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0048, 0.0079, 0.0022, 0.0128, 0.0016]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19198446 0.24105145 0.20572986 0.18632618 0.17490803]
np_weight_alpha[1] [0.21544474 0.23134616 0.19031389 0.19013213 0.17276311]
np_weight_alpha[2] [0.19432376 0.19082491 0.22253008 0.19836912 0.19395217]
np_weight_alpha[3] [0.18111685 0.19173406 0.19806159 0.23034309 0.19874445]
np_weight_alpha[4] [0.1728918  0.16776569 0.20425816 0.17007771 0.28500667]
-------------Round number:  261  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.45634920634920634
client Accurancy:  0.43253968253968256
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.42063492063492064
Average Global Trainning Accurancy:  0.45408163265306123
Average Global Trainning Loss:  1.4157756364264455
All users are selected
model: 0 tensor([0.1920, 0.2411, 0.2057, 0.1863, 0.1749], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0722,  0.0300,  0.0013, -0.0084, -0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2154, 0.2313, 0.1903, 0.1901, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0177,  0.0043,  0.0011,  0.0016, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1943, 0.1908, 0.2225, 0.1984, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0166, 0.0156, 0.0201, 0.0156, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1917, 0.1981, 0.2303, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0166, -0.0116, -0.0138, -0.0047, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1678, 0.2043, 0.1701, 0.2850], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0496, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0061, -0.0166,  0.0114, -0.0300,  0.0469]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2586462  0.1982562  0.191845   0.18272889 0.16852374]
np_weight_alpha[1] [0.14477783 0.21888152 0.19332014 0.19080421 0.25221625]
np_weight_alpha[2] [0.19384915 0.1914272  0.21934937 0.19881125 0.19656307]
np_weight_alpha[3] [0.18508326 0.19036208 0.19860613 0.22308409 0.20286435]
np_weight_alpha[4] [0.17118016 0.18690489 0.19507253 0.20224799 0.24459447]
-------------Round number:  262  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.42857142857142855
client Accurancy:  0.45634920634920634
client Accurancy:  0.4246031746031746
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4095238095238095
Average Global Trainning Accurancy:  0.45
Average Global Trainning Loss:  1.4548515890731293
All users are selected
model: 0 tensor([0.2586, 0.1983, 0.1918, 0.1827, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0369, -0.0539, -0.0473, -0.0431, -0.0468],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1448, 0.2189, 0.1933, 0.1908, 0.2522], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0313, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1142, -0.0520, -0.0513, -0.0471,  0.0309],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1938, 0.1914, 0.2193, 0.1988, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0446, 0.0379, 0.0459, 0.0446, 0.0490],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1904, 0.1986, 0.2231, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0255, 0.0175, 0.0202, 0.0235, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1869, 0.1951, 0.2022, 0.2446], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0252, 0.0298, 0.0261, 0.0170, 0.0180]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25416583 0.2046101  0.19167396 0.17937294 0.1701772 ]
np_weight_alpha[1] [0.16088857 0.21899655 0.19259594 0.18937674 0.23814219]
np_weight_alpha[2] [0.19352241 0.19772168 0.21847901 0.19839787 0.19187905]
np_weight_alpha[3] [0.18038186 0.19274688 0.19822735 0.22037546 0.20826851]
np_weight_alpha[4] [0.1696961  0.17941745 0.19038863 0.2065147  0.2539831 ]
-------------Round number:  263  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.4722222222222222
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.4142857142857143
Average Global Trainning Accurancy:  0.4418367346938776
Average Global Trainning Loss:  1.4557283362563775
All users are selected
model: 0 tensor([0.2542, 0.2046, 0.1917, 0.1794, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0119, -0.0071, -0.0034, -0.0018, -0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1609, 0.2190, 0.1926, 0.1894, 0.2381], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0648, -0.0210, -0.0086, -0.0115,  0.0563],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1977, 0.2185, 0.1984, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0149, 0.0227, 0.0129, 0.0157, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1804, 0.1927, 0.1982, 0.2204, 0.2083], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0120, -0.0111, -0.0121, -0.0202, -0.0028],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1697, 0.1794, 0.1904, 0.2065, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0044, 0.0075, 0.0020, 0.0123, 0.0015]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19214034 0.24081181 0.2060887  0.18608412 0.174875  ]
np_weight_alpha[1] [0.21523717 0.23122299 0.1904551  0.19018559 0.17289917]
np_weight_alpha[2] [0.19437009 0.19092998 0.22245257 0.19838472 0.1938627 ]
np_weight_alpha[3] [0.18104796 0.19172886 0.19807215 0.23038298 0.19876803]
np_weight_alpha[4] [0.17301434 0.16838259 0.20388956 0.17070945 0.284004  ]
-------------Round number:  264  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.5158730158730159
client Accurancy:  0.45634920634920634
client Accurancy:  0.43253968253968256
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42063492063492064
Average Global Trainning Accurancy:  0.45408163265306123
Average Global Trainning Loss:  1.4124337332589285
All users are selected
model: 0 tensor([0.1921, 0.2408, 0.2061, 0.1861, 0.1749], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0720,  0.0303,  0.0016, -0.0084, -0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2152, 0.2312, 0.1905, 0.1902, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0171,  0.0036,  0.0005,  0.0007, -0.0135],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1944, 0.1909, 0.2225, 0.1984, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0165, 0.0157, 0.0201, 0.0160, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1917, 0.1981, 0.2304, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0173, -0.0126, -0.0142, -0.0056, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1730, 0.1684, 0.2039, 0.1707, 0.2840], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0483, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0073, -0.0148,  0.0121, -0.0283,  0.0468]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2587944  0.19793414 0.19206946 0.1826184  0.16858359]
np_weight_alpha[1] [0.1442997  0.21933846 0.19322887 0.19185576 0.25127724]
np_weight_alpha[2] [0.19408539 0.1915247  0.21937244 0.19849478 0.19652268]
np_weight_alpha[3] [0.18498254 0.19060962 0.19828856 0.2233109  0.20280838]
np_weight_alpha[4] [0.17119044 0.18684682 0.19503286 0.20220712 0.2447228 ]
-------------Round number:  265  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.42857142857142855
client Accurancy:  0.4642857142857143
client Accurancy:  0.4246031746031746
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4111111111111111
Average Global Trainning Accurancy:  0.4523809523809524
Average Global Trainning Loss:  1.4495716743728742
All users are selected
model: 0 tensor([0.2588, 0.1979, 0.1921, 0.1826, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0373, -0.0549, -0.0478, -0.0436, -0.0473],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1443, 0.2193, 0.1932, 0.1919, 0.2513], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0311, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1147, -0.0516, -0.0514, -0.0458,  0.0300],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1941, 0.1915, 0.2194, 0.1985, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0437, 0.0370, 0.0451, 0.0433, 0.0481],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1906, 0.1983, 0.2233, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0275, 0.0198, 0.0217, 0.0254, 0.0164],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1868, 0.1950, 0.2022, 0.2447], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0248, 0.0293, 0.0257, 0.0165, 0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25410742 0.20469007 0.19183692 0.1792121  0.17015345]
np_weight_alpha[1] [0.16060759 0.21942514 0.19254498 0.19016333 0.23725893]
np_weight_alpha[2] [0.19368388 0.19773754 0.21832143 0.19843054 0.19182661]
np_weight_alpha[3] [0.18020317 0.19263333 0.19824429 0.22063445 0.20828484]
np_weight_alpha[4] [0.1696673  0.17936522 0.1903182  0.20652393 0.2541254 ]
-------------Round number:  266  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.4722222222222222
client Accurancy:  0.46825396825396826
client Accurancy:  0.4126984126984127
client Accurancy:  0.2777777777777778
Average Global Accurancy:  0.4174603174603175
Average Global Trainning Accurancy:  0.44421768707482995
Average Global Trainning Loss:  1.4498548442814625
All users are selected
model: 0 tensor([0.2541, 0.2047, 0.1918, 0.1792, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0117, -0.0067, -0.0033, -0.0019, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1606, 0.2194, 0.1925, 0.1902, 0.2373], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0660, -0.0216, -0.0100, -0.0121,  0.0542],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1977, 0.2183, 0.1984, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0159, 0.0234, 0.0136, 0.0168, 0.0146],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1926, 0.1982, 0.2206, 0.2083], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0118, -0.0110, -0.0116, -0.0197, -0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1697, 0.1794, 0.1903, 0.2065, 0.2541], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0042, 0.0074, 0.0019, 0.0123, 0.0015]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19309513 0.2391281  0.20588619 0.18641151 0.175479  ]
np_weight_alpha[1] [0.21498059 0.23112617 0.19060948 0.19033349 0.17295034]
np_weight_alpha[2] [0.19444707 0.19106701 0.22245719 0.19820397 0.19382483]
np_weight_alpha[3] [0.18098374 0.19189061 0.19788559 0.23055036 0.19868965]
np_weight_alpha[4] [0.17362368 0.16854633 0.20403628 0.17043725 0.28335643]
-------------Round number:  267  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.5198412698412699
client Accurancy:  0.4523809523809524
client Accurancy:  0.43253968253968256
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42063492063492064
Average Global Trainning Accurancy:  0.4554421768707483
Average Global Trainning Loss:  1.4086766249468536
All users are selected
model: 0 tensor([0.1931, 0.2391, 0.2059, 0.1864, 0.1755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0716,  0.0278,  0.0006, -0.0089, -0.0038],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2150, 0.2311, 0.1906, 0.1903, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0166,  0.0031,  0.0003,  0.0005, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1944, 0.1911, 0.2225, 0.1982, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0168, 0.0161, 0.0203, 0.0160, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1919, 0.1979, 0.2306, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0176, -0.0127, -0.0146, -0.0050, -0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1736, 0.1685, 0.2040, 0.1704, 0.2834], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0476, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0088, -0.0136,  0.0132, -0.0279,  0.0470]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25852928 0.19798112 0.19205147 0.18277246 0.16866574]
np_weight_alpha[1] [0.14512315 0.2202913  0.19285342 0.19183333 0.24989884]
np_weight_alpha[2] [0.19404642 0.19154893 0.21935034 0.19859563 0.1964587 ]
np_weight_alpha[3] [0.1851459  0.19071832 0.19839825 0.22274934 0.20298824]
np_weight_alpha[4] [0.17120558 0.18666622 0.19496486 0.20236716 0.24479625]
-------------Round number:  268  -------------
client Accurancy:  0.4444444444444444
client Accurancy:  0.43253968253968256
client Accurancy:  0.4603174603174603
client Accurancy:  0.42857142857142855
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4126984126984127
Average Global Trainning Accurancy:  0.45510204081632655
Average Global Trainning Loss:  1.4434553704294217
All users are selected
model: 0 tensor([0.2585, 0.1980, 0.1921, 0.1828, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0372, -0.0549, -0.0477, -0.0437, -0.0472],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1451, 0.2203, 0.1929, 0.1918, 0.2499], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1134, -0.0502, -0.0514, -0.0455,  0.0290],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1940, 0.1915, 0.2194, 0.1986, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0421, 0.0354, 0.0432, 0.0418, 0.0464],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1907, 0.1984, 0.2227, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0285, 0.0210, 0.0229, 0.0260, 0.0177],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1867, 0.1950, 0.2024, 0.2448], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0251, 0.0296, 0.0260, 0.0171, 0.0178]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25369415 0.2047751  0.1918157  0.17948271 0.17023233]
np_weight_alpha[1] [0.16116524 0.2203134  0.19230063 0.19020495 0.23601581]
np_weight_alpha[2] [0.1936341  0.19772142 0.21848427 0.19838645 0.19177377]
np_weight_alpha[3] [0.18046594 0.1926472  0.19821358 0.22050272 0.2081706 ]
np_weight_alpha[4] [0.1697218  0.17928395 0.19026162 0.20639479 0.25433782]
-------------Round number:  269  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.4722222222222222
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.42063492063492064
Average Global Trainning Accurancy:  0.4459183673469388
Average Global Trainning Loss:  1.4450907804528061
All users are selected
model: 0 tensor([0.2537, 0.2048, 0.1918, 0.1795, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0118, -0.0060, -0.0031, -0.0013, -0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1612, 0.2203, 0.1923, 0.1902, 0.2360], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0658, -0.0214, -0.0109, -0.0129,  0.0524],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1977, 0.2185, 0.1984, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0157, 0.0234, 0.0140, 0.0170, 0.0148],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1805, 0.1926, 0.1982, 0.2205, 0.2082], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0124, -0.0119, -0.0122, -0.0203, -0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1697, 0.1793, 0.1903, 0.2064, 0.2543], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0051, 0.0081, 0.0027, 0.0130, 0.0020]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19448869 0.23753992 0.20709567 0.18619111 0.1746847 ]
np_weight_alpha[1] [0.2146741  0.23111968 0.1907172  0.19056773 0.17292127]
np_weight_alpha[2] [0.19467017 0.19115105 0.22236322 0.19809864 0.19371687]
np_weight_alpha[3] [0.18115225 0.19209646 0.19779493 0.23030795 0.19864836]
np_weight_alpha[4] [0.17280075 0.16816667 0.20361319 0.17058583 0.28483358]
-------------Round number:  270  -------------
client Accurancy:  0.40476190476190477
client Accurancy:  0.5277777777777778
client Accurancy:  0.4523809523809524
client Accurancy:  0.4365079365079365
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4246031746031746
Average Global Trainning Accurancy:  0.4574829931972789
Average Global Trainning Loss:  1.4023488985437924
All users are selected
model: 0 tensor([0.1945, 0.2375, 0.2071, 0.1862, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0708,  0.0256,  0.0011, -0.0097, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2147, 0.2311, 0.1907, 0.1906, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0163,  0.0029,  0.0005,  0.0007, -0.0133],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1947, 0.1912, 0.2224, 0.1981, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0175, 0.0168, 0.0206, 0.0168, 0.0144],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1812, 0.1921, 0.1978, 0.2303, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0185, -0.0136, -0.0154, -0.0066, -0.0196],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1682, 0.2036, 0.1706, 0.2848], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0491, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0091, -0.0129,  0.0138, -0.0269,  0.0489]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25857496 0.19800492 0.1922249  0.18278089 0.16841432]
np_weight_alpha[1] [0.14613555 0.2215317  0.19253817 0.19118758 0.24860698]
np_weight_alpha[2] [0.19424255 0.19155154 0.21963225 0.19822536 0.19634834]
np_weight_alpha[3] [0.18512347 0.19074377 0.19803037 0.22298506 0.20311733]
np_weight_alpha[4] [0.17096296 0.18644193 0.19482249 0.20244086 0.24533181]
-------------Round number:  271  -------------
client Accurancy:  0.4444444444444444
client Accurancy:  0.44047619047619047
client Accurancy:  0.4642857142857143
client Accurancy:  0.4246031746031746
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4174603174603175
Average Global Trainning Accurancy:  0.45782312925170066
Average Global Trainning Loss:  1.4371763060693028
All users are selected
model: 0 tensor([0.2586, 0.1980, 0.1922, 0.1828, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0366, -0.0547, -0.0474, -0.0437, -0.0473],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1461, 0.2215, 0.1925, 0.1912, 0.2486], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0293, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1111, -0.0477, -0.0505, -0.0451,  0.0289],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1916, 0.2196, 0.1982, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0408, 0.0339, 0.0417, 0.0402, 0.0449],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1907, 0.1980, 0.2230, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0282, 0.0210, 0.0229, 0.0262, 0.0179],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1864, 0.1948, 0.2024, 0.2453], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0249, 0.0296, 0.0261, 0.0174, 0.0183]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25336435 0.20482521 0.19184157 0.17968714 0.17028172]
np_weight_alpha[1] [0.16183496 0.22144344 0.19209975 0.18977378 0.23484808]
np_weight_alpha[2] [0.19362314 0.19771817 0.21881625 0.19812891 0.19171359]
np_weight_alpha[3] [0.18066621 0.19270125 0.19796191 0.22053741 0.20813325]
np_weight_alpha[4] [0.1697491  0.17919374 0.19019157 0.2063509  0.25451466]
-------------Round number:  272  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.4722222222222222
client Accurancy:  0.4722222222222222
client Accurancy:  0.4166666666666667
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4222222222222222
Average Global Trainning Accurancy:  0.44761904761904764
Average Global Trainning Loss:  1.438805072810374
All users are selected
model: 0 tensor([0.2534, 0.2048, 0.1918, 0.1797, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0119, -0.0053, -0.0031, -0.0009, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1618, 0.2214, 0.1921, 0.1898, 0.2348], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0652, -0.0207, -0.0121, -0.0139,  0.0505],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1977, 0.2188, 0.1981, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0160, 0.0237, 0.0151, 0.0175, 0.0158],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1807, 0.1927, 0.1980, 0.2205, 0.2081], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0135, -0.0130, -0.0135, -0.0215, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1697, 0.1792, 0.1902, 0.2064, 0.2545], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0059, 0.0088, 0.0038, 0.0137, 0.0027]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19506486 0.23541549 0.20872672 0.18600981 0.17478313]
np_weight_alpha[1] [0.21421015 0.23099677 0.19111173 0.19062544 0.17305587]
np_weight_alpha[2] [0.195016   0.19149822 0.22218373 0.19798937 0.19331266]
np_weight_alpha[3] [0.18125696 0.19208701 0.19769323 0.23030426 0.19865851]
np_weight_alpha[4] [0.17288485 0.16853525 0.2018398  0.17072186 0.28601822]
-------------Round number:  273  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5396825396825397
client Accurancy:  0.4523809523809524
client Accurancy:  0.42857142857142855
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.42857142857142855
Average Global Trainning Accurancy:  0.45918367346938777
Average Global Trainning Loss:  1.397927628082483
All users are selected
model: 0 tensor([0.1951, 0.2354, 0.2087, 0.1860, 0.1748], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0263, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0701,  0.0231,  0.0027, -0.0104, -0.0047],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2142, 0.2310, 0.1911, 0.1906, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0157,  0.0031,  0.0010,  0.0007, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1950, 0.1915, 0.2222, 0.1980, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0174, 0.0206, 0.0170, 0.0141],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1813, 0.1921, 0.1977, 0.2303, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0200, -0.0150, -0.0167, -0.0076, -0.0206],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1685, 0.2018, 0.1707, 0.2860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0499, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0103, -0.0115,  0.0129, -0.0255,  0.0508]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25829038 0.19823167 0.19210818 0.18312812 0.16824171]
np_weight_alpha[1] [0.1481864  0.22080582 0.19089566 0.1918971  0.24821503]
np_weight_alpha[2] [0.19411944 0.19147584 0.21974857 0.19817488 0.1964813 ]
np_weight_alpha[3] [0.18547392 0.19093351 0.1979828  0.22275525 0.20285456]
np_weight_alpha[4] [0.17081708 0.18643989 0.19493596 0.2021708  0.24563625]
-------------Round number:  274  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.44047619047619047
client Accurancy:  0.4642857142857143
client Accurancy:  0.4246031746031746
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.41825396825396827
Average Global Trainning Accurancy:  0.4605442176870748
Average Global Trainning Loss:  1.4317897666879251
All users are selected
model: 0 tensor([0.2583, 0.1982, 0.1921, 0.1831, 0.1682], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0366, -0.0541, -0.0472, -0.0433, -0.0476],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1482, 0.2208, 0.1909, 0.1919, 0.2482], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0280, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1088, -0.0484, -0.0524, -0.0448,  0.0282],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1941, 0.1915, 0.2197, 0.1982, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0403, 0.0333, 0.0416, 0.0395, 0.0444],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1855, 0.1909, 0.1980, 0.2228, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0291, 0.0216, 0.0233, 0.0269, 0.0184],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1864, 0.1949, 0.2022, 0.2456], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0295, 0.0261, 0.0173, 0.0190]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25321454 0.20463803 0.19178036 0.17979418 0.17057288]
np_weight_alpha[1] [0.16317283 0.22084306 0.19092907 0.19043736 0.23461777]
np_weight_alpha[2] [0.19354953 0.19777341 0.21854074 0.19829409 0.19184223]
np_weight_alpha[3] [0.18075235 0.19291486 0.19813266 0.2202027  0.20799746]
np_weight_alpha[4] [0.1700752  0.17932023 0.19035101 0.20621537 0.25403818]
-------------Round number:  275  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.48412698412698413
client Accurancy:  0.46825396825396826
client Accurancy:  0.4166666666666667
client Accurancy:  0.28174603174603174
Average Global Accurancy:  0.42142857142857143
Average Global Trainning Accurancy:  0.45034013605442175
Average Global Trainning Loss:  1.4346864038584184
All users are selected
model: 0 tensor([0.2532, 0.2046, 0.1918, 0.1798, 0.1706], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 1.2519e-02, -4.6169e-03, -2.6191e-03, -9.1405e-05,  8.1073e-04],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1632, 0.2208, 0.1909, 0.1904, 0.2346], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0650, -0.0224, -0.0148, -0.0147,  0.0488],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1978, 0.2185, 0.1983, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0149, 0.0229, 0.0143, 0.0170, 0.0151],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1808, 0.1929, 0.1981, 0.2202, 0.2080], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0124, -0.0119, -0.0122, -0.0209, -0.0033],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1701, 0.1793, 0.1904, 0.2062, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0067, 0.0092, 0.0042, 0.0141, 0.0025]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.1955522  0.23541598 0.21000269 0.18567483 0.17335427]
np_weight_alpha[1] [0.21399492 0.23077151 0.19125828 0.19077514 0.17320012]
np_weight_alpha[2] [0.19524236 0.19161206 0.22187464 0.19789092 0.19338006]
np_weight_alpha[3] [0.18127324 0.19219452 0.1975919  0.2304396  0.1985007 ]
np_weight_alpha[4] [0.17115319 0.16825816 0.20129797 0.17030886 0.28898177]
-------------Round number:  276  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.5396825396825397
client Accurancy:  0.45634920634920634
client Accurancy:  0.42857142857142855
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.46258503401360546
Average Global Trainning Loss:  1.3911465807025936
All users are selected
model: 0 tensor([0.1956, 0.2354, 0.2100, 0.1857, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0263, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0707,  0.0223,  0.0031, -0.0116, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2140, 0.2308, 0.1913, 0.1908, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0161,  0.0035,  0.0018,  0.0015, -0.0124],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1952, 0.1916, 0.2219, 0.1979, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0184, 0.0176, 0.0201, 0.0170, 0.0142],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1813, 0.1922, 0.1976, 0.2304, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0152, -0.0170, -0.0078, -0.0213],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1683, 0.2013, 0.1703, 0.2890], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0532, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0091, -0.0114,  0.0128, -0.0257,  0.0544]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25847024 0.19819422 0.19214225 0.18311913 0.16807422]
np_weight_alpha[1] [0.14884831 0.22209263 0.19020605 0.19110359 0.24774942]
np_weight_alpha[2] [0.19417927 0.19144373 0.21987978 0.19806711 0.19643007]
np_weight_alpha[3] [0.18544818 0.19088311 0.1978753  0.22269167 0.20310181]
np_weight_alpha[4] [0.17076944 0.18652911 0.19489776 0.20236748 0.2454362 ]
-------------Round number:  277  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.4523809523809524
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.42063492063492064
Average Global Trainning Accurancy:  0.463265306122449
Average Global Trainning Loss:  1.4258815635629252
All users are selected
model: 0 tensor([0.2585, 0.1982, 0.1921, 0.1831, 0.1681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0364, -0.0543, -0.0472, -0.0434, -0.0481],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1488, 0.2221, 0.1902, 0.1911, 0.2477], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0278, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1077, -0.0467, -0.0526, -0.0452,  0.0281],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1914, 0.2199, 0.1981, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0396, 0.0325, 0.0405, 0.0387, 0.0435],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1909, 0.1979, 0.2227, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0305, 0.0229, 0.0247, 0.0280, 0.0201],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1865, 0.1949, 0.2024, 0.2454], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0235, 0.0290, 0.0254, 0.0169, 0.0182]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25302762 0.20469232 0.19167095 0.17982686 0.17078224]
np_weight_alpha[1] [0.16359481 0.22198555 0.1903961  0.18984272 0.23418087]
np_weight_alpha[2] [0.19340777 0.19772528 0.21895638 0.1980857  0.19182488]
np_weight_alpha[3] [0.180768   0.19292709 0.1979276  0.22044457 0.20793273]
np_weight_alpha[4] [0.17026713 0.17925158 0.19034183 0.20617434 0.25396508]
-------------Round number:  278  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.48412698412698413
client Accurancy:  0.4642857142857143
client Accurancy:  0.42063492063492064
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.42142857142857143
Average Global Trainning Accurancy:  0.4523809523809524
Average Global Trainning Loss:  1.4300611846301021
All users are selected
model: 0 tensor([0.2530, 0.2047, 0.1917, 0.1798, 0.1708], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0127, -0.0040, -0.0024,  0.0003,  0.0015],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1636, 0.2220, 0.1904, 0.1898, 0.2342], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0652, -0.0219, -0.0163, -0.0162,  0.0474],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1977, 0.2190, 0.1981, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0155, 0.0234, 0.0156, 0.0176, 0.0160],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1808, 0.1929, 0.1979, 0.2204, 0.2079], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0122, -0.0127, -0.0209, -0.0037],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1703, 0.1793, 0.1903, 0.2062, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0272, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0069, 0.0090, 0.0043, 0.0140, 0.0023]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19647107 0.2346123  0.21079679 0.18585034 0.17226954]
np_weight_alpha[1] [0.21383737 0.23054716 0.1914597  0.19082151 0.17333427]
np_weight_alpha[2] [0.19531764 0.19178456 0.2217874  0.19782355 0.19328688]
np_weight_alpha[3] [0.18134351 0.19219035 0.19752775 0.2303997  0.19853872]
np_weight_alpha[4] [0.17012857 0.16873355 0.20083465 0.17056839 0.28973487]
-------------Round number:  279  -------------
client Accurancy:  0.42063492063492064
client Accurancy:  0.5357142857142857
client Accurancy:  0.45634920634920634
client Accurancy:  0.43253968253968256
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.46496598639455783
Average Global Trainning Loss:  1.3859293619791666
All users are selected
model: 0 tensor([0.1965, 0.2346, 0.2108, 0.1859, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0687,  0.0223,  0.0047, -0.0105, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2138, 0.2305, 0.1915, 0.1908, 0.1733], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0151,  0.0022,  0.0014,  0.0008, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1953, 0.1918, 0.2218, 0.1978, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0185, 0.0181, 0.0201, 0.0173, 0.0144],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1813, 0.1922, 0.1975, 0.2304, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0159, -0.0177, -0.0089, -0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1701, 0.1687, 0.2008, 0.1706, 0.2897], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0539, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0086, -0.0104,  0.0128, -0.0250,  0.0553]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25833148 0.19831976 0.19225961 0.18311232 0.16797681]
np_weight_alpha[1] [0.14982721 0.22460197 0.18873945 0.19052403 0.24630736]
np_weight_alpha[2] [0.19429675 0.19128916 0.22006299 0.19794045 0.19641064]
np_weight_alpha[3] [0.18541345 0.19079423 0.19774638 0.22295497 0.20309103]
np_weight_alpha[4] [0.17066558 0.18640211 0.19486423 0.20233262 0.2457355 ]
-------------Round number:  280  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.4444444444444444
client Accurancy:  0.45634920634920634
client Accurancy:  0.4087301587301587
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4166666666666667
Average Global Trainning Accurancy:  0.4663265306122449
Average Global Trainning Loss:  1.4196020009566326
All users are selected
model: 0 tensor([0.2583, 0.1983, 0.1923, 0.1831, 0.1680], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0356, -0.0533, -0.0464, -0.0428, -0.0472],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1498, 0.2246, 0.1887, 0.1905, 0.2463], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0274, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1059, -0.0436, -0.0534, -0.0453,  0.0274],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1913, 0.2201, 0.1979, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0380, 0.0308, 0.0391, 0.0369, 0.0420],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1908, 0.1977, 0.2230, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0310, 0.0235, 0.0253, 0.0294, 0.0209],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1707, 0.1864, 0.1949, 0.2023, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0287, 0.0251, 0.0165, 0.0177]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25291643 0.20468283 0.19184281 0.17996526 0.17059268]
np_weight_alpha[1] [0.16421673 0.22424373 0.18927191 0.18944003 0.23282762]
np_weight_alpha[2] [0.1935848  0.1976154  0.21893616 0.19815376 0.19170992]
np_weight_alpha[3] [0.18093155 0.19305141 0.19800483 0.2200812  0.20793091]
np_weight_alpha[4] [0.17003456 0.17908801 0.1901968  0.20613806 0.2545425 ]
-------------Round number:  281  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.49206349206349204
client Accurancy:  0.4642857142857143
client Accurancy:  0.42063492063492064
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.4246031746031746
Average Global Trainning Accurancy:  0.4554421768707483
Average Global Trainning Loss:  1.422922977784864
All users are selected
model: 0 tensor([0.2529, 0.2047, 0.1918, 0.1800, 0.1706], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0133, -0.0034, -0.0019,  0.0005,  0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1642, 0.2242, 0.1893, 0.1894, 0.2328], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0653, -0.0204, -0.0187, -0.0181,  0.0447],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1976, 0.2189, 0.1982, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0158, 0.0236, 0.0161, 0.0181, 0.0162],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1809, 0.1931, 0.1980, 0.2201, 0.2079], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0133, -0.0127, -0.0128, -0.0212, -0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1700, 0.1791, 0.1902, 0.2061, 0.2545], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0074, 0.0095, 0.0048, 0.0147, 0.0038]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19564582 0.23310722 0.21094295 0.18713553 0.17316844]
np_weight_alpha[1] [0.21341576 0.23022313 0.19159994 0.19119401 0.17356715]
np_weight_alpha[2] [0.19546992 0.19186682 0.22164273 0.19768737 0.19333318]
np_weight_alpha[3] [0.18171011 0.19250199 0.19741161 0.22983617 0.1985401 ]
np_weight_alpha[4] [0.17141856 0.16993935 0.20198205 0.17090636 0.2857537 ]
-------------Round number:  282  -------------
client Accurancy:  0.4166666666666667
client Accurancy:  0.5396825396825397
client Accurancy:  0.45634920634920634
client Accurancy:  0.43253968253968256
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.467687074829932
Average Global Trainning Loss:  1.3862170161033163
All users are selected
model: 0 tensor([0.1956, 0.2331, 0.2109, 0.1871, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0704,  0.0198,  0.0038, -0.0103, -0.0072],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2134, 0.2302, 0.1916, 0.1912, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0153,  0.0026,  0.0020,  0.0018, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1919, 0.2216, 0.1977, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0176, 0.0195, 0.0167, 0.0139],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1817, 0.1925, 0.1974, 0.2298, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0152, -0.0174, -0.0088, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1699, 0.2020, 0.1709, 0.2858], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0496, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0104, -0.0086,  0.0145, -0.0242,  0.0519]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25813636 0.19830357 0.19226956 0.18316309 0.16812739]
np_weight_alpha[1] [0.1509462  0.22561675 0.18896015 0.1893476  0.2451293 ]
np_weight_alpha[2] [0.19430485 0.1914318  0.21995533 0.19791268 0.19639532]
np_weight_alpha[3] [0.18547684 0.19083166 0.1977207  0.22277953 0.20319124]
np_weight_alpha[4] [0.1707019  0.18633825 0.19483212 0.20244491 0.24568279]
-------------Round number:  283  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.4523809523809524
client Accurancy:  0.4523809523809524
client Accurancy:  0.4087301587301587
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.41904761904761906
Average Global Trainning Accurancy:  0.4683673469387755
Average Global Trainning Loss:  1.4143456699085883
All users are selected
model: 0 tensor([0.2581, 0.1983, 0.1923, 0.1832, 0.1681], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0353, -0.0530, -0.0462, -0.0426, -0.0471],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1509, 0.2256, 0.1890, 0.1893, 0.2451], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1047, -0.0427, -0.0534, -0.0467,  0.0259],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1914, 0.2200, 0.1979, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0382, 0.0311, 0.0390, 0.0373, 0.0425],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1855, 0.1908, 0.1977, 0.2228, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0307, 0.0232, 0.0251, 0.0287, 0.0208],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1707, 0.1863, 0.1948, 0.2024, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0232, 0.0288, 0.0255, 0.0169, 0.0178]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25262526 0.20461234 0.1918891  0.1800212  0.17085212]
np_weight_alpha[1] [0.16493629 0.22517851 0.18948677 0.18859096 0.23180743]
np_weight_alpha[2] [0.19360767 0.19769228 0.21917152 0.19803406 0.1914945 ]
np_weight_alpha[3] [0.18096367 0.19302921 0.19789067 0.22031076 0.20780574]
np_weight_alpha[4] [0.17028865 0.17910725 0.18999906 0.20602156 0.25458342]
-------------Round number:  284  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.49603174603174605
client Accurancy:  0.4603174603174603
client Accurancy:  0.42063492063492064
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.4253968253968254
Average Global Trainning Accurancy:  0.45918367346938777
Average Global Trainning Loss:  1.4171981292517006
All users are selected
model: 0 tensor([0.2526, 0.2046, 0.1919, 0.1800, 0.1709], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0132, -0.0035, -0.0020,  0.0004,  0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1649, 0.2252, 0.1895, 0.1886, 0.2318], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0644, -0.0193, -0.0185, -0.0189,  0.0435],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1977, 0.2192, 0.1980, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0158, 0.0236, 0.0160, 0.0182, 0.0160],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1930, 0.1979, 0.2203, 0.2078], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0133, -0.0126, -0.0127, -0.0209, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1703, 0.1791, 0.1900, 0.2060, 0.2546], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0075, 0.0095, 0.0047, 0.0145, 0.0041]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.195276   0.2334772  0.21093717 0.18739918 0.1729104 ]
np_weight_alpha[1] [0.2133061  0.23005602 0.19167575 0.19121225 0.17374985]
np_weight_alpha[2] [0.19550169 0.19191812 0.22185014 0.19749576 0.19323425]
np_weight_alpha[3] [0.18180627 0.19246167 0.19722399 0.22984895 0.19865914]
np_weight_alpha[4] [0.17135668 0.1702556  0.20242251 0.17190082 0.2840644 ]
-------------Round number:  285  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5357142857142857
client Accurancy:  0.4603174603174603
client Accurancy:  0.4246031746031746
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.46802721088435373
Average Global Trainning Loss:  1.383982382015306
All users are selected
model: 0 tensor([0.1953, 0.2335, 0.2109, 0.1874, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0714,  0.0203,  0.0038, -0.0100, -0.0076],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2133, 0.2301, 0.1917, 0.1912, 0.1737], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0157,  0.0025,  0.0024,  0.0020, -0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1919, 0.2219, 0.1975, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0186, 0.0180, 0.0199, 0.0168, 0.0139],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1818, 0.1925, 0.1972, 0.2298, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0206, -0.0159, -0.0180, -0.0093, -0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1703, 0.2024, 0.1719, 0.2841], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0478, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0104, -0.0082,  0.0149, -0.0232,  0.0505]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25870666 0.19800171 0.19212836 0.18298922 0.16817403]
np_weight_alpha[1] [0.15031786 0.22755454 0.18815845 0.18982026 0.24414882]
np_weight_alpha[2] [0.19417699 0.19132793 0.22010423 0.19784813 0.19654271]
np_weight_alpha[3] [0.18534264 0.19094865 0.19765364 0.22281706 0.20323797]
np_weight_alpha[4] [0.17075141 0.1863486  0.1949584  0.20249182 0.24544968]
-------------Round number:  286  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.45634920634920634
client Accurancy:  0.4603174603174603
client Accurancy:  0.4087301587301587
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.423015873015873
Average Global Trainning Accurancy:  0.46938775510204084
Average Global Trainning Loss:  1.408631284545068
All users are selected
model: 0 tensor([0.2587, 0.1980, 0.1921, 0.1830, 0.1682], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0345, -0.0532, -0.0462, -0.0428, -0.0472],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1503, 0.2276, 0.1882, 0.1898, 0.2441], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0271, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1059, -0.0414, -0.0549, -0.0470,  0.0241],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1913, 0.2201, 0.1978, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0377, 0.0305, 0.0388, 0.0366, 0.0423],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1853, 0.1909, 0.1977, 0.2228, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0314, 0.0242, 0.0258, 0.0300, 0.0219],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1863, 0.1950, 0.2025, 0.2454], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0290, 0.0259, 0.0172, 0.0177]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2524375  0.20453936 0.1918249  0.18018617 0.17101209]
np_weight_alpha[1] [0.16447271 0.22688377 0.1888541  0.18892556 0.23086388]
np_weight_alpha[2] [0.1935284  0.19773595 0.21911699 0.19822243 0.19139622]
np_weight_alpha[3] [0.1811288  0.19309229 0.19809245 0.21997635 0.20771009]
np_weight_alpha[4] [0.17041324 0.17906533 0.18990725 0.20593037 0.2546838 ]
-------------Round number:  287  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.4603174603174603
client Accurancy:  0.42063492063492064
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.4261904761904762
Average Global Trainning Accurancy:  0.4605442176870748
Average Global Trainning Loss:  1.4125001660820578
All users are selected
model: 0 tensor([0.2524, 0.2045, 0.1918, 0.1802, 0.1710], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0136, -0.0022, -0.0008,  0.0015,  0.0028],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1645, 0.2269, 0.1889, 0.1889, 0.2309], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0653, -0.0183, -0.0200, -0.0195,  0.0415],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1977, 0.2191, 0.1982, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0155, 0.0231, 0.0154, 0.0178, 0.0154],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1931, 0.1981, 0.2200, 0.2077], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0131, -0.0126, -0.0125, -0.0209, -0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1704, 0.1791, 0.1899, 0.2059, 0.2547], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0077, 0.0096, 0.0049, 0.0148, 0.0046]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19808094 0.23192565 0.21001956 0.1872188  0.17275503]
np_weight_alpha[1] [0.2129183  0.22999743 0.19173586 0.19136143 0.17398699]
np_weight_alpha[2] [0.19526128 0.19194782 0.22195281 0.19758156 0.19325654]
np_weight_alpha[3] [0.18189587 0.19259225 0.19731896 0.22962567 0.19856718]
np_weight_alpha[4] [0.17148718 0.17115355 0.203012   0.17187923 0.28246805]
-------------Round number:  288  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5357142857142857
client Accurancy:  0.45634920634920634
client Accurancy:  0.42063492063492064
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42777777777777776
Average Global Trainning Accurancy:  0.46904761904761905
Average Global Trainning Loss:  1.3809929880155187
All users are selected
model: 0 tensor([0.1981, 0.2319, 0.2100, 0.1872, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0686,  0.0184,  0.0024, -0.0106, -0.0083],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2129, 0.2300, 0.1917, 0.1914, 0.1740], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0152,  0.0024,  0.0023,  0.0019, -0.0115],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1953, 0.1919, 0.2220, 0.1976, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0186, 0.0184, 0.0201, 0.0175, 0.0144],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1819, 0.1926, 0.1973, 0.2296, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0156, -0.0176, -0.0096, -0.0220],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1712, 0.2030, 0.1719, 0.2825], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0462, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0105, -0.0073,  0.0156, -0.0231,  0.0489]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25832906 0.19800974 0.19221264 0.18308498 0.16836357]
np_weight_alpha[1] [0.15150753 0.22758074 0.18800749 0.18959157 0.24331264]
np_weight_alpha[2] [0.19423337 0.1913257  0.22034    0.19766493 0.19643594]
np_weight_alpha[3] [0.18536666 0.19099991 0.19747949 0.22296847 0.20318548]
np_weight_alpha[4] [0.17078969 0.18635534 0.19485609 0.20245677 0.24554215]
-------------Round number:  289  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.45634920634920634
client Accurancy:  0.4603174603174603
client Accurancy:  0.4087301587301587
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4222222222222222
Average Global Trainning Accurancy:  0.4707482993197279
Average Global Trainning Loss:  1.404263990752551
All users are selected
model: 0 tensor([0.2583, 0.1980, 0.1922, 0.1831, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0342, -0.0525, -0.0456, -0.0421, -0.0466],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1515, 0.2276, 0.1880, 0.1896, 0.2433], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1038, -0.0407, -0.0544, -0.0466,  0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1913, 0.2203, 0.1977, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0367, 0.0295, 0.0380, 0.0356, 0.0409],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1910, 0.1975, 0.2230, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0309, 0.0237, 0.0253, 0.0293, 0.0214],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1864, 0.1949, 0.2025, 0.2455], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0235, 0.0294, 0.0259, 0.0176, 0.0186]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25224444 0.20447062 0.19188336 0.18017472 0.17122686]
np_weight_alpha[1] [0.16526121 0.2269681  0.18878336 0.18880999 0.23017737]
np_weight_alpha[2] [0.19356623 0.19773392 0.21907027 0.19800104 0.19162856]
np_weight_alpha[3] [0.18110041 0.1931076  0.19785926 0.2203086  0.20762412]
np_weight_alpha[4] [0.17066984 0.17910115 0.19015525 0.20587811 0.25419566]
-------------Round number:  290  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4246031746031746
Average Global Trainning Accurancy:  0.46190476190476193
Average Global Trainning Loss:  1.4079774194834183
All users are selected
model: 0 tensor([0.2522, 0.2045, 0.1919, 0.1802, 0.1712], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0145, -0.0016, -0.0003,  0.0019,  0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1653, 0.2270, 0.1888, 0.1888, 0.2302], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0655, -0.0191, -0.0213, -0.0207,  0.0395],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1977, 0.2191, 0.1980, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0159, 0.0234, 0.0161, 0.0184, 0.0161],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1811, 0.1931, 0.1979, 0.2203, 0.2076], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0134, -0.0126, -0.0125, -0.0207, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1707, 0.1791, 0.1902, 0.2059, 0.2542], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0079, 0.0095, 0.0051, 0.0147, 0.0045]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19685899 0.23200072 0.2106432  0.18810102 0.17239612]
np_weight_alpha[1] [0.21279281 0.22975427 0.19192953 0.19135089 0.17417257]
np_weight_alpha[2] [0.19544297 0.1921372  0.22176723 0.19734511 0.1933074 ]
np_weight_alpha[3] [0.1820648  0.19254133 0.19707851 0.22968799 0.1986274 ]
np_weight_alpha[4] [0.17091851 0.17138612 0.20228481 0.17227966 0.28313088]
-------------Round number:  291  -------------
client Accurancy:  0.4126984126984127
client Accurancy:  0.5396825396825397
client Accurancy:  0.45634920634920634
client Accurancy:  0.4246031746031746
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.46870748299319726
Average Global Trainning Loss:  1.3778581061330781
All users are selected
model: 0 tensor([0.1969, 0.2320, 0.2106, 0.1881, 0.1724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0699,  0.0182,  0.0027, -0.0101, -0.0089],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2128, 0.2298, 0.1919, 0.1914, 0.1742], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0150,  0.0022,  0.0025,  0.0018, -0.0114],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1954, 0.1921, 0.2218, 0.1973, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0188, 0.0185, 0.0201, 0.0173, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1821, 0.1925, 0.1971, 0.2297, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0206, -0.0160, -0.0180, -0.0097, -0.0220],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1714, 0.2023, 0.1723, 0.2831], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0467, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0104, -0.0066,  0.0153, -0.0220,  0.0501]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25813246 0.1980113  0.19228677 0.18320914 0.16836025]
np_weight_alpha[1] [0.1519065  0.22800045 0.18742214 0.19019635 0.24247447]
np_weight_alpha[2] [0.19429943 0.19134606 0.2201687  0.19760388 0.1965819 ]
np_weight_alpha[3] [0.18551181 0.19112033 0.19741616 0.22295877 0.20299296]
np_weight_alpha[4] [0.17084867 0.18637432 0.19500393 0.20226195 0.24551105]
-------------Round number:  292  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.4642857142857143
client Accurancy:  0.4642857142857143
client Accurancy:  0.4087301587301587
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4253968253968254
Average Global Trainning Accurancy:  0.4717687074829932
Average Global Trainning Loss:  1.3997395833333333
All users are selected
model: 0 tensor([0.2581, 0.1980, 0.1923, 0.1832, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0331, -0.0511, -0.0442, -0.0406, -0.0456],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1519, 0.2280, 0.1874, 0.1902, 0.2425], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1029, -0.0399, -0.0547, -0.0457,  0.0232],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1913, 0.2202, 0.1976, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0357, 0.0283, 0.0366, 0.0344, 0.0400],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1855, 0.1911, 0.1974, 0.2230, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0319, 0.0245, 0.0260, 0.0300, 0.0220],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1864, 0.1950, 0.2023, 0.2455], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0222, 0.0283, 0.0251, 0.0164, 0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25233552 0.20432857 0.19182019 0.1800982  0.17141747]
np_weight_alpha[1] [0.16550831 0.22735013 0.188378   0.18929811 0.22946532]
np_weight_alpha[2] [0.19349961 0.19780935 0.21917084 0.19800444 0.19151574]
np_weight_alpha[3] [0.1810081  0.19314654 0.19786233 0.22042848 0.2075546 ]
np_weight_alpha[4] [0.17087759 0.17917682 0.190063   0.20581037 0.25407222]
-------------Round number:  293  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.503968253968254
client Accurancy:  0.45634920634920634
client Accurancy:  0.42063492063492064
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4253968253968254
Average Global Trainning Accurancy:  0.463265306122449
Average Global Trainning Loss:  1.4026021736819727
All users are selected
model: 0 tensor([0.2523, 0.2043, 0.1918, 0.1801, 0.1714], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0151, -0.0005,  0.0005,  0.0031,  0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1655, 0.2274, 0.1884, 0.1893, 0.2295], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0652, -0.0189, -0.0221, -0.0205,  0.0384],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1978, 0.2192, 0.1980, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0151, 0.0229, 0.0160, 0.0183, 0.0153],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1931, 0.1979, 0.2204, 0.2076], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0139, -0.0133, -0.0128, -0.0216, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1792, 0.1901, 0.2058, 0.2541], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0087, 0.0098, 0.0050, 0.0148, 0.0047]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19888106 0.23132865 0.21203901 0.18719466 0.17055662]
np_weight_alpha[1] [0.21255085 0.22963314 0.19211417 0.19142188 0.17427997]
np_weight_alpha[2] [0.19568251 0.19231394 0.22146463 0.1969965  0.19354239]
np_weight_alpha[3] [0.18182431 0.1925964  0.1967074  0.23018071 0.19869108]
np_weight_alpha[4] [0.1690944  0.17124002 0.2037874  0.17278785 0.28309035]
-------------Round number:  294  -------------
client Accurancy:  0.4246031746031746
client Accurancy:  0.5476190476190477
client Accurancy:  0.4603174603174603
client Accurancy:  0.4246031746031746
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.43492063492063493
Average Global Trainning Accurancy:  0.4707482993197279
Average Global Trainning Loss:  1.3709420340401786
All users are selected
model: 0 tensor([0.1989, 0.2313, 0.2120, 0.1872, 0.1706], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0680,  0.0169,  0.0036, -0.0119, -0.0117],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2126, 0.2296, 0.1921, 0.1914, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0146,  0.0019,  0.0026,  0.0018, -0.0114],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1957, 0.1923, 0.2215, 0.1970, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0186, 0.0183, 0.0190, 0.0165, 0.0141],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1818, 0.1926, 0.1967, 0.2302, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0204, -0.0153, -0.0176, -0.0085, -0.0213],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1691, 0.1712, 0.2038, 0.1728, 0.2831], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0472, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0088, -0.0063,  0.0174, -0.0210,  0.0507]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25747296 0.19809376 0.1922646  0.18349212 0.1686766 ]
np_weight_alpha[1] [0.15294282 0.22908676 0.18636398 0.1895811  0.24202538]
np_weight_alpha[2] [0.19424771 0.19125567 0.22046016 0.19754192 0.19649452]
np_weight_alpha[3] [0.1857103  0.19106025 0.19736096 0.22288771 0.20298082]
np_weight_alpha[4] [0.17109343 0.1864366  0.19489786 0.202236   0.24533603]
-------------Round number:  295  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.4722222222222222
client Accurancy:  0.4642857142857143
client Accurancy:  0.40476190476190477
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4246031746031746
Average Global Trainning Accurancy:  0.47585034013605443
Average Global Trainning Loss:  1.395650643069728
All users are selected
model: 0 tensor([0.2575, 0.1981, 0.1923, 0.1835, 0.1687], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0333, -0.0505, -0.0436, -0.0399, -0.0450],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1529, 0.2291, 0.1864, 0.1896, 0.2420], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0256, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1011, -0.0382, -0.0551, -0.0457,  0.0234],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1913, 0.2205, 0.1975, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0347, 0.0272, 0.0360, 0.0330, 0.0387],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1911, 0.1974, 0.2229, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0326, 0.0250, 0.0263, 0.0304, 0.0226],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1864, 0.1949, 0.2022, 0.2453], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0220, 0.0281, 0.0246, 0.0162, 0.0172]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25228608 0.20436333 0.19169514 0.18011339 0.17154205]
np_weight_alpha[1] [0.16617845 0.22835056 0.1875739  0.18883072 0.22906636]
np_weight_alpha[2] [0.19336191 0.1977698  0.21901706 0.19818714 0.1916641 ]
np_weight_alpha[3] [0.18103127 0.19309716 0.19804178 0.22039552 0.20743436]
np_weight_alpha[4] [0.17103091 0.1791606  0.19021    0.20570645 0.25389206]
-------------Round number:  296  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.503968253968254
client Accurancy:  0.4603174603174603
client Accurancy:  0.4087301587301587
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.4253968253968254
Average Global Trainning Accurancy:  0.46496598639455783
Average Global Trainning Loss:  1.398396145567602
All users are selected
model: 0 tensor([0.2523, 0.2044, 0.1917, 0.1801, 0.1715], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0159, 0.0002, 0.0008, 0.0035, 0.0058],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1662, 0.2284, 0.1876, 0.1888, 0.2291], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0651, -0.0186, -0.0237, -0.0218,  0.0374],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1978, 0.2190, 0.1982, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0146, 0.0226, 0.0158, 0.0184, 0.0153],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1931, 0.1980, 0.2204, 0.2074], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0137, -0.0128, -0.0217, -0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1792, 0.1902, 0.2057, 0.2539], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0268, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0095, 0.0106, 0.0059, 0.0153, 0.0051]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19797756 0.23058634 0.21337609 0.18791652 0.1701435 ]
np_weight_alpha[1] [0.21236658 0.22966976 0.19219564 0.19154732 0.17422065]
np_weight_alpha[2] [0.1958519  0.19237614 0.22135852 0.19690393 0.19350949]
np_weight_alpha[3] [0.18198738 0.19269812 0.19662842 0.22993678 0.19874933]
np_weight_alpha[4] [0.16840741 0.17060623 0.20296048 0.17327325 0.28475264]
-------------Round number:  297  -------------
client Accurancy:  0.42063492063492064
client Accurancy:  0.5476190476190477
client Accurancy:  0.4603174603174603
client Accurancy:  0.42063492063492064
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.4744897959183674
Average Global Trainning Loss:  1.3668628095769557
All users are selected
model: 0 tensor([0.1980, 0.2306, 0.2134, 0.1879, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0258, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0693,  0.0157,  0.0045, -0.0117, -0.0125],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2124, 0.2297, 0.1922, 0.1915, 0.1742], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0149,  0.0023,  0.0032,  0.0025, -0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1959, 0.1924, 0.2214, 0.1969, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0187, 0.0184, 0.0191, 0.0166, 0.0140],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1820, 0.1927, 0.1966, 0.2299, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0152, -0.0177, -0.0088, -0.0213],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1684, 0.1706, 0.2030, 0.1733, 0.2848], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0488, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0080, -0.0070,  0.0164, -0.0206,  0.0525]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25745067 0.19811149 0.19228895 0.18354817 0.16860074]
np_weight_alpha[1] [0.15350561 0.22939654 0.18617086 0.1888305  0.2420965 ]
np_weight_alpha[2] [0.19429606 0.19127601 0.2203543  0.19744955 0.19662403]
np_weight_alpha[3] [0.18577904 0.19100189 0.197265   0.22291346 0.20304061]
np_weight_alpha[4] [0.17113277 0.18645471 0.19503275 0.20226423 0.24511549]
-------------Round number:  298  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.47619047619047616
client Accurancy:  0.46825396825396826
client Accurancy:  0.4007936507936508
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4246031746031746
Average Global Trainning Accurancy:  0.4792517006802721
Average Global Trainning Loss:  1.391726456207483
All users are selected
model: 0 tensor([0.2575, 0.1981, 0.1923, 0.1835, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0330, -0.0508, -0.0438, -0.0403, -0.0456],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1535, 0.2294, 0.1862, 0.1888, 0.2421], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0256, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0993, -0.0369, -0.0543, -0.0453,  0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1913, 0.2204, 0.1974, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0344, 0.0267, 0.0355, 0.0325, 0.0385],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1910, 0.1973, 0.2229, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0328, 0.0254, 0.0265, 0.0311, 0.0231],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1865, 0.1950, 0.2023, 0.2451], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0210, 0.0275, 0.0240, 0.0155, 0.0164]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25164255 0.20438726 0.19169678 0.18039192 0.17188151]
np_weight_alpha[1] [0.16653326 0.22865851 0.18744372 0.1882562  0.22910827]
np_weight_alpha[2] [0.19331968 0.197858   0.21894512 0.19826584 0.19161132]
np_weight_alpha[3] [0.18128443 0.19304423 0.19813061 0.22009243 0.20744833]
np_weight_alpha[4] [0.17132813 0.17905048 0.19017182 0.2057342  0.25371543]
-------------Round number:  299  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.4642857142857143
client Accurancy:  0.4087301587301587
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42698412698412697
Average Global Trainning Accurancy:  0.46530612244897956
Average Global Trainning Loss:  1.3950610517644557
All users are selected
model: 0 tensor([0.2516, 0.2044, 0.1917, 0.1804, 0.1719], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0157, 0.0006, 0.0013, 0.0039, 0.0060],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1665, 0.2287, 0.1874, 0.1883, 0.2291], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0653, -0.0190, -0.0246, -0.0230,  0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1979, 0.2189, 0.1983, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0156, 0.0234, 0.0162, 0.0192, 0.0160],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1813, 0.1930, 0.1981, 0.2201, 0.2074], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0137, -0.0128, -0.0221, -0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1791, 0.1902, 0.2057, 0.2537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0093, 0.0102, 0.0057, 0.0151, 0.0056]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19968927 0.23014468 0.21180238 0.18756631 0.17079733]
np_weight_alpha[1] [0.21222122 0.22967182 0.19219767 0.1914153  0.174494  ]
np_weight_alpha[2] [0.19553532 0.19236483 0.22164151 0.19691285 0.19354545]
np_weight_alpha[3] [0.18211548 0.19252728 0.1966412  0.22983797 0.19887808]
np_weight_alpha[4] [0.1696108  0.17229387 0.20367002 0.17394443 0.28048092]
-------------Round number:  300  -------------
client Accurancy:  0.4246031746031746
client Accurancy:  0.5476190476190477
client Accurancy:  0.46825396825396826
client Accurancy:  0.4166666666666667
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.4741496598639456
Average Global Trainning Loss:  1.3667844188456633
All users are selected
model: 0 tensor([0.1997, 0.2301, 0.2118, 0.1876, 0.1708], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0679,  0.0148,  0.0023, -0.0128, -0.0124],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2122, 0.2297, 0.1922, 0.1914, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0148,  0.0022,  0.0033,  0.0021, -0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1924, 0.2216, 0.1969, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0178, 0.0180, 0.0185, 0.0162, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1821, 0.1925, 0.1966, 0.2298, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0162, -0.0182, -0.0095, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1696, 0.1723, 0.2037, 0.1739, 0.2805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0443, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0112, -0.0033,  0.0190, -0.0180,  0.0494]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25721577 0.1980377  0.19236915 0.18373033 0.16864699]
np_weight_alpha[1] [0.15372032 0.22995226 0.18555608 0.19029169 0.24047966]
np_weight_alpha[2] [0.19433832 0.19113638 0.22071205 0.19731916 0.19649407]
np_weight_alpha[3] [0.18593046 0.19120201 0.19715326 0.22284545 0.20286883]
np_weight_alpha[4] [0.17094243 0.18628715 0.1948841  0.20211497 0.24577133]
-------------Round number:  301  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.47619047619047616
client Accurancy:  0.4722222222222222
client Accurancy:  0.4007936507936508
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4261904761904762
Average Global Trainning Accurancy:  0.4806122448979592
Average Global Trainning Loss:  1.3869334941007654
All users are selected
model: 0 tensor([0.2572, 0.1980, 0.1924, 0.1837, 0.1686], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0325, -0.0502, -0.0428, -0.0395, -0.0449],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1537, 0.2300, 0.1856, 0.1903, 0.2405], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0249, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0977, -0.0349, -0.0534, -0.0423,  0.0244],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1911, 0.2207, 0.1973, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0251, 0.0344, 0.0309, 0.0367],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1859, 0.1912, 0.1972, 0.2228, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0259, 0.0266, 0.0311, 0.0232],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1863, 0.1949, 0.2021, 0.2458], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0198, 0.0265, 0.0229, 0.0146, 0.0164]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25160787 0.20446998 0.19157651 0.18039969 0.17194596]
np_weight_alpha[1] [0.16671072 0.22920792 0.18701    0.18937898 0.2276924 ]
np_weight_alpha[2] [0.19318448 0.1978308  0.21898702 0.19823661 0.19176105]
np_weight_alpha[3] [0.18127973 0.19295673 0.19809346 0.22032842 0.2073416 ]
np_weight_alpha[4] [0.17144085 0.17907472 0.1903241  0.20561992 0.25354046]
-------------Round number:  302  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.4642857142857143
client Accurancy:  0.4126984126984127
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.42857142857142855
Average Global Trainning Accurancy:  0.4683673469387755
Average Global Trainning Loss:  1.3896668726084183
All users are selected
model: 0 tensor([0.2516, 0.2045, 0.1916, 0.1804, 0.1719], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0158, 0.0010, 0.0014, 0.0043, 0.0062],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1667, 0.2292, 0.1870, 0.1894, 0.2277], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0652, -0.0188, -0.0254, -0.0221,  0.0349],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1932, 0.1978, 0.2190, 0.1982, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0145, 0.0224, 0.0156, 0.0183, 0.0153],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1813, 0.1930, 0.1981, 0.2203, 0.2073], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0140, -0.0136, -0.0126, -0.0218, -0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1791, 0.1903, 0.2056, 0.2535], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0099, 0.0110, 0.0065, 0.0157, 0.0059]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.20004232 0.22916348 0.21278466 0.18703786 0.17097168]
np_weight_alpha[1] [0.21206501 0.2298015  0.19233164 0.19141425 0.17438763]
np_weight_alpha[2] [0.19563845 0.19250488 0.22144365 0.19687174 0.1935413 ]
np_weight_alpha[3] [0.18200728 0.19255202 0.19659352 0.23001166 0.19883558]
np_weight_alpha[4] [0.16942133 0.17114048 0.20290756 0.17405364 0.282477  ]
-------------Round number:  303  -------------
client Accurancy:  0.42857142857142855
client Accurancy:  0.5515873015873016
client Accurancy:  0.4642857142857143
client Accurancy:  0.42063492063492064
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.47687074829931975
Average Global Trainning Loss:  1.3616083054315475
All users are selected
model: 0 tensor([0.2000, 0.2292, 0.2128, 0.1870, 0.1710], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0678,  0.0143,  0.0036, -0.0127, -0.0117],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2121, 0.2298, 0.1923, 0.1914, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0147,  0.0022,  0.0034,  0.0020, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1925, 0.2214, 0.1969, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0178, 0.0180, 0.0184, 0.0159, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1820, 0.1926, 0.1966, 0.2300, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0211, -0.0163, -0.0185, -0.0097, -0.0219],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1711, 0.2029, 0.1741, 0.2825], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0463, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0111, -0.0046,  0.0182, -0.0178,  0.0515]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25783756 0.19788715 0.19237801 0.18346569 0.16843157]
np_weight_alpha[1] [0.15356393 0.2295358  0.18490383 0.19021733 0.2417791 ]
np_weight_alpha[2] [0.19440304 0.19111574 0.22051471 0.19742702 0.19653946]
np_weight_alpha[3] [0.1857051  0.19118331 0.19724765 0.2230379  0.20282598]
np_weight_alpha[4] [0.17085339 0.18646102 0.19493565 0.2020592  0.24569073]
-------------Round number:  304  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.47619047619047616
client Accurancy:  0.4801587301587302
client Accurancy:  0.4007936507936508
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.48367346938775513
Average Global Trainning Loss:  1.3817638578869047
All users are selected
model: 0 tensor([0.2578, 0.1979, 0.1924, 0.1835, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0305, -0.0490, -0.0415, -0.0386, -0.0439],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1536, 0.2295, 0.1849, 0.1902, 0.2418], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0978, -0.0354, -0.0540, -0.0424,  0.0258],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1944, 0.1911, 0.2205, 0.1974, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0330, 0.0250, 0.0339, 0.0309, 0.0365],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1912, 0.1972, 0.2230, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0328, 0.0259, 0.0268, 0.0315, 0.0232],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1865, 0.1949, 0.2021, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0187, 0.0256, 0.0218, 0.0135, 0.0154]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25150082 0.20441346 0.1915457  0.1805508  0.17198917]
np_weight_alpha[1] [0.1665776  0.2288106  0.1864887  0.18929672 0.22882642]
np_weight_alpha[2] [0.19313695 0.1977898  0.21907398 0.19818991 0.19180936]
np_weight_alpha[3] [0.18143101 0.19300063 0.19805169 0.22011814 0.20739853]
np_weight_alpha[4] [0.17145619 0.17908248 0.19037895 0.2056874  0.25339493]
-------------Round number:  305  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.4642857142857143
client Accurancy:  0.4166666666666667
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.47210884353741495
Average Global Trainning Loss:  1.3854842620642007
All users are selected
model: 0 tensor([0.2515, 0.2044, 0.1915, 0.1806, 0.1720], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0167, 0.0015, 0.0015, 0.0043, 0.0066],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1666, 0.2288, 0.1865, 0.1893, 0.2288], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0645, -0.0184, -0.0257, -0.0215,  0.0370],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1978, 0.2191, 0.1982, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0137, 0.0213, 0.0154, 0.0180, 0.0149],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1814, 0.1930, 0.1981, 0.2201, 0.2074], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0142, -0.0129, -0.0222, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1791, 0.1904, 0.2057, 0.2534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0100, 0.0113, 0.0066, 0.0157, 0.0054]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19757468 0.22830436 0.21421413 0.18907051 0.17083628]
np_weight_alpha[1] [0.21187766 0.22966886 0.19281061 0.19151922 0.17412369]
np_weight_alpha[2] [0.19590323 0.19297655 0.22111174 0.19657446 0.193434  ]
np_weight_alpha[3] [0.18253791 0.1926625  0.19631319 0.22965248 0.19883391]
np_weight_alpha[4] [0.16904047 0.17002408 0.20194767 0.17360796 0.28537977]
-------------Round number:  306  -------------
client Accurancy:  0.42857142857142855
client Accurancy:  0.5515873015873016
client Accurancy:  0.46825396825396826
client Accurancy:  0.42063492063492064
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.4806122448979592
Average Global Trainning Loss:  1.3563893428465137
All users are selected
model: 0 tensor([0.1976, 0.2283, 0.2142, 0.1891, 0.1708], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0694,  0.0147,  0.0061, -0.0095, -0.0105],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2119, 0.2297, 0.1928, 0.1915, 0.1741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0146,  0.0018,  0.0036,  0.0019, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1959, 0.1930, 0.2211, 0.1966, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0176, 0.0180, 0.0178, 0.0153, 0.0129],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1825, 0.1927, 0.1963, 0.2297, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0211, -0.0169, -0.0193, -0.0106, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1690, 0.1700, 0.2019, 0.1736, 0.2854], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0492, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0106, -0.0058,  0.0170, -0.0184,  0.0543]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25822377 0.1977482  0.19236079 0.18341117 0.16825606]
np_weight_alpha[1] [0.15349106 0.23085435 0.18366396 0.19018243 0.24180815]
np_weight_alpha[2] [0.19443302 0.19123241 0.22033638 0.19733746 0.19666076]
np_weight_alpha[3] [0.18572609 0.19126445 0.1971508  0.22296986 0.20288888]
np_weight_alpha[4] [0.17087018 0.18634178 0.19504437 0.20208286 0.24566089]
-------------Round number:  307  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.47619047619047616
client Accurancy:  0.48412698412698413
client Accurancy:  0.3968253968253968
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.48673469387755103
Average Global Trainning Loss:  1.3772023311277637
All users are selected
model: 0 tensor([0.2582, 0.1977, 0.1924, 0.1834, 0.1683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0288, -0.0480, -0.0401, -0.0375, -0.0429],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1535, 0.2309, 0.1837, 0.1902, 0.2418], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0978, -0.0338, -0.0550, -0.0423,  0.0260],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1944, 0.1912, 0.2203, 0.1973, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0324, 0.0244, 0.0330, 0.0297, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1913, 0.1972, 0.2230, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0265, 0.0269, 0.0322, 0.0237],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1863, 0.1950, 0.2021, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0178, 0.0246, 0.0211, 0.0127, 0.0144]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25137943 0.20456436 0.1914138  0.18063632 0.1720061 ]
np_weight_alpha[1] [0.16651246 0.22994749 0.185514   0.18923157 0.22879446]
np_weight_alpha[2] [0.19298698 0.19771802 0.21905605 0.19843678 0.19180219]
np_weight_alpha[3] [0.18151622 0.19302323 0.198305   0.21977578 0.20737983]
np_weight_alpha[4] [0.17144592 0.17905253 0.19036362 0.20566198 0.253476  ]
-------------Round number:  308  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42777777777777776
Average Global Trainning Accurancy:  0.4744897959183674
Average Global Trainning Loss:  1.3821276606345663
All users are selected
model: 0 tensor([0.2514, 0.2046, 0.1914, 0.1806, 0.1720], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0183, 0.0034, 0.0031, 0.0061, 0.0080],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1665, 0.2299, 0.1855, 0.1892, 0.2288], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0649, -0.0176, -0.0273, -0.0222,  0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1977, 0.2191, 0.1984, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0138, 0.0214, 0.0158, 0.0188, 0.0148],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1815, 0.1930, 0.1983, 0.2198, 0.2074], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0154, -0.0148, -0.0131, -0.0234, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1791, 0.1904, 0.2057, 0.2535], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0090, 0.0105, 0.0057, 0.0151, 0.0055]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.1978347  0.2270817  0.21457084 0.18833713 0.1721756 ]
np_weight_alpha[1] [0.21174006 0.2295347  0.19294162 0.19156858 0.17421506]
np_weight_alpha[2] [0.19586354 0.19309917 0.22091897 0.19638042 0.19373783]
np_weight_alpha[3] [0.18242243 0.19268723 0.19610617 0.22992058 0.19886366]
np_weight_alpha[4] [0.17079723 0.17058893 0.20394732 0.17408341 0.28058308]
-------------Round number:  309  -------------
client Accurancy:  0.43253968253968256
client Accurancy:  0.5436507936507936
client Accurancy:  0.46825396825396826
client Accurancy:  0.42063492063492064
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.47993197278911565
Average Global Trainning Loss:  1.3579687832164116
All users are selected
model: 0 tensor([0.1978, 0.2271, 0.2146, 0.1883, 0.1722], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0690,  0.0136,  0.0068, -0.0100, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2117, 0.2295, 0.1929, 0.1916, 0.1742], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0141,  0.0015,  0.0035,  0.0018, -0.0114],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1959, 0.1931, 0.2209, 0.1964, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0179, 0.0184, 0.0178, 0.0153, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1824, 0.1927, 0.1961, 0.2299, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0219, -0.0175, -0.0203, -0.0111, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1706, 0.2039, 0.1741, 0.2806], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0445, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0131, -0.0047,  0.0197, -0.0174,  0.0496]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2583417  0.1978418  0.19223431 0.1833998  0.16818243]
np_weight_alpha[1] [0.1541309  0.23108058 0.18319498 0.18962337 0.24197017]
np_weight_alpha[2] [0.194339   0.19123086 0.22044438 0.19742534 0.19656041]
np_weight_alpha[3] [0.18572798 0.19119146 0.19723916 0.22305083 0.20279062]
np_weight_alpha[4] [0.17063943 0.1863476  0.19490139 0.202019   0.2460926 ]
-------------Round number:  310  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.4722222222222222
client Accurancy:  0.48412698412698413
client Accurancy:  0.39285714285714285
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.48775510204081635
Average Global Trainning Loss:  1.372293692867772
All users are selected
model: 0 tensor([0.2583, 0.1978, 0.1922, 0.1834, 0.1682], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0280, -0.0474, -0.0400, -0.0372, -0.0429],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1541, 0.2311, 0.1832, 0.1896, 0.2420], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0965, -0.0332, -0.0550, -0.0424,  0.0265],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1912, 0.2204, 0.1974, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0321, 0.0243, 0.0330, 0.0297, 0.0357],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1912, 0.1972, 0.2231, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0263, 0.0269, 0.0321, 0.0236],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1706, 0.1863, 0.1949, 0.2020, 0.2461], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0168, 0.0240, 0.0205, 0.0123, 0.0146]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2509827  0.20443249 0.19155508 0.18069728 0.17233242]
np_weight_alpha[1] [0.16689517 0.23017505 0.18516009 0.18880191 0.22896773]
np_weight_alpha[2] [0.19310795 0.19769077 0.21899706 0.1984704  0.19173379]
np_weight_alpha[3] [0.18154253 0.1929801  0.19833836 0.21989815 0.20724088]
np_weight_alpha[4] [0.17178278 0.17916593 0.19032438 0.20553787 0.25318903]
-------------Round number:  311  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42777777777777776
Average Global Trainning Accurancy:  0.4782312925170068
Average Global Trainning Loss:  1.3778864231239372
All users are selected
model: 0 tensor([0.2510, 0.2044, 0.1916, 0.1807, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0185, 0.0043, 0.0039, 0.0065, 0.0090],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1669, 0.2302, 0.1852, 0.1888, 0.2290], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0647, -0.0180, -0.0283, -0.0236,  0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1977, 0.2190, 0.1985, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0143, 0.0216, 0.0160, 0.0190, 0.0151],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1815, 0.1930, 0.1983, 0.2199, 0.2072], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0162, -0.0156, -0.0135, -0.0230, -0.0072],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1718, 0.1792, 0.1903, 0.2055, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0265, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0094, 0.0108, 0.0058, 0.0151, 0.0051]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19960077 0.22569606 0.2137564  0.18984604 0.17110081]
np_weight_alpha[1] [0.21131508 0.22955756 0.1930063  0.19193675 0.1741843 ]
np_weight_alpha[2] [0.19581564 0.19314179 0.2209332  0.19643216 0.1936772 ]
np_weight_alpha[3] [0.1828122  0.19304527 0.19618313 0.22918335 0.19877608]
np_weight_alpha[4] [0.1694345  0.16971168 0.20350952 0.17392676 0.2834175 ]
-------------Round number:  312  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.5396825396825397
client Accurancy:  0.46825396825396826
client Accurancy:  0.42063492063492064
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.4792517006802721
Average Global Trainning Loss:  1.3505339538159014
All users are selected
model: 0 tensor([0.1996, 0.2257, 0.2138, 0.1898, 0.1711], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0668,  0.0124,  0.0061, -0.0084, -0.0102],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2113, 0.2296, 0.1930, 0.1919, 0.1742], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0138,  0.0017,  0.0035,  0.0022, -0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1958, 0.1931, 0.2209, 0.1964, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0181, 0.0186, 0.0180, 0.0156, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1828, 0.1930, 0.1962, 0.2292, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0209, -0.0165, -0.0195, -0.0112, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1694, 0.1697, 0.2035, 0.1739, 0.2834], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0475, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0104, -0.0068,  0.0182, -0.0184,  0.0523]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25790086 0.197795   0.19229154 0.18347195 0.16854067]
np_weight_alpha[1] [0.1551519  0.22998539 0.18315767 0.1884319  0.2432731 ]
np_weight_alpha[2] [0.19435127 0.1912689  0.2203903  0.19735716 0.19663228]
np_weight_alpha[3] [0.18574642 0.19122168 0.19717288 0.22308849 0.2027705 ]
np_weight_alpha[4] [0.17107475 0.1866379  0.19501677 0.20198506 0.24528547]
-------------Round number:  313  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.4880952380952381
client Accurancy:  0.4880952380952381
client Accurancy:  0.39285714285714285
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.4884353741496599
Average Global Trainning Loss:  1.369112474091199
All users are selected
model: 0 tensor([0.2579, 0.1978, 0.1923, 0.1835, 0.1685], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0273, -0.0467, -0.0390, -0.0363, -0.0417],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1552, 0.2300, 0.1832, 0.1884, 0.2433], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0965, -0.0352, -0.0559, -0.0444,  0.0268],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1944, 0.1913, 0.2204, 0.1974, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0324, 0.0246, 0.0330, 0.0299, 0.0360],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1912, 0.1972, 0.2231, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0333, 0.0268, 0.0272, 0.0322, 0.0242],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1866, 0.1950, 0.2020, 0.2453], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0167, 0.0237, 0.0201, 0.0119, 0.0133]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25075892 0.20459488 0.19150238 0.18079509 0.17234871]
np_weight_alpha[1] [0.16760308 0.22916982 0.1851262  0.18790309 0.23019786]
np_weight_alpha[2] [0.19303767 0.19758876 0.21922518 0.19838044 0.19176802]
np_weight_alpha[3] [0.18164395 0.1928798  0.19824937 0.22019535 0.20703161]
np_weight_alpha[4] [0.17177644 0.1792712  0.1903577  0.205356   0.25323868]
-------------Round number:  314  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5119047619047619
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.47959183673469385
Average Global Trainning Loss:  1.374168925382653
All users are selected
model: 0 tensor([0.2508, 0.2046, 0.1915, 0.1808, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0192, 0.0053, 0.0049, 0.0071, 0.0097],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1676, 0.2292, 0.1851, 0.1879, 0.2302], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0646, -0.0195, -0.0290, -0.0251,  0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1976, 0.2192, 0.1984, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0154, 0.0224, 0.0170, 0.0198, 0.0160],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1816, 0.1929, 0.1982, 0.2202, 0.2070], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0173, -0.0166, -0.0145, -0.0232, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1718, 0.1793, 0.1904, 0.2054, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0092, 0.0105, 0.0056, 0.0147, 0.0057]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.19990686 0.22497107 0.21260846 0.19103234 0.17148131]
np_weight_alpha[1] [0.21130058 0.22936805 0.19300039 0.19193268 0.17439829]
np_weight_alpha[2] [0.19553827 0.19313452 0.22112256 0.19645281 0.19375177]
np_weight_alpha[3] [0.18312946 0.1930105  0.1962178  0.22868815 0.19895412]
np_weight_alpha[4] [0.17016543 0.17079994 0.20412931 0.17552099 0.2793843 ]
-------------Round number:  315  -------------
client Accurancy:  0.4365079365079365
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.42063492063492064
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.4806122448979592
Average Global Trainning Loss:  1.3518280652104593
All users are selected
model: 0 tensor([0.1999, 0.2250, 0.2126, 0.1910, 0.1715], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0660,  0.0122,  0.0056, -0.0068, -0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2113, 0.2294, 0.1930, 0.1919, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0127,  0.0003,  0.0024,  0.0011, -0.0125],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1931, 0.2211, 0.1965, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0173, 0.0180, 0.0175, 0.0150, 0.0130],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1831, 0.1930, 0.1962, 0.2287, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0207, -0.0165, -0.0195, -0.0118, -0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1702, 0.1708, 0.2041, 0.1755, 0.2794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0433, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0126, -0.0043,  0.0201, -0.0153,  0.0490]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2579685  0.1978425  0.19221537 0.18356694 0.16840671]
np_weight_alpha[1] [0.15532677 0.23141587 0.18292822 0.18816458 0.24216452]
np_weight_alpha[2] [0.19427505 0.19121465 0.22046997 0.19735932 0.196681  ]
np_weight_alpha[3] [0.1858622  0.19117115 0.19717962 0.22325113 0.20253591]
np_weight_alpha[4] [0.17082265 0.18653736 0.19503248 0.20173916 0.24586834]
-------------Round number:  316  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.4801587301587302
client Accurancy:  0.4880952380952381
client Accurancy:  0.38492063492063494
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42698412698412697
Average Global Trainning Accurancy:  0.4887755102040816
Average Global Trainning Loss:  1.3658018773915817
All users are selected
model: 0 tensor([0.2580, 0.1978, 0.1922, 0.1836, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0258, -0.0453, -0.0376, -0.0348, -0.0404],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1553, 0.2314, 0.1829, 0.1882, 0.2422], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0963, -0.0337, -0.0562, -0.0446,  0.0256],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1912, 0.2205, 0.1974, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0324, 0.0247, 0.0331, 0.0300, 0.0363],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1859, 0.1912, 0.1972, 0.2233, 0.2025], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0265, 0.0270, 0.0320, 0.0236],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1865, 0.1950, 0.2017, 0.2459], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0153, 0.0225, 0.0192, 0.0106, 0.0127]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2507408  0.20462443 0.19148193 0.180779   0.1723739 ]
np_weight_alpha[1] [0.16770785 0.23045379 0.18495792 0.18768662 0.22919393]
np_weight_alpha[2] [0.19302113 0.19763231 0.21935341 0.19839105 0.19160213]
np_weight_alpha[3] [0.18161339 0.192808   0.19826353 0.22027607 0.20703907]
np_weight_alpha[4] [0.17181082 0.17929973 0.19020371 0.20534089 0.25334486]
-------------Round number:  317  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5119047619047619
client Accurancy:  0.4603174603174603
client Accurancy:  0.4166666666666667
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.48027210884353744
Average Global Trainning Loss:  1.36943741363733
All users are selected
model: 0 tensor([0.2507, 0.2046, 0.1915, 0.1808, 0.1724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0203, 0.0063, 0.0060, 0.0081, 0.0106],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1677, 0.2305, 0.1850, 0.1877, 0.2292], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0652, -0.0188, -0.0299, -0.0261,  0.0344],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1976, 0.2194, 0.1984, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0157, 0.0228, 0.0173, 0.0203, 0.0158],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1816, 0.1928, 0.1983, 0.2203, 0.2070], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0175, -0.0169, -0.0145, -0.0233, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1718, 0.1793, 0.1902, 0.2053, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0088, 0.0103, 0.0050, 0.0143, 0.0061]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24337931 0.20723003 0.19439106 0.18231976 0.17267987]
np_weight_alpha[1] [0.21123232 0.22923945 0.19296746 0.1919723  0.1745885 ]
np_weight_alpha[2] [0.19546425 0.19309163 0.22118746 0.19628654 0.19397011]
np_weight_alpha[3] [0.18308623 0.19303134 0.19604579 0.22873564 0.19910096]
np_weight_alpha[4] [0.1710938  0.17130479 0.20617479 0.1764489  0.27497777]
-------------Round number:  318  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.4166666666666667
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.48775510204081635
Average Global Trainning Loss:  1.3328586708120749
All users are selected
model: 0 tensor([0.2434, 0.2072, 0.1944, 0.1823, 0.1727], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0204, -0.0063, -0.0134, -0.0165, -0.0101],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2112, 0.2292, 0.1930, 0.1920, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0117, -0.0007,  0.0013,  0.0002, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1931, 0.2212, 0.1963, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0191, 0.0196, 0.0195, 0.0167, 0.0149],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1831, 0.1930, 0.1960, 0.2287, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0169, -0.0200, -0.0124, -0.0224],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1713, 0.2062, 0.1764, 0.2750], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0394, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0140, -0.0029,  0.0228, -0.0136,  0.0457]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25485528 0.1982574  0.19269806 0.18419391 0.16999537]
np_weight_alpha[1] [0.15539895 0.23199308 0.18384987 0.18812932 0.24062881]
np_weight_alpha[2] [0.19414096 0.191373   0.22039983 0.19729179 0.19679447]
np_weight_alpha[3] [0.1856657  0.19117416 0.1971028  0.22349289 0.2025644 ]
np_weight_alpha[4] [0.17113349 0.186437   0.19512987 0.201817   0.24548267]
-------------Round number:  319  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.48412698412698413
client Accurancy:  0.49206349206349204
client Accurancy:  0.3888888888888889
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.4884353741496599
Average Global Trainning Loss:  1.3625790550595238
All users are selected
model: 0 tensor([0.2549, 0.1983, 0.1927, 0.1842, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0279, -0.0439, -0.0358, -0.0331, -0.0377],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1554, 0.2320, 0.1838, 0.1881, 0.2406], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0253, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0965, -0.0332, -0.0554, -0.0450,  0.0237],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1941, 0.1914, 0.2204, 0.1973, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0323, 0.0246, 0.0327, 0.0297, 0.0360],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1912, 0.1971, 0.2235, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0267, 0.0271, 0.0325, 0.0241],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1864, 0.1951, 0.2018, 0.2455], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0147, 0.0216, 0.0182, 0.0100, 0.0116]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25086257 0.20474769 0.19124343 0.18081054 0.17233576]
np_weight_alpha[1] [0.16778629 0.23099811 0.18565366 0.18771048 0.22785145]
np_weight_alpha[2] [0.19279693 0.19758148 0.21935052 0.19844912 0.19182196]
np_weight_alpha[3] [0.18175763 0.19288269 0.19832404 0.22019581 0.2068398 ]
np_weight_alpha[4] [0.171923   0.17928971 0.19042496 0.20517501 0.25318733]
-------------Round number:  320  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5158730158730159
client Accurancy:  0.4642857142857143
client Accurancy:  0.4166666666666667
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.48401360544217686
Average Global Trainning Loss:  1.3650327513818028
All users are selected
model: 0 tensor([0.2509, 0.2047, 0.1912, 0.1808, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0210, 0.0074, 0.0066, 0.0091, 0.0114],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1678, 0.2310, 0.1857, 0.1877, 0.2279], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0649, -0.0180, -0.0292, -0.0260,  0.0332],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1976, 0.2194, 0.1984, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0165, 0.0235, 0.0184, 0.0214, 0.0172],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1818, 0.1929, 0.1983, 0.2202, 0.2068], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0174, -0.0149, -0.0244, -0.0093],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1719, 0.1793, 0.1904, 0.2052, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0075, 0.0090, 0.0039, 0.0130, 0.0040]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24365345 0.2071387  0.19440173 0.18214044 0.17266567]
np_weight_alpha[1] [0.21112174 0.22913331 0.19315784 0.1920485  0.17453861]
np_weight_alpha[2] [0.19550917 0.19330552 0.22113024 0.1962028  0.19385228]
np_weight_alpha[3] [0.18288508 0.19306435 0.19595301 0.2292748  0.19882275]
np_weight_alpha[4] [0.17034526 0.17046426 0.20443225 0.17559755 0.27916068]
-------------Round number:  321  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.42063492063492064
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.49047619047619045
Average Global Trainning Loss:  1.3239649766156463
All users are selected
model: 0 tensor([0.2437, 0.2071, 0.1944, 0.1821, 0.1727], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0191, -0.0053, -0.0125, -0.0157, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2111, 0.2291, 0.1932, 0.1920, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0108, -0.0016,  0.0006, -0.0006, -0.0140],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1933, 0.2211, 0.1962, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0195, 0.0202, 0.0200, 0.0171, 0.0154],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1829, 0.1931, 0.1960, 0.2293, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0220, -0.0176, -0.0208, -0.0125, -0.0233],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1703, 0.1705, 0.2044, 0.1756, 0.2792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0432, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0133, -0.0039,  0.0210, -0.0144,  0.0496]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2549168  0.19818687 0.19281794 0.18430033 0.16977806]
np_weight_alpha[1] [0.15547185 0.23206916 0.18346412 0.18808424 0.24091065]
np_weight_alpha[2] [0.19427028 0.19144528 0.22026187 0.19729505 0.19672745]
np_weight_alpha[3] [0.1857932  0.19123684 0.19710575 0.22341567 0.20244847]
np_weight_alpha[4] [0.17104049 0.18648213 0.19508275 0.2016767  0.24571785]
-------------Round number:  322  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.47619047619047616
client Accurancy:  0.4880952380952381
client Accurancy:  0.39285714285714285
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42698412698412697
Average Global Trainning Accurancy:  0.49047619047619045
Average Global Trainning Loss:  1.358379504145408
All users are selected
model: 0 tensor([0.2549, 0.1982, 0.1928, 0.1843, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0273, -0.0436, -0.0354, -0.0327, -0.0377],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1555, 0.2321, 0.1835, 0.1881, 0.2409], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0961, -0.0329, -0.0555, -0.0448,  0.0244],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1943, 0.1914, 0.2203, 0.1973, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0318, 0.0241, 0.0320, 0.0290, 0.0354],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1912, 0.1971, 0.2234, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0343, 0.0279, 0.0282, 0.0339, 0.0251],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1865, 0.1951, 0.2017, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0133, 0.0205, 0.0171, 0.0086, 0.0107]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25057283 0.20478341 0.19127794 0.18091233 0.17245348]
np_weight_alpha[1] [0.16782746 0.23106582 0.18535519 0.18767634 0.22807518]
np_weight_alpha[2] [0.19280854 0.19754852 0.21939844 0.19848892 0.19175555]
np_weight_alpha[3] [0.18183917 0.19293585 0.19836779 0.21993144 0.20692578]
np_weight_alpha[4] [0.17201851 0.17922185 0.1903587  0.20524482 0.2531561 ]
-------------Round number:  323  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5158730158730159
client Accurancy:  0.4642857142857143
client Accurancy:  0.4126984126984127
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.48333333333333334
Average Global Trainning Loss:  1.3614663052721088
All users are selected
model: 0 tensor([0.2506, 0.2048, 0.1913, 0.1809, 0.1725], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0222, 0.0087, 0.0076, 0.0102, 0.0125],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1678, 0.2311, 0.1854, 0.1877, 0.2281], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0653, -0.0185, -0.0302, -0.0267,  0.0328],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1975, 0.2194, 0.1985, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0168, 0.0239, 0.0190, 0.0220, 0.0176],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1818, 0.1929, 0.1984, 0.2199, 0.2069], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0182, -0.0178, -0.0151, -0.0250, -0.0096],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1720, 0.1792, 0.1904, 0.2052, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0071, 0.0084, 0.0034, 0.0126, 0.0038]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24330378 0.20703046 0.19456068 0.18234988 0.17275518]
np_weight_alpha[1] [0.21097542 0.22906266 0.19322224 0.19211295 0.17462668]
np_weight_alpha[2] [0.19565634 0.19335619 0.22103725 0.19608186 0.1938683 ]
np_weight_alpha[3] [0.18308851 0.19312161 0.19583948 0.22910382 0.19884656]
np_weight_alpha[4] [0.17047161 0.17115386 0.20488453 0.17551321 0.27797675]
-------------Round number:  324  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.4166666666666667
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.4914965986394558
Average Global Trainning Loss:  1.3217529296875
All users are selected
model: 0 tensor([0.2433, 0.2070, 0.1946, 0.1823, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0188, -0.0049, -0.0119, -0.0152, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2110, 0.2291, 0.1932, 0.1921, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0102, -0.0024,  0.0003, -0.0008, -0.0143],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1957, 0.1934, 0.2210, 0.1961, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0195, 0.0200, 0.0194, 0.0167, 0.0151],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1831, 0.1931, 0.1958, 0.2291, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0216, -0.0171, -0.0206, -0.0125, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1705, 0.1712, 0.2049, 0.1755, 0.2780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0420, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0132, -0.0031,  0.0216, -0.0146,  0.0486]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2547008  0.19816451 0.19276705 0.18437026 0.16999744]
np_weight_alpha[1] [0.1558176  0.23416775 0.18301609 0.18685815 0.24014041]
np_weight_alpha[2] [0.19419242 0.1914028  0.22047597 0.1972617  0.19666706]
np_weight_alpha[3] [0.18583418 0.19103989 0.19707261 0.22348253 0.20257086]
np_weight_alpha[4] [0.17122522 0.18643811 0.19502883 0.20181182 0.24549605]
-------------Round number:  325  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.47619047619047616
client Accurancy:  0.4880952380952381
client Accurancy:  0.39285714285714285
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.42698412698412697
Average Global Trainning Accurancy:  0.49115646258503404
Average Global Trainning Loss:  1.3553270820046768
All users are selected
model: 0 tensor([0.2547, 0.1982, 0.1928, 0.1844, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0262, -0.0425, -0.0344, -0.0317, -0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1558, 0.2342, 0.1830, 0.1869, 0.2401], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0959, -0.0310, -0.0563, -0.0464,  0.0232],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1942, 0.1914, 0.2205, 0.1973, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0323, 0.0247, 0.0329, 0.0298, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1910, 0.1971, 0.2235, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0345, 0.0280, 0.0287, 0.0343, 0.0256],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1712, 0.1864, 0.1950, 0.2018, 0.2455], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0120, 0.0191, 0.0155, 0.0073, 0.0090]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2503655  0.20474285 0.19137028 0.18104991 0.1724715 ]
np_weight_alpha[1] [0.16799508 0.23294817 0.18499175 0.18672903 0.22733594]
np_weight_alpha[2] [0.19289565 0.19760342 0.21936677 0.19833331 0.19180092]
np_weight_alpha[3] [0.18198214 0.19296245 0.19821653 0.21994165 0.20689723]
np_weight_alpha[4] [0.17202516 0.1791819  0.19040337 0.20523056 0.25315902]
-------------Round number:  326  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5198412698412699
client Accurancy:  0.46825396825396826
client Accurancy:  0.4087301587301587
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.4857142857142857
Average Global Trainning Loss:  1.357826616974915
All users are selected
model: 0 tensor([0.2504, 0.2047, 0.1914, 0.1810, 0.1725], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0229, 0.0096, 0.0085, 0.0109, 0.0130],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1680, 0.2329, 0.1850, 0.1867, 0.2273], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0646, -0.0163, -0.0304, -0.0276,  0.0320],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1976, 0.2194, 0.1983, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0169, 0.0239, 0.0192, 0.0218, 0.0175],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1820, 0.1930, 0.1982, 0.2199, 0.2069], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0189, -0.0186, -0.0161, -0.0253, -0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1720, 0.1792, 0.1904, 0.2052, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0066, 0.0081, 0.0032, 0.0123, 0.0044]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24306527 0.20682876 0.1945517  0.18248446 0.17306976]
np_weight_alpha[1] [0.21065494 0.2289774  0.19325288 0.19226165 0.17485306]
np_weight_alpha[2] [0.19562347 0.19337155 0.22082543 0.19615398 0.19402558]
np_weight_alpha[3] [0.18321794 0.19323008 0.1959161  0.22860284 0.19903305]
np_weight_alpha[4] [0.17228858 0.17205943 0.205855   0.17658126 0.27321574]
-------------Round number:  327  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5317460317460317
client Accurancy:  0.4642857142857143
client Accurancy:  0.42063492063492064
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.49047619047619045
Average Global Trainning Loss:  1.324342647215136
All users are selected
model: 0 tensor([0.2431, 0.2068, 0.1946, 0.1825, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0187, -0.0046, -0.0117, -0.0147, -0.0076],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2107, 0.2290, 0.1933, 0.1923, 0.1749], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 9.8260e-03, -2.5278e-03,  3.4355e-05, -9.6215e-04, -1.4356e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1934, 0.2208, 0.1962, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0186, 0.0194, 0.0191, 0.0162, 0.0146],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1932, 0.1959, 0.2286, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0218, -0.0174, -0.0208, -0.0131, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1723, 0.1721, 0.2059, 0.1766, 0.2732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0375, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0162, -0.0015,  0.0232, -0.0128,  0.0442]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25466523 0.1980693  0.19300278 0.18443243 0.16983026]
np_weight_alpha[1] [0.15653452 0.23362911 0.18328793 0.18698244 0.23956592]
np_weight_alpha[2] [0.1944545  0.19148324 0.22004148 0.19726378 0.19675691]
np_weight_alpha[3] [0.18591093 0.19117488 0.19707486 0.22337078 0.20246853]
np_weight_alpha[4] [0.17085491 0.18640879 0.19508143 0.2017187  0.24593613]
-------------Round number:  328  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.47619047619047616
client Accurancy:  0.4880952380952381
client Accurancy:  0.39285714285714285
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.42777777777777776
Average Global Trainning Accurancy:  0.4925170068027211
Average Global Trainning Loss:  1.3506331878454507
All users are selected
model: 0 tensor([0.2547, 0.1981, 0.1930, 0.1844, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0255, -0.0419, -0.0335, -0.0309, -0.0362],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1565, 0.2336, 0.1833, 0.1870, 0.2396], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0946, -0.0312, -0.0555, -0.0458,  0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1915, 0.2200, 0.1973, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0321, 0.0243, 0.0319, 0.0295, 0.0353],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1859, 0.1912, 0.1971, 0.2234, 0.2025], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0355, 0.0290, 0.0296, 0.0344, 0.0264],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1864, 0.1951, 0.2017, 0.2459], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0099, 0.0176, 0.0140, 0.0060, 0.0086]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2502406  0.20469001 0.1913459  0.18096185 0.17276163]
np_weight_alpha[1] [0.20986824 0.22472887 0.19730963 0.19145215 0.17664117]
np_weight_alpha[2] [0.19284615 0.1975616  0.21938753 0.19818483 0.19201991]
np_weight_alpha[3] [0.1818541  0.19286165 0.19804978 0.22050059 0.2067339 ]
np_weight_alpha[4] [0.17237513 0.17932864 0.19065174 0.20509401 0.2525505 ]
-------------Round number:  329  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5357142857142857
client Accurancy:  0.4642857142857143
client Accurancy:  0.4087301587301587
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.5003401360544217
Average Global Trainning Loss:  1.3376322013180273
All users are selected
model: 0 tensor([0.2502, 0.2047, 0.1913, 0.1810, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0241, 0.0107, 0.0097, 0.0121, 0.0144],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2099, 0.2247, 0.1973, 0.1915, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0275, -0.0224, -0.0282, -0.0274],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1976, 0.2194, 0.1982, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0181, 0.0249, 0.0205, 0.0230, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1819, 0.1929, 0.1980, 0.2205, 0.2067], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0186, -0.0183, -0.0157, -0.0241, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1724, 0.1793, 0.1907, 0.2051, 0.2526], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0080, 0.0094, 0.0044, 0.0131, 0.0048]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24295752 0.20692506 0.19451897 0.18248095 0.17311743]
np_weight_alpha[1] [0.20759545 0.22736037 0.19322051 0.19316953 0.17865415]
np_weight_alpha[2] [0.1955967  0.19358863 0.22072153 0.19605735 0.19403577]
np_weight_alpha[3] [0.18322182 0.19333835 0.19581929 0.22853278 0.19908774]
np_weight_alpha[4] [0.17104231 0.17088032 0.20470035 0.17713971 0.2762373 ]
-------------Round number:  330  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5357142857142857
client Accurancy:  0.46825396825396826
client Accurancy:  0.42063492063492064
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.4928571428571429
Average Global Trainning Loss:  1.3205044078178145
All users are selected
model: 0 tensor([0.2430, 0.2069, 0.1945, 0.1825, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0189, -0.0047, -0.0119, -0.0149, -0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2274, 0.1932, 0.1932, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0070, -0.0038,  0.0006,  0.0007, -0.0097],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1936, 0.2207, 0.1961, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0192, 0.0185, 0.0157, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1933, 0.1958, 0.2285, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0226, -0.0179, -0.0217, -0.0141, -0.0238],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1709, 0.2047, 0.1771, 0.2762], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0402, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0153, -0.0021,  0.0228, -0.0115,  0.0482]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25459516 0.19811276 0.19295068 0.18443587 0.16990551]
np_weight_alpha[1] [0.16845977 0.24337941 0.1839916  0.18310772 0.2210615 ]
np_weight_alpha[2] [0.19439311 0.19148205 0.22013207 0.19730088 0.19669187]
np_weight_alpha[3] [0.18590221 0.19102556 0.19710901 0.22349131 0.20247193]
np_weight_alpha[4] [0.17109147 0.1865012  0.19505486 0.20168531 0.24566719]
-------------Round number:  331  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.48412698412698413
client Accurancy:  0.4880952380952381
client Accurancy:  0.3888888888888889
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.49829931972789115
Average Global Trainning Loss:  1.336064303651148
All users are selected
model: 0 tensor([0.2546, 0.1981, 0.1930, 0.1844, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0251, -0.0416, -0.0332, -0.0306, -0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1685, 0.2434, 0.1840, 0.1831, 0.2211], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0812, -0.0207, -0.0545, -0.0499,  0.0030],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1915, 0.2201, 0.1973, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0325, 0.0248, 0.0323, 0.0298, 0.0356],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1859, 0.1910, 0.1971, 0.2235, 0.2025], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0364, 0.0299, 0.0305, 0.0354, 0.0275],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1865, 0.1951, 0.2017, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0096, 0.0173, 0.0136, 0.0056, 0.0079]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2500492  0.20477165 0.19126824 0.18098605 0.1729249 ]
np_weight_alpha[1] [0.2086175  0.2241279  0.19722013 0.19195323 0.17808126]
np_weight_alpha[2] [0.19274946 0.19745515 0.21951808 0.19828236 0.1919949 ]
np_weight_alpha[3] [0.18187161 0.19278243 0.19814901 0.2205602  0.20663668]
np_weight_alpha[4] [0.1725177  0.1793046  0.19062972 0.20501527 0.25253272]
-------------Round number:  332  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5357142857142857
client Accurancy:  0.4642857142857143
client Accurancy:  0.4087301587301587
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.5020408163265306
Average Global Trainning Loss:  1.3352196103050595
All users are selected
model: 0 tensor([0.2500, 0.2048, 0.1913, 0.1810, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0242, 0.0111, 0.0099, 0.0123, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2241, 0.1972, 0.1920, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0247, -0.0274, -0.0218, -0.0270, -0.0252],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1975, 0.2195, 0.1983, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0177, 0.0243, 0.0202, 0.0226, 0.0183],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1819, 0.1928, 0.1981, 0.2206, 0.2066], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0190, -0.0189, -0.0160, -0.0245, -0.0108],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1793, 0.1906, 0.2050, 0.2525], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0077, 0.0091, 0.0042, 0.0130, 0.0052]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24288549 0.20681332 0.19440965 0.18249135 0.17340028]
np_weight_alpha[1] [0.20758592 0.22733109 0.19325131 0.19317129 0.17866036]
np_weight_alpha[2] [0.19547494 0.19361681 0.22073616 0.1960555  0.19411662]
np_weight_alpha[3] [0.18322048 0.19337817 0.1958166  0.22856091 0.19902386]
np_weight_alpha[4] [0.17216271 0.17179899 0.2054491  0.17730269 0.27328655]
-------------Round number:  333  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5277777777777778
client Accurancy:  0.4642857142857143
client Accurancy:  0.42063492063492064
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.4925170068027211
Average Global Trainning Loss:  1.3208255274766156
All users are selected
model: 0 tensor([0.2429, 0.2068, 0.1944, 0.1825, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0188, -0.0046, -0.0119, -0.0148, -0.0070],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2273, 0.1933, 0.1932, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0071, -0.0039,  0.0008,  0.0009, -0.0094],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1936, 0.2207, 0.1961, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0172, 0.0185, 0.0178, 0.0151, 0.0137],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1934, 0.1958, 0.2286, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0229, -0.0180, -0.0217, -0.0143, -0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1722, 0.1718, 0.2054, 0.1773, 0.2733], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0374, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0175, -0.0004,  0.0241, -0.0107,  0.0451]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25469542 0.19806626 0.19306074 0.1845461  0.16963151]
np_weight_alpha[1] [0.16828136 0.24476181 0.18381631 0.18302019 0.2201204 ]
np_weight_alpha[2] [0.19452707 0.19148174 0.22011188 0.19720556 0.19667377]
np_weight_alpha[3] [0.18603164 0.19102001 0.1970184  0.22353755 0.20239237]
np_weight_alpha[4] [0.170666   0.18624873 0.19498715 0.2016016  0.24649659]
-------------Round number:  334  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.48412698412698413
client Accurancy:  0.49206349206349204
client Accurancy:  0.39285714285714285
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.5003401360544217
Average Global Trainning Loss:  1.3306618203922194
All users are selected
model: 0 tensor([0.2547, 0.1981, 0.1931, 0.1845, 0.1696], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0246, -0.0416, -0.0330, -0.0305, -0.0362],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1683, 0.2448, 0.1838, 0.1830, 0.2201], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0815, -0.0192, -0.0547, -0.0501,  0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1915, 0.2201, 0.1972, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0327, 0.0250, 0.0324, 0.0298, 0.0358],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1860, 0.1910, 0.1970, 0.2235, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0374, 0.0309, 0.0314, 0.0367, 0.0284],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1707, 0.1862, 0.1950, 0.2016, 0.2465], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0080, 0.0158, 0.0124, 0.0045, 0.0077]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24969454 0.20481293 0.19139662 0.18114793 0.17294803]
np_weight_alpha[1] [0.20860924 0.22397186 0.19717124 0.19198935 0.17825826]
np_weight_alpha[2] [0.19286065 0.19739294 0.21945898 0.19833629 0.19195113]
np_weight_alpha[3] [0.18201849 0.19279617 0.1982064  0.22035894 0.20662001]
np_weight_alpha[4] [0.17710692 0.15772752 0.17903584 0.22569901 0.26043075]
-------------Round number:  335  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5396825396825397
client Accurancy:  0.4642857142857143
client Accurancy:  0.4087301587301587
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.43492063492063493
Average Global Trainning Accurancy:  0.5081632653061224
Average Global Trainning Loss:  1.3186895461309525
All users are selected
model: 0 tensor([0.2497, 0.2048, 0.1914, 0.1811, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0244, 0.0114, 0.0100, 0.0126, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2240, 0.1972, 0.1920, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0240, -0.0269, -0.0214, -0.0264, -0.0243],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1974, 0.2195, 0.1983, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0178, 0.0243, 0.0205, 0.0232, 0.0185],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1820, 0.1928, 0.1982, 0.2204, 0.2066], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0191, -0.0191, -0.0158, -0.0250, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1771, 0.1577, 0.1790, 0.2257, 0.2604], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0353, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0107, -0.0140, -0.0085,  0.0335,  0.0134]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24248299 0.20672303 0.19463608 0.18258256 0.17357531]
np_weight_alpha[1] [0.20748083 0.2273179  0.19343328 0.19323437 0.17853363]
np_weight_alpha[2] [0.19569509 0.19380525 0.22056979 0.19577281 0.19415711]
np_weight_alpha[3] [0.18328294 0.19343784 0.19553071 0.22865067 0.19909787]
np_weight_alpha[4] [0.1732416  0.177881   0.19252212 0.19708307 0.25927225]
-------------Round number:  336  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.49115646258503404
Average Global Trainning Loss:  1.3241941698554422
All users are selected
model: 0 tensor([0.2425, 0.2067, 0.1946, 0.1826, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0189, -0.0047, -0.0116, -0.0147, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2075, 0.2273, 0.1934, 0.1932, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0059, -0.0049, -0.0003, -0.0002, -0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1957, 0.1938, 0.2206, 0.1958, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0172, 0.0184, 0.0172, 0.0144, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1833, 0.1934, 0.1955, 0.2287, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0220, -0.0171, -0.0213, -0.0132, -0.0232],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1732, 0.1779, 0.1925, 0.1971, 0.2593], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0200, 0.0074, 0.0127, 0.0109, 0.0326]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25432724 0.1980713  0.19302873 0.18455619 0.17001662]
np_weight_alpha[1] [0.16852868 0.24381344 0.18321006 0.18264578 0.22180206]
np_weight_alpha[2] [0.19445655 0.19149004 0.22025025 0.19730797 0.19649512]
np_weight_alpha[3] [0.18601854 0.19099088 0.1971225  0.22333668 0.20253141]
np_weight_alpha[4] [0.17078575 0.18613628 0.19512594 0.20134163 0.24661039]
-------------Round number:  337  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.4880952380952381
client Accurancy:  0.4880952380952381
client Accurancy:  0.3968253968253968
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.5040816326530613
Average Global Trainning Loss:  1.3283830915178572
All users are selected
model: 0 tensor([0.2543, 0.1981, 0.1930, 0.1846, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0246, -0.0414, -0.0328, -0.0305, -0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1685, 0.2438, 0.1832, 0.1826, 0.2218], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0816, -0.0207, -0.0556, -0.0510,  0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1915, 0.2203, 0.1973, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0338, 0.0262, 0.0335, 0.0309, 0.0365],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1860, 0.1910, 0.1971, 0.2233, 0.2025], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0383, 0.0318, 0.0324, 0.0374, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1861, 0.1951, 0.2013, 0.2466], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0061, 0.0139, 0.0108, 0.0027, 0.0065]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2495069  0.20478538 0.19126628 0.18122572 0.17321576]
np_weight_alpha[1] [0.20856723 0.22405177 0.19706456 0.1920628  0.17825367]
np_weight_alpha[2] [0.19269975 0.19726086 0.2196267  0.19832623 0.1920865 ]
np_weight_alpha[3] [0.18209833 0.1928777  0.198199   0.2203945  0.20643045]
np_weight_alpha[4] [0.17830326 0.15854944 0.17926905 0.22611122 0.25776702]
-------------Round number:  338  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5436507936507936
client Accurancy:  0.46825396825396826
client Accurancy:  0.40476190476190477
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.508843537414966
Average Global Trainning Loss:  1.3180388366284013
All users are selected
model: 0 tensor([0.2495, 0.2048, 0.1913, 0.1812, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0235, 0.0109, 0.0097, 0.0127, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2241, 0.1971, 0.1921, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0272, -0.0220, -0.0266, -0.0248],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1973, 0.2196, 0.1983, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0185, 0.0248, 0.0211, 0.0240, 0.0193],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1821, 0.1929, 0.1982, 0.2204, 0.2064], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0182, -0.0185, -0.0154, -0.0253, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1783, 0.1585, 0.1793, 0.2261, 0.2578], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0332, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0117, -0.0134, -0.0085,  0.0337,  0.0106]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2428834  0.20682652 0.19449547 0.18216778 0.17362687]
np_weight_alpha[1] [0.20760022 0.22728142 0.19343308 0.19307074 0.17861453]
np_weight_alpha[2] [0.19557716 0.19380467 0.22080955 0.19561192 0.19419666]
np_weight_alpha[3] [0.18283553 0.19322926 0.19534796 0.2294586  0.19912869]
np_weight_alpha[4] [0.17324825 0.1778909  0.19258238 0.19710621 0.25917226]
-------------Round number:  339  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.49523809523809526
Average Global Trainning Loss:  1.320567103794643
All users are selected
model: 0 tensor([0.2429, 0.2068, 0.1945, 0.1822, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0182, -0.0043, -0.0116, -0.0148, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2273, 0.1934, 0.1931, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0056, -0.0055, -0.0006, -0.0008, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1938, 0.2208, 0.1956, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0185, 0.0174, 0.0142, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1828, 0.1932, 0.1953, 0.2295, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0224, -0.0173, -0.0214, -0.0124, -0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1732, 0.1779, 0.1926, 0.1971, 0.2592], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0202, 0.0075, 0.0127, 0.0111, 0.0322]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25429398 0.19807331 0.19312865 0.18459019 0.16991386]
np_weight_alpha[1] [0.168124   0.24451979 0.18280093 0.18330507 0.22125024]
np_weight_alpha[2] [0.19456068 0.1914108  0.22023924 0.19727975 0.19650957]
np_weight_alpha[3] [0.18607432 0.19101824 0.1970946  0.22340927 0.2024036 ]
np_weight_alpha[4] [0.17065394 0.18608944 0.19512731 0.20122841 0.24690092]
-------------Round number:  340  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.4880952380952381
client Accurancy:  0.4880952380952381
client Accurancy:  0.3968253968253968
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.5040816326530613
Average Global Trainning Loss:  1.3250434304581207
All users are selected
model: 0 tensor([0.2543, 0.1981, 0.1931, 0.1846, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0240, -0.0407, -0.0319, -0.0299, -0.0354],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1681, 0.2445, 0.1828, 0.1833, 0.2213], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0821, -0.0200, -0.0561, -0.0504,  0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1914, 0.2202, 0.1973, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0344, 0.0264, 0.0336, 0.0312, 0.0368],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1861, 0.1910, 0.1971, 0.2234, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0384, 0.0320, 0.0326, 0.0377, 0.0298],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1707, 0.1861, 0.1951, 0.2012, 0.2469], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0050, 0.0128, 0.0098, 0.0017, 0.0059]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24956422 0.20477082 0.19112563 0.18133576 0.17320363]
np_weight_alpha[1] [0.20856662 0.22399524 0.19704458 0.19203757 0.17835596]
np_weight_alpha[2] [0.19254778 0.1972317  0.21980454 0.19833699 0.19207896]
np_weight_alpha[3] [0.1822153  0.19285424 0.19821356 0.22036491 0.20635198]
np_weight_alpha[4] [0.17885412 0.15916634 0.17932291 0.22626084 0.25639576]
-------------Round number:  341  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5515873015873016
client Accurancy:  0.4722222222222222
client Accurancy:  0.4007936507936508
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.5091836734693878
Average Global Trainning Loss:  1.31647567230017
All users are selected
model: 0 tensor([0.2496, 0.2048, 0.1911, 0.1813, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0246, 0.0119, 0.0101, 0.0132, 0.0149],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2240, 0.1970, 0.1920, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0238, -0.0266, -0.0216, -0.0263, -0.0244],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1972, 0.2198, 0.1983, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0173, 0.0238, 0.0212, 0.0232, 0.0182],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1822, 0.1929, 0.1982, 0.2204, 0.2064], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0194, -0.0196, -0.0163, -0.0256, -0.0121],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1789, 0.1592, 0.1793, 0.2263, 0.2564], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0321, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0127, -0.0123, -0.0082,  0.0342,  0.0103]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24250436 0.20655692 0.19470271 0.18248878 0.17374715]
np_weight_alpha[1] [0.20731023 0.22707558 0.19360949 0.19324741 0.17875724]
np_weight_alpha[2] [0.19578363 0.19398554 0.22007334 0.19569537 0.19446208]
np_weight_alpha[3] [0.18316521 0.1934166  0.19544172 0.22869262 0.19928394]
np_weight_alpha[4] [0.17330633 0.17800549 0.19285369 0.19729458 0.25853994]
-------------Round number:  342  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.4965986394557823
Average Global Trainning Loss:  1.3207150829081633
All users are selected
model: 0 tensor([0.2425, 0.2066, 0.1947, 0.1825, 0.1737], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0190, -0.0050, -0.0118, -0.0151, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2073, 0.2271, 0.1936, 0.1932, 0.1788], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0037, -0.0075, -0.0019, -0.0022, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1958, 0.1940, 0.2201, 0.1957, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0177, 0.0192, 0.0169, 0.0148, 0.0144],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1934, 0.1954, 0.2287, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0213, -0.0162, -0.0205, -0.0126, -0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1733, 0.1780, 0.1929, 0.1973, 0.2585], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0209, 0.0084, 0.0138, 0.0122, 0.0323]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2541563  0.19803396 0.19310692 0.18466176 0.17004111]
np_weight_alpha[1] [0.16888618 0.2465434  0.18169738 0.1823193  0.22055367]
np_weight_alpha[2] [0.1945245  0.1913207  0.22046812 0.19721338 0.19647324]
np_weight_alpha[3] [0.18612315 0.1909601  0.19702946 0.22366184 0.20222546]
np_weight_alpha[4] [0.17077114 0.18610625 0.19509797 0.20105307 0.24697167]
-------------Round number:  343  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.4880952380952381
client Accurancy:  0.4880952380952381
client Accurancy:  0.3968253968253968
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.5061224489795918
Average Global Trainning Loss:  1.3203983644238946
All users are selected
model: 0 tensor([0.2542, 0.1980, 0.1931, 0.1847, 0.1700], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0238, -0.0404, -0.0314, -0.0292, -0.0348],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1689, 0.2465, 0.1817, 0.1823, 0.2206], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0811, -0.0177, -0.0569, -0.0510,  0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1913, 0.2205, 0.1972, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0352, 0.0271, 0.0344, 0.0320, 0.0376],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1861, 0.1910, 0.1970, 0.2237, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0381, 0.0316, 0.0322, 0.0373, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1861, 0.1951, 0.2011, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0043, 0.0120, 0.0089, 0.0005, 0.0051]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24965435 0.20487079 0.19107038 0.18121937 0.1731852 ]
np_weight_alpha[1] [0.20856802 0.22404596 0.19709057 0.19194639 0.17834911]
np_weight_alpha[2] [0.1924974  0.19725157 0.22000988 0.19820794 0.19203319]
np_weight_alpha[3] [0.18209027 0.19270997 0.19808184 0.22055423 0.20656367]
np_weight_alpha[4] [0.17835754 0.15864743 0.1791973  0.22814092 0.25565684]
-------------Round number:  344  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5476190476190477
client Accurancy:  0.46825396825396826
client Accurancy:  0.39285714285714285
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.5102040816326531
Average Global Trainning Loss:  1.3116438469919218
All users are selected
model: 0 tensor([0.2497, 0.2049, 0.1911, 0.1812, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0245, 0.0119, 0.0101, 0.0133, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2240, 0.1971, 0.1919, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0239, -0.0268, -0.0216, -0.0264, -0.0244],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1973, 0.2200, 0.1982, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0246, 0.0215, 0.0239, 0.0191],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1821, 0.1927, 0.1981, 0.2206, 0.2066], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0196, -0.0200, -0.0167, -0.0263, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1784, 0.1586, 0.1792, 0.2281, 0.2557], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0325, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0117, -0.0130, -0.0082,  0.0362,  0.0091]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24265538 0.20655914 0.19451238 0.18228947 0.17398362]
np_weight_alpha[1] [0.20731972 0.22723597 0.19355743 0.19315855 0.17872836]
np_weight_alpha[2] [0.19557853 0.19392733 0.22072743 0.1955965  0.19417015]
np_weight_alpha[3] [0.18294665 0.19331819 0.19533865 0.22931083 0.19908564]
np_weight_alpha[4] [0.1735708  0.17799374 0.1925864  0.19704327 0.25880575]
-------------Round number:  345  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5003401360544217
Average Global Trainning Loss:  1.3152217527636054
All users are selected
model: 0 tensor([0.2427, 0.2066, 0.1945, 0.1823, 0.1740], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0184, -0.0046, -0.0119, -0.0151, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2073, 0.2272, 0.1936, 0.1932, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0033, -0.0080, -0.0026, -0.0027, -0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1939, 0.2207, 0.1956, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0172, 0.0190, 0.0176, 0.0147, 0.0141],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1829, 0.1933, 0.1953, 0.2293, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0212, -0.0157, -0.0201, -0.0114, -0.0216],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1736, 0.1780, 0.1926, 0.1970, 0.2588], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0210, 0.0083, 0.0134, 0.0118, 0.0323]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25401813 0.1979107  0.19326584 0.18475153 0.17005381]
np_weight_alpha[1] [0.16827218 0.24709743 0.18209085 0.18215469 0.22038493]
np_weight_alpha[2] [0.19468406 0.19137876 0.2203314  0.19721238 0.19639337]
np_weight_alpha[3] [0.1862116  0.19086666 0.19702786 0.22364362 0.20225026]
np_weight_alpha[4] [0.17076066 0.1860543  0.1950149  0.20108052 0.24708961]
-------------Round number:  346  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.49206349206349204
client Accurancy:  0.4880952380952381
client Accurancy:  0.3968253968253968
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.43253968253968256
Average Global Trainning Accurancy:  0.507482993197279
Average Global Trainning Loss:  1.3165817156940902
All users are selected
model: 0 tensor([0.2540, 0.1979, 0.1933, 0.1848, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0232, -0.0399, -0.0307, -0.0289, -0.0341],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1683, 0.2471, 0.1821, 0.1822, 0.2204], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0811, -0.0166, -0.0559, -0.0507,  0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1947, 0.1914, 0.2203, 0.1972, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0269, 0.0340, 0.0315, 0.0371],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1909, 0.1970, 0.2236, 0.2023], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0378, 0.0313, 0.0320, 0.0376, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1861, 0.1950, 0.2011, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 3.7185e-03,  1.1299e-02,  8.2072e-03, -3.6112e-05,  4.5408e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24944791 0.20484488 0.19110394 0.18147783 0.1731255 ]
np_weight_alpha[1] [0.20854591 0.22404024 0.19700666 0.19201168 0.17839542]
np_weight_alpha[2] [0.19251242 0.19717364 0.21991958 0.1983145  0.19207984]
np_weight_alpha[3] [0.18236607 0.19278587 0.19819477 0.22016633 0.20648693]
np_weight_alpha[4] [0.17808434 0.15905    0.17970419 0.22763015 0.25553134]
-------------Round number:  347  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5555555555555556
client Accurancy:  0.4722222222222222
client Accurancy:  0.3968253968253968
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5105442176870748
Average Global Trainning Loss:  1.308254859561012
All users are selected
model: 0 tensor([0.2494, 0.2048, 0.1911, 0.1815, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0247, 0.0123, 0.0104, 0.0138, 0.0147],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2085, 0.2240, 0.1970, 0.1920, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0237, -0.0266, -0.0220, -0.0262, -0.0241],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1972, 0.2199, 0.1983, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0186, 0.0248, 0.0223, 0.0247, 0.0198],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1824, 0.1928, 0.1982, 0.2202, 0.2065], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0201, -0.0207, -0.0173, -0.0275, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1781, 0.1591, 0.1797, 0.2276, 0.2555], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0321, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0113, -0.0126, -0.0078,  0.0354,  0.0089]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24256924 0.20647392 0.19460407 0.1823046  0.17404822]
np_weight_alpha[1] [0.20723096 0.22713214 0.19389427 0.19314161 0.17860106]
np_weight_alpha[2] [0.19568607 0.19427414 0.22041735 0.19548878 0.19413362]
np_weight_alpha[3] [0.18294166 0.1932898  0.19522654 0.22932461 0.1992174 ]
np_weight_alpha[4] [0.17362246 0.17786226 0.19254903 0.19716555 0.25880066]
-------------Round number:  348  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.4087301587301587
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5010204081632653
Average Global Trainning Loss:  1.3133313237404336
All users are selected
model: 0 tensor([0.2426, 0.2065, 0.1946, 0.1823, 0.1740], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0182, -0.0045, -0.0116, -0.0149, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2072, 0.2271, 0.1939, 0.1931, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0034, -0.0080, -0.0019, -0.0026, -0.0133],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1957, 0.1943, 0.2204, 0.1955, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0178, 0.0200, 0.0176, 0.0151, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1829, 0.1933, 0.1952, 0.2293, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0212, -0.0158, -0.0202, -0.0116, -0.0213],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1736, 0.1779, 0.1925, 0.1972, 0.2588], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0201, 0.0073, 0.0127, 0.0114, 0.0318]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25380474 0.19794321 0.19327427 0.1847444  0.1702334 ]
np_weight_alpha[1] [0.16859366 0.24756    0.17999446 0.18242644 0.22142544]
np_weight_alpha[2] [0.19466278 0.19119251 0.22050221 0.19719294 0.19644962]
np_weight_alpha[3] [0.18619277 0.1909245  0.197006   0.22379676 0.20207997]
np_weight_alpha[4] [0.17094715 0.18616682 0.19507809 0.20093623 0.24687174]
-------------Round number:  349  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.49603174603174605
client Accurancy:  0.4880952380952381
client Accurancy:  0.3888888888888889
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.5102040816326531
Average Global Trainning Loss:  1.313798595610119
All users are selected
model: 0 tensor([0.2538, 0.1979, 0.1933, 0.1847, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0228, -0.0395, -0.0303, -0.0282, -0.0337],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1686, 0.2476, 0.1800, 0.1824, 0.2214], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0806, -0.0159, -0.0577, -0.0501,  0.0034],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1947, 0.1912, 0.2205, 0.1972, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0355, 0.0274, 0.0345, 0.0323, 0.0377],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1909, 0.1970, 0.2238, 0.2021], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0375, 0.0311, 0.0317, 0.0366, 0.0285],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1862, 0.1951, 0.2009, 0.2469], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0030,  0.0106,  0.0075, -0.0007,  0.0039]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24925366 0.20494945 0.1911451  0.18131906 0.17333275]
np_weight_alpha[1] [0.20862097 0.22406384 0.1969232  0.19189933 0.1784926 ]
np_weight_alpha[2] [0.19254515 0.19703335 0.22019438 0.19810887 0.1921183 ]
np_weight_alpha[3] [0.18217279 0.19265284 0.19797963 0.22086076 0.20633404]
np_weight_alpha[4] [0.17850663 0.15929286 0.17973854 0.2275414  0.25492054]
-------------Round number:  350  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5634920634920635
client Accurancy:  0.46825396825396826
client Accurancy:  0.3968253968253968
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.5119047619047619
Average Global Trainning Loss:  1.3046298695259353
All users are selected
model: 0 tensor([0.2493, 0.2049, 0.1911, 0.1813, 0.1733], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0244, 0.0119, 0.0100, 0.0131, 0.0142],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2241, 0.1969, 0.1919, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0268, -0.0228, -0.0268, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1970, 0.2202, 0.1981, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0196, 0.0254, 0.0236, 0.0254, 0.0208],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1822, 0.1927, 0.1980, 0.2209, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0208, -0.0174, -0.0267, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1785, 0.1593, 0.1797, 0.2275, 0.2549], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0315, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0114, -0.0123, -0.0077,  0.0353,  0.0084]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24213096 0.20653862 0.19462758 0.1823906  0.17431232]
np_weight_alpha[1] [0.20728092 0.22685298 0.1940926  0.19316049 0.17861298]
np_weight_alpha[2] [0.19569123 0.1944725  0.22030239 0.19545317 0.19408076]
np_weight_alpha[3] [0.18301618 0.19330451 0.19518997 0.22928324 0.19920602]
np_weight_alpha[4] [0.17385407 0.17786384 0.19251993 0.19717765 0.2585845 ]
-------------Round number:  351  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5396825396825397
client Accurancy:  0.4722222222222222
client Accurancy:  0.4007936507936508
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.5006802721088436
Average Global Trainning Loss:  1.3101163903061224
All users are selected
model: 0 tensor([0.2421, 0.2065, 0.1946, 0.1824, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0185, -0.0047, -0.0116, -0.0149, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2073, 0.2269, 0.1941, 0.1932, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0029, -0.0086, -0.0021, -0.0029, -0.0135],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1957, 0.1945, 0.2203, 0.1955, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0177, 0.0200, 0.0172, 0.0148, 0.0143],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1830, 0.1933, 0.1952, 0.2293, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0150, -0.0194, -0.0108, -0.0205],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1739, 0.1779, 0.1925, 0.1972, 0.2586], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0202, 0.0072, 0.0125, 0.0112, 0.0312]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25361726 0.19811423 0.19321826 0.18479125 0.17025892]
np_weight_alpha[1] [0.16909826 0.24874552 0.17918977 0.18215823 0.22080825]
np_weight_alpha[2] [0.1945916  0.19117501 0.22064103 0.19722033 0.19637199]
np_weight_alpha[3] [0.18623428 0.19089487 0.19703527 0.22378053 0.20205504]
np_weight_alpha[4] [0.17095731 0.18607342 0.19499315 0.20090397 0.24707213]
-------------Round number:  352  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.49603174603174605
client Accurancy:  0.4880952380952381
client Accurancy:  0.39285714285714285
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.5119047619047619
Average Global Trainning Loss:  1.3091066113945578
All users are selected
model: 0 tensor([0.2536, 0.1981, 0.1932, 0.1848, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0229, -0.0396, -0.0306, -0.0285, -0.0340],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1691, 0.2487, 0.1792, 0.1822, 0.2208], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0803, -0.0151, -0.0587, -0.0506,  0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1912, 0.2206, 0.1972, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0355, 0.0276, 0.0347, 0.0325, 0.0380],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1909, 0.1970, 0.2238, 0.2021], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0384, 0.0321, 0.0327, 0.0376, 0.0295],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1861, 0.1950, 0.2009, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0023,  0.0099,  0.0071, -0.0013,  0.0036]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2488743  0.20497978 0.1912195  0.18144928 0.17347713]
np_weight_alpha[1] [0.20855343 0.22413933 0.19688505 0.19184576 0.17857645]
np_weight_alpha[2] [0.1926018  0.19696386 0.22033057 0.1981376  0.19196616]
np_weight_alpha[3] [0.18228668 0.19256884 0.19801635 0.22080837 0.20631973]
np_weight_alpha[4] [0.17918506 0.15977825 0.17943764 0.22766338 0.25393564]
-------------Round number:  353  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5595238095238095
client Accurancy:  0.47619047619047616
client Accurancy:  0.4007936507936508
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5119047619047619
Average Global Trainning Loss:  1.3021636340082907
All users are selected
model: 0 tensor([0.2489, 0.2050, 0.1912, 0.1814, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0239, 0.0120, 0.0101, 0.0129, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2241, 0.1969, 0.1918, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0238, -0.0265, -0.0225, -0.0267, -0.0238],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1970, 0.2203, 0.1981, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0201, 0.0255, 0.0241, 0.0255, 0.0211],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1823, 0.1926, 0.1980, 0.2208, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0211, -0.0217, -0.0182, -0.0267, -0.0135],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1792, 0.1598, 0.1794, 0.2277, 0.2539], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0307, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0123, -0.0116, -0.0080,  0.0355,  0.0065]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24228376 0.20641682 0.19452359 0.18265113 0.17412478]
np_weight_alpha[1] [0.20715041 0.22701912 0.19414045 0.19336319 0.17832683]
np_weight_alpha[2] [0.1955869  0.19452585 0.22019857 0.1957227  0.19396596]
np_weight_alpha[3] [0.18333662 0.19355375 0.19547956 0.2286105  0.19901952]
np_weight_alpha[4] [0.17354354 0.17747901 0.1923228  0.19696459 0.25969008]
-------------Round number:  354  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5396825396825397
client Accurancy:  0.4722222222222222
client Accurancy:  0.39285714285714285
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5034013605442177
Average Global Trainning Loss:  1.3039534173044218
All users are selected
model: 0 tensor([0.2423, 0.2064, 0.1945, 0.1827, 0.1741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0182, -0.0047, -0.0118, -0.0147, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2072, 0.2270, 0.1941, 0.1934, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0020, -0.0092, -0.0029, -0.0035, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1945, 0.2202, 0.1957, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0195, 0.0167, 0.0147, 0.0137],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1833, 0.1936, 0.1955, 0.2286, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0194, -0.0141, -0.0184, -0.0110, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1735, 0.1775, 0.1923, 0.1970, 0.2597], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0204, 0.0073, 0.0130, 0.0117, 0.0332]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.253488   0.19803302 0.19330148 0.18483722 0.17034024]
np_weight_alpha[1] [0.16913751 0.24716002 0.17933851 0.18140328 0.22296065]
np_weight_alpha[2] [0.19467525 0.19124466 0.22056486 0.19713633 0.1963789 ]
np_weight_alpha[3] [0.18624239 0.19087605 0.19695045 0.22394344 0.20198767]
np_weight_alpha[4] [0.17107704 0.18624161 0.19501646 0.20082429 0.24684066]
-------------Round number:  355  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.49603174603174605
client Accurancy:  0.48412698412698413
client Accurancy:  0.39285714285714285
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.513265306122449
Average Global Trainning Loss:  1.3062955064838435
All users are selected
model: 0 tensor([0.2535, 0.1980, 0.1933, 0.1848, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0233, -0.0397, -0.0305, -0.0284, -0.0339],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1691, 0.2472, 0.1793, 0.1814, 0.2230], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0805, -0.0169, -0.0587, -0.0515,  0.0044],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1947, 0.1912, 0.2206, 0.1971, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0367, 0.0288, 0.0355, 0.0335, 0.0390],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1909, 0.1970, 0.2239, 0.2020], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0386, 0.0322, 0.0327, 0.0378, 0.0295],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1711, 0.1862, 0.1950, 0.2008, 0.2468], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0016,  0.0091,  0.0061, -0.0023,  0.0025]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24912374 0.20496958 0.191158   0.1813746  0.17337415]
np_weight_alpha[1] [0.20861767 0.22423944 0.1968065  0.1918071  0.17852929]
np_weight_alpha[2] [0.19254476 0.19687398 0.22046196 0.19811517 0.19200416]
np_weight_alpha[3] [0.18222593 0.19254214 0.19799016 0.22091238 0.20632944]
np_weight_alpha[4] [0.17821789 0.15948442 0.17943215 0.22802028 0.25484532]
-------------Round number:  356  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5595238095238095
client Accurancy:  0.4722222222222222
client Accurancy:  0.39285714285714285
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5146258503401361
Average Global Trainning Loss:  1.297236560639881
All users are selected
model: 0 tensor([0.2491, 0.2050, 0.1912, 0.1814, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0248, 0.0125, 0.0106, 0.0135, 0.0147],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2242, 0.1968, 0.1918, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0238, -0.0264, -0.0227, -0.0267, -0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1969, 0.2205, 0.1981, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0203, 0.0257, 0.0243, 0.0261, 0.0214],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1822, 0.1925, 0.1980, 0.2209, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0214, -0.0220, -0.0183, -0.0274, -0.0140],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1782, 0.1595, 0.1794, 0.2280, 0.2548], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0317, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0107, -0.0123, -0.0084,  0.0354,  0.0075]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24209975 0.20645592 0.19453606 0.1825664  0.17434192]
np_weight_alpha[1] [0.20718531 0.22700083 0.19420744 0.19327015 0.17833626]
np_weight_alpha[2] [0.19559114 0.19459198 0.2204185  0.19540252 0.1939959 ]
np_weight_alpha[3] [0.18321016 0.19343856 0.19515054 0.22905518 0.1991456 ]
np_weight_alpha[4] [0.17384952 0.17756791 0.1924183  0.19708066 0.2590836 ]
-------------Round number:  357  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5396825396825397
client Accurancy:  0.4722222222222222
client Accurancy:  0.3888888888888889
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5051020408163265
Average Global Trainning Loss:  1.3017443598533163
All users are selected
model: 0 tensor([0.2421, 0.2065, 0.1945, 0.1826, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0180, -0.0033, -0.0107, -0.0138, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2072, 0.2270, 0.1942, 0.1933, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0022, -0.0095, -0.0032, -0.0038, -0.0152],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1946, 0.2204, 0.1954, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0153, 0.0177, 0.0149, 0.0127, 0.0121],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1934, 0.1952, 0.2291, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0194, -0.0141, -0.0185, -0.0105, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1738, 0.1776, 0.1924, 0.1971, 0.2591], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0218, 0.0082, 0.0141, 0.0127, 0.0333]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2542388  0.19767356 0.19322199 0.18478295 0.17008266]
np_weight_alpha[1] [0.16750117 0.24760167 0.17959008 0.18157363 0.22373353]
np_weight_alpha[2] [0.19463588 0.19136506 0.22075859 0.197041   0.19619942]
np_weight_alpha[3] [0.18624692 0.19085352 0.19685645 0.22399186 0.20205124]
np_weight_alpha[4] [0.17083229 0.18635128 0.19483106 0.20089068 0.24709469]
-------------Round number:  358  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.49603174603174605
client Accurancy:  0.49206349206349204
client Accurancy:  0.3888888888888889
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.5149659863945578
Average Global Trainning Loss:  1.3015565210459183
All users are selected
model: 0 tensor([0.2542, 0.1977, 0.1932, 0.1848, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0220, -0.0397, -0.0305, -0.0285, -0.0340],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1675, 0.2476, 0.1796, 0.1816, 0.2237], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0818, -0.0162, -0.0581, -0.0510,  0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1914, 0.2208, 0.1970, 0.1962], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0366, 0.0290, 0.0360, 0.0335, 0.0388],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1909, 0.1969, 0.2240, 0.2021], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0388, 0.0326, 0.0331, 0.0386, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1864, 0.1948, 0.2009, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0003,  0.0082,  0.0048, -0.0033,  0.0019]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24879178 0.20484723 0.1913354  0.18161309 0.17341244]
np_weight_alpha[1] [0.20857958 0.2242844  0.19684283 0.19180925 0.1784839 ]
np_weight_alpha[2] [0.192705   0.1969254  0.22017695 0.19810602 0.19208659]
np_weight_alpha[3] [0.18244977 0.19259456 0.19798416 0.22055215 0.20641935]
np_weight_alpha[4] [0.17924531 0.15933327 0.18054485 0.22831514 0.2525614 ]
-------------Round number:  359  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5595238095238095
client Accurancy:  0.4801587301587302
client Accurancy:  0.39285714285714285
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5163265306122449
Average Global Trainning Loss:  1.2952352718431122
All users are selected
model: 0 tensor([0.2488, 0.2048, 0.1913, 0.1816, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0236, 0.0120, 0.0099, 0.0126, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2243, 0.1968, 0.1918, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0251, -0.0216, -0.0256, -0.0230],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1969, 0.2202, 0.1981, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0205, 0.0255, 0.0242, 0.0261, 0.0212],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1824, 0.1926, 0.1980, 0.2206, 0.2064], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0219, -0.0225, -0.0186, -0.0277, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1792, 0.1593, 0.1805, 0.2283, 0.2526], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0301, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0244, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0116, -0.0125, -0.0073,  0.0357,  0.0062]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24206619 0.20593321 0.19450754 0.18283355 0.17465945]
np_weight_alpha[1] [0.20662987 0.22692108 0.19437882 0.19345151 0.17861864]
np_weight_alpha[2] [0.19554695 0.19474916 0.22020054 0.19530876 0.19419459]
np_weight_alpha[3] [0.18348572 0.19361414 0.19506486 0.22849728 0.19933799]
np_weight_alpha[4] [0.1741227  0.17784128 0.19264409 0.19733243 0.2580595 ]
-------------Round number:  360  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5396825396825397
client Accurancy:  0.4801587301587302
client Accurancy:  0.3888888888888889
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4396825396825397
Average Global Trainning Accurancy:  0.5037414965986394
Average Global Trainning Loss:  1.301808633609694
All users are selected
model: 0 tensor([0.2421, 0.2059, 0.1945, 0.1828, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0185, -0.0045, -0.0117, -0.0142, -0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2066, 0.2269, 0.1944, 0.1935, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0017, -0.0095, -0.0031, -0.0038, -0.0151],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1947, 0.2202, 0.1953, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0138, 0.0167, 0.0136, 0.0114, 0.0113],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1835, 0.1936, 0.1951, 0.2285, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0127, -0.0173, -0.0099, -0.0182],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1741, 0.1778, 0.1926, 0.1973, 0.2581], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0227, 0.0089, 0.0151, 0.0137, 0.0327]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25399458 0.19758885 0.19348656 0.18478303 0.17014693]
np_weight_alpha[1] [0.1690624  0.24742313 0.17885612 0.18142478 0.22323358]
np_weight_alpha[2] [0.19490749 0.1913359  0.22072108 0.19698198 0.1960536 ]
np_weight_alpha[3] [0.18622798 0.19095278 0.1968009  0.22411717 0.20190118]
np_weight_alpha[4] [0.17086142 0.18646953 0.19469811 0.20074654 0.24722444]
-------------Round number:  361  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.49206349206349204
client Accurancy:  0.49206349206349204
client Accurancy:  0.3888888888888889
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.5156462585034014
Average Global Trainning Loss:  1.2978353694993623
All users are selected
model: 0 tensor([0.2540, 0.1976, 0.1935, 0.1848, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0225, -0.0405, -0.0308, -0.0292, -0.0345],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1691, 0.2474, 0.1789, 0.1814, 0.2232], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0801, -0.0164, -0.0586, -0.0508,  0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1949, 0.1913, 0.2207, 0.1970, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0375, 0.0296, 0.0365, 0.0341, 0.0390],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1910, 0.1968, 0.2241, 0.2019], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0391, 0.0332, 0.0336, 0.0390, 0.0303],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1865, 0.1947, 0.2007, 0.2472], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0002,  0.0079,  0.0040, -0.0039,  0.0014]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24843328 0.20504043 0.19131488 0.18174513 0.1734663 ]
np_weight_alpha[1] [0.2086386  0.22448847 0.19676776 0.19174351 0.17836173]
np_weight_alpha[2] [0.19265094 0.19683771 0.22025132 0.19798318 0.19227684]
np_weight_alpha[3] [0.1825694  0.19249238 0.1978522  0.22075616 0.20632987]
np_weight_alpha[4] [0.17932425 0.1581918  0.18183565 0.22846897 0.25217932]
-------------Round number:  362  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5555555555555556
client Accurancy:  0.4801587301587302
client Accurancy:  0.39285714285714285
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5176870748299319
Average Global Trainning Loss:  1.2912874182876275
All users are selected
model: 0 tensor([0.2484, 0.2050, 0.1913, 0.1817, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0240, 0.0128, 0.0105, 0.0131, 0.0140],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2245, 0.1968, 0.1917, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0218, -0.0248, -0.0214, -0.0255, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1968, 0.2203, 0.1980, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0213, 0.0264, 0.0251, 0.0268, 0.0224],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1826, 0.1925, 0.1979, 0.2208, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0227, -0.0233, -0.0196, -0.0280, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1793, 0.1582, 0.1818, 0.2285, 0.2522], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0107, -0.0147, -0.0068,  0.0349,  0.0051]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24183202 0.2059161  0.1944978  0.18299116 0.1747629 ]
np_weight_alpha[1] [0.20659353 0.226989   0.19429088 0.19343053 0.17869605]
np_weight_alpha[2] [0.19552426 0.19466412 0.22026968 0.19537817 0.19416378]
np_weight_alpha[3] [0.18364699 0.19360077 0.1951439  0.22826467 0.1993436 ]
np_weight_alpha[4] [0.17423072 0.17794827 0.19260599 0.19734016 0.25787485]
-------------Round number:  363  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5476190476190477
client Accurancy:  0.48412698412698413
client Accurancy:  0.3888888888888889
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5064625850340136
Average Global Trainning Loss:  1.2992126049638606
All users are selected
model: 0 tensor([0.2418, 0.2059, 0.1945, 0.1830, 0.1748], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0183, -0.0037, -0.0106, -0.0132, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2066, 0.2270, 0.1943, 0.1934, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0019, -0.0091, -0.0027, -0.0035, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1947, 0.2203, 0.1954, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0135, 0.0162, 0.0131, 0.0108, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1836, 0.1936, 0.1951, 0.2283, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0175, -0.0125, -0.0173, -0.0099, -0.0179],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.1779, 0.1926, 0.1973, 0.2579], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0082, 0.0141, 0.0130, 0.0320]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25435784 0.19760855 0.19322075 0.18473737 0.17007545]
np_weight_alpha[1] [0.16933566 0.24699453 0.17857268 0.1813773  0.22371973]
np_weight_alpha[2] [0.194646   0.19119851 0.2207193  0.19717479 0.19626138]
np_weight_alpha[3] [0.18620403 0.19092624 0.19699083 0.22408421 0.20179474]
np_weight_alpha[4] [0.17082974 0.18661317 0.19490126 0.20064977 0.24700598]
-------------Round number:  364  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.49603174603174605
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.5170068027210885
Average Global Trainning Loss:  1.2949617346938775
All users are selected
model: 0 tensor([0.2544, 0.1976, 0.1932, 0.1847, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0219, -0.0406, -0.0310, -0.0293, -0.0346],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1693, 0.2470, 0.1786, 0.1814, 0.2237], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0796, -0.0166, -0.0585, -0.0506,  0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1912, 0.2207, 0.1972, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0381, 0.0305, 0.0371, 0.0353, 0.0403],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1909, 0.1970, 0.2241, 0.2018], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0385, 0.0327, 0.0334, 0.0383, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1708, 0.1866, 0.1949, 0.2006, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0010,  0.0074,  0.0036, -0.0048,  0.0003]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24818878 0.20515531 0.19135544 0.18178159 0.17351888]
np_weight_alpha[1] [0.20874308 0.22457972 0.1966985  0.19170052 0.17827821]
np_weight_alpha[2] [0.19269353 0.19675517 0.22062525 0.1978361  0.19209   ]
np_weight_alpha[3] [0.18258177 0.19245242 0.19771841 0.22090748 0.20633987]
np_weight_alpha[4] [0.17937815 0.15737405 0.18020679 0.22878146 0.2542596 ]
-------------Round number:  365  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5555555555555556
client Accurancy:  0.4801587301587302
client Accurancy:  0.39285714285714285
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5193877551020408
Average Global Trainning Loss:  1.2863016349117773
All users are selected
model: 0 tensor([0.2482, 0.2052, 0.1914, 0.1818, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0239, 0.0128, 0.0104, 0.0127, 0.0134],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2087, 0.2246, 0.1967, 0.1917, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0207, -0.0238, -0.0207, -0.0247, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1968, 0.2206, 0.1978, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0222, 0.0270, 0.0261, 0.0275, 0.0226],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1826, 0.1925, 0.1977, 0.2209, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0232, -0.0236, -0.0198, -0.0280, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1794, 0.1574, 0.1802, 0.2288, 0.2543], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0320, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0094, -0.0167, -0.0097,  0.0344,  0.0072]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24144047 0.20578636 0.19441268 0.1832381  0.17512235]
np_weight_alpha[1] [0.20643581 0.22694987 0.19431898 0.19342883 0.17886657]
np_weight_alpha[2] [0.1953979  0.1946785  0.22028336 0.19524689 0.19439334]
np_weight_alpha[3] [0.18387917 0.19359623 0.19501066 0.22817512 0.19933885]
np_weight_alpha[4] [0.17468189 0.17823544 0.19292958 0.19737111 0.25678197]
-------------Round number:  366  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5476190476190477
client Accurancy:  0.4880952380952381
client Accurancy:  0.3888888888888889
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5061224489795918
Average Global Trainning Loss:  1.2995880334555698
All users are selected
model: 0 tensor([0.2414, 0.2058, 0.1944, 0.1832, 0.1751], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0186, -0.0037, -0.0106, -0.0131, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2064, 0.2269, 0.1943, 0.1934, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0008, -0.0099, -0.0039, -0.0043, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1954, 0.1947, 0.2203, 0.1952, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0141, 0.0166, 0.0139, 0.0113, 0.0114],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1936, 0.1950, 0.2282, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0128, -0.0178, -0.0103, -0.0182],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1747, 0.1782, 0.1929, 0.1974, 0.2568], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0234, 0.0090, 0.0151, 0.0137, 0.0313]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25432742 0.19759582 0.1931711  0.18498339 0.16992235]
np_weight_alpha[1] [0.16988091 0.2461856  0.17972432 0.18089297 0.22331622]
np_weight_alpha[2] [0.19461577 0.1914609  0.22055449 0.19714345 0.1962254 ]
np_weight_alpha[3] [0.18646047 0.1908172  0.19696191 0.2240159  0.2017445 ]
np_weight_alpha[4] [0.17063795 0.18662748 0.19485654 0.20059179 0.24728628]
-------------Round number:  367  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.503968253968254
client Accurancy:  0.3888888888888889
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.5166666666666667
Average Global Trainning Loss:  1.290988221460459
All users are selected
model: 0 tensor([0.2543, 0.1976, 0.1932, 0.1850, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0215, -0.0404, -0.0307, -0.0288, -0.0345],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1699, 0.2462, 0.1797, 0.1809, 0.2233], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0786, -0.0169, -0.0569, -0.0504,  0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1915, 0.2206, 0.1971, 0.1962], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0377, 0.0302, 0.0364, 0.0348, 0.0397],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1865, 0.1908, 0.1970, 0.2240, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0387, 0.0328, 0.0334, 0.0381, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1706, 0.1866, 0.1949, 0.2006, 0.2473], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0015,  0.0071,  0.0033, -0.0050,  0.0004]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2480546  0.20525528 0.1912389  0.18185866 0.17359254]
np_weight_alpha[1] [0.20879923 0.22454731 0.19671819 0.19158545 0.17834984]
np_weight_alpha[2] [0.19255869 0.19679649 0.22067189 0.19782884 0.19214407]
np_weight_alpha[3] [0.18264243 0.1923046  0.19770876 0.22106768 0.20627646]
np_weight_alpha[4] [0.180598   0.15763766 0.18071225 0.22879423 0.2522578 ]
-------------Round number:  368  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5515873015873016
client Accurancy:  0.48412698412698413
client Accurancy:  0.3968253968253968
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5200680272108843
Average Global Trainning Loss:  1.285569379118835
All users are selected
model: 0 tensor([0.2481, 0.2053, 0.1912, 0.1819, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0239, 0.0130, 0.0103, 0.0127, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2088, 0.2245, 0.1967, 0.1916, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0236, -0.0207, -0.0247, -0.0222],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1968, 0.2207, 0.1978, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0219, 0.0267, 0.0264, 0.0273, 0.0226],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1826, 0.1923, 0.1977, 0.2211, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0242, -0.0203, -0.0281, -0.0161],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1806, 0.1576, 0.1807, 0.2288, 0.2523], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0305, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0109, -0.0161, -0.0089,  0.0345,  0.0052]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24137503 0.20576221 0.19445969 0.18329448 0.17510858]
np_weight_alpha[1] [0.20640911 0.22680865 0.1945542  0.19342744 0.1788006 ]
np_weight_alpha[2] [0.1954582  0.19492203 0.21991767 0.19531351 0.19438861]
np_weight_alpha[3] [0.18394326 0.19359647 0.19507733 0.22802159 0.19936134]
np_weight_alpha[4] [0.17455421 0.17809574 0.19289184 0.19740108 0.25705713]
-------------Round number:  369  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.4880952380952381
client Accurancy:  0.3888888888888889
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.5071428571428571
Average Global Trainning Loss:  1.297072305484694
All users are selected
model: 0 tensor([0.2414, 0.2058, 0.1945, 0.1833, 0.1751], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0188, -0.0042, -0.0107, -0.0131, -0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2064, 0.2268, 0.1946, 0.1934, 0.1788], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0015, -0.0089, -0.0028, -0.0035, -0.0151],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1949, 0.2199, 0.1953, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0142, 0.0168, 0.0133, 0.0113, 0.0115],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1936, 0.1951, 0.2280, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0178, -0.0130, -0.0179, -0.0110, -0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1746, 0.1781, 0.1929, 0.1974, 0.2571], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0226, 0.0083, 0.0148, 0.0136, 0.0314]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25424    0.1977432  0.19303776 0.18482834 0.17015065]
np_weight_alpha[1] [0.17057934 0.24469067 0.17887251 0.18091017 0.22494726]
np_weight_alpha[2] [0.19446325 0.19144513 0.22079398 0.19719358 0.19610403]
np_weight_alpha[3] [0.18628089 0.19080636 0.19700453 0.22437347 0.20153476]
np_weight_alpha[4] [0.17089683 0.18686634 0.19475913 0.200404   0.24707374]
-------------Round number:  370  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.49603174603174605
client Accurancy:  0.3888888888888889
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.5176870748299319
Average Global Trainning Loss:  1.288252185639881
All users are selected
model: 0 tensor([0.2542, 0.1977, 0.1930, 0.1848, 0.1702], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0216, -0.0403, -0.0308, -0.0290, -0.0342],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1706, 0.2447, 0.1789, 0.1809, 0.2249], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0773, -0.0179, -0.0571, -0.0497,  0.0089],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1914, 0.2208, 0.1972, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0385, 0.0311, 0.0374, 0.0359, 0.0408],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1863, 0.1908, 0.1970, 0.2244, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0378, 0.0321, 0.0328, 0.0377, 0.0288],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1709, 0.1869, 0.1948, 0.2004, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0021,  0.0066,  0.0024, -0.0061, -0.0013]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24798787 0.20531663 0.19126381 0.18192585 0.17350587]
np_weight_alpha[1] [0.20887837 0.22475334 0.19677392 0.19151796 0.17807643]
np_weight_alpha[2] [0.1925862  0.19682156 0.22087839 0.19776186 0.19195195]
np_weight_alpha[3] [0.18271936 0.1922599  0.19764833 0.2211275  0.20624487]
np_weight_alpha[4] [0.17878662 0.15591572 0.17992225 0.22919104 0.2561843 ]
-------------Round number:  371  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5515873015873016
client Accurancy:  0.48412698412698413
client Accurancy:  0.4007936507936508
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.5224489795918368
Average Global Trainning Loss:  1.2768987331260628
All users are selected
model: 0 tensor([0.2480, 0.2053, 0.1913, 0.1819, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0227, 0.0119, 0.0091, 0.0115, 0.0122],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2248, 0.1968, 0.1915, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0189, -0.0220, -0.0193, -0.0235, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1968, 0.2209, 0.1978, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0230, 0.0277, 0.0276, 0.0283, 0.0236],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1827, 0.1923, 0.1976, 0.2211, 0.2062], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0250, -0.0209, -0.0284, -0.0166],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1788, 0.1559, 0.1799, 0.2292, 0.2562], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0340, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0082, -0.0182, -0.0102,  0.0345,  0.0084]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24121255 0.20570369 0.1944671  0.1833868  0.17522989]
np_weight_alpha[1] [0.20633045 0.22683841 0.19463138 0.1936145  0.1785852 ]
np_weight_alpha[2] [0.19545086 0.1949996  0.22000669 0.1953183  0.19422455]
np_weight_alpha[3] [0.1840386  0.1937968  0.19509207 0.22780825 0.19926427]
np_weight_alpha[4] [0.1748216  0.17799787 0.19274768 0.19725622 0.2571766 ]
-------------Round number:  372  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.4880952380952381
client Accurancy:  0.3888888888888889
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.5091836734693878
Average Global Trainning Loss:  1.292758324032738
All users are selected
model: 0 tensor([0.2412, 0.2057, 0.1945, 0.1834, 0.1752], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0193, -0.0046, -0.0107, -0.0132, -0.0044],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2063, 0.2268, 0.1946, 0.1936, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010, -0.0091, -0.0028, -0.0034, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1950, 0.2200, 0.1953, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0141, 0.0168, 0.0133, 0.0111, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1938, 0.1951, 0.2278, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0176, -0.0126, -0.0177, -0.0111, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1748, 0.1780, 0.1927, 0.1973, 0.2572], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0236, 0.0087, 0.0147, 0.0139, 0.0317]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25440577 0.19795752 0.1929106  0.18486744 0.16985874]
np_weight_alpha[1] [0.17183171 0.24492097 0.17812572 0.18006866 0.22505295]
np_weight_alpha[2] [0.19433917 0.19133717 0.22064784 0.19717528 0.19650058]
np_weight_alpha[3] [0.18633424 0.19077179 0.19697975 0.22444032 0.20147394]
np_weight_alpha[4] [0.17060943 0.18670692 0.19510943 0.20032991 0.24724437]
-------------Round number:  373  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5
client Accurancy:  0.5
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5187074829931972
Average Global Trainning Loss:  1.2843805637489372
All users are selected
model: 0 tensor([0.2544, 0.1980, 0.1929, 0.1849, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0206, -0.0396, -0.0301, -0.0282, -0.0337],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1718, 0.2449, 0.1781, 0.1801, 0.2251], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0759, -0.0172, -0.0574, -0.0500,  0.0094],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1913, 0.2206, 0.1972, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0375, 0.0301, 0.0362, 0.0348, 0.0402],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1863, 0.1908, 0.1970, 0.2244, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0382, 0.0325, 0.0330, 0.0378, 0.0291],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1706, 0.1867, 0.1951, 0.2003, 0.2472], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0026,  0.0061,  0.0025, -0.0064, -0.0016]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24796827 0.2055901  0.19117242 0.18186046 0.17340875]
np_weight_alpha[1] [0.20909697 0.22469974 0.19672042 0.191388   0.17809494]
np_weight_alpha[2] [0.1925082  0.19674991 0.22100945 0.19782835 0.19190414]
np_weight_alpha[3] [0.18264267 0.19207577 0.19771655 0.22142357 0.20614144]
np_weight_alpha[4] [0.17931144 0.15647258 0.17852512 0.22894105 0.2567498 ]
-------------Round number:  374  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5476190476190477
client Accurancy:  0.48412698412698413
client Accurancy:  0.4007936507936508
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.5231292517006803
Average Global Trainning Loss:  1.2746455808886055
All users are selected
model: 0 tensor([0.2480, 0.2056, 0.1912, 0.1819, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0225, 0.0123, 0.0088, 0.0114, 0.0116],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2091, 0.2247, 0.1967, 0.1914, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0216, -0.0189, -0.0232, -0.0205],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1967, 0.2210, 0.1978, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0228, 0.0275, 0.0276, 0.0284, 0.0234],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1826, 0.1921, 0.1977, 0.2214, 0.2061], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0257, -0.0212, -0.0285, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1793, 0.1565, 0.1785, 0.2289, 0.2567], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0342, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0088, -0.0175, -0.0114,  0.0344,  0.0101]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24124251 0.20546268 0.1945105  0.18330316 0.17548122]
np_weight_alpha[1] [0.20608059 0.22690429 0.19459786 0.19368118 0.17873608]
np_weight_alpha[2] [0.19549204 0.19496237 0.22000177 0.19522461 0.1943192 ]
np_weight_alpha[3] [0.18394461 0.19384946 0.1949986  0.22772479 0.19948255]
np_weight_alpha[4] [0.17509352 0.17818336 0.19292912 0.19751942 0.2562746 ]
-------------Round number:  375  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.49206349206349204
client Accurancy:  0.38095238095238093
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5098639455782313
Average Global Trainning Loss:  1.290891561702806
All users are selected
model: 0 tensor([0.2412, 0.2055, 0.1945, 0.1833, 0.1755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0191, -0.0049, -0.0107, -0.0137, -0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2061, 0.2269, 0.1946, 0.1937, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0005, -0.0092, -0.0031, -0.0035, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1955, 0.1950, 0.2200, 0.1952, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0137, 0.0163, 0.0128, 0.0106, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1938, 0.1950, 0.2277, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0122, -0.0176, -0.0107, -0.0177],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1751, 0.1782, 0.1929, 0.1975, 0.2563], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0246, 0.0093, 0.0155, 0.0146, 0.0313]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25416744 0.19794908 0.19296838 0.18516627 0.16974881]
np_weight_alpha[1] [0.17265925 0.24407336 0.17833893 0.17942701 0.2255015 ]
np_weight_alpha[2] [0.19439052 0.19135265 0.22070698 0.19717702 0.19637284]
np_weight_alpha[3] [0.18664843 0.19069557 0.19699456 0.22411446 0.20154703]
np_weight_alpha[4] [0.17046198 0.18687476 0.19498591 0.20040715 0.24727014]
-------------Round number:  376  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5
client Accurancy:  0.503968253968254
client Accurancy:  0.3968253968253968
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5207482993197279
Average Global Trainning Loss:  1.2797412275457059
All users are selected
model: 0 tensor([0.2542, 0.1979, 0.1930, 0.1852, 0.1697], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0210, -0.0397, -0.0304, -0.0281, -0.0338],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1727, 0.2441, 0.1783, 0.1794, 0.2255], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0754, -0.0187, -0.0578, -0.0511,  0.0095],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1914, 0.2207, 0.1972, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0374, 0.0301, 0.0365, 0.0350, 0.0402],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1866, 0.1907, 0.1970, 0.2241, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0399, 0.0339, 0.0345, 0.0387, 0.0307],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1705, 0.1869, 0.1950, 0.2004, 0.2473], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034,  0.0056,  0.0016, -0.0071, -0.0028]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24792653 0.2054903  0.1913839  0.18190286 0.17329645]
np_weight_alpha[1] [0.20896494 0.22488968 0.19683142 0.19136727 0.17794672]
np_weight_alpha[2] [0.1927334  0.19687189 0.22075777 0.19774526 0.19189167]
np_weight_alpha[3] [0.18267538 0.1920342  0.19762796 0.22158146 0.20608093]
np_weight_alpha[4] [0.1791269  0.15531668 0.17877434 0.22809674 0.25868535]
-------------Round number:  377  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5476190476190477
client Accurancy:  0.48412698412698413
client Accurancy:  0.4007936507936508
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.5258503401360545
Average Global Trainning Loss:  1.2675127717102466
All users are selected
model: 0 tensor([0.2479, 0.2055, 0.1914, 0.1819, 0.1733], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0223, 0.0122, 0.0091, 0.0116, 0.0116],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2249, 0.1968, 0.1914, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0212, -0.0185, -0.0230, -0.0205],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1969, 0.2208, 0.1977, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0241, 0.0287, 0.0283, 0.0292, 0.0243],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1827, 0.1920, 0.1976, 0.2216, 0.2061], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0245, -0.0257, -0.0214, -0.0286, -0.0174],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1791, 0.1553, 0.1788, 0.2281, 0.2587], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0356, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0074, -0.0201, -0.0123,  0.0323,  0.0110]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24154398 0.20544103 0.19442433 0.18315658 0.17543404]
np_weight_alpha[1] [0.20606773 0.22688214 0.19456343 0.1936461  0.17884062]
np_weight_alpha[2] [0.19540796 0.19491841 0.22006804 0.195252   0.19435363]
np_weight_alpha[3] [0.1838029  0.19380067 0.19501595 0.227911   0.19946948]
np_weight_alpha[4] [0.17513059 0.1783558  0.1929657  0.19752915 0.25601876]
-------------Round number:  378  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.4880952380952381
client Accurancy:  0.373015873015873
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5112244897959184
Average Global Trainning Loss:  1.2866102984162415
All users are selected
model: 0 tensor([0.2415, 0.2054, 0.1944, 0.1832, 0.1754], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0195, -0.0058, -0.0117, -0.0147, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2061, 0.2269, 0.1946, 0.1936, 0.1788], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0009, -0.0087, -0.0026, -0.0030, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1954, 0.1949, 0.2201, 0.1953, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0139, 0.0165, 0.0132, 0.0109, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1838, 0.1938, 0.1950, 0.2279, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0180, -0.0122, -0.0175, -0.0105, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1751, 0.1784, 0.1930, 0.1975, 0.2560], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0096, 0.0155, 0.0147, 0.0310]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25395966 0.19804111 0.19295935 0.18519954 0.1698404 ]
np_weight_alpha[1] [0.17314637 0.24468182 0.17866713 0.17949931 0.22400536]
np_weight_alpha[2] [0.19437315 0.19139211 0.22065443 0.19716242 0.1964179 ]
np_weight_alpha[3] [0.1866694  0.19068216 0.19697833 0.22417374 0.20149644]
np_weight_alpha[4] [0.17051372 0.18669757 0.19502707 0.2003613  0.24740042]
-------------Round number:  379  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5
client Accurancy:  0.503968253968254
client Accurancy:  0.40476190476190477
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5224489795918368
Average Global Trainning Loss:  1.2760547871492347
All users are selected
model: 0 tensor([0.2540, 0.1980, 0.1930, 0.1852, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0204, -0.0390, -0.0298, -0.0273, -0.0330],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1731, 0.2447, 0.1787, 0.1795, 0.2240], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0738, -0.0168, -0.0563, -0.0498,  0.0090],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1914, 0.2207, 0.1972, 0.1964], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0375, 0.0302, 0.0367, 0.0351, 0.0404],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1907, 0.1970, 0.2242, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0381, 0.0322, 0.0326, 0.0369, 0.0286],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1705, 0.1867, 0.1950, 0.2004, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0035,  0.0052,  0.0015, -0.0074, -0.0026]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24783975 0.20558986 0.19140966 0.1818696  0.17329109]
np_weight_alpha[1] [0.20899321 0.22474907 0.19686213 0.19129954 0.17809606]
np_weight_alpha[2] [0.19276181 0.19691092 0.22070052 0.19775793 0.19186883]
np_weight_alpha[3] [0.18263607 0.19193737 0.19763874 0.22156784 0.20621997]
np_weight_alpha[4] [0.179045   0.15615262 0.17861167 0.22913869 0.25705203]
-------------Round number:  380  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5396825396825397
client Accurancy:  0.49206349206349204
client Accurancy:  0.40476190476190477
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.5272108843537415
Average Global Trainning Loss:  1.2645358338647958
All users are selected
model: 0 tensor([0.2478, 0.2056, 0.1914, 0.1819, 0.1733], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0219, 0.0120, 0.0088, 0.0109, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2247, 0.1969, 0.1913, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0176, -0.0211, -0.0183, -0.0230, -0.0206],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1969, 0.2207, 0.1978, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0250, 0.0295, 0.0289, 0.0300, 0.0248],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1826, 0.1919, 0.1976, 0.2216, 0.2062], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0247, -0.0258, -0.0213, -0.0284, -0.0171],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1790, 0.1562, 0.1786, 0.2291, 0.2571], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0346, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0067, -0.0198, -0.0130,  0.0331,  0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24125841 0.20530778 0.19430035 0.18336429 0.17576917]
np_weight_alpha[1] [0.2059248  0.2268003  0.19449474 0.19368844 0.17909177]
np_weight_alpha[2] [0.19524848 0.19483304 0.22018442 0.19522856 0.19450548]
np_weight_alpha[3] [0.18400408 0.19384585 0.1949968  0.22777967 0.19937359]
np_weight_alpha[4] [0.17545427 0.17860018 0.193156   0.19745934 0.2553302 ]
-------------Round number:  381  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5515873015873016
client Accurancy:  0.48412698412698413
client Accurancy:  0.373015873015873
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5122448979591837
Average Global Trainning Loss:  1.2860693691539116
All users are selected
model: 0 tensor([0.2413, 0.2053, 0.1943, 0.1834, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0200, -0.0056, -0.0111, -0.0142, -0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2059, 0.2268, 0.1945, 0.1937, 0.1791], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-6.5056e-05, -9.5511e-03, -3.5089e-03, -3.7019e-03, -1.5511e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1952, 0.1948, 0.2202, 0.1952, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0132, 0.0156, 0.0124, 0.0100, 0.0101],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1938, 0.1950, 0.2278, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0167, -0.0110, -0.0165, -0.0096, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1755, 0.1786, 0.1932, 0.1975, 0.2553], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0254, 0.0099, 0.0158, 0.0148, 0.0301]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25470755 0.19803604 0.19264597 0.18517758 0.16943283]
np_weight_alpha[1] [0.173815   0.24457482 0.17891969 0.17906174 0.22362877]
np_weight_alpha[2] [0.1941041  0.1913839  0.22083946 0.19721036 0.19646218]
np_weight_alpha[3] [0.186697   0.19061634 0.19702935 0.22425134 0.20140588]
np_weight_alpha[4] [0.17012596 0.18678012 0.19505179 0.20025285 0.24778938]
-------------Round number:  382  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.503968253968254
client Accurancy:  0.4007936507936508
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5238095238095238
Average Global Trainning Loss:  1.2706482348798895
All users are selected
model: 0 tensor([0.2547, 0.1980, 0.1926, 0.1852, 0.1694], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0195, -0.0390, -0.0300, -0.0273, -0.0335],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1738, 0.2446, 0.1789, 0.1791, 0.2236], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0737, -0.0177, -0.0564, -0.0506,  0.0083],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1914, 0.2208, 0.1972, 0.1965], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0382, 0.0314, 0.0375, 0.0363, 0.0416],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1906, 0.1970, 0.2243, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0382, 0.0323, 0.0328, 0.0368, 0.0287],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1701, 0.1868, 0.1951, 0.2003, 0.2478], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0046,  0.0048,  0.0010, -0.0081, -0.0030]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2476362  0.20570135 0.19139624 0.18187258 0.17339367]
np_weight_alpha[1] [0.20905147 0.22505024 0.19670951 0.19121175 0.17797707]
np_weight_alpha[2] [0.1927386  0.1967614  0.22106853 0.19766484 0.19176657]
np_weight_alpha[3] [0.18260317 0.19182742 0.197552   0.22185864 0.2061588 ]
np_weight_alpha[4] [0.18083891 0.15535116 0.17814305 0.22928198 0.25638488]
-------------Round number:  383  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5436507936507936
client Accurancy:  0.49603174603174605
client Accurancy:  0.40476190476190477
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.527891156462585
Average Global Trainning Loss:  1.2605408960459183
All users are selected
model: 0 tensor([0.2476, 0.2057, 0.1914, 0.1819, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0208, 0.0115, 0.0083, 0.0103, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2091, 0.2251, 0.1967, 0.1912, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0165, -0.0198, -0.0176, -0.0222, -0.0196],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1968, 0.2211, 0.1977, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0251, 0.0293, 0.0292, 0.0300, 0.0249],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1826, 0.1918, 0.1976, 0.2219, 0.2062], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0251, -0.0264, -0.0218, -0.0285, -0.0177],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1808, 0.1554, 0.1781, 0.2293, 0.2564], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0344, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0088, -0.0204, -0.0133,  0.0332,  0.0086]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24165985 0.20526728 0.19418754 0.18331581 0.17556949]
np_weight_alpha[1] [0.2058863  0.22675103 0.19464768 0.19371185 0.17900312]
np_weight_alpha[2] [0.19515432 0.19498442 0.22027548 0.19519748 0.19438836]
np_weight_alpha[3] [0.1839883  0.19386773 0.19496854 0.22770536 0.19947007]
np_weight_alpha[4] [0.17517237 0.17845656 0.19302854 0.19754766 0.2557948 ]
-------------Round number:  384  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.47619047619047616
client Accurancy:  0.373015873015873
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.513265306122449
Average Global Trainning Loss:  1.281893235809949
All users are selected
model: 0 tensor([0.2417, 0.2053, 0.1942, 0.1833, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0195, -0.0055, -0.0117, -0.0143, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2059, 0.2268, 0.1946, 0.1937, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0002, -0.0101, -0.0038, -0.0043, -0.0163],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1952, 0.1950, 0.2203, 0.1952, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0122, 0.0151, 0.0118, 0.0093, 0.0096],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1939, 0.1950, 0.2277, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0158, -0.0103, -0.0157, -0.0089, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1752, 0.1785, 0.1930, 0.1975, 0.2558], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0251, 0.0100, 0.0163, 0.0154, 0.0314]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.254358   0.19770259 0.1929009  0.18513526 0.16990325]
np_weight_alpha[1] [0.1722892  0.24471843 0.17842047 0.17945723 0.22511464]
np_weight_alpha[2] [0.1943394  0.19141765 0.22080784 0.19722329 0.19621183]
np_weight_alpha[3] [0.18661526 0.19073017 0.19704331 0.22430031 0.20131096]
np_weight_alpha[4] [0.17060225 0.18701643 0.19484837 0.20018616 0.24734673]
-------------Round number:  385  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5
client Accurancy:  0.49206349206349204
client Accurancy:  0.4007936507936508
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5248299319727892
Average Global Trainning Loss:  1.2693861773224915
All users are selected
model: 0 tensor([0.2544, 0.1977, 0.1929, 0.1851, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0198, -0.0393, -0.0296, -0.0270, -0.0331],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1723, 0.2447, 0.1784, 0.1795, 0.2251], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0756, -0.0178, -0.0571, -0.0504,  0.0094],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1914, 0.2208, 0.1972, 0.1962], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0382, 0.0312, 0.0372, 0.0359, 0.0410],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1866, 0.1907, 0.1970, 0.2243, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0394, 0.0334, 0.0337, 0.0376, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1706, 0.1870, 0.1948, 0.2002, 0.2473], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0048,  0.0043,  0.0002, -0.0085, -0.0037]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24776672 0.20571288 0.19134933 0.18163794 0.17353316]
np_weight_alpha[1] [0.20915887 0.22498415 0.19663619 0.19113588 0.17808487]
np_weight_alpha[2] [0.1926807  0.19666256 0.22106424 0.19778654 0.19180602]
np_weight_alpha[3] [0.1823674  0.19177376 0.19765545 0.22219633 0.20600708]
np_weight_alpha[4] [0.1799339  0.15543322 0.17895722 0.22880329 0.2568724 ]
-------------Round number:  386  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5476190476190477
client Accurancy:  0.49603174603174605
client Accurancy:  0.40476190476190477
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.5275510204081633
Average Global Trainning Loss:  1.2568180006377552
All users are selected
model: 0 tensor([0.2478, 0.2057, 0.1913, 0.1816, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0206, 0.0114, 0.0079, 0.0098, 0.0103],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2250, 0.1966, 0.1911, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0156, -0.0193, -0.0171, -0.0216, -0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1967, 0.2211, 0.1978, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0251, 0.0294, 0.0293, 0.0302, 0.0251],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1824, 0.1918, 0.1977, 0.2222, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0271, -0.0224, -0.0288, -0.0187],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1799, 0.1554, 0.1790, 0.2288, 0.2569], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0345, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0081, -0.0203, -0.0122,  0.0328,  0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24178456 0.20509382 0.19424362 0.18329245 0.17558555]
np_weight_alpha[1] [0.2057073  0.22676182 0.19460739 0.1937094  0.1792141 ]
np_weight_alpha[2] [0.19522089 0.194943   0.22028461 0.19521114 0.19434041]
np_weight_alpha[3] [0.18397196 0.19385496 0.19498768 0.2275872  0.1995982 ]
np_weight_alpha[4] [0.17526507 0.17870274 0.19299738 0.19769289 0.2553419 ]
-------------Round number:  387  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5515873015873016
client Accurancy:  0.47619047619047616
client Accurancy:  0.376984126984127
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5156462585034014
Average Global Trainning Loss:  1.2791463216145833
All users are selected
model: 0 tensor([0.2418, 0.2051, 0.1942, 0.1833, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0191, -0.0057, -0.0115, -0.0144, -0.0050],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2057, 0.2268, 0.1946, 0.1937, 0.1792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0016, -0.0110, -0.0051, -0.0053, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1952, 0.1949, 0.2203, 0.1952, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0123, 0.0149, 0.0117, 0.0093, 0.0093],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1939, 0.1950, 0.2276, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0157, -0.0101, -0.0154, -0.0087, -0.0152],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1753, 0.1787, 0.1930, 0.1977, 0.2553], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0260, 0.0112, 0.0173, 0.0165, 0.0323]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2541297  0.19780603 0.19281682 0.18519625 0.17005119]
np_weight_alpha[1] [0.17343579 0.2435696  0.17898998 0.17936158 0.22464304]
np_weight_alpha[2] [0.19423477 0.19148856 0.22081754 0.19719356 0.1962656 ]
np_weight_alpha[3] [0.18666267 0.19069402 0.19701298 0.22424842 0.20138198]
np_weight_alpha[4] [0.17074087 0.18710388 0.19491826 0.20027882 0.24695808]
-------------Round number:  388  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5079365079365079
client Accurancy:  0.49206349206349204
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5272108843537415
Average Global Trainning Loss:  1.2666133543261053
All users are selected
model: 0 tensor([0.2541, 0.1978, 0.1928, 0.1852, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0198, -0.0391, -0.0296, -0.0269, -0.0327],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1734, 0.2436, 0.1790, 0.1794, 0.2246], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0736, -0.0182, -0.0558, -0.0497,  0.0098],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1915, 0.2208, 0.1972, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0379, 0.0311, 0.0371, 0.0360, 0.0409],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1907, 0.1970, 0.2242, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0392, 0.0334, 0.0338, 0.0373, 0.0298],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1707, 0.1871, 0.1949, 0.2003, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0053,  0.0038, -0.0005, -0.0091, -0.0051]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24763623 0.20571998 0.19141683 0.18179727 0.17342973]
np_weight_alpha[1] [0.20910257 0.2250691  0.19671117 0.19111262 0.17800456]
np_weight_alpha[2] [0.19275033 0.19675665 0.22110027 0.19756399 0.19182873]
np_weight_alpha[3] [0.18253131 0.19173238 0.19743687 0.22235294 0.20594646]
np_weight_alpha[4] [0.17860435 0.1545005  0.1786299  0.22787227 0.26039302]
-------------Round number:  389  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5476190476190477
client Accurancy:  0.49603174603174605
client Accurancy:  0.40476190476190477
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.5292517006802722
Average Global Trainning Loss:  1.2509514841092686
All users are selected
model: 0 tensor([0.2476, 0.2057, 0.1914, 0.1818, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0206, 0.0113, 0.0076, 0.0095, 0.0096],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2091, 0.2251, 0.1967, 0.1911, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0177, -0.0158, -0.0203, -0.0182],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1968, 0.2211, 0.1976, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0252, 0.0294, 0.0296, 0.0301, 0.0252],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1825, 0.1917, 0.1974, 0.2224, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0263, -0.0274, -0.0229, -0.0288, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1786, 0.1545, 0.1786, 0.2279, 0.2604], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0370, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0055, -0.0224, -0.0133,  0.0312,  0.0133]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24126971 0.20498554 0.19435285 0.18348902 0.17590296]
np_weight_alpha[1] [0.20558043 0.22656818 0.19470324 0.19368958 0.17945856]
np_weight_alpha[2] [0.19530314 0.19503249 0.22011063 0.19520551 0.19434829]
np_weight_alpha[3] [0.18414222 0.19382584 0.19498251 0.22744288 0.19960651]
np_weight_alpha[4] [0.1757279  0.1790863  0.19307613 0.19773862 0.25437102]
-------------Round number:  390  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5515873015873016
client Accurancy:  0.47619047619047616
client Accurancy:  0.373015873015873
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5173469387755102
Average Global Trainning Loss:  1.2788051060267858
All users are selected
model: 0 tensor([0.2413, 0.2050, 0.1944, 0.1835, 0.1759], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0202, -0.0067, -0.0122, -0.0154, -0.0059],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2056, 0.2266, 0.1947, 0.1937, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0007, -0.0102, -0.0040, -0.0044, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1953, 0.1950, 0.2201, 0.1952, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0110, 0.0135, 0.0098, 0.0077, 0.0079],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1841, 0.1938, 0.1950, 0.2274, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0095, -0.0150, -0.0081, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1757, 0.1791, 0.1931, 0.1977, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0272, 0.0124, 0.0184, 0.0177, 0.0324]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25367385 0.19776468 0.19276989 0.18548273 0.1703089 ]
np_weight_alpha[1] [0.17356145 0.24457456 0.17823818 0.17932278 0.22430304]
np_weight_alpha[2] [0.19016072 0.17805299 0.22135876 0.20633112 0.20409636]
np_weight_alpha[3] [0.18693507 0.19069457 0.19709788 0.2240391  0.20123337]
np_weight_alpha[4] [0.17095895 0.18724738 0.1948358  0.20015016 0.24680771]
-------------Round number:  391  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5
client Accurancy:  0.5
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.527891156462585
Average Global Trainning Loss:  1.2655758397108843
All users are selected
model: 0 tensor([0.2537, 0.1978, 0.1928, 0.1855, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0204, -0.0397, -0.0302, -0.0274, -0.0328],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1736, 0.2446, 0.1782, 0.1793, 0.2243], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0732, -0.0169, -0.0562, -0.0493,  0.0098],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1902, 0.1781, 0.2214, 0.2063, 0.2041], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0309, 0.0149, 0.0355, 0.0433, 0.0473],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1869, 0.1907, 0.1971, 0.2240, 0.2012], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0405, 0.0348, 0.0352, 0.0385, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1872, 0.1948, 0.2002, 0.2468], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0049,  0.0040, -0.0005, -0.0091, -0.0052]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24726385 0.20586312 0.19146658 0.18201044 0.17339604]
np_weight_alpha[1] [0.20918107 0.22516054 0.19661258 0.19101705 0.17802878]
np_weight_alpha[2] [0.19347806 0.19725531 0.2210384  0.19715296 0.19107528]
np_weight_alpha[3] [0.18273768 0.19161819 0.19747521 0.22227597 0.20589295]
np_weight_alpha[4] [0.17750803 0.1539437  0.17927347 0.22802709 0.26124772]
-------------Round number:  392  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5436507936507936
client Accurancy:  0.5
client Accurancy:  0.4007936507936508
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.527891156462585
Average Global Trainning Loss:  1.2452347735969387
All users are selected
model: 0 tensor([0.2473, 0.2059, 0.1915, 0.1820, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0201, 0.0113, 0.0078, 0.0094, 0.0096],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2252, 0.1966, 0.1910, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0140, -0.0173, -0.0158, -0.0202, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1973, 0.2210, 0.1972, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0305, 0.0302, 0.0303, 0.0249],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1827, 0.1916, 0.1975, 0.2223, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0266, -0.0277, -0.0230, -0.0290, -0.0192],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1775, 0.1539, 0.1793, 0.2280, 0.2612], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0380, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0039, -0.0235, -0.0133,  0.0309,  0.0137]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24133793 0.2050191  0.19417799 0.18367463 0.17579034]
np_weight_alpha[1] [0.20561363 0.22644393 0.19480382 0.19364466 0.17949393]
np_weight_alpha[2] [0.19506472 0.19508593 0.22009034 0.19522923 0.19452968]
np_weight_alpha[3] [0.18434678 0.1937825  0.19497925 0.22736798 0.19952345]
np_weight_alpha[4] [0.1756874  0.17915548 0.19316803 0.19763294 0.25435615]
-------------Round number:  393  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5515873015873016
client Accurancy:  0.47619047619047616
client Accurancy:  0.36904761904761907
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5180272108843538
Average Global Trainning Loss:  1.2750578795971514
All users are selected
model: 0 tensor([0.2413, 0.2050, 0.1942, 0.1837, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0206, -0.0066, -0.0127, -0.0154, -0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2056, 0.2264, 0.1948, 0.1936, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0007, -0.0108, -0.0043, -0.0048, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1951, 0.1951, 0.2201, 0.1952, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0115, 0.0143, 0.0107, 0.0087, 0.0091],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1938, 0.1950, 0.2274, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0154, -0.0100, -0.0152, -0.0087, -0.0149],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1757, 0.1792, 0.1932, 0.1976, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0272, 0.0124, 0.0186, 0.0177, 0.0323]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25388852 0.19745198 0.19283631 0.18549508 0.17032813]
np_weight_alpha[1] [0.17202143 0.24591266 0.1783431  0.17953235 0.22419037]
np_weight_alpha[2] [0.19424458 0.19152732 0.22103633 0.19712129 0.19607046]
np_weight_alpha[3] [0.18694302 0.19071482 0.1969549  0.22421724 0.20116997]
np_weight_alpha[4] [0.17097455 0.18726148 0.1947588  0.20008194 0.24692316]
-------------Round number:  394  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5
client Accurancy:  0.49603174603174605
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5299319727891156
Average Global Trainning Loss:  1.2606395487882653
All users are selected
model: 0 tensor([0.2539, 0.1975, 0.1928, 0.1855, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0199, -0.0399, -0.0302, -0.0274, -0.0329],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1720, 0.2459, 0.1783, 0.1795, 0.2242], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0751, -0.0160, -0.0564, -0.0494,  0.0093],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1915, 0.2210, 0.1971, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0362, 0.0297, 0.0358, 0.0344, 0.0392],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1869, 0.1907, 0.1970, 0.2242, 0.2012], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0408, 0.0352, 0.0355, 0.0389, 0.0312],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1710, 0.1873, 0.1948, 0.2001, 0.2469], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0048,  0.0043, -0.0003, -0.0089, -0.0048]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24693368 0.20581177 0.19163476 0.182095   0.17352474]
np_weight_alpha[1] [0.2091573  0.22524545 0.1966074  0.1909595  0.17803036]
np_weight_alpha[2] [0.19293563 0.19664381 0.2210491  0.19751714 0.19185434]
np_weight_alpha[3] [0.18280074 0.19157813 0.19739112 0.22235245 0.20587754]
np_weight_alpha[4] [0.1780478  0.15399034 0.17925155 0.22830847 0.26040182]
-------------Round number:  395  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5436507936507936
client Accurancy:  0.49603174603174605
client Accurancy:  0.40476190476190477
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.527891156462585
Average Global Trainning Loss:  1.2431281887755101
All users are selected
model: 0 tensor([0.2469, 0.2058, 0.1916, 0.1821, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0194, 0.0109, 0.0077, 0.0093, 0.0094],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2252, 0.1966, 0.1910, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0131, -0.0162, -0.0149, -0.0194, -0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1966, 0.2210, 0.1975, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0305, 0.0308, 0.0314, 0.0264],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1828, 0.1916, 0.1974, 0.2224, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0288, -0.0240, -0.0299, -0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1780, 0.1540, 0.1793, 0.2283, 0.2604], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0374, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0042, -0.0236, -0.0136,  0.0309,  0.0124]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24141978 0.20504846 0.19412392 0.1835686  0.17583926]
np_weight_alpha[1] [0.20563935 0.22633287 0.19484878 0.19381574 0.17936333]
np_weight_alpha[2] [0.19507043 0.19516729 0.22016647 0.19513763 0.19445816]
np_weight_alpha[3] [0.18424788 0.19395109 0.19491377 0.22737224 0.19951504]
np_weight_alpha[4] [0.17570907 0.17899014 0.19316217 0.1976221  0.25451657]
-------------Round number:  396  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5515873015873016
client Accurancy:  0.4722222222222222
client Accurancy:  0.373015873015873
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5204081632653061
Average Global Trainning Loss:  1.2711463980123299
All users are selected
model: 0 tensor([0.2414, 0.2050, 0.1941, 0.1836, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0209, -0.0074, -0.0133, -0.0162, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2056, 0.2263, 0.1948, 0.1938, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0005, -0.0107, -0.0040, -0.0042, -0.0163],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1951, 0.1952, 0.2202, 0.1951, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0114, 0.0142, 0.0105, 0.0081, 0.0088],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1940, 0.1949, 0.2274, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0089, -0.0148, -0.0080, -0.0141],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1757, 0.1790, 0.1932, 0.1976, 0.2545], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0123, 0.0187, 0.0177, 0.0328]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25353694 0.19760755 0.19272433 0.18545055 0.1706806 ]
np_weight_alpha[1] [0.17250544 0.24661453 0.17807312 0.17819107 0.22461586]
np_weight_alpha[2] [0.19409679 0.19151191 0.22100562 0.19735295 0.19603278]
np_weight_alpha[3] [0.18686515 0.19056799 0.19717942 0.22425207 0.20113537]
np_weight_alpha[4] [0.17132765 0.18728305 0.19473796 0.20006606 0.24658532]
-------------Round number:  397  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.503968253968254
client Accurancy:  0.49603174603174605
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.5319727891156463
Average Global Trainning Loss:  1.2559724768813776
All users are selected
model: 0 tensor([0.2535, 0.1976, 0.1927, 0.1855, 0.1707], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0210, -0.0405, -0.0311, -0.0283, -0.0334],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1725, 0.2466, 0.1781, 0.1782, 0.2246], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0745, -0.0152, -0.0566, -0.0508,  0.0096],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1915, 0.2210, 0.1974, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0384, 0.0320, 0.0379, 0.0369, 0.0415],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1869, 0.1906, 0.1972, 0.2243, 0.2011], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0407, 0.0350, 0.0357, 0.0390, 0.0314],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1873, 0.1947, 0.2001, 0.2466], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0058,  0.0029, -0.0016, -0.0100, -0.0065]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24693279 0.20575017 0.19156307 0.18217975 0.17357425]
np_weight_alpha[1] [0.20903972 0.22517164 0.19656605 0.19104683 0.1781758 ]
np_weight_alpha[2] [0.19286016 0.19657679 0.22121777 0.19755101 0.19179422]
np_weight_alpha[3] [0.18290453 0.1916175  0.19743311 0.22235532 0.20568955]
np_weight_alpha[4] [0.17696422 0.15436871 0.17900814 0.22733133 0.26232764]
-------------Round number:  398  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5396825396825397
client Accurancy:  0.49603174603174605
client Accurancy:  0.40476190476190477
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.5299319727891156
Average Global Trainning Loss:  1.2379379583864796
All users are selected
model: 0 tensor([0.2469, 0.2058, 0.1916, 0.1822, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0194, 0.0113, 0.0080, 0.0097, 0.0095],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2252, 0.1966, 0.1910, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0122, -0.0155, -0.0140, -0.0185, -0.0161],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1966, 0.2212, 0.1976, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0262, 0.0297, 0.0301, 0.0306, 0.0256],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1829, 0.1916, 0.1974, 0.2224, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0269, -0.0284, -0.0237, -0.0296, -0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1770, 0.1544, 0.1790, 0.2273, 0.2623], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0384, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0022, -0.0241, -0.0144,  0.0293,  0.0144]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24163677 0.20484234 0.19400369 0.183528   0.17598929]
np_weight_alpha[1] [0.20543955 0.22642708 0.19479701 0.1937796  0.17955673]
np_weight_alpha[2] [0.19494781 0.1951081  0.22030044 0.1951445  0.1944992 ]
np_weight_alpha[3] [0.18420056 0.19390386 0.19492026 0.22738524 0.19959007]
np_weight_alpha[4] [0.17597893 0.17926767 0.19325432 0.19772276 0.25377637]
-------------Round number:  399  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5555555555555556
client Accurancy:  0.47619047619047616
client Accurancy:  0.36507936507936506
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5217687074829932
Average Global Trainning Loss:  1.2705027469972363
All users are selected
model: 0 tensor([0.2416, 0.2048, 0.1940, 0.1835, 0.1760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0210, -0.0086, -0.0139, -0.0172, -0.0082],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2054, 0.2264, 0.1948, 0.1938, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004, -0.0101, -0.0033, -0.0035, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1949, 0.1951, 0.2203, 0.1951, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0109, 0.0137, 0.0097, 0.0075, 0.0083],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1939, 0.1949, 0.2274, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0141, -0.0080, -0.0140, -0.0072, -0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1760, 0.1793, 0.1933, 0.1977, 0.2538], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0126, 0.0187, 0.0179, 0.0318]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.253036   0.19790329 0.19250332 0.18565476 0.17090265]
np_weight_alpha[1] [0.17454374 0.24686015 0.17770958 0.17795424 0.22293223]
np_weight_alpha[2] [0.19383231 0.1913685  0.2214051  0.19740944 0.19598463]
np_weight_alpha[3] [0.18704686 0.19048993 0.19724648 0.22426972 0.20094696]
np_weight_alpha[4] [0.17148298 0.18713692 0.19469512 0.19988914 0.24679586]
-------------Round number:  400  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5198412698412699
client Accurancy:  0.49206349206349204
client Accurancy:  0.39285714285714285
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.535374149659864
Average Global Trainning Loss:  1.2521442854485545
All users are selected
model: 0 tensor([0.2530, 0.1979, 0.1925, 0.1857, 0.1709], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0208, -0.0395, -0.0303, -0.0275, -0.0326],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1745, 0.2469, 0.1777, 0.1780, 0.2229], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0723, -0.0149, -0.0571, -0.0508,  0.0076],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1914, 0.2214, 0.1974, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0379, 0.0313, 0.0375, 0.0364, 0.0410],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1870, 0.1905, 0.1972, 0.2243, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0408, 0.0353, 0.0358, 0.0390, 0.0313],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1871, 0.1947, 0.1999, 0.2468], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060,  0.0023, -0.0018, -0.0105, -0.0062]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24694175 0.20576943 0.1912826  0.18232563 0.1736806 ]
np_weight_alpha[1] [0.20888968 0.22509575 0.19667736 0.19085783 0.17847934]
np_weight_alpha[2] [0.19256987 0.19667305 0.22147651 0.19754513 0.19173548]
np_weight_alpha[3] [0.18304975 0.19135113 0.19743638 0.22240871 0.20575407]
np_weight_alpha[4] [0.17723067 0.1556356  0.17909701 0.22863808 0.25939867]
-------------Round number:  401  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5396825396825397
client Accurancy:  0.49603174603174605
client Accurancy:  0.4087301587301587
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.5299319727891156
Average Global Trainning Loss:  1.235966564360119
All users are selected
model: 0 tensor([0.2469, 0.2058, 0.1913, 0.1823, 0.1737], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0189, 0.0106, 0.0068, 0.0089, 0.0085],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2251, 0.1967, 0.1909, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0122, -0.0155, -0.0137, -0.0188, -0.0158],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1967, 0.2215, 0.1975, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0264, 0.0304, 0.0308, 0.0311, 0.0261],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1830, 0.1914, 0.1974, 0.2224, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0267, -0.0287, -0.0235, -0.0291, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1772, 0.1556, 0.1791, 0.2286, 0.2594], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0364, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0024, -0.0227, -0.0143,  0.0308,  0.0115]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24133062 0.2047757  0.19404933 0.1836472  0.17619719]
np_weight_alpha[1] [0.2053701  0.22638619 0.1947032  0.19395825 0.17958225]
np_weight_alpha[2] [0.19497707 0.1950121  0.22036456 0.19518489 0.19446136]
np_weight_alpha[3] [0.18431926 0.19409896 0.1949747  0.22710404 0.19950302]
np_weight_alpha[4] [0.17609787 0.17921788 0.19321065 0.19762988 0.2538437 ]
-------------Round number:  402  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5555555555555556
client Accurancy:  0.4801587301587302
client Accurancy:  0.3611111111111111
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.523469387755102
Average Global Trainning Loss:  1.2654031143707483
All users are selected
model: 0 tensor([0.2413, 0.2048, 0.1940, 0.1836, 0.1762], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0220, -0.0096, -0.0149, -0.0181, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2054, 0.2264, 0.1947, 0.1940, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0003, -0.0099, -0.0034, -0.0031, -0.0150],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1950, 0.1950, 0.2204, 0.1952, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0106, 0.0131, 0.0095, 0.0074, 0.0081],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1843, 0.1941, 0.1950, 0.2271, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0139, -0.0076, -0.0136, -0.0073, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1761, 0.1792, 0.1932, 0.1976, 0.2538], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0278, 0.0134, 0.0195, 0.0186, 0.0322]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2528459  0.19793601 0.1926079  0.1858282  0.17078196]
np_weight_alpha[1] [0.17493957 0.24690825 0.17888963 0.17710736 0.2221552 ]
np_weight_alpha[2] [0.19043314 0.17886268 0.2220183  0.20645565 0.20223022]
np_weight_alpha[3] [0.18721175 0.19043809 0.19710317 0.22433437 0.2009126 ]
np_weight_alpha[4] [0.1713378  0.18699741 0.19457482 0.19982915 0.24726087]
-------------Round number:  403  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5158730158730159
client Accurancy:  0.49206349206349204
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.536734693877551
Average Global Trainning Loss:  1.2485383118090987
All users are selected
model: 0 tensor([0.2528, 0.1979, 0.1926, 0.1858, 0.1708], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0208, -0.0393, -0.0301, -0.0272, -0.0325],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1749, 0.2469, 0.1789, 0.1771, 0.2222], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0711, -0.0143, -0.0549, -0.0511,  0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1904, 0.1789, 0.2220, 0.2065, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0320, 0.0165, 0.0364, 0.0440, 0.0461],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1872, 0.1904, 0.1971, 0.2243, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0408, 0.0350, 0.0355, 0.0393, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1713, 0.1870, 0.1946, 0.1998, 0.2473], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060,  0.0025, -0.0019, -0.0106, -0.0058]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24686962 0.20576285 0.191396   0.18236159 0.17360999]
np_weight_alpha[1] [0.20883065 0.22536631 0.196461   0.19102    0.17832208]
np_weight_alpha[2] [0.19328946 0.19704281 0.2213889  0.19719782 0.19108105]
np_weight_alpha[3] [0.18309246 0.19150992 0.19750994 0.22203358 0.20585415]
np_weight_alpha[4] [0.1774647  0.15526254 0.17990819 0.22944547 0.25791916]
-------------Round number:  404  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5396825396825397
client Accurancy:  0.503968253968254
client Accurancy:  0.40476190476190477
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.5316326530612245
Average Global Trainning Loss:  1.2324245323129253
All users are selected
model: 0 tensor([0.2469, 0.2058, 0.1914, 0.1824, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0185, 0.0101, 0.0067, 0.0085, 0.0077],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2088, 0.2254, 0.1965, 0.1910, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0116, -0.0145, -0.0135, -0.0179, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1970, 0.2214, 0.1972, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0280, 0.0314, 0.0314, 0.0315, 0.0257],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1831, 0.1915, 0.1975, 0.2220, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0264, -0.0282, -0.0231, -0.0292, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1775, 0.1553, 0.1799, 0.2294, 0.2579], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0357, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0014, -0.0241, -0.0146,  0.0305,  0.0099]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24124677 0.20475112 0.19384652 0.18365929 0.17649627]
np_weight_alpha[1] [0.20534265 0.22628592 0.19479907 0.19385646 0.17971596]
np_weight_alpha[2] [0.1947042  0.19506107 0.22030745 0.19513638 0.19479093]
np_weight_alpha[3] [0.18430741 0.1939844  0.19489168 0.22713214 0.19968443]
np_weight_alpha[4] [0.1764175  0.17938633 0.19350342 0.19782527 0.2528675 ]
-------------Round number:  405  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5595238095238095
client Accurancy:  0.4801587301587302
client Accurancy:  0.35714285714285715
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.5231292517006803
Average Global Trainning Loss:  1.2655220291241496
All users are selected
model: 0 tensor([0.2412, 0.2048, 0.1938, 0.1837, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0216, -0.0093, -0.0150, -0.0183, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2053, 0.2263, 0.1948, 0.1939, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0015, -0.0116, -0.0046, -0.0047, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1947, 0.1951, 0.2203, 0.1951, 0.1948], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0097, 0.0126, 0.0089, 0.0066, 0.0079],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1843, 0.1940, 0.1949, 0.2271, 0.1997], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0138, -0.0074, -0.0134, -0.0069, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1764, 0.1794, 0.1935, 0.1978, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0293, 0.0151, 0.0214, 0.0207, 0.0330]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25235295 0.19772717 0.19264503 0.18608712 0.1711877 ]
np_weight_alpha[1] [0.17390914 0.2481558  0.17816533 0.17750359 0.22226615]
np_weight_alpha[2] [0.19155483 0.17839904 0.22205606 0.2073091  0.2006809 ]
np_weight_alpha[3] [0.18745422 0.19047649 0.19723728 0.22428294 0.2005491 ]
np_weight_alpha[4] [0.17170087 0.18714862 0.19456972 0.19950695 0.24707383]
-------------Round number:  406  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5119047619047619
client Accurancy:  0.49603174603174605
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5387755102040817
Average Global Trainning Loss:  1.246045004916029
All users are selected
model: 0 tensor([0.2524, 0.1977, 0.1926, 0.1861, 0.1712], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0204, -0.0390, -0.0295, -0.0267, -0.0315],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1739, 0.2482, 0.1782, 0.1775, 0.2223], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0732, -0.0140, -0.0568, -0.0517,  0.0067],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1784, 0.2221, 0.2073, 0.2007], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0347, 0.0176, 0.0376, 0.0467, 0.0460],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1905, 0.1972, 0.2243, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0401, 0.0344, 0.0353, 0.0386, 0.0300],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1717, 0.1871, 0.1946, 0.1995, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060,  0.0022, -0.0022, -0.0113, -0.0062]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24652481 0.20579043 0.19140898 0.18263076 0.17364505]
np_weight_alpha[1] [0.208861   0.22518471 0.19655116 0.19097829 0.17842491]
np_weight_alpha[2] [0.193199   0.19707952 0.22174814 0.19687754 0.19109584]
np_weight_alpha[3] [0.18334913 0.19146915 0.19718803 0.22207661 0.2059171 ]
np_weight_alpha[4] [0.17621458 0.15513588 0.17951266 0.23110951 0.25802737]
-------------Round number:  407  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5476190476190477
client Accurancy:  0.503968253968254
client Accurancy:  0.40476190476190477
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4531746031746032
Average Global Trainning Accurancy:  0.5346938775510204
Average Global Trainning Loss:  1.2280660408694728
All users are selected
model: 0 tensor([0.2465, 0.2058, 0.1914, 0.1826, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0185, 0.0106, 0.0071, 0.0089, 0.0079],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2252, 0.1966, 0.1910, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0106, -0.0138, -0.0127, -0.0170, -0.0146],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1932, 0.1971, 0.2217, 0.1969, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0284, 0.0317, 0.0323, 0.0316, 0.0263],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1833, 0.1915, 0.1972, 0.2221, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0274, -0.0293, -0.0247, -0.0302, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1762, 0.1551, 0.1795, 0.2311, 0.2580], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0367, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004, -0.0247, -0.0153,  0.0318,  0.0098]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2411183  0.20464963 0.1938401  0.18377617 0.17661573]
np_weight_alpha[1] [0.20523246 0.2262691  0.19495077 0.19377606 0.17977168]
np_weight_alpha[2] [0.1946948  0.19521691 0.22019446 0.19520113 0.19469269]
np_weight_alpha[3] [0.18442315 0.19390464 0.19495958 0.22696216 0.19975048]
np_weight_alpha[4] [0.17661625 0.1794873  0.19343585 0.19783257 0.25262806]
-------------Round number:  408  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5595238095238095
client Accurancy:  0.47619047619047616
client Accurancy:  0.35714285714285715
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.523469387755102
Average Global Trainning Loss:  1.2632169762436225
All users are selected
model: 0 tensor([0.2411, 0.2046, 0.1938, 0.1838, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0214, -0.0101, -0.0151, -0.0183, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2052, 0.2263, 0.1950, 0.1938, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0015, -0.0107, -0.0037, -0.0038, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1947, 0.1952, 0.2202, 0.1952, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0097, 0.0128, 0.0087, 0.0069, 0.0078],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1844, 0.1939, 0.1950, 0.2270, 0.1998], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0137, -0.0072, -0.0132, -0.0073, -0.0118],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1766, 0.1795, 0.1934, 0.1978, 0.2526], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0290, 0.0146, 0.0206, 0.0199, 0.0315]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2517841  0.19833621 0.19267808 0.18617673 0.17102489]
np_weight_alpha[1] [0.17708325 0.24752232 0.1776394  0.1769365  0.22081855]
np_weight_alpha[2] [0.19161904 0.17771547 0.22346286 0.20631191 0.20089065]
np_weight_alpha[3] [0.18751039 0.19027352 0.19709788 0.22457387 0.20054431]
np_weight_alpha[4] [0.17147836 0.18689941 0.19450831 0.1994833  0.24763055]
-------------Round number:  409  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.49206349206349204
client Accurancy:  0.3968253968253968
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5414965986394558
Average Global Trainning Loss:  1.240890731292517
All users are selected
model: 0 tensor([0.2518, 0.1983, 0.1927, 0.1862, 0.1710], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0214, -0.0384, -0.0294, -0.0264, -0.0316],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1771, 0.2475, 0.1776, 0.1769, 0.2208], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0696, -0.0144, -0.0570, -0.0519,  0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1777, 0.2235, 0.2063, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0170, 0.0388, 0.0456, 0.0465],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1903, 0.1971, 0.2246, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0405, 0.0344, 0.0352, 0.0388, 0.0301],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1715, 0.1869, 0.1945, 0.1995, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0066,  0.0016, -0.0025, -0.0117, -0.0064]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24692231 0.20583105 0.19126461 0.18241917 0.17356287]
np_weight_alpha[1] [0.20873639 0.22529644 0.1965271  0.19097604 0.17846404]
np_weight_alpha[2] [0.1930784  0.19703735 0.2220291  0.19698976 0.19086535]
np_weight_alpha[3] [0.18315512 0.19139537 0.19728918 0.22226028 0.20590001]
np_weight_alpha[4] [0.17683446 0.15567026 0.17880075 0.23118137 0.2575132 ]
-------------Round number:  410  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5436507936507936
client Accurancy:  0.5119047619047619
client Accurancy:  0.4087301587301587
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.5370748299319728
Average Global Trainning Loss:  1.223321242559524
All users are selected
model: 0 tensor([0.2469, 0.2058, 0.1913, 0.1824, 0.1736], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0188, 0.0100, 0.0064, 0.0083, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2087, 0.2253, 0.1965, 0.1910, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0101, -0.0128, -0.0116, -0.0162, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1970, 0.2220, 0.1970, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0284, 0.0321, 0.0327, 0.0320, 0.0262],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1914, 0.1973, 0.2223, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0280, -0.0298, -0.0248, -0.0304, -0.0212],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1768, 0.1557, 0.1788, 0.2312, 0.2575], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0362, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-7.4457e-05, -2.4380e-02, -1.6385e-02,  3.1570e-02,  8.9826e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24076213 0.20484115 0.19391695 0.1838084  0.17667133]
np_weight_alpha[1] [0.20543116 0.22626126 0.19476238 0.19383359 0.17971164]
np_weight_alpha[2] [0.19475168 0.19502537 0.22035807 0.19510859 0.19475624]
np_weight_alpha[3] [0.1844405  0.19397436 0.19487108 0.22697458 0.19973946]
np_weight_alpha[4] [0.17660522 0.17940122 0.1935046  0.19783394 0.25265503]
-------------Round number:  411  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5595238095238095
client Accurancy:  0.4722222222222222
client Accurancy:  0.35714285714285715
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5255102040816326
Average Global Trainning Loss:  1.2594797977784864
All users are selected
model: 0 tensor([0.2408, 0.2048, 0.1939, 0.1838, 0.1767], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0220, -0.0095, -0.0149, -0.0179, -0.0082],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2054, 0.2263, 0.1948, 0.1938, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0009, -0.0108, -0.0037, -0.0037, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1948, 0.1950, 0.2204, 0.1951, 0.1948], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0092, 0.0122, 0.0085, 0.0062, 0.0074],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1844, 0.1940, 0.1949, 0.2270, 0.1997], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0128, -0.0065, -0.0126, -0.0065, -0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1766, 0.1794, 0.1935, 0.1978, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0285, 0.0139, 0.0201, 0.0193, 0.0310]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2523225  0.19804977 0.19273399 0.1859913  0.17090245]
np_weight_alpha[1] [0.1750716  0.24874248 0.17798221 0.17697673 0.221227  ]
np_weight_alpha[2] [0.19186062 0.17820281 0.22217683 0.2071383  0.20062144]
np_weight_alpha[3] [0.19863485 0.17763017 0.2081671  0.20946059 0.2061073 ]
np_weight_alpha[4] [0.17139676 0.18693435 0.19449979 0.19958681 0.24758226]
-------------Round number:  412  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5079365079365079
client Accurancy:  0.49206349206349204
client Accurancy:  0.39285714285714285
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5428571428571428
Average Global Trainning Loss:  1.2384205928465135
All users are selected
model: 0 tensor([0.2523, 0.1980, 0.1927, 0.1860, 0.1709], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0201, -0.0386, -0.0294, -0.0271, -0.0319],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1751, 0.2487, 0.1780, 0.1770, 0.2212], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0709, -0.0126, -0.0558, -0.0510,  0.0065],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1782, 0.2222, 0.2071, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0174, 0.0376, 0.0462, 0.0459],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1986, 0.1776, 0.2082, 0.2095, 0.2061], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0522, 0.0224, 0.0470, 0.0242, 0.0366],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1714, 0.1869, 0.1945, 0.1996, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0080,  0.0004, -0.0037, -0.0125, -0.0073]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24611947 0.20579608 0.19139037 0.18290998 0.1737841 ]
np_weight_alpha[1] [0.20874256 0.2254447  0.19642344 0.19083616 0.17855309]
np_weight_alpha[2] [0.19313507 0.1969458  0.22180238 0.19708802 0.19102873]
np_weight_alpha[3] [0.18320921 0.19150625 0.19720322 0.22245313 0.20562822]
np_weight_alpha[4] [0.17808941 0.15626606 0.17960753 0.22964984 0.2563871 ]
-------------Round number:  413  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.4166666666666667
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.5401360544217687
Average Global Trainning Loss:  1.2215230721194728
All users are selected
model: 0 tensor([0.2461, 0.2058, 0.1914, 0.1829, 0.1738], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0175, 0.0102, 0.0068, 0.0088, 0.0074],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2087, 0.2254, 0.1964, 0.1908, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0093, -0.0122, -0.0112, -0.0159, -0.0133],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1969, 0.2218, 0.1971, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0290, 0.0323, 0.0326, 0.0320, 0.0267],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1915, 0.1972, 0.2225, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0286, -0.0304, -0.0260, -0.0307, -0.0220],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1781, 0.1563, 0.1796, 0.2296, 0.2564], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0343, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0011, -0.0240, -0.0155,  0.0301,  0.0079]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24131909 0.20457038 0.19361195 0.18370533 0.17679323]
np_weight_alpha[1] [0.20515288 0.22623654 0.19473416 0.19388959 0.17998683]
np_weight_alpha[2] [0.19445857 0.19498532 0.22048202 0.19544348 0.1946306 ]
np_weight_alpha[3] [0.18438265 0.19401193 0.19521725 0.22676456 0.19962357]
np_weight_alpha[4] [0.17669085 0.17962009 0.1933724  0.19778898 0.25252768]
-------------Round number:  414  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5555555555555556
client Accurancy:  0.46825396825396826
client Accurancy:  0.3611111111111111
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.5275510204081633
Average Global Trainning Loss:  1.2562433567176872
All users are selected
model: 0 tensor([0.2413, 0.2046, 0.1936, 0.1837, 0.1768], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0219, -0.0104, -0.0161, -0.0190, -0.0093],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2052, 0.2262, 0.1947, 0.1939, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0006, -0.0103, -0.0033, -0.0031, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1945, 0.1950, 0.2205, 0.1954, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0078, 0.0110, 0.0074, 0.0056, 0.0063],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1844, 0.1940, 0.1952, 0.2268, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0122, -0.0057, -0.0114, -0.0061, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1767, 0.1796, 0.1934, 0.1978, 0.2525], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0288, 0.0147, 0.0207, 0.0201, 0.0317]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25191197 0.19793314 0.19274731 0.18610193 0.17130566]
np_weight_alpha[1] [0.17553307 0.2487176  0.17852738 0.17697762 0.22024441]
np_weight_alpha[2] [0.1929886  0.17880537 0.2223301  0.20526321 0.20061271]
np_weight_alpha[3] [0.19924542 0.17768349 0.2062288  0.2112968  0.20554551]
np_weight_alpha[4] [0.1717688  0.18699746 0.19442616 0.19940473 0.24740285]
-------------Round number:  415  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5079365079365079
client Accurancy:  0.49603174603174605
client Accurancy:  0.39285714285714285
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.5445578231292517
Average Global Trainning Loss:  1.233092348267432
All users are selected
model: 0 tensor([0.2519, 0.1979, 0.1927, 0.1861, 0.1713], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0200, -0.0386, -0.0289, -0.0265, -0.0308],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1755, 0.2487, 0.1785, 0.1770, 0.2202], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0700, -0.0122, -0.0544, -0.0503,  0.0065],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1788, 0.2223, 0.2053, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0359, 0.0180, 0.0371, 0.0442, 0.0457],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1992, 0.1777, 0.2062, 0.2113, 0.2055], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0523, 0.0219, 0.0446, 0.0255, 0.0353],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1718, 0.1870, 0.1944, 0.1994, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0075,  0.0005, -0.0039, -0.0131, -0.0082]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24604496 0.20609859 0.19139872 0.18291356 0.17354423]
np_weight_alpha[1] [0.20899196 0.22569    0.19625327 0.19074813 0.17831665]
np_weight_alpha[2] [0.19306156 0.19675097 0.22223224 0.19699743 0.19095781]
np_weight_alpha[3] [0.18320745 0.19141695 0.19709474 0.2224564  0.20582446]
np_weight_alpha[4] [0.175212   0.15458713 0.17903782 0.2311156  0.26004747]
-------------Round number:  416  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.4126984126984127
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.5418367346938775
Average Global Trainning Loss:  1.2131737949085883
All users are selected
model: 0 tensor([0.2460, 0.2061, 0.1914, 0.1829, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0176, 0.0104, 0.0065, 0.0084, 0.0068],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2090, 0.2257, 0.1963, 0.1907, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0117, -0.0110, -0.0157, -0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1968, 0.2222, 0.1970, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0300, 0.0333, 0.0342, 0.0332, 0.0277],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1832, 0.1914, 0.1971, 0.2225, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0306, -0.0259, -0.0306, -0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1752, 0.1546, 0.1790, 0.2311, 0.2600], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0385, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0033, -0.0270, -0.0173,  0.0304,  0.0110]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20783445 0.20359509 0.20859459 0.19056354 0.1894123 ]
np_weight_alpha[1] [0.2050404  0.22635227 0.19470242 0.19395007 0.17995475]
np_weight_alpha[2] [0.19457601 0.194958   0.22044283 0.19527988 0.19474328]
np_weight_alpha[3] [0.18459152 0.19408323 0.19505945 0.22662506 0.19964077]
np_weight_alpha[4] [0.1770453  0.1797481  0.19353731 0.1977515  0.2519178 ]
-------------Round number:  417  -------------
client Accurancy:  0.4444444444444444
client Accurancy:  0.5476190476190477
client Accurancy:  0.4722222222222222
client Accurancy:  0.3611111111111111
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.42698412698412697
Average Global Trainning Accurancy:  0.5217687074829932
Average Global Trainning Loss:  1.2752467979379252
All users are selected
model: 0 tensor([0.2078, 0.2036, 0.2086, 0.1906, 0.1894], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0567, -0.0109,  0.0002, -0.0108,  0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2050, 0.2264, 0.1947, 0.1940, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0005, -0.0101, -0.0032, -0.0030, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1946, 0.1950, 0.2204, 0.1953, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0065, 0.0096, 0.0060, 0.0040, 0.0050],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1846, 0.1941, 0.1951, 0.2266, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0126, -0.0061, -0.0121, -0.0066, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1770, 0.1797, 0.1935, 0.1978, 0.2519], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0292, 0.0149, 0.0208, 0.0202, 0.0309]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25447002 0.19809017 0.19217224 0.18550327 0.16976431]
np_weight_alpha[1] [0.17564219 0.24876334 0.17846856 0.17684326 0.2202826 ]
np_weight_alpha[2] [0.19265082 0.17872415 0.22208872 0.20611337 0.20042287]
np_weight_alpha[3] [0.19906293 0.17750652 0.20705222 0.21150945 0.20486891]
np_weight_alpha[4] [0.17171891 0.18696281 0.19446693 0.19928989 0.24756148]
-------------Round number:  418  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5079365079365079
client Accurancy:  0.49603174603174605
client Accurancy:  0.39285714285714285
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.545578231292517
Average Global Trainning Loss:  1.2272965826955782
All users are selected
model: 0 tensor([0.2545, 0.1981, 0.1922, 0.1855, 0.1698], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0164, -0.0376, -0.0287, -0.0265, -0.0320],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1756, 0.2488, 0.1785, 0.1768, 0.2203], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0687, -0.0113, -0.0532, -0.0493,  0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1927, 0.1787, 0.2221, 0.2061, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0358, 0.0182, 0.0370, 0.0452, 0.0455],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1991, 0.1775, 0.2071, 0.2115, 0.2049], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0506, 0.0203, 0.0441, 0.0242, 0.0333],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1717, 0.1870, 0.1945, 0.1993, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-8.3796e-03, -1.2638e-05, -4.5799e-03, -1.3619e-02, -8.3852e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2456441  0.2060163  0.19137213 0.18306327 0.17390417]
np_weight_alpha[1] [0.20892552 0.22596453 0.19609761 0.19075058 0.17826171]
np_weight_alpha[2] [0.19300146 0.19661511 0.22224633 0.19699414 0.19114299]
np_weight_alpha[3] [0.1832721  0.19142003 0.19708645 0.2225197  0.2057018 ]
np_weight_alpha[4] [0.17654711 0.15456802 0.17988819 0.23100105 0.2579956 ]
-------------Round number:  419  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.4087301587301587
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.54421768707483
Average Global Trainning Loss:  1.2107729126806972
All users are selected
model: 0 tensor([0.2456, 0.2060, 0.1914, 0.1831, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0175, 0.0107, 0.0069, 0.0090, 0.0076],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2260, 0.1961, 0.1908, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0083, -0.0112, -0.0107, -0.0155, -0.0128],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1966, 0.2222, 0.1970, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0312, 0.0345, 0.0354, 0.0345, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1833, 0.1914, 0.1971, 0.2225, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0327, -0.0278, -0.0324, -0.0238],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1765, 0.1546, 0.1799, 0.2310, 0.2580], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0367, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019, -0.0269, -0.0166,  0.0303,  0.0086]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.241016   0.20447268 0.19371268 0.18393002 0.17686863]
np_weight_alpha[1] [0.20501524 0.22645192 0.19457527 0.19408295 0.17987466]
np_weight_alpha[2] [0.19455038 0.19483362 0.22049128 0.19526401 0.19486074]
np_weight_alpha[3] [0.18461794 0.19422375 0.19504678 0.22659236 0.19951913]
np_weight_alpha[4] [0.17688823 0.17959824 0.19361714 0.1976465  0.2522499 ]
-------------Round number:  420  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5476190476190477
client Accurancy:  0.4722222222222222
client Accurancy:  0.36904761904761907
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.5306122448979592
Average Global Trainning Loss:  1.2513507453762756
All users are selected
model: 0 tensor([0.2410, 0.2045, 0.1937, 0.1839, 0.1769], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0219, -0.0103, -0.0157, -0.0188, -0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2050, 0.2265, 0.1946, 0.1941, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004, -0.0099, -0.0031, -0.0026, -0.0146],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1946, 0.1948, 0.2205, 0.1953, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0069, 0.0098, 0.0061, 0.0043, 0.0053],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1846, 0.1942, 0.1950, 0.2266, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0118, -0.0050, -0.0112, -0.0062, -0.0099],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1769, 0.1796, 0.1936, 0.1976, 0.2522], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0293, 0.0150, 0.0212, 0.0206, 0.0317]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25171992 0.19793797 0.19263883 0.18630822 0.17139506]
np_weight_alpha[1] [0.17597578 0.24806835 0.17874378 0.17578687 0.22142515]
np_weight_alpha[2] [0.19200209 0.17897588 0.2233935  0.20558524 0.20004325]
np_weight_alpha[3] [0.19926327 0.1763838  0.20649013 0.21349931 0.20436352]
np_weight_alpha[4] [0.1718445  0.18711291 0.19450079 0.19910686 0.24743493]
-------------Round number:  421  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5119047619047619
client Accurancy:  0.49206349206349204
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5459183673469388
Average Global Trainning Loss:  1.2260033017113094
All users are selected
model: 0 tensor([0.2517, 0.1979, 0.1926, 0.1863, 0.1714], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0192, -0.0377, -0.0281, -0.0256, -0.0302],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1760, 0.2481, 0.1787, 0.1758, 0.2214], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0683, -0.0118, -0.0529, -0.0504,  0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1790, 0.2234, 0.2056, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0346, 0.0178, 0.0377, 0.0441, 0.0447],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1993, 0.1764, 0.2065, 0.2135, 0.2044], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0507, 0.0190, 0.0435, 0.0264, 0.0327],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1718, 0.1871, 0.1945, 0.1991, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0081,  0.0004, -0.0043, -0.0138, -0.0084]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24584235 0.20607859 0.19129048 0.18299837 0.17379023]
np_weight_alpha[1] [0.20893365 0.22587493 0.19617794 0.19086061 0.17815287]
np_weight_alpha[2] [0.1929622  0.19667925 0.2223473  0.19694683 0.19106442]
np_weight_alpha[3] [0.18331176 0.19156098 0.19704755 0.22224884 0.20583084]
np_weight_alpha[4] [0.17615406 0.15368824 0.17920966 0.23247157 0.25847644]
-------------Round number:  422  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.4126984126984127
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.545578231292517
Average Global Trainning Loss:  1.2057397959183673
All users are selected
model: 0 tensor([0.2458, 0.2061, 0.1913, 0.1830, 0.1738], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0172, 0.0107, 0.0068, 0.0087, 0.0072],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2259, 0.1962, 0.1909, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0087, -0.0118, -0.0113, -0.0159, -0.0135],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1967, 0.2223, 0.1969, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0319, 0.0350, 0.0360, 0.0348, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1833, 0.1916, 0.1970, 0.2222, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0324, -0.0280, -0.0326, -0.0236],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1762, 0.1537, 0.1792, 0.2325, 0.2585], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0381, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0022, -0.0276, -0.0170,  0.0321,  0.0093]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24133256 0.20435554 0.19350854 0.18389522 0.1769082 ]
np_weight_alpha[1] [0.20491128 0.22644886 0.19471082 0.19401029 0.1799187 ]
np_weight_alpha[2] [0.19435044 0.19496487 0.2205362  0.19541052 0.194738  ]
np_weight_alpha[3] [0.18458714 0.1941477  0.19519438 0.22652942 0.19954138]
np_weight_alpha[4] [0.17698036 0.17968117 0.1935143  0.19762108 0.25220308]
-------------Round number:  423  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.48412698412698413
client Accurancy:  0.36904761904761907
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5299319727891156
Average Global Trainning Loss:  1.247163152370323
All users are selected
model: 0 tensor([0.2413, 0.2044, 0.1935, 0.1839, 0.1769], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0219, -0.0108, -0.0162, -0.0195, -0.0096],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2049, 0.2264, 0.1947, 0.1940, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0006, -0.0101, -0.0029, -0.0028, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1944, 0.1950, 0.2205, 0.1954, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0067, 0.0099, 0.0059, 0.0040, 0.0049],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1846, 0.1941, 0.1952, 0.2265, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0119, -0.0049, -0.0111, -0.0057, -0.0093],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1770, 0.1797, 0.1935, 0.1976, 0.2522], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0298, 0.0155, 0.0215, 0.0213, 0.0320]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25158477 0.1978957  0.19248793 0.18659058 0.17144103]
np_weight_alpha[1] [0.17609465 0.24905492 0.17743894 0.17621475 0.22119677]
np_weight_alpha[2] [0.19190475 0.17768197 0.22302218 0.20641968 0.20097141]
np_weight_alpha[3] [0.20094441 0.17694509 0.20736785 0.2120293  0.20271339]
np_weight_alpha[4] [0.171861   0.18710935 0.19457604 0.19880943 0.24764425]
-------------Round number:  424  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5119047619047619
client Accurancy:  0.49206349206349204
client Accurancy:  0.3888888888888889
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.5472789115646258
Average Global Trainning Loss:  1.2232317243303572
All users are selected
model: 0 tensor([0.2516, 0.1979, 0.1925, 0.1866, 0.1714], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0183, -0.0369, -0.0275, -0.0245, -0.0292],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1761, 0.2491, 0.1774, 0.1762, 0.2212], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0682, -0.0107, -0.0542, -0.0500,  0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1777, 0.2230, 0.2064, 0.2010], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0351, 0.0173, 0.0380, 0.0456, 0.0465],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2009, 0.1769, 0.2074, 0.2120, 0.2027], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0514, 0.0186, 0.0433, 0.0239, 0.0300],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1719, 0.1871, 0.1946, 0.1988, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-8.4493e-03, -8.8144e-05, -4.4993e-03, -1.4286e-02, -8.7353e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24568984 0.20608501 0.19136515 0.18310486 0.17375518]
np_weight_alpha[1] [0.20890743 0.22578183 0.19614433 0.19092391 0.17824243]
np_weight_alpha[2] [0.19308081 0.1966568  0.22237317 0.19699873 0.19089043]
np_weight_alpha[3] [0.18329209 0.19154269 0.19711427 0.22223407 0.20581691]
np_weight_alpha[4] [0.17587787 0.15400766 0.17850453 0.23286195 0.258748  ]
-------------Round number:  425  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.4126984126984127
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.5482993197278911
Average Global Trainning Loss:  1.2029208021099065
All users are selected
model: 0 tensor([0.2457, 0.2061, 0.1914, 0.1831, 0.1738], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0175, 0.0112, 0.0075, 0.0093, 0.0077],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2258, 0.1961, 0.1909, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0076, -0.0109, -0.0101, -0.0145, -0.0121],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1967, 0.2224, 0.1970, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0314, 0.0342, 0.0352, 0.0340, 0.0285],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1833, 0.1915, 0.1971, 0.2222, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0309, -0.0325, -0.0282, -0.0329, -0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1759, 0.1540, 0.1785, 0.2329, 0.2587], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0385, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0030, -0.0279, -0.0184,  0.0319,  0.0090]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24143565 0.20435302 0.19339135 0.18392783 0.17689212]
np_weight_alpha[1] [0.2049137  0.22665758 0.19470337 0.19387288 0.17985247]
np_weight_alpha[2] [0.19422518 0.19495602 0.22056171 0.19542806 0.19482897]
np_weight_alpha[3] [0.18462723 0.19402002 0.19520575 0.2266086  0.19953835]
np_weight_alpha[4] [0.17698528 0.17964177 0.19360638 0.19759817 0.25216845]
-------------Round number:  426  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5555555555555556
client Accurancy:  0.48412698412698413
client Accurancy:  0.373015873015873
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5306122448979592
Average Global Trainning Loss:  1.2440977758290817
All users are selected
model: 0 tensor([0.2414, 0.2044, 0.1934, 0.1839, 0.1769], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0216, -0.0104, -0.0161, -0.0193, -0.0095],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2049, 0.2267, 0.1947, 0.1939, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0006, -0.0104, -0.0032, -0.0031, -0.0150],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1942, 0.1950, 0.2206, 0.1954, 0.1948], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0057, 0.0090, 0.0050, 0.0032, 0.0044],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1846, 0.1940, 0.1952, 0.2266, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0043, -0.0103, -0.0049, -0.0086],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1770, 0.1796, 0.1936, 0.1976, 0.2522], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0299, 0.0156, 0.0220, 0.0214, 0.0321]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25167704 0.19771093 0.19249246 0.18658522 0.17153433]
np_weight_alpha[1] [0.17523926 0.24916156 0.17771842 0.176367   0.22151381]
np_weight_alpha[2] [0.19246683 0.1780052  0.22368266 0.2063852  0.19946012]
np_weight_alpha[3] [0.20074925 0.1770726  0.20737788 0.21167612 0.20312406]
np_weight_alpha[4] [0.1719485  0.1871138  0.19436735 0.19888282 0.2476875 ]
-------------Round number:  427  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5158730158730159
client Accurancy:  0.5079365079365079
client Accurancy:  0.3888888888888889
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.5486394557823129
Average Global Trainning Loss:  1.2187764900882228
All users are selected
model: 0 tensor([0.2517, 0.1977, 0.1925, 0.1866, 0.1715], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0169, -0.0357, -0.0264, -0.0236, -0.0279],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1752, 0.2492, 0.1777, 0.1764, 0.2215], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0683, -0.0102, -0.0532, -0.0492,  0.0095],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1780, 0.2237, 0.2064, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0335, 0.0156, 0.0366, 0.0435, 0.0428],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2007, 0.1771, 0.2074, 0.2117, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0513, 0.0192, 0.0437, 0.0240, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1719, 0.1871, 0.1944, 0.1989, 0.2477], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0085, -0.0004, -0.0049, -0.0142, -0.0088]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24550208 0.2059125  0.19149691 0.18331076 0.17377785]
np_weight_alpha[1] [0.20876342 0.2260223  0.19603927 0.19082002 0.17835502]
np_weight_alpha[2] [0.19313236 0.1965208  0.22232097 0.19704112 0.19098482]
np_weight_alpha[3] [0.18350984 0.19145903 0.19713363 0.22225967 0.20563787]
np_weight_alpha[4] [0.17570543 0.1547157  0.17929712 0.23176427 0.2585174 ]
-------------Round number:  428  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.4087301587301587
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4603174603174603
Average Global Trainning Accurancy:  0.5476190476190477
Average Global Trainning Loss:  1.199451597045068
All users are selected
model: 0 tensor([0.2455, 0.2059, 0.1915, 0.1833, 0.1738], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0171, 0.0105, 0.0072, 0.0086, 0.0070],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2088, 0.2260, 0.1960, 0.1908, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0074, -0.0104, -0.0096, -0.0144, -0.0117],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1965, 0.2223, 0.1970, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0350, 0.0357, 0.0347, 0.0292],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1835, 0.1915, 0.1971, 0.2223, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0319, -0.0337, -0.0292, -0.0335, -0.0248],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1757, 0.1547, 0.1793, 0.2318, 0.2585], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0375, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0028, -0.0267, -0.0172,  0.0315,  0.0094]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24099956 0.2043991  0.19329278 0.18423979 0.17706881]
np_weight_alpha[1] [0.20493966 0.22679771 0.19443971 0.19396129 0.17986163]
np_weight_alpha[2] [0.19409136 0.19468786 0.22077385 0.19547573 0.19497114]
np_weight_alpha[3] [0.18493693 0.19413209 0.19526778 0.22628471 0.19937848]
np_weight_alpha[4] [0.1771265  0.17964853 0.1937328  0.1974842  0.25200805]
-------------Round number:  429  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5555555555555556
client Accurancy:  0.48412698412698413
client Accurancy:  0.373015873015873
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.5302721088435374
Average Global Trainning Loss:  1.2423675329506803
All users are selected
model: 0 tensor([0.2410, 0.2044, 0.1933, 0.1842, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0221, -0.0104, -0.0163, -0.0188, -0.0097],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2049, 0.2268, 0.1944, 0.1940, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013, -0.0110, -0.0042, -0.0036, -0.0158],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1947, 0.2208, 0.1955, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0048, 0.0081, 0.0045, 0.0027, 0.0041],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1849, 0.1941, 0.1953, 0.2263, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0095, -0.0030, -0.0092, -0.0046, -0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1771, 0.1796, 0.1937, 0.1975, 0.2520], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0301, 0.0159, 0.0226, 0.0217, 0.0326]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25159797 0.19766054 0.192613   0.1863572  0.1717713 ]
np_weight_alpha[1] [0.17488828 0.24869165 0.1787087  0.17567869 0.22203264]
np_weight_alpha[2] [0.19367838 0.17909308 0.22298348 0.2058975  0.19834761]
np_weight_alpha[3] [0.19807169 0.17618535 0.20674741 0.21514267 0.20385285]
np_weight_alpha[4] [0.17220643 0.18722926 0.19428773 0.19890705 0.24736948]
-------------Round number:  430  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5158730158730159
client Accurancy:  0.5119047619047619
client Accurancy:  0.3888888888888889
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.5513605442176871
Average Global Trainning Loss:  1.213633510044643
All users are selected
model: 0 tensor([0.2516, 0.1977, 0.1926, 0.1864, 0.1718], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0171, -0.0364, -0.0266, -0.0244, -0.0283],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1749, 0.2487, 0.1787, 0.1757, 0.2220], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0682, -0.0101, -0.0516, -0.0493,  0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1791, 0.2230, 0.2059, 0.1983], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0345, 0.0163, 0.0348, 0.0427, 0.0411],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1981, 0.1762, 0.2067, 0.2151, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0490, 0.0190, 0.0441, 0.0281, 0.0327],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1722, 0.1872, 0.1943, 0.1989, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0088, -0.0006, -0.0052, -0.0145, -0.0095]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24514048 0.20609169 0.19135605 0.18348858 0.17392322]
np_weight_alpha[1] [0.20893918 0.22600722 0.19593953 0.19079769 0.17831641]
np_weight_alpha[2] [0.19284756 0.19635755 0.22298883 0.19677998 0.19102605]
np_weight_alpha[3] [0.18387529 0.19152117 0.19684422 0.22236301 0.2053963 ]
np_weight_alpha[4] [0.17530549 0.15422273 0.17924367 0.23117496 0.26005313]
-------------Round number:  431  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5476190476190477
client Accurancy:  0.503968253968254
client Accurancy:  0.4126984126984127
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.5486394557823129
Average Global Trainning Loss:  1.194575344786352
All users are selected
model: 0 tensor([0.2451, 0.2061, 0.1914, 0.1835, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0172, 0.0115, 0.0079, 0.0098, 0.0082],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2260, 0.1959, 0.1908, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0071, -0.0102, -0.0098, -0.0144, -0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1964, 0.2230, 0.1968, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0322, 0.0349, 0.0367, 0.0347, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1915, 0.1968, 0.2224, 0.2054], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0323, -0.0347, -0.0304, -0.0344, -0.0260],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1753, 0.1542, 0.1792, 0.2312, 0.2601], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0386, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034, -0.0273, -0.0174,  0.0306,  0.0105]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24145694 0.20429337 0.19327793 0.18408193 0.1768898 ]
np_weight_alpha[1] [0.20483741 0.22667213 0.19461575 0.19408397 0.17979069]
np_weight_alpha[2] [0.19411625 0.19487117 0.22065563 0.19547959 0.19487731]
np_weight_alpha[3] [0.18479002 0.19423366 0.19527222 0.22631744 0.19938663]
np_weight_alpha[4] [0.1770118  0.17958382 0.19363913 0.19746774 0.2522975 ]
-------------Round number:  432  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5595238095238095
client Accurancy:  0.48412698412698413
client Accurancy:  0.373015873015873
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.5316326530612245
Average Global Trainning Loss:  1.2392655353156887
All users are selected
model: 0 tensor([0.2415, 0.2043, 0.1933, 0.1841, 0.1769], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0214, -0.0106, -0.0162, -0.0193, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2048, 0.2267, 0.1946, 0.1941, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0009, -0.0108, -0.0034, -0.0032, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1949, 0.2207, 0.1955, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0044, 0.0078, 0.0035, 0.0019, 0.0030],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1848, 0.1942, 0.1953, 0.2263, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0099, -0.0030, -0.0092, -0.0043, -0.0074],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1770, 0.1796, 0.1936, 0.1975, 0.2523], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0299, 0.0161, 0.0226, 0.0222, 0.0333]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25120687 0.19767016 0.19239643 0.18662424 0.17210227]
np_weight_alpha[1] [0.17514643 0.25021142 0.17696065 0.17563595 0.22204559]
np_weight_alpha[2] [0.19217508 0.17727557 0.2247431  0.20616238 0.19964391]
np_weight_alpha[3] [0.19999063 0.17636733 0.2070943  0.21439561 0.20215212]
np_weight_alpha[4] [0.17251901 0.18722774 0.19448453 0.19860823 0.24716048]
-------------Round number:  433  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5158730158730159
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.5503401360544218
Average Global Trainning Loss:  1.2119447876806972
All users are selected
model: 0 tensor([0.2512, 0.1977, 0.1924, 0.1866, 0.1721], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0175, -0.0364, -0.0267, -0.0244, -0.0280],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1751, 0.2502, 0.1770, 0.1756, 0.2220], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0237, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0671, -0.0081, -0.0524, -0.0484,  0.0117],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1922, 0.1773, 0.2247, 0.2062, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0326, 0.0141, 0.0361, 0.0426, 0.0421],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2000, 0.1764, 0.2071, 0.2144, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0510, 0.0195, 0.0445, 0.0277, 0.0309],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1872, 0.1945, 0.1986, 0.2472], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0009, -0.0056, -0.0154, -0.0103]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24503429 0.20609823 0.19125487 0.18369365 0.17391893]
np_weight_alpha[1] [0.20887826 0.22641815 0.19584666 0.19071707 0.17813979]
np_weight_alpha[2] [0.1928576  0.19633201 0.22309211 0.19676468 0.19095366]
np_weight_alpha[3] [0.18396531 0.19139342 0.19687271 0.2221315  0.20563713]
np_weight_alpha[4] [0.17398106 0.15322687 0.17861383 0.2328592  0.26131904]
-------------Round number:  434  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5476190476190477
client Accurancy:  0.503968253968254
client Accurancy:  0.4126984126984127
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.5506802721088435
Average Global Trainning Loss:  1.188082948022959
All users are selected
model: 0 tensor([0.2450, 0.2061, 0.1913, 0.1837, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0175, 0.0119, 0.0085, 0.0101, 0.0086],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2264, 0.1958, 0.1907, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0073, -0.0101, -0.0099, -0.0147, -0.0118],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1963, 0.2231, 0.1968, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0356, 0.0372, 0.0354, 0.0295],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1914, 0.1969, 0.2221, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0331, -0.0355, -0.0308, -0.0350, -0.0263],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1740, 0.1532, 0.1786, 0.2329, 0.2613], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0408, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0049, -0.0284, -0.0187,  0.0322,  0.0121]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2414603  0.20435755 0.19297442 0.18433298 0.17687468]
np_weight_alpha[1] [0.204893   0.22678599 0.19445683 0.1941738  0.17969039]
np_weight_alpha[2] [0.193783   0.19469732 0.22077484 0.19536152 0.19538333]
np_weight_alpha[3] [0.18506904 0.19435143 0.1951554  0.22606178 0.19936228]
np_weight_alpha[4] [0.17712124 0.17957343 0.19415659 0.19741662 0.25173214]
-------------Round number:  435  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5634920634920635
client Accurancy:  0.49206349206349204
client Accurancy:  0.373015873015873
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.532312925170068
Average Global Trainning Loss:  1.2359368356717686
All users are selected
model: 0 tensor([0.2415, 0.2044, 0.1930, 0.1843, 0.1769], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0215, -0.0105, -0.0166, -0.0192, -0.0105],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2049, 0.2268, 0.1945, 0.1942, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0003, -0.0103, -0.0030, -0.0025, -0.0151],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1938, 0.1947, 0.2208, 0.1954, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0029, 0.0065, 0.0023, 0.0007, 0.0025],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1851, 0.1944, 0.1952, 0.2261, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0021, -0.0086, -0.0039, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1771, 0.1796, 0.1942, 0.1974, 0.2517], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0301, 0.0162, 0.0233, 0.0222, 0.0328]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25120968 0.1975761  0.19237457 0.18670283 0.17213684]
np_weight_alpha[1] [0.174474   0.25035748 0.17750357 0.17486244 0.22280249]
np_weight_alpha[2] [0.19347402 0.17796329 0.22519344 0.20639479 0.19697446]
np_weight_alpha[3] [0.19917884 0.17546134 0.20730913 0.21550675 0.20254393]
np_weight_alpha[4] [0.17253494 0.18728146 0.19437882 0.19866711 0.24713765]
-------------Round number:  436  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5079365079365079
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.5523809523809524
Average Global Trainning Loss:  1.2076954951902636
All users are selected
model: 0 tensor([0.2512, 0.1976, 0.1924, 0.1867, 0.1721], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0167, -0.0363, -0.0269, -0.0245, -0.0279],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1745, 0.2504, 0.1775, 0.1749, 0.2228], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0671, -0.0075, -0.0512, -0.0485,  0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1780, 0.2252, 0.2064, 0.1970], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0336, 0.0148, 0.0361, 0.0429, 0.0393],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1992, 0.1755, 0.2073, 0.2155, 0.2025], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0494, 0.0182, 0.0446, 0.0283, 0.0309],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1873, 0.1944, 0.1987, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0092, -0.0013, -0.0057, -0.0156, -0.0105]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24433139 0.20608026 0.19159241 0.1839833  0.17401265]
np_weight_alpha[1] [0.20885442 0.22653301 0.19576521 0.1906016  0.17824581]
np_weight_alpha[2] [0.1930349  0.19616587 0.22332819 0.19654872 0.19092232]
np_weight_alpha[3] [0.18430446 0.19132315 0.19661155 0.22215983 0.20560104]
np_weight_alpha[4] [0.17421478 0.15372424 0.1780788  0.23278587 0.26119632]
-------------Round number:  437  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.4126984126984127
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.5544217687074829
Average Global Trainning Loss:  1.1852721752763606
All users are selected
model: 0 tensor([0.2443, 0.2061, 0.1916, 0.1840, 0.1740], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0162, 0.0113, 0.0082, 0.0099, 0.0082],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2265, 0.1958, 0.1906, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0069, -0.0097, -0.0094, -0.0144, -0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1962, 0.2233, 0.1965, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0335, 0.0360, 0.0380, 0.0357, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1913, 0.1966, 0.2222, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0328, -0.0356, -0.0311, -0.0354, -0.0264],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.1537, 0.1781, 0.2328, 0.2612], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0405, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047, -0.0280, -0.0195,  0.0322,  0.0119]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2414361  0.20437953 0.19311433 0.1842538  0.17681631]
np_weight_alpha[1] [0.20490332 0.22693631 0.19433956 0.19413896 0.1796819 ]
np_weight_alpha[2] [0.1939273  0.19458663 0.22067085 0.19525826 0.1955569 ]
np_weight_alpha[3] [0.18497948 0.1943059  0.19503877 0.22639638 0.19927947]
np_weight_alpha[4] [0.17707138 0.17955962 0.19433172 0.19733015 0.2517071 ]
-------------Round number:  438  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5674603174603174
client Accurancy:  0.49206349206349204
client Accurancy:  0.36904761904761907
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.5350340136054422
Average Global Trainning Loss:  1.231365427030187
All users are selected
model: 0 tensor([0.2414, 0.2044, 0.1931, 0.1843, 0.1768], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0213, -0.0104, -0.0165, -0.0200, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2049, 0.2269, 0.1943, 0.1941, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0001, -0.0102, -0.0033, -0.0029, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1946, 0.2207, 0.1953, 0.1956], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0029, 0.0061, 0.0017, 0.0001, 0.0023],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1850, 0.1943, 0.1950, 0.2264, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0018, -0.0082, -0.0030, -0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1771, 0.1796, 0.1943, 0.1973, 0.2517], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0299, 0.0160, 0.0236, 0.0230, 0.0329]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2507844  0.19731562 0.19225803 0.18719737 0.17244457]
np_weight_alpha[1] [0.17314555 0.24866565 0.17762144 0.17596751 0.22459991]
np_weight_alpha[2] [0.19210331 0.1779866  0.22608346 0.2072483  0.19657828]
np_weight_alpha[3] [0.20219606 0.17669173 0.20828953 0.21375093 0.19907175]
np_weight_alpha[4] [0.17281578 0.18756586 0.1944448  0.19794582 0.24722776]
-------------Round number:  439  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5079365079365079
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.5493197278911565
Average Global Trainning Loss:  1.2084277509832058
All users are selected
model: 0 tensor([0.2508, 0.1973, 0.1923, 0.1872, 0.1724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0174, -0.0368, -0.0272, -0.0242, -0.0277],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1731, 0.2487, 0.1776, 0.1760, 0.2246], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0676, -0.0084, -0.0499, -0.0461,  0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1921, 0.1780, 0.2261, 0.2072, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0320, 0.0148, 0.0367, 0.0438, 0.0387],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2022, 0.1767, 0.2083, 0.2138, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0519, 0.0189, 0.0450, 0.0255, 0.0262],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1876, 0.1944, 0.1979, 0.2472], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0089, -0.0009, -0.0057, -0.0164, -0.0104]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24435253 0.20612438 0.19158554 0.18397757 0.17395997]
np_weight_alpha[1] [0.20901753 0.22689177 0.19564234 0.19042489 0.17802344]
np_weight_alpha[2] [0.19309041 0.19607317 0.2235649  0.19633318 0.19093835]
np_weight_alpha[3] [0.1840581  0.19108403 0.19638833 0.22246762 0.20600192]
np_weight_alpha[4] [0.17288516 0.1524344  0.17785305 0.23657236 0.26025504]
-------------Round number:  440  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.4087301587301587
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.5547619047619048
Average Global Trainning Loss:  1.1807422871492348
All users are selected
model: 0 tensor([0.2444, 0.2061, 0.1916, 0.1840, 0.1740], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0163, 0.0113, 0.0081, 0.0097, 0.0079],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2269, 0.1956, 0.1904, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060, -0.0088, -0.0090, -0.0139, -0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1931, 0.1961, 0.2236, 0.1963, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0347, 0.0369, 0.0392, 0.0364, 0.0309],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1911, 0.1964, 0.2225, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0345, -0.0371, -0.0327, -0.0362, -0.0273],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1524, 0.1779, 0.2366, 0.2603], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0423, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0064, -0.0295, -0.0197,  0.0360,  0.0110]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24124883 0.20430103 0.19308472 0.18437852 0.1769869 ]
np_weight_alpha[1] [0.19037232 0.2229209  0.1914862  0.21098377 0.18423681]
np_weight_alpha[2] [0.19388069 0.19460368 0.22075644 0.19532941 0.19542974]
np_weight_alpha[3] [0.18512043 0.19425392 0.19511661 0.22621235 0.1992967 ]
np_weight_alpha[4] [0.1773169  0.17965694 0.1942283  0.1972636  0.25153422]
-------------Round number:  441  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5555555555555556
client Accurancy:  0.49206349206349204
client Accurancy:  0.36904761904761907
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.5333333333333333
Average Global Trainning Loss:  1.2344166865965136
All users are selected
model: 0 tensor([0.2412, 0.2043, 0.1931, 0.1844, 0.1770], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0212, -0.0101, -0.0163, -0.0198, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1904, 0.2229, 0.1915, 0.2110, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0143, -0.0054,  0.0150, -0.0098],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1946, 0.2208, 0.1953, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0028, 0.0063, 0.0016, 0.0002, 0.0022],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1851, 0.1943, 0.1951, 0.2262, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0094, -0.0022, -0.0085, -0.0035, -0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1773, 0.1797, 0.1942, 0.1973, 0.2515], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0294, 0.0154, 0.0228, 0.0224, 0.0318]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25067025 0.19720766 0.19226238 0.18736318 0.17249659]
np_weight_alpha[1] [0.19886965 0.23310216 0.19053103 0.18966083 0.18783633]
np_weight_alpha[2] [0.19221732 0.17701444 0.22679763 0.20706472 0.19690591]
np_weight_alpha[3] [0.20250246 0.17712295 0.20811573 0.2144871  0.19777179]
np_weight_alpha[4] [0.17284183 0.18754324 0.19440404 0.19770268 0.2475082 ]
-------------Round number:  442  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.5540816326530612
Average Global Trainning Loss:  1.1934319528592687
All users are selected
model: 0 tensor([0.2507, 0.1972, 0.1923, 0.1874, 0.1725], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0166, -0.0362, -0.0263, -0.0231, -0.0272],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1989, 0.2331, 0.1905, 0.1897, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0413, -0.0247, -0.0378, -0.0340, -0.0242],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1922, 0.1770, 0.2268, 0.2071, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0326, 0.0142, 0.0378, 0.0440, 0.0395],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2025, 0.1771, 0.2081, 0.2145, 0.1978], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0516, 0.0184, 0.0440, 0.0255, 0.0241],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1875, 0.1944, 0.1977, 0.2475], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0095, -0.0011, -0.0061, -0.0170, -0.0103]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24421138 0.20618086 0.1915053  0.18388054 0.17422199]
np_weight_alpha[1] [0.20729123 0.22642192 0.19532087 0.19086571 0.18010034]
np_weight_alpha[2] [0.1930123  0.19614942 0.22360969 0.19633628 0.19089237]
np_weight_alpha[3] [0.1839139  0.19116691 0.19639243 0.2224756  0.20605116]
np_weight_alpha[4] [0.17419358 0.15209246 0.17800282 0.23769313 0.25801796]
-------------Round number:  443  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.4087301587301587
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.5571428571428572
Average Global Trainning Loss:  1.178305199032738
All users are selected
model: 0 tensor([0.2442, 0.2062, 0.1915, 0.1839, 0.1742], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0164, 0.0119, 0.0084, 0.0098, 0.0084],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2073, 0.2264, 0.1953, 0.1909, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0062, -0.0078, -0.0076, -0.0118, -0.0074],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1930, 0.1961, 0.2236, 0.1963, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0339, 0.0363, 0.0383, 0.0357, 0.0300],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1912, 0.1964, 0.2225, 0.2061], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0357, -0.0379, -0.0335, -0.0371, -0.0282],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.1521, 0.1780, 0.2377, 0.2580], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0412, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0300, -0.0196,  0.0371,  0.0091]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24131522 0.20413342 0.1929745  0.18452004 0.17705683]
np_weight_alpha[1] [0.19671589 0.2255608  0.19216985 0.20839904 0.1771544 ]
np_weight_alpha[2] [0.1937584  0.19450444 0.2209296  0.19525097 0.19555652]
np_weight_alpha[3] [0.18527004 0.19418587 0.19504009 0.22624111 0.19926289]
np_weight_alpha[4] [0.17733572 0.17989549 0.19437231 0.19723932 0.2511571 ]
-------------Round number:  444  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5714285714285714
client Accurancy:  0.49206349206349204
client Accurancy:  0.36904761904761907
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.5360544217687074
Average Global Trainning Loss:  1.2301121718218537
All users are selected
model: 0 tensor([0.2413, 0.2041, 0.1930, 0.1845, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0210, -0.0102, -0.0166, -0.0194, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1967, 0.2256, 0.1922, 0.2084, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0077, -0.0112, -0.0043,  0.0128, -0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1945, 0.2209, 0.1953, 0.1956], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012,  0.0050,  0.0006, -0.0010,  0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 25.0
model: 3 tensor([0.1853, 0.1942, 0.1950, 0.2262, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0084, -0.0016, -0.0079, -0.0028, -0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1773, 0.1799, 0.1944, 0.1972, 0.2512], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0299, 0.0161, 0.0235, 0.0223, 0.0318]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2506845  0.19718403 0.19255134 0.18716899 0.17241113]
np_weight_alpha[1] [0.19830166 0.23314667 0.1905504  0.18975146 0.18824987]
np_weight_alpha[2] [0.19291967 0.12074244 0.2398181  0.25585005 0.19066967]
np_weight_alpha[3] [0.20080522 0.17700225 0.20786643 0.21379943 0.2005267 ]
np_weight_alpha[4] [0.1727478  0.1874244  0.19418323 0.19819956 0.24744496]
-------------Round number:  445  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5476190476190477
client Accurancy:  0.503968253968254
client Accurancy:  0.3968253968253968
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4587301587301587
Average Global Trainning Accurancy:  0.5568027210884354
Average Global Trainning Loss:  1.189957350127551
All users are selected
model: 0 tensor([0.2507, 0.1972, 0.1926, 0.1872, 0.1724], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0155, -0.0351, -0.0251, -0.0222, -0.0260],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2331, 0.1906, 0.1898, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0409, -0.0237, -0.0364, -0.0328, -0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1207, 0.2398, 0.2559, 0.1907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0556, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0268, -0.0489,  0.0462,  0.0891,  0.0291],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2008, 0.1770, 0.2079, 0.2138, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0483, 0.0168, 0.0423, 0.0234, 0.0257],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1874, 0.1942, 0.1982, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0010, -0.0059, -0.0159, -0.0099]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24429165 0.20619428 0.19161902 0.18384023 0.17405483]
np_weight_alpha[1] [0.20734823 0.22655343 0.19505773 0.19085048 0.18019018]
np_weight_alpha[2] [0.19429886 0.19775109 0.22303228 0.19495885 0.18995886]
np_weight_alpha[3] [0.18401074 0.1912433  0.19650364 0.22245705 0.2057852 ]
np_weight_alpha[4] [0.17384909 0.15310945 0.17929693 0.23500934 0.25873524]
-------------Round number:  446  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5515873015873016
client Accurancy:  0.5158730158730159
client Accurancy:  0.4007936507936508
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4634920634920635
Average Global Trainning Accurancy:  0.560204081632653
Average Global Trainning Loss:  1.175489277742347
All users are selected
model: 0 tensor([0.2443, 0.2062, 0.1916, 0.1838, 0.1741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0155, 0.0111, 0.0079, 0.0089, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2073, 0.2266, 0.1951, 0.1909, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0066, -0.0069, -0.0108, -0.0064],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1943, 0.1978, 0.2230, 0.1950, 0.1900], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0359, 0.0384, 0.0380, 0.0346, 0.0293],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1912, 0.1965, 0.2225, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0363, -0.0385, -0.0341, -0.0378, -0.0290],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1738, 0.1531, 0.1793, 0.2350, 0.2587], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0399, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0055, -0.0291, -0.0184,  0.0344,  0.0099]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24151085 0.20407747 0.19281831 0.18450798 0.17708541]
np_weight_alpha[1] [0.19626191 0.22465093 0.19315454 0.20870325 0.17722934]
np_weight_alpha[2] [0.19349276 0.19439888 0.22107053 0.19534628 0.19569157]
np_weight_alpha[3] [0.18525463 0.19421636 0.19507217 0.22624776 0.19920906]
np_weight_alpha[4] [0.17735969 0.1799541  0.19436687 0.1972516  0.2510677 ]
-------------Round number:  447  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5634920634920635
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.5384353741496599
Average Global Trainning Loss:  1.2252107581313776
All users are selected
model: 0 tensor([0.2415, 0.2041, 0.1928, 0.1845, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0199, -0.0097, -0.0161, -0.0190, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1963, 0.2247, 0.1932, 0.2087, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0074, -0.0114, -0.0025,  0.0138, -0.0163],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1944, 0.2211, 0.1953, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 9.9558e-06,  3.8946e-03, -4.2765e-04, -2.1498e-03,  7.1759e-04],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 2 grad_lr: 25.0
model: 3 tensor([0.1853, 0.1942, 0.1951, 0.2262, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0087, -0.0017, -0.0081, -0.0029, -0.0052],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1774, 0.1800, 0.1944, 0.1973, 0.2511], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0294, 0.0159, 0.0236, 0.0227, 0.0315]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2502099  0.19714999 0.19248948 0.18735737 0.17279324]
np_weight_alpha[1] [0.19827057 0.23307379 0.19048049 0.18975145 0.1884237 ]
np_weight_alpha[2] [0.19692418 0.12172529 0.23874782 0.26035643 0.18224628]
np_weight_alpha[3] [0.20171015 0.1769828  0.2089688  0.2140948  0.19824345]
np_weight_alpha[4] [0.17309412 0.18760407 0.1939868  0.1977225  0.24759252]
-------------Round number:  448  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5515873015873016
client Accurancy:  0.5158730158730159
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5561224489795918
Average Global Trainning Loss:  1.1870937632865646
All users are selected
model: 0 tensor([0.2502, 0.1971, 0.1925, 0.1874, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0153, -0.0348, -0.0247, -0.0216, -0.0255],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2331, 0.1905, 0.1898, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0403, -0.0233, -0.0357, -0.0319, -0.0222],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1969, 0.1217, 0.2387, 0.2604, 0.1822], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0580, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0310, -0.0478,  0.0447,  0.0933,  0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2017, 0.1770, 0.2090, 0.2141, 0.1982], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0492, 0.0170, 0.0432, 0.0233, 0.0232],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1731, 0.1876, 0.1940, 0.1977, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0096, -0.0016, -0.0068, -0.0171, -0.0102]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24392492 0.20631252 0.19159181 0.18385482 0.17431596]
np_weight_alpha[1] [0.20743588 0.22674526 0.19489293 0.19061391 0.18031201]
np_weight_alpha[2] [0.19390175 0.19741327 0.22322324 0.19504695 0.19041483]
np_weight_alpha[3] [0.18392853 0.1909578  0.19654825 0.2226819  0.2058835 ]
np_weight_alpha[4] [0.17400496 0.15319158 0.17978497 0.2371487  0.25586978]
-------------Round number:  449  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5515873015873016
client Accurancy:  0.5158730158730159
client Accurancy:  0.4007936507936508
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5605442176870749
Average Global Trainning Loss:  1.1733014787946427
All users are selected
model: 0 tensor([0.2439, 0.2063, 0.1916, 0.1839, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0156, 0.0117, 0.0084, 0.0093, 0.0080],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2074, 0.2267, 0.1949, 0.1906, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0036, -0.0052, -0.0057, -0.0097, -0.0050],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1974, 0.2232, 0.1950, 0.1904], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0360, 0.0384, 0.0383, 0.0352, 0.0301],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1910, 0.1965, 0.2227, 0.2059], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0380, -0.0402, -0.0354, -0.0390, -0.0305],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1740, 0.1532, 0.1798, 0.2371, 0.2559], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0389, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0059, -0.0295, -0.0184,  0.0359,  0.0066]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24149098 0.20404428 0.19269985 0.18461269 0.17715222]
np_weight_alpha[1] [0.1956947  0.22429304 0.19374639 0.20946777 0.17679809]
np_weight_alpha[2] [0.19339435 0.19440216 0.22131145 0.1952184  0.19567366]
np_weight_alpha[3] [0.18537515 0.19418329 0.19495893 0.22615118 0.19933139]
np_weight_alpha[4] [0.1774023  0.17992316 0.1943936  0.1973339  0.25094703]
-------------Round number:  450  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5674603174603174
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.5404761904761904
Average Global Trainning Loss:  1.221576384460034
All users are selected
model: 0 tensor([0.2415, 0.2040, 0.1927, 0.1846, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0203, -0.0099, -0.0165, -0.0192, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1957, 0.2243, 0.1937, 0.2095, 0.1768], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0076, -0.0115, -0.0015,  0.0149, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1944, 0.2213, 0.1952, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0011,  0.0029, -0.0014, -0.0032, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 25.0
model: 3 tensor([0.1854, 0.1942, 0.1950, 0.2262, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0089, -0.0021, -0.0084, -0.0031, -0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1774, 0.1799, 0.1944, 0.1973, 0.2509], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0307, 0.0172, 0.0248, 0.0238, 0.0325]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25031552 0.197138   0.19246607 0.18738347 0.17269693]
np_weight_alpha[1] [0.19828658 0.2331857  0.19042332 0.18980025 0.18830417]
np_weight_alpha[2] [0.19886136 0.12111524 0.23736222 0.26029965 0.18236148]
np_weight_alpha[3] [0.20142373 0.17747656 0.20882167 0.21390301 0.19837502]
np_weight_alpha[4] [0.17299387 0.18748291 0.19396687 0.19783463 0.24772176]
-------------Round number:  451  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5515873015873016
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4603174603174603
Average Global Trainning Accurancy:  0.5574829931972789
Average Global Trainning Loss:  1.1816393793845663
All users are selected
model: 0 tensor([0.2503, 0.1971, 0.1925, 0.1874, 0.1727], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0151, -0.0349, -0.0248, -0.0216, -0.0254],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2332, 0.1904, 0.1898, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0392, -0.0222, -0.0344, -0.0307, -0.0210],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1989, 0.1211, 0.2374, 0.2603, 0.1824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0578, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0323, -0.0490,  0.0423,  0.0925,  0.0194],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2014, 0.1775, 0.2088, 0.2139, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0483, 0.0170, 0.0426, 0.0227, 0.0227],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1730, 0.1875, 0.1940, 0.1978, 0.2477], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0093, -0.0014, -0.0064, -0.0168, -0.0100]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24383166 0.2063853  0.19165725 0.18392761 0.1741981 ]
np_weight_alpha[1] [0.20750153 0.22695193 0.19474165 0.19058996 0.18021488]
np_weight_alpha[2] [0.19387454 0.19727005 0.22350773 0.19501114 0.19033647]
np_weight_alpha[3] [0.18401109 0.19093882 0.19649084 0.22259131 0.20596799]
np_weight_alpha[4] [0.17369147 0.15314902 0.17941296 0.23701215 0.25673437]
-------------Round number:  452  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5634920634920635
client Accurancy:  0.5158730158730159
client Accurancy:  0.40476190476190477
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.46746031746031746
Average Global Trainning Accurancy:  0.5612244897959183
Average Global Trainning Loss:  1.1678430258822279
All users are selected
model: 0 tensor([0.2438, 0.2064, 0.1917, 0.1839, 0.1742], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0145, 0.0112, 0.0078, 0.0085, 0.0071],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2075, 0.2270, 0.1947, 0.1906, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0020, -0.0038, -0.0045, -0.0084, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1973, 0.2235, 0.1950, 0.1903], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0372, 0.0374, 0.0342, 0.0288],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1909, 0.1965, 0.2226, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0381, -0.0404, -0.0355, -0.0393, -0.0306],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1737, 0.1531, 0.1794, 0.2370, 0.2567], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0395, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0055, -0.0290, -0.0183,  0.0365,  0.0085]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22133203 0.19916815 0.201253   0.19030689 0.18793993]
np_weight_alpha[1] [0.1944457  0.22396849 0.19412522 0.20974375 0.1777168 ]
np_weight_alpha[2] [0.19327243 0.19434835 0.2214322  0.1951112  0.19583589]
np_weight_alpha[3] [0.18540762 0.19420595 0.19485036 0.22623082 0.19930534]
np_weight_alpha[4] [0.17744215 0.18005984 0.19458123 0.19732282 0.250594  ]
-------------Round number:  453  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5634920634920635
client Accurancy:  0.5
client Accurancy:  0.373015873015873
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.5374149659863946
Average Global Trainning Loss:  1.2317592906303145
All users are selected
model: 0 tensor([0.2213, 0.1992, 0.2013, 0.1903, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0414, -0.0145, -0.0066, -0.0124,  0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1944, 0.2240, 0.1941, 0.2097, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0102, -0.0131, -0.0021,  0.0139, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1943, 0.2214, 0.1951, 0.1958], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0014,  0.0025, -0.0020, -0.0041, -0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1854, 0.1942, 0.1949, 0.2262, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0079, -0.0012, -0.0078, -0.0021, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1774, 0.1801, 0.1946, 0.1973, 0.2506], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0301, 0.0167, 0.0243, 0.0236, 0.0317]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25223267 0.19742687 0.19169909 0.18689184 0.17174959]
np_weight_alpha[1] [0.19837394 0.23327102 0.19018519 0.18984155 0.18832828]
np_weight_alpha[2] [0.19387272 0.17663519 0.2264765  0.20920336 0.19381224]
np_weight_alpha[3] [0.2013473  0.177724   0.21053824 0.21358995 0.19680052]
np_weight_alpha[4] [0.17313509 0.18758619 0.19414116 0.19751889 0.24761866]
-------------Round number:  454  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5515873015873016
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.5608843537414966
Average Global Trainning Loss:  1.1747063669217688
All users are selected
model: 0 tensor([0.2522, 0.1974, 0.1917, 0.1869, 0.1717], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0125, -0.0341, -0.0249, -0.0218, -0.0261],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1984, 0.2333, 0.1902, 0.1898, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0379, -0.0210, -0.0336, -0.0295, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1766, 0.2265, 0.2092, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0309, 0.0108, 0.0335, 0.0428, 0.0327],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2013, 0.1777, 0.2105, 0.2136, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0476, 0.0167, 0.0440, 0.0217, 0.0206],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1731, 0.1876, 0.1941, 0.1975, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0092, -0.0011, -0.0063, -0.0169, -0.0099]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24364404 0.20629366 0.19154508 0.18411152 0.17440568]
np_weight_alpha[1] [0.20744541 0.22691952 0.19487432 0.19063583 0.18012495]
np_weight_alpha[2] [0.19286688 0.19565019 0.22412945 0.19621533 0.19113807]
np_weight_alpha[3] [0.18410647 0.19094865 0.1962001  0.22277835 0.20596647]
np_weight_alpha[4] [0.17356616 0.15235555 0.17939259 0.2379483  0.25673738]
-------------Round number:  455  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5634920634920635
client Accurancy:  0.5158730158730159
client Accurancy:  0.40476190476190477
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.564625850340136
Average Global Trainning Loss:  1.1635062081473215
All users are selected
model: 0 tensor([0.2436, 0.2063, 0.1915, 0.1841, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0152, 0.0116, 0.0080, 0.0092, 0.0077],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2074, 0.2269, 0.1949, 0.1906, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0024, -0.0041, -0.0045, -0.0086, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1929, 0.1957, 0.2241, 0.1962, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0340, 0.0361, 0.0384, 0.0360, 0.0302],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1909, 0.1962, 0.2228, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0380, -0.0404, -0.0357, -0.0392, -0.0307],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1736, 0.1524, 0.1794, 0.2379, 0.2567], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0403, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0064, -0.0304, -0.0188,  0.0369,  0.0080]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24136548 0.20390378 0.19283456 0.18465656 0.17723958]
np_weight_alpha[1] [0.19490609 0.22455464 0.19305833 0.20951916 0.17796175]
np_weight_alpha[2] [0.19361179 0.1943232  0.22150002 0.19490328 0.19566171]
np_weight_alpha[3] [0.18540862 0.1941995  0.19470495 0.22629178 0.19939512]
np_weight_alpha[4] [0.17756571 0.18008325 0.19452862 0.19738054 0.25044185]
-------------Round number:  456  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5674603174603174
client Accurancy:  0.49603174603174605
client Accurancy:  0.373015873015873
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.5428571428571428
Average Global Trainning Loss:  1.215793075042517
All users are selected
model: 0 tensor([0.2414, 0.2039, 0.1928, 0.1847, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0209, -0.0108, -0.0171, -0.0199, -0.0115],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1949, 0.2246, 0.1931, 0.2095, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0089, -0.0118, -0.0023,  0.0144, -0.0158],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1943, 0.2215, 0.1949, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0017,  0.0024, -0.0021, -0.0044, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1854, 0.1942, 0.1947, 0.2263, 0.1994], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-6.7472e-03,  3.7060e-06, -6.7358e-03, -1.2816e-03, -2.9911e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1776, 0.1801, 0.1945, 0.1974, 0.2504], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0304, 0.0169, 0.0248, 0.0242, 0.0324]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2499767  0.19709022 0.19249785 0.18735011 0.17308506]
np_weight_alpha[1] [0.19827409 0.23332013 0.19007339 0.18977539 0.18855704]
np_weight_alpha[2] [0.19427411 0.176042   0.22580138 0.20941706 0.1944654 ]
np_weight_alpha[3] [0.20094934 0.17736931 0.21045046 0.21504095 0.19618991]
np_weight_alpha[4] [0.17339043 0.18783705 0.19415355 0.19750057 0.24711843]
-------------Round number:  457  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5515873015873016
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.5595238095238095
Average Global Trainning Loss:  1.172906950866284
All users are selected
model: 0 tensor([0.2500, 0.1971, 0.1925, 0.1874, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0147, -0.0343, -0.0239, -0.0210, -0.0247],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2333, 0.1901, 0.1898, 0.1886], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0380, -0.0210, -0.0335, -0.0296, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1760, 0.2258, 0.2094, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0317, 0.0107, 0.0329, 0.0434, 0.0335],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2009, 0.1774, 0.2105, 0.2150, 0.1962], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0462, 0.0153, 0.0430, 0.0221, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1734, 0.1878, 0.1942, 0.1975, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0088, -0.0005, -0.0060, -0.0166, -0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24373934 0.2063449  0.19148687 0.1839652  0.1744637 ]
np_weight_alpha[1] [0.20743868 0.22708975 0.19467312 0.19063625 0.1801622 ]
np_weight_alpha[2] [0.1928341  0.19546784 0.22434975 0.19615096 0.19119735]
np_weight_alpha[3] [0.18403436 0.19096941 0.19613932 0.22285616 0.20600075]
np_weight_alpha[4] [0.1734668  0.15171932 0.17977098 0.2382293  0.25681362]
-------------Round number:  458  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5674603174603174
client Accurancy:  0.5119047619047619
client Accurancy:  0.40476190476190477
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.46746031746031746
Average Global Trainning Accurancy:  0.5636054421768707
Average Global Trainning Loss:  1.1610771750106292
All users are selected
model: 0 tensor([0.2437, 0.2063, 0.1915, 0.1840, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0167, 0.0127, 0.0091, 0.0099, 0.0086],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2074, 0.2271, 0.1947, 0.1906, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0020, -0.0036, -0.0043, -0.0082, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1928, 0.1955, 0.2243, 0.1962, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0334, 0.0352, 0.0378, 0.0352, 0.0295],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1910, 0.1961, 0.2229, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0393, -0.0413, -0.0368, -0.0399, -0.0315],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1735, 0.1517, 0.1798, 0.2382, 0.2568], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0407, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0064, -0.0309, -0.0181,  0.0375,  0.0086]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24099024 0.20391521 0.19276987 0.18489173 0.17743297]
np_weight_alpha[1] [0.19494852 0.22389771 0.1935092  0.20936778 0.1782768 ]
np_weight_alpha[2] [0.19352236 0.19425036 0.22158882 0.19496661 0.19567189]
np_weight_alpha[3] [0.18563417 0.19417913 0.19477662 0.22611424 0.19929582]
np_weight_alpha[4] [0.17775685 0.18020895 0.1945472  0.19729525 0.25019172]
-------------Round number:  459  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5674603174603174
client Accurancy:  0.49603174603174605
client Accurancy:  0.373015873015873
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.5462585034013605
Average Global Trainning Loss:  1.213768617798682
All users are selected
model: 0 tensor([0.2410, 0.2039, 0.1928, 0.1849, 0.1774], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0201, -0.0094, -0.0159, -0.0181, -0.0099],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1949, 0.2239, 0.1935, 0.2094, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0084, -0.0119, -0.0017,  0.0146, -0.0149],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1935, 0.1943, 0.2216, 0.1950, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0025,  0.0014, -0.0027, -0.0048, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1856, 0.1942, 0.1948, 0.2261, 0.1993], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0008, -0.0071, -0.0023, -0.0038],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1778, 0.1802, 0.1945, 0.1973, 0.2502], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0302, 0.0168, 0.0245, 0.0236, 0.0315]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25019524 0.1970448  0.19254933 0.18717887 0.17303176]
np_weight_alpha[1] [0.19825192 0.23316    0.1902885  0.189908   0.18839155]
np_weight_alpha[2] [0.19505957 0.17739783 0.225707   0.20798755 0.19384801]
np_weight_alpha[3] [0.19916251 0.17804883 0.2089559  0.21696669 0.19686608]
np_weight_alpha[4] [0.17333162 0.18765853 0.19402453 0.1975332  0.24745215]
-------------Round number:  460  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5515873015873016
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5625850340136055
Average Global Trainning Loss:  1.1665231717687075
All users are selected
model: 0 tensor([0.2502, 0.1970, 0.1925, 0.1872, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0145, -0.0342, -0.0237, -0.0209, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2332, 0.1903, 0.1899, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0374, -0.0207, -0.0327, -0.0289, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1951, 0.1774, 0.2257, 0.2080, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0342, 0.0137, 0.0344, 0.0435, 0.0345],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1992, 0.1780, 0.2090, 0.2170, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0433, 0.0147, 0.0403, 0.0226, 0.0186],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1733, 0.1877, 0.1940, 0.1975, 0.2475], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0099, -0.0016, -0.0072, -0.0175, -0.0106]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24397415 0.20633    0.19143552 0.1838032  0.17445713]
np_weight_alpha[1] [0.20743655 0.2272072  0.19469112 0.1906063  0.18005888]
np_weight_alpha[2] [0.19271003 0.19542979 0.22437552 0.19621995 0.19126473]
np_weight_alpha[3] [0.1839699  0.19096397 0.19618557 0.22310355 0.20577703]
np_weight_alpha[4] [0.17376246 0.15192644 0.18021904 0.2374341  0.25665793]
-------------Round number:  461  -------------
client Accurancy:  0.5
client Accurancy:  0.5634920634920635
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.567687074829932
Average Global Trainning Loss:  1.1536778871704931
All users are selected
model: 0 tensor([0.2440, 0.2063, 0.1914, 0.1838, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0173, 0.0135, 0.0097, 0.0101, 0.0090],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2074, 0.2272, 0.1947, 0.1906, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0022, -0.0041, -0.0048, -0.0087, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1927, 0.1954, 0.2244, 0.1962, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0348, 0.0375, 0.0348, 0.0292],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1910, 0.1962, 0.2231, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0394, -0.0413, -0.0367, -0.0394, -0.0315],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1738, 0.1519, 0.1802, 0.2374, 0.2567], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0400, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0305, -0.0176,  0.0369,  0.0085]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24114603 0.20364426 0.19261442 0.18502359 0.17757173]
np_weight_alpha[1] [0.193638   0.22427966 0.19392793 0.20982087 0.17833365]
np_weight_alpha[2] [0.19337086 0.1943529  0.22154672 0.1950441  0.19568549]
np_weight_alpha[3] [0.1857735  0.19424856 0.19486085 0.225953   0.19916418]
np_weight_alpha[4] [0.17784576 0.18013044 0.19454826 0.19719157 0.25028393]
-------------Round number:  462  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5674603174603174
client Accurancy:  0.49603174603174605
client Accurancy:  0.376984126984127
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.5493197278911565
Average Global Trainning Loss:  1.2078394883343964
All users are selected
model: 0 tensor([0.2411, 0.2036, 0.1926, 0.1850, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0189, -0.0088, -0.0150, -0.0169, -0.0089],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1936, 0.2243, 0.1939, 0.2098, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0098, -0.0115, -0.0012,  0.0152, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1944, 0.2215, 0.1950, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0029,  0.0012, -0.0033, -0.0051, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1858, 0.1942, 0.1949, 0.2260, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0010, -0.0073, -0.0029, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1778, 0.1801, 0.1945, 0.1972, 0.2503], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0299, 0.0164, 0.0242, 0.0231, 0.0313]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25014928 0.197147   0.19247007 0.18709102 0.17314258]
np_weight_alpha[1] [0.19841994 0.23316498 0.19027682 0.18982749 0.1883108 ]
np_weight_alpha[2] [0.19522193 0.17700826 0.2267212  0.20757942 0.1934692 ]
np_weight_alpha[3] [0.19802871 0.17749918 0.20852445 0.21834998 0.19759774]
np_weight_alpha[4] [0.17344697 0.18762463 0.19397475 0.19757405 0.24737959]
-------------Round number:  463  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.5079365079365079
client Accurancy:  0.3968253968253968
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.5653061224489796
Average Global Trainning Loss:  1.1601657166772958
All users are selected
model: 0 tensor([0.2501, 0.1971, 0.1925, 0.1871, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0130, -0.0326, -0.0222, -0.0197, -0.0230],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1984, 0.2332, 0.1903, 0.1898, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0359, -0.0192, -0.0312, -0.0276, -0.0177],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1952, 0.1770, 0.2267, 0.2076, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0122, 0.0341, 0.0419, 0.0328],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1980, 0.1775, 0.2085, 0.2183, 0.1976], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0396, 0.0117, 0.0376, 0.0220, 0.0172],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1734, 0.1876, 0.1940, 0.1976, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0092, -0.0011, -0.0067, -0.0169, -0.0103]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2438301  0.20638543 0.19140103 0.18396801 0.1744154 ]
np_weight_alpha[1] [0.20747982 0.22708492 0.19460514 0.19074503 0.18008515]
np_weight_alpha[2] [0.19264688 0.19533236 0.22451    0.19621642 0.19129439]
np_weight_alpha[3] [0.18424001 0.19116081 0.19618556 0.22275908 0.20565459]
np_weight_alpha[4] [0.17307507 0.15205541 0.18039839 0.2370239  0.25744724]
-------------Round number:  464  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5634920634920635
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.5710884353741497
Average Global Trainning Loss:  1.1500690070950255
All users are selected
model: 0 tensor([0.2438, 0.2064, 0.1914, 0.1840, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0180, 0.0142, 0.0103, 0.0106, 0.0096],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2075, 0.2271, 0.1946, 0.1907, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0017, -0.0040, -0.0045, -0.0083, -0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1926, 0.1953, 0.2245, 0.1962, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0339, 0.0356, 0.0385, 0.0358, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1912, 0.1962, 0.2228, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0405, -0.0422, -0.0377, -0.0406, -0.0326],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1731, 0.1521, 0.1804, 0.2370, 0.2574], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0404, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0075, -0.0310, -0.0183,  0.0359,  0.0087]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24089988 0.20359407 0.19259791 0.18533847 0.17756969]
np_weight_alpha[1] [0.19317143 0.22542757 0.19393995 0.2093388  0.17812222]
np_weight_alpha[2] [0.19333981 0.19429287 0.22154175 0.19496204 0.19586353]
np_weight_alpha[3] [0.18608117 0.19428049 0.19478571 0.22575442 0.19909815]
np_weight_alpha[4] [0.17785627 0.1801379  0.194724   0.19712721 0.25015467]
-------------Round number:  465  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5634920634920635
client Accurancy:  0.49206349206349204
client Accurancy:  0.376984126984127
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.5513605442176871
Average Global Trainning Loss:  1.2050626793686225
All users are selected
model: 0 tensor([0.2409, 0.2036, 0.1926, 0.1853, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0188, -0.0078, -0.0142, -0.0159, -0.0079],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1932, 0.2254, 0.1939, 0.2093, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0116, -0.0020,  0.0137, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1943, 0.2215, 0.1950, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0039,  0.0003, -0.0043, -0.0062, -0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1861, 0.1943, 0.1948, 0.2258, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0002, -0.0067, -0.0025, -0.0034],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1779, 0.1801, 0.1947, 0.1971, 0.2502], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0306, 0.0167, 0.0247, 0.0238, 0.0316]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2507029  0.19685291 0.19238704 0.1871434  0.17291373]
np_weight_alpha[1] [0.19814314 0.23345038 0.19006431 0.18980975 0.18853249]
np_weight_alpha[2] [0.19504015 0.17621638 0.226957   0.20819521 0.19359124]
np_weight_alpha[3] [0.19720362 0.17721555 0.20910445 0.21970184 0.19677445]
np_weight_alpha[4] [0.17325088 0.18782908 0.1941348  0.19735922 0.24742602]
-------------Round number:  466  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5683673469387756
Average Global Trainning Loss:  1.1566618004623725
All users are selected
model: 0 tensor([0.2507, 0.1969, 0.1924, 0.1871, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0123, -0.0329, -0.0223, -0.0198, -0.0232],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2335, 0.1901, 0.1898, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0350, -0.0180, -0.0301, -0.0265, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1950, 0.1762, 0.2270, 0.2082, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0330, 0.0115, 0.0341, 0.0426, 0.0330],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1972, 0.1772, 0.2091, 0.2197, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0386, 0.0114, 0.0383, 0.0234, 0.0163],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1733, 0.1878, 0.1941, 0.1974, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0106, -0.0021, -0.0078, -0.0184, -0.0115]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24367824 0.20638551 0.19141692 0.18409792 0.17442137]
np_weight_alpha[1] [0.2074816  0.227372   0.19447337 0.19070171 0.17997134]
np_weight_alpha[2] [0.19267373 0.19523442 0.22473732 0.19606622 0.19128838]
np_weight_alpha[3] [0.18440193 0.19115348 0.19603777 0.22268595 0.20572084]
np_weight_alpha[4] [0.17377315 0.17913781 0.19025935 0.20388229 0.25294736]
-------------Round number:  467  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5595238095238095
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.5670068027210884
Average Global Trainning Loss:  1.1623513565582484
All users are selected
model: 0 tensor([0.2437, 0.2064, 0.1914, 0.1841, 0.1744], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0181, 0.0142, 0.0104, 0.0107, 0.0099],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2075, 0.2274, 0.1945, 0.1907, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0009, -0.0028, -0.0036, -0.0074, -0.0032],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1927, 0.1952, 0.2247, 0.1961, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0333, 0.0350, 0.0381, 0.0351, 0.0293],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1912, 0.1960, 0.2227, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0413, -0.0430, -0.0386, -0.0414, -0.0334],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1738, 0.1791, 0.1903, 0.2039, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0071, -0.0043, -0.0095,  0.0003,  0.0019]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24079184 0.2036873  0.19266334 0.18546681 0.17739075]
np_weight_alpha[1] [0.19361083 0.22426468 0.19413394 0.20927581 0.17871481]
np_weight_alpha[2] [0.19340199 0.19421989 0.22156316 0.19492093 0.19589399]
np_weight_alpha[3] [0.18621475 0.19422959 0.19474752 0.22565264 0.19915543]
np_weight_alpha[4] [0.1901591  0.18184932 0.21909916 0.18340074 0.22549163]
-------------Round number:  468  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5595238095238095
client Accurancy:  0.49603174603174605
client Accurancy:  0.376984126984127
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.5476190476190477
Average Global Trainning Loss:  1.228481744260204
All users are selected
model: 0 tensor([0.2408, 0.2037, 0.1927, 0.1855, 0.1774], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0190, -0.0082, -0.0146, -0.0164, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1936, 0.2243, 0.1941, 0.2093, 0.1787], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0112, -0.0133, -0.0025,  0.0132, -0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1934, 0.1942, 0.2216, 0.1949, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0054, -0.0015, -0.0059, -0.0078, -0.0044],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1862, 0.1942, 0.1947, 0.2257, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0011, -0.0076, -0.0036, -0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1902, 0.1818, 0.2191, 0.1834, 0.2255], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0485, 0.0232, 0.0543, 0.0141, 0.0095]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2501967  0.19690196 0.19243455 0.18732259 0.1731442 ]
np_weight_alpha[1] [0.19816214 0.23347208 0.19019702 0.18971923 0.18844952]
np_weight_alpha[2] [0.19492033 0.17718132 0.2271296  0.20832038 0.19244842]
np_weight_alpha[3] [0.19742425 0.17699324 0.20918411 0.22061265 0.19578572]
np_weight_alpha[4] [0.17216492 0.18741772 0.19321513 0.19763115 0.24957116]
-------------Round number:  469  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5673469387755102
Average Global Trainning Loss:  1.1506801890678147
All users are selected
model: 0 tensor([0.2502, 0.1969, 0.1924, 0.1873, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0126, -0.0327, -0.0219, -0.0192, -0.0228],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2335, 0.1902, 0.1897, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0350, -0.0180, -0.0299, -0.0264, -0.0163],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1949, 0.1772, 0.2271, 0.2083, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0330, 0.0125, 0.0340, 0.0428, 0.0317],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1974, 0.1770, 0.2092, 0.2206, 0.1958], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0389, 0.0113, 0.0384, 0.0239, 0.0152],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1722, 0.1874, 0.1932, 0.1976, 0.2496], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0121, -0.0028, -0.0090, -0.0183, -0.0092]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2437957  0.20645605 0.19130048 0.18397895 0.17446877]
np_weight_alpha[1] [0.20754233 0.22745003 0.1944307  0.19055109 0.18002585]
np_weight_alpha[2] [0.19252709 0.19514713 0.22497737 0.19597502 0.19137344]
np_weight_alpha[3] [0.18426675 0.19097994 0.19592556 0.22305922 0.20576845]
np_weight_alpha[4] [0.17397343 0.17927276 0.19032708 0.20386764 0.25255907]
-------------Round number:  470  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5555555555555556
client Accurancy:  0.503968253968254
client Accurancy:  0.4007936507936508
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4603174603174603
Average Global Trainning Accurancy:  0.5683673469387756
Average Global Trainning Loss:  1.158352432769983
All users are selected
model: 0 tensor([0.2438, 0.2065, 0.1913, 0.1840, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0188, 0.0150, 0.0110, 0.0111, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2075, 0.2275, 0.1944, 0.1906, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0003, -0.0024, -0.0032, -0.0069, -0.0026],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1925, 0.1951, 0.2250, 0.1960, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0327, 0.0344, 0.0377, 0.0347, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1910, 0.1959, 0.2231, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0421, -0.0436, -0.0391, -0.0418, -0.0338],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1740, 0.1793, 0.1903, 0.2039, 0.2526], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0042, -0.0096,  0.0002,  0.0014]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24075757 0.20359962 0.19257767 0.18556754 0.17749764]
np_weight_alpha[1] [0.19292748 0.22508352 0.1942798  0.2092962  0.17841302]
np_weight_alpha[2] [0.1933092  0.19421887 0.22182958 0.19476725 0.19587514]
np_weight_alpha[3] [0.18631175 0.19412084 0.19459562 0.22588585 0.19908594]
np_weight_alpha[4] [0.18978384 0.18119185 0.21872137 0.18316822 0.22713466]
-------------Round number:  471  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5674603174603174
client Accurancy:  0.49206349206349204
client Accurancy:  0.373015873015873
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.5506802721088435
Average Global Trainning Loss:  1.2205870336415816
All users are selected
model: 0 tensor([0.2408, 0.2036, 0.1926, 0.1856, 0.1775], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0181, -0.0073, -0.0137, -0.0151, -0.0074],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1929, 0.2251, 0.1943, 0.2093, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0120, -0.0123, -0.0024,  0.0131, -0.0164],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1942, 0.2218, 0.1948, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0062, -0.0021, -0.0061, -0.0085, -0.0050],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1863, 0.1941, 0.1946, 0.2259, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0014, -0.0080, -0.0035, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1898, 0.1812, 0.2187, 0.1832, 0.2271], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0479, 0.0221, 0.0536, 0.0135, 0.0108]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2504251  0.19695409 0.1924637  0.18720452 0.17295256]
np_weight_alpha[1] [0.19825856 0.23322918 0.19025064 0.18976572 0.18849584]
np_weight_alpha[2] [0.19557871 0.17745069 0.22512846 0.20915586 0.19268626]
np_weight_alpha[3] [0.19652227 0.17760168 0.20998527 0.21983315 0.1960576 ]
np_weight_alpha[4] [0.1720378  0.18747412 0.1932457  0.19761533 0.24962713]
-------------Round number:  472  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4634920634920635
Average Global Trainning Accurancy:  0.5693877551020409
Average Global Trainning Loss:  1.1446525729432397
All users are selected
model: 0 tensor([0.2504, 0.1970, 0.1925, 0.1872, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0116, -0.0321, -0.0214, -0.0186, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2332, 0.1903, 0.1898, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0335, -0.0171, -0.0282, -0.0248, -0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1956, 0.1775, 0.2251, 0.2092, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0124, 0.0314, 0.0429, 0.0313],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1965, 0.1776, 0.2100, 0.2198, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0367, 0.0106, 0.0377, 0.0215, 0.0142],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1720, 0.1875, 0.1932, 0.1976, 0.2496], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0123, -0.0027, -0.0090, -0.0182, -0.0091]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2435606  0.20652653 0.19142231 0.18388934 0.17460117]
np_weight_alpha[1] [0.2076045  0.22775912 0.19417714 0.19048393 0.17997533]
np_weight_alpha[2] [0.19261798 0.19489817 0.22496732 0.19609357 0.19142295]
np_weight_alpha[3] [0.18418458 0.1909217  0.19602984 0.2232271  0.20563671]
np_weight_alpha[4] [0.17408851 0.17924727 0.19038796 0.2037629  0.25251335]
-------------Round number:  473  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5595238095238095
client Accurancy:  0.503968253968254
client Accurancy:  0.4007936507936508
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.5710884353741497
Average Global Trainning Loss:  1.1533447265625
All users are selected
model: 0 tensor([0.2436, 0.2065, 0.1914, 0.1839, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0180, 0.0147, 0.0109, 0.0107, 0.0101],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2278, 0.1942, 0.1905, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 7.0996e-05, -1.8242e-03, -2.9948e-03, -6.7911e-03, -2.4849e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1926, 0.1949, 0.2250, 0.1961, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0344, 0.0374, 0.0349, 0.0289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1909, 0.1960, 0.2232, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0419, -0.0435, -0.0388, -0.0414, -0.0338],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1741, 0.1792, 0.1904, 0.2038, 0.2525], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-7.2541e-03, -4.4136e-03, -9.6848e-03,  3.9403e-05,  1.5981e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2409466  0.20361583 0.19234623 0.18548834 0.17760299]
np_weight_alpha[1] [0.1927734  0.22355752 0.1946152  0.210075   0.17897885]
np_weight_alpha[2] [0.19307101 0.19406869 0.22214478 0.19473732 0.19597815]
np_weight_alpha[3] [0.18624128 0.19420089 0.19456933 0.22587332 0.1991151 ]
np_weight_alpha[4] [0.19005805 0.18165521 0.21911433 0.18371105 0.22546138]
-------------Round number:  474  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5634920634920635
client Accurancy:  0.49206349206349204
client Accurancy:  0.373015873015873
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.5510204081632653
Average Global Trainning Loss:  1.2199533475499575
All users are selected
model: 0 tensor([0.2409, 0.2036, 0.1923, 0.1855, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0176, -0.0072, -0.0141, -0.0154, -0.0080],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1928, 0.2236, 0.1946, 0.2101, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0119, -0.0140, -0.0019,  0.0141, -0.0159],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1941, 0.2221, 0.1947, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0082, -0.0040, -0.0077, -0.0103, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1862, 0.1942, 0.1946, 0.2259, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-5.9196e-03, -6.3526e-05, -6.7762e-03, -2.5541e-03, -2.9923e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1901, 0.1817, 0.2191, 0.1837, 0.2255], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0483, 0.0231, 0.0548, 0.0149, 0.0102]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24990562 0.19678198 0.19255921 0.18729055 0.17346269]
np_weight_alpha[1] [0.19807917 0.23347013 0.19016656 0.18968165 0.18860246]
np_weight_alpha[2] [0.19687873 0.17776267 0.22479793 0.20903458 0.19152613]
np_weight_alpha[3] [0.19700664 0.17708571 0.2098292  0.22080053 0.19527788]
np_weight_alpha[4] [0.1725068  0.18764333 0.19311668 0.19751061 0.24922262]
-------------Round number:  475  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.3968253968253968
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5687074829931973
Average Global Trainning Loss:  1.142603369472789
All users are selected
model: 0 tensor([0.2499, 0.1968, 0.1926, 0.1873, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0115, -0.0317, -0.0208, -0.0182, -0.0211],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2335, 0.1902, 0.1897, 0.1886], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0337, -0.0169, -0.0282, -0.0248, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1969, 0.1778, 0.2248, 0.2090, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0341, 0.0126, 0.0307, 0.0428, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1970, 0.1771, 0.2098, 0.2208, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0365, 0.0097, 0.0374, 0.0221, 0.0131],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1876, 0.1931, 0.1975, 0.2492], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115, -0.0025, -0.0091, -0.0183, -0.0100]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.243519   0.20655647 0.19148779 0.18414591 0.1742909 ]
np_weight_alpha[1] [0.20761879 0.22788277 0.19415887 0.19041863 0.179921  ]
np_weight_alpha[2] [0.19258873 0.19483319 0.22516944 0.19592655 0.19148204]
np_weight_alpha[3] [0.18444829 0.19086885 0.1958376  0.22325847 0.20558687]
np_weight_alpha[4] [0.17374422 0.17914954 0.19032204 0.20365807 0.25312614]
-------------Round number:  476  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5555555555555556
client Accurancy:  0.5119047619047619
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5727891156462585
Average Global Trainning Loss:  1.1473584648703232
All users are selected
model: 0 tensor([0.2435, 0.2066, 0.1915, 0.1841, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0186, 0.0153, 0.0115, 0.0113, 0.0103],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2279, 0.1942, 0.1904, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0004, -0.0017, -0.0028, -0.0067, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1926, 0.1948, 0.2252, 0.1959, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0324, 0.0336, 0.0369, 0.0341, 0.0283],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1909, 0.1958, 0.2233, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0420, -0.0439, -0.0392, -0.0415, -0.0342],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1737, 0.1791, 0.1903, 0.2037, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0073, -0.0040, -0.0094,  0.0002,  0.0024]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24082215 0.20356509 0.19237983 0.1856168  0.17761613]
np_weight_alpha[1] [0.19245896 0.22396965 0.1947565  0.2104528  0.1783621 ]
np_weight_alpha[2] [0.19310199 0.19409056 0.2221806  0.19467776 0.1959491 ]
np_weight_alpha[3] [0.18636562 0.1942303  0.1945168  0.22572385 0.19916347]
np_weight_alpha[4] [0.19147117 0.18133128 0.21934302 0.18432653 0.22352807]
-------------Round number:  477  -------------
client Accurancy:  0.5
client Accurancy:  0.5634920634920635
client Accurancy:  0.49603174603174605
client Accurancy:  0.373015873015873
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.5517006802721088
Average Global Trainning Loss:  1.218617632599915
All users are selected
model: 0 tensor([0.2408, 0.2036, 0.1924, 0.1856, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0169, -0.0065, -0.0133, -0.0145, -0.0071],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1925, 0.2240, 0.1948, 0.2105, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0130, -0.0143, -0.0024,  0.0137, -0.0171],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1941, 0.2222, 0.1947, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0042, -0.0082, -0.0107, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1864, 0.1942, 0.1945, 0.2257, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0054,  0.0003, -0.0064, -0.0024, -0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1915, 0.1813, 0.2193, 0.1843, 0.2235], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0499, 0.0229, 0.0552, 0.0157, 0.0077]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24982825 0.19685705 0.19258127 0.18730387 0.17342958]
np_weight_alpha[1] [0.19815215 0.23351115 0.1900907  0.18970974 0.18853626]
np_weight_alpha[2] [0.19682413 0.17732477 0.22566031 0.20903026 0.19116047]
np_weight_alpha[3] [0.1965467  0.17715386 0.20980382 0.22207126 0.19442436]
np_weight_alpha[4] [0.1723421  0.18751813 0.19298163 0.19735087 0.24980727]
-------------Round number:  478  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5476190476190477
client Accurancy:  0.5158730158730159
client Accurancy:  0.3968253968253968
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5700680272108843
Average Global Trainning Loss:  1.1365523357780611
All users are selected
model: 0 tensor([0.2498, 0.1969, 0.1926, 0.1873, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0113, -0.0314, -0.0205, -0.0179, -0.0210],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2335, 0.1901, 0.1897, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0323, -0.0158, -0.0270, -0.0233, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1968, 0.1773, 0.2257, 0.2090, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0338, 0.0119, 0.0312, 0.0426, 0.0294],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1965, 0.1772, 0.2098, 0.2221, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0348, 0.0086, 0.0360, 0.0219, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1723, 0.1875, 0.1930, 0.1974, 0.2498], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0119, -0.0025, -0.0091, -0.0186, -0.0094]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24341041 0.2065818  0.19149171 0.18405907 0.17445706]
np_weight_alpha[1] [0.2076292  0.22810493 0.19419923 0.19027887 0.17978783]
np_weight_alpha[2] [0.1925914  0.19489238 0.22529832 0.19589388 0.19132398]
np_weight_alpha[3] [0.18435755 0.19072668 0.19579971 0.22335362 0.20576248]
np_weight_alpha[4] [0.17392236 0.17904285 0.190173   0.20380399 0.25305778]
-------------Round number:  479  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5595238095238095
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5744897959183674
Average Global Trainning Loss:  1.1421583525988521
All users are selected
model: 0 tensor([0.2434, 0.2066, 0.1915, 0.1841, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0185, 0.0154, 0.0113, 0.0112, 0.0100],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2281, 0.1942, 0.1903, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010, -0.0012, -0.0024, -0.0063, -0.0020],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1926, 0.1949, 0.2253, 0.1959, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0324, 0.0337, 0.0372, 0.0342, 0.0282],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1907, 0.1958, 0.2234, 0.2058], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0426, -0.0445, -0.0397, -0.0422, -0.0345],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1739, 0.1790, 0.1902, 0.2038, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0074, -0.0042, -0.0096,  0.0004,  0.0029]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2406959  0.20333853 0.19246158 0.1855776  0.17792639]
np_weight_alpha[1] [0.19127183 0.22407347 0.19471474 0.21058771 0.1793522 ]
np_weight_alpha[2] [0.19317353 0.19411135 0.22204542 0.19462705 0.1960427 ]
np_weight_alpha[3] [0.18630582 0.19413604 0.19445464 0.22596632 0.1991372 ]
np_weight_alpha[4] [0.19247548 0.1822637  0.22052789 0.18372948 0.22100338]
-------------Round number:  480  -------------
client Accurancy:  0.5
client Accurancy:  0.5634920634920635
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.5537414965986395
Average Global Trainning Loss:  1.2160244273490646
All users are selected
model: 0 tensor([0.2407, 0.2033, 0.1925, 0.1856, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0169, -0.0067, -0.0135, -0.0146, -0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1913, 0.2241, 0.1947, 0.2106, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0138, -0.0141, -0.0022,  0.0144, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1932, 0.1941, 0.2220, 0.1946, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0091, -0.0047, -0.0086, -0.0108, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1863, 0.1941, 0.1945, 0.2260, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0065, -0.0006, -0.0073, -0.0031, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1925, 0.1823, 0.2205, 0.1837, 0.2210], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0520, 0.0251, 0.0575, 0.0156, 0.0062]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24965183 0.1967967  0.19281705 0.1873     0.17343444]
np_weight_alpha[1] [0.1981523  0.23380354 0.19024162 0.18953641 0.1882661 ]
np_weight_alpha[2] [0.19777396 0.17800845 0.2259459  0.20818403 0.19008762]
np_weight_alpha[3] [0.19673832 0.17682388 0.2090437  0.22074145 0.19665273]
np_weight_alpha[4] [0.1722345  0.1872808  0.192805   0.1978065  0.24987319]
-------------Round number:  481  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5476190476190477
client Accurancy:  0.5198412698412699
client Accurancy:  0.4007936507936508
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.5717687074829932
Average Global Trainning Loss:  1.1300674957482992
All users are selected
model: 0 tensor([0.2497, 0.1968, 0.1928, 0.1873, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0112, -0.0311, -0.0198, -0.0172, -0.0206],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2338, 0.1902, 0.1895, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0317, -0.0148, -0.0260, -0.0227, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1978, 0.1780, 0.2259, 0.2082, 0.1901], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0355, 0.0134, 0.0319, 0.0423, 0.0288],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1967, 0.1768, 0.2090, 0.2207, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0340, 0.0071, 0.0340, 0.0190, 0.0119],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1722, 0.1873, 0.1928, 0.1978, 0.2499], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0125, -0.0034, -0.0098, -0.0185, -0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24364609 0.20667854 0.19142108 0.18379964 0.17445467]
np_weight_alpha[1] [0.20772241 0.22808605 0.19403802 0.19020544 0.17994814]
np_weight_alpha[2] [0.19245107 0.19467057 0.225516   0.19591601 0.19144633]
np_weight_alpha[3] [0.1841213  0.19066451 0.19579835 0.22385286 0.20556304]
np_weight_alpha[4] [0.17396937 0.17920415 0.19021003 0.20372744 0.252889  ]
-------------Round number:  482  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5595238095238095
client Accurancy:  0.5198412698412699
client Accurancy:  0.3888888888888889
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5775510204081633
Average Global Trainning Loss:  1.1384514841092688
All users are selected
model: 0 tensor([0.2436, 0.2067, 0.1914, 0.1838, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0190, 0.0157, 0.0114, 0.0110, 0.0102],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2077, 0.2281, 0.1940, 0.1902, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012, -0.0012, -0.0024, -0.0065, -0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1925, 0.1947, 0.2255, 0.1959, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0336, 0.0350, 0.0387, 0.0355, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1907, 0.1958, 0.2239, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0444, -0.0461, -0.0412, -0.0427, -0.0361],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1740, 0.1792, 0.1902, 0.2037, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0074, -0.0041, -0.0095,  0.0002,  0.0022]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24060984 0.20330411 0.19250207 0.18570636 0.17787762]
np_weight_alpha[1] [0.1907113  0.22430493 0.19495066 0.2118276  0.17820556]
np_weight_alpha[2] [0.1932179  0.19404826 0.22219017 0.1947109  0.19583276]
np_weight_alpha[3] [0.18645544 0.19433571 0.19455995 0.2255086  0.19914031]
np_weight_alpha[4] [0.1918231  0.18104726 0.21923208 0.18398267 0.22391485]
-------------Round number:  483  -------------
client Accurancy:  0.5
client Accurancy:  0.5634920634920635
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.5564625850340136
Average Global Trainning Loss:  1.21025772613733
All users are selected
model: 0 tensor([0.2406, 0.2033, 0.1925, 0.1857, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0171, -0.0066, -0.0134, -0.0143, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1907, 0.2243, 0.1950, 0.2118, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0150, -0.0025,  0.0149, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1932, 0.1940, 0.2222, 0.1947, 0.1958], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0101, -0.0055, -0.0096, -0.0118, -0.0082],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1865, 0.1943, 0.1946, 0.2255, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0044,  0.0015, -0.0054, -0.0021, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1918, 0.1810, 0.2192, 0.1840, 0.2239], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0514, 0.0236, 0.0561, 0.0160, 0.0088]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24989574 0.19676372 0.1928792  0.18722832 0.173233  ]
np_weight_alpha[1] [0.1981325  0.23412348 0.18995742 0.18941548 0.1883711 ]
np_weight_alpha[2] [0.19795342 0.17699763 0.22587255 0.20822243 0.19095403]
np_weight_alpha[3] [0.19572592 0.17567207 0.20890139 0.22424594 0.19545475]
np_weight_alpha[4] [0.17212623 0.18740836 0.1928242  0.19754693 0.25009426]
-------------Round number:  484  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.3968253968253968
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.5751700680272109
Average Global Trainning Loss:  1.1259880221619898
All users are selected
model: 0 tensor([0.2499, 0.1968, 0.1929, 0.1872, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0105, -0.0310, -0.0195, -0.0173, -0.0207],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2341, 0.1900, 0.1894, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0317, -0.0146, -0.0263, -0.0226, -0.0126],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1980, 0.1770, 0.2259, 0.2082, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0341, 0.0106, 0.0301, 0.0408, 0.0282],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1957, 0.1757, 0.2089, 0.2242, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0336, 0.0070, 0.0349, 0.0234, 0.0119],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1721, 0.1874, 0.1928, 0.1975, 0.2501], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0123, -0.0028, -0.0093, -0.0182, -0.0093]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24332108 0.20669048 0.19135764 0.18406479 0.17456606]
np_weight_alpha[1] [0.20771591 0.22828162 0.19409347 0.19005856 0.17985043]
np_weight_alpha[2] [0.19238855 0.19477043 0.22566512 0.19583175 0.1913442 ]
np_weight_alpha[3] [0.18445069 0.19057679 0.19573364 0.22386159 0.20537733]
np_weight_alpha[4] [0.1740346  0.17910847 0.19016224 0.20355803 0.25313672]
-------------Round number:  485  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5595238095238095
client Accurancy:  0.5198412698412699
client Accurancy:  0.3888888888888889
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5789115646258504
Average Global Trainning Loss:  1.1349086216517856
All users are selected
model: 0 tensor([0.2433, 0.2067, 0.1914, 0.1841, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0178, 0.0150, 0.0108, 0.0104, 0.0095],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2077, 0.2283, 0.1941, 0.1901, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0008, -0.0016, -0.0027, -0.0071, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1924, 0.1948, 0.2257, 0.1958, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0339, 0.0352, 0.0386, 0.0355, 0.0300],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1845, 0.1906, 0.1957, 0.2239, 0.2054], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0432, -0.0452, -0.0403, -0.0419, -0.0351],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1740, 0.1791, 0.1902, 0.2036, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0073, -0.0040, -0.0094,  0.0004,  0.0022]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24073792 0.20330718 0.19223653 0.18579471 0.17792366]
np_weight_alpha[1] [0.19073719 0.2242394  0.1944233  0.21226281 0.17833734]
np_weight_alpha[2] [0.19293702 0.1939695  0.22262561 0.19472711 0.1957407 ]
np_weight_alpha[3] [0.1865452  0.19429637 0.19458276 0.2256706  0.19890505]
np_weight_alpha[4] [0.19187242 0.18115726 0.21892181 0.18352066 0.22452784]
-------------Round number:  486  -------------
client Accurancy:  0.5
client Accurancy:  0.5595238095238095
client Accurancy:  0.5
client Accurancy:  0.3611111111111111
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5595238095238095
Average Global Trainning Loss:  1.205136419802296
All users are selected
model: 0 tensor([0.2407, 0.2033, 0.1922, 0.1858, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0163, -0.0060, -0.0132, -0.0138, -0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1907, 0.2242, 0.1944, 0.2123, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0162, -0.0161, -0.0042,  0.0144, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1940, 0.2226, 0.1947, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0099, -0.0051, -0.0088, -0.0111, -0.0075],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1865, 0.1943, 0.1946, 0.2257, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0050,  0.0010, -0.0058, -0.0027, -0.0025],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1919, 0.1812, 0.2189, 0.1835, 0.2245], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0519, 0.0242, 0.0565, 0.0162, 0.0096]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24968515 0.19672695 0.19295456 0.18738887 0.17324452]
np_weight_alpha[1] [0.19808528 0.23413852 0.19004598 0.18932192 0.18840826]
np_weight_alpha[2] [0.19950381 0.17769636 0.22482003 0.20750058 0.19047917]
np_weight_alpha[3] [0.19612053 0.1754534  0.20811693 0.22467944 0.1956297 ]
np_weight_alpha[4] [0.17211829 0.18742569 0.19264339 0.19738898 0.25042364]
-------------Round number:  487  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5515873015873016
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.5772108843537415
Average Global Trainning Loss:  1.121512442867772
All users are selected
model: 0 tensor([0.2497, 0.1967, 0.1930, 0.1874, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0101, -0.0305, -0.0188, -0.0163, -0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2341, 0.1900, 0.1893, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0302, -0.0129, -0.0244, -0.0211, -0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1995, 0.1777, 0.2248, 0.2075, 0.1905], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0108, 0.0283, 0.0392, 0.0268],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1961, 0.1755, 0.2081, 0.2247, 0.1956], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0055, 0.0327, 0.0223, 0.0108],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1721, 0.1874, 0.1926, 0.1974, 0.2504], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0125, -0.0029, -0.0096, -0.0184, -0.0090]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24331173 0.20679587 0.19141626 0.1838548  0.17462131]
np_weight_alpha[1] [0.20782033 0.22828555 0.19397956 0.1900612  0.17985338]
np_weight_alpha[2] [0.1923545  0.19460294 0.2256522  0.19594708 0.19144328]
np_weight_alpha[3] [0.18422855 0.19057778 0.19581726 0.22407885 0.20529756]
np_weight_alpha[4] [0.1741106  0.17912601 0.19019593 0.20350252 0.25306493]
-------------Round number:  488  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5595238095238095
client Accurancy:  0.5238095238095238
client Accurancy:  0.3888888888888889
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5799319727891157
Average Global Trainning Loss:  1.1290671004730017
All users are selected
model: 0 tensor([0.2433, 0.2068, 0.1914, 0.1839, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0175, 0.0146, 0.0106, 0.0095, 0.0094],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2078, 0.2283, 0.1940, 0.1901, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012, -0.0013, -0.0027, -0.0066, -0.0015],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1924, 0.1946, 0.2257, 0.1959, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0358, 0.0395, 0.0367, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1906, 0.1958, 0.2241, 0.2053], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0445, -0.0459, -0.0409, -0.0424, -0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1741, 0.1791, 0.1902, 0.2035, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0072, -0.0039, -0.0095,  0.0001,  0.0015]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24070457 0.20337203 0.19215946 0.18603335 0.1777306 ]
np_weight_alpha[1] [0.19063953 0.22458409 0.19590163 0.21179202 0.17708278]
np_weight_alpha[2] [0.19286996 0.19418441 0.2226265  0.19459428 0.19572482]
np_weight_alpha[3] [0.18680136 0.19422911 0.19445546 0.22558095 0.1989331 ]
np_weight_alpha[4] [0.1903612  0.17974702 0.2186363  0.18381467 0.22744077]
-------------Round number:  489  -------------
client Accurancy:  0.5
client Accurancy:  0.5555555555555556
client Accurancy:  0.5
client Accurancy:  0.36507936507936506
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.5622448979591836
Average Global Trainning Loss:  1.1990200328178147
All users are selected
model: 0 tensor([0.2407, 0.2034, 0.1922, 0.1860, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0163, -0.0057, -0.0132, -0.0140, -0.0064],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1906, 0.2246, 0.1959, 0.2118, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0159, -0.0159, -0.0024,  0.0139, -0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1942, 0.2226, 0.1946, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0095, -0.0043, -0.0088, -0.0113, -0.0072],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1868, 0.1942, 0.1945, 0.2256, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0044,  0.0016, -0.0054, -0.0018, -0.0012],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1904, 0.1797, 0.2186, 0.1838, 0.2274], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0490, 0.0213, 0.0551, 0.0159, 0.0115]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24967234 0.19644023 0.1927773  0.18772833 0.17338176]
np_weight_alpha[1] [0.19774634 0.23439346 0.18973227 0.18940274 0.18872514]
np_weight_alpha[2] [0.19866891 0.17557198 0.22637402 0.20919962 0.1901855 ]
np_weight_alpha[3] [0.19690076 0.17602839 0.20989072 0.22406778 0.19311231]
np_weight_alpha[4] [0.17239991 0.18776901 0.19259563 0.19686747 0.25036797]
-------------Round number:  490  -------------
client Accurancy:  0.5
client Accurancy:  0.5515873015873016
client Accurancy:  0.5198412698412699
client Accurancy:  0.39285714285714285
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.5789115646258504
Average Global Trainning Loss:  1.1197817017431972
All users are selected
model: 0 tensor([0.2497, 0.1964, 0.1928, 0.1877, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0099, -0.0305, -0.0186, -0.0157, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1977, 0.2344, 0.1897, 0.1894, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0129, -0.0248, -0.0210, -0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1987, 0.1756, 0.2264, 0.2092, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0342, 0.0088, 0.0296, 0.0411, 0.0269],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1969, 0.1760, 0.2099, 0.2241, 0.1931], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0338, 0.0063, 0.0346, 0.0216, 0.0080],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1724, 0.1878, 0.1926, 0.1969, 0.2504], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0126, -0.0031, -0.0100, -0.0195, -0.0094]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24345553 0.2067861  0.19128701 0.18388762 0.17458381]
np_weight_alpha[1] [0.20781916 0.22839026 0.19390877 0.18992183 0.17995992]
np_weight_alpha[2] [0.1922969  0.1946005  0.22606352 0.1958163  0.19122285]
np_weight_alpha[3] [0.18417382 0.19037153 0.19569623 0.22417057 0.2055879 ]
np_weight_alpha[4] [0.17407563 0.17923835 0.19004272 0.20362225 0.25302103]
-------------Round number:  491  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5595238095238095
client Accurancy:  0.5198412698412699
client Accurancy:  0.3888888888888889
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.580952380952381
Average Global Trainning Loss:  1.1241386984481292
All users are selected
model: 0 tensor([0.2435, 0.2068, 0.1913, 0.1839, 0.1746], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0177, 0.0147, 0.0104, 0.0098, 0.0099],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2078, 0.2284, 0.1939, 0.1899, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-9.7639e-05, -2.3035e-03, -3.8140e-03, -7.7636e-03, -2.8374e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1923, 0.1946, 0.2261, 0.1958, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0345, 0.0359, 0.0399, 0.0365, 0.0308],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1904, 0.1957, 0.2242, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0440, -0.0456, -0.0406, -0.0421, -0.0354],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1741, 0.1792, 0.1900, 0.2036, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0063, -0.0034, -0.0090,  0.0008,  0.0022]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24078615 0.20344923 0.19237992 0.1859335  0.17745112]
np_weight_alpha[1] [0.19105816 0.22376123 0.19557309 0.21160884 0.17799875]
np_weight_alpha[2] [0.1930999  0.19405748 0.22255322 0.19457094 0.19571847]
np_weight_alpha[3] [0.18671009 0.19407341 0.19442365 0.22578777 0.19900513]
np_weight_alpha[4] [0.18908    0.18056406 0.21923909 0.1837792  0.22733764]
-------------Round number:  492  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5555555555555556
client Accurancy:  0.49603174603174605
client Accurancy:  0.36507936507936506
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.5653061224489796
Average Global Trainning Loss:  1.1938255673363096
All users are selected
model: 0 tensor([0.2408, 0.2034, 0.1924, 0.1859, 0.1775], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0155, -0.0052, -0.0124, -0.0132, -0.0062],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1911, 0.2238, 0.1956, 0.2116, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0157, -0.0167, -0.0028,  0.0137, -0.0189],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1941, 0.2226, 0.1946, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0096, -0.0048, -0.0091, -0.0115, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1867, 0.1941, 0.1944, 0.2258, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0037,  0.0021, -0.0048, -0.0010, -0.0008],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1891, 0.1806, 0.2192, 0.1838, 0.2273], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0465, 0.0214, 0.0548, 0.0146, 0.0104]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24948688 0.1966402  0.19283196 0.18753563 0.17350534]
np_weight_alpha[1] [0.19795604 0.23432887 0.18987566 0.18938106 0.18845838]
np_weight_alpha[2] [0.1980012  0.17669512 0.22655915 0.20908692 0.18965758]
np_weight_alpha[3] [0.19621001 0.17652495 0.20983246 0.22307223 0.19436039]
np_weight_alpha[4] [0.17255594 0.18752928 0.19246943 0.19717632 0.25026903]
-------------Round number:  493  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5555555555555556
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.46746031746031746
Average Global Trainning Accurancy:  0.5812925170068027
Average Global Trainning Loss:  1.1134806315104167
All users are selected
model: 0 tensor([0.2495, 0.1966, 0.1928, 0.1875, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0096, -0.0301, -0.0182, -0.0159, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1980, 0.2343, 0.1899, 0.1894, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0300, -0.0126, -0.0241, -0.0206, -0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1980, 0.1767, 0.2266, 0.2091, 0.1897], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0336, 0.0100, 0.0295, 0.0411, 0.0263],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1962, 0.1765, 0.2098, 0.2231, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0324, 0.0062, 0.0342, 0.0202, 0.0090],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1875, 0.1925, 0.1972, 0.2503], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0034, -0.0102, -0.0192, -0.0098]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24311051 0.20686749 0.19124293 0.18408467 0.17469443]
np_weight_alpha[1] [0.20787163 0.22845139 0.19381075 0.18999653 0.17986965]
np_weight_alpha[2] [0.19223058 0.19446327 0.22635838 0.19570741 0.19124043]
np_weight_alpha[3] [0.18440926 0.19046424 0.19559397 0.2241458  0.2053867 ]
np_weight_alpha[4] [0.17415793 0.17913635 0.19003026 0.2034839  0.25319156]
-------------Round number:  494  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5595238095238095
client Accurancy:  0.5198412698412699
client Accurancy:  0.3888888888888889
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4634920634920635
Average Global Trainning Accurancy:  0.5826530612244898
Average Global Trainning Loss:  1.1195078324298469
All users are selected
model: 0 tensor([0.2431, 0.2069, 0.1912, 0.1841, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0162, 0.0137, 0.0095, 0.0089, 0.0088],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2079, 0.2285, 0.1938, 0.1900, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0007, -0.0016, -0.0031, -0.0069, -0.0022],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1922, 0.1945, 0.2264, 0.1957, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0350, 0.0361, 0.0403, 0.0366, 0.0311],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1905, 0.1956, 0.2241, 0.2054], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0442, -0.0458, -0.0412, -0.0424, -0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.1791, 0.1900, 0.2035, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060, -0.0031, -0.0086,  0.0010,  0.0029]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24086203 0.20344836 0.19215524 0.18594924 0.1775851 ]
np_weight_alpha[1] [0.1908498  0.2239994  0.19580646 0.21093959 0.17840478]
np_weight_alpha[2] [0.19286813 0.19401929 0.22276151 0.19466732 0.1956837 ]
np_weight_alpha[3] [0.18672107 0.19400084 0.19452587 0.22571965 0.19903255]
np_weight_alpha[4] [0.18961377 0.18109047 0.2192026  0.18438883 0.22570434]
-------------Round number:  495  -------------
client Accurancy:  0.5
client Accurancy:  0.5595238095238095
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.5670068027210884
Average Global Trainning Loss:  1.1894398384353742
All users are selected
model: 0 tensor([0.2409, 0.2034, 0.1922, 0.1859, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0134, -0.0035, -0.0107, -0.0117, -0.0045],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1908, 0.2240, 0.1958, 0.2109, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0170, -0.0031,  0.0125, -0.0189],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1940, 0.2228, 0.1947, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0098, -0.0051, -0.0091, -0.0116, -0.0076],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1867, 0.1940, 0.1945, 0.2257, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0050,  0.0008, -0.0058, -0.0023, -0.0015],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1896, 0.1811, 0.2192, 0.1844, 0.2257], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0470, 0.0221, 0.0548, 0.0157, 0.0086]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2706868  0.17540622 0.19847834 0.19740537 0.15802333]
np_weight_alpha[1] [0.1979952  0.23435086 0.1898673  0.18941534 0.18837132]
np_weight_alpha[2] [0.19817714 0.17685033 0.22605959 0.20871308 0.1901998 ]
np_weight_alpha[3] [0.19732524 0.17690115 0.20938194 0.22419207 0.19219963]
np_weight_alpha[4] [0.17266564 0.18741319 0.19253735 0.19674553 0.2506383 ]
-------------Round number:  496  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5555555555555556
client Accurancy:  0.5119047619047619
client Accurancy:  0.3888888888888889
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.46746031746031746
Average Global Trainning Accurancy:  0.5867346938775511
Average Global Trainning Loss:  1.0983239829134779
All users are selected
model: 0 tensor([0.2707, 0.1754, 0.1985, 0.1974, 0.1580], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0369, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0114, -0.0528, -0.0136, -0.0073, -0.0371],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1980, 0.2344, 0.1899, 0.1894, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0116, -0.0228, -0.0193, -0.0096],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1982, 0.1769, 0.2261, 0.2087, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0097, 0.0283, 0.0400, 0.0263],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1973, 0.1769, 0.2094, 0.2242, 0.1922], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0342, 0.0075, 0.0344, 0.0221, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1874, 0.1925, 0.1967, 0.2506], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0131, -0.0041, -0.0107, -0.0202, -0.0098]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24198063 0.2071088  0.19111796 0.18420959 0.17558306]
np_weight_alpha[1] [0.20780793 0.22867873 0.19366276 0.18985842 0.17999212]
np_weight_alpha[2] [0.19223654 0.19431986 0.2264676  0.19578272 0.19119322]
np_weight_alpha[3] [0.18437524 0.19027592 0.1956682  0.22409682 0.20558377]
np_weight_alpha[4] [0.17417555 0.17927326 0.19001843 0.20355399 0.2529787 ]
-------------Round number:  497  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5555555555555556
client Accurancy:  0.5198412698412699
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.5843537414965987
Average Global Trainning Loss:  1.1153303704294217
All users are selected
model: 0 tensor([0.2420, 0.2071, 0.1911, 0.1842, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0155, 0.0146, 0.0100, 0.0095, 0.0101],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2078, 0.2287, 0.1937, 0.1899, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0013, -0.0010, -0.0029, -0.0066, -0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1922, 0.1943, 0.2265, 0.1958, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0338, 0.0345, 0.0390, 0.0353, 0.0300],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1903, 0.1957, 0.2241, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0448, -0.0466, -0.0417, -0.0428, -0.0361],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.1793, 0.1900, 0.2036, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0053, -0.0020, -0.0076,  0.0020,  0.0029]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24093653 0.20328484 0.19210584 0.1860217  0.17765112]
np_weight_alpha[1] [0.19022085 0.2235453  0.19696927 0.21207926 0.17718533]
np_weight_alpha[2] [0.19282132 0.19414072 0.2228573  0.19474286 0.19543782]
np_weight_alpha[3] [0.18682785 0.19412671 0.1946112  0.22561729 0.19881696]
np_weight_alpha[4] [0.19002356 0.17969821 0.21780442 0.18314867 0.22932512]
-------------Round number:  498  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5515873015873016
client Accurancy:  0.5
client Accurancy:  0.36507936507936506
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.5680272108843537
Average Global Trainning Loss:  1.183415377869898
All users are selected
model: 0 tensor([0.2409, 0.2033, 0.1921, 0.1860, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0142, -0.0043, -0.0117, -0.0125, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1902, 0.2235, 0.1970, 0.2121, 0.1772], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0172, -0.0013,  0.0141, -0.0196],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1928, 0.1941, 0.2229, 0.1947, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0059, -0.0102, -0.0124, -0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1868, 0.1941, 0.1946, 0.2256, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0037,  0.0021, -0.0043, -0.0011, -0.0005],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1900, 0.1797, 0.2178, 0.1831, 0.2293], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0476, 0.0209, 0.0534, 0.0145, 0.0124]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27068278 0.17529264 0.19915256 0.19749138 0.15738064]
np_weight_alpha[1] [0.1978426  0.23464511 0.18973069 0.18948086 0.18830071]
np_weight_alpha[2] [0.19886145 0.17596214 0.22613963 0.20745875 0.19157802]
np_weight_alpha[3] [0.19730005 0.17696024 0.20810412 0.2244117  0.19322383]
np_weight_alpha[4] [0.17262715 0.18738283 0.19264933 0.19680372 0.25053704]
-------------Round number:  499  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5555555555555556
client Accurancy:  0.503968253968254
client Accurancy:  0.39285714285714285
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.46746031746031746
Average Global Trainning Accurancy:  0.5880952380952381
Average Global Trainning Loss:  1.0925351097470237
All users are selected
model: 0 tensor([0.2707, 0.1753, 0.1992, 0.1975, 0.1574], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0371, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0119, -0.0525, -0.0124, -0.0067, -0.0376],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1978, 0.2346, 0.1897, 0.1895, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0277, -0.0101, -0.0215, -0.0180, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1989, 0.1760, 0.2261, 0.2075, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0352, 0.0103, 0.0293, 0.0402, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1973, 0.1770, 0.2081, 0.2244, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0314, 0.0047, 0.0303, 0.0191, 0.0057],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1874, 0.1926, 0.1968, 0.2505], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0134, -0.0042, -0.0106, -0.0200, -0.0098]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24186245 0.20718072 0.19104256 0.1841158  0.17579852]
np_weight_alpha[1] [0.20787683 0.22876428 0.19350086 0.18984841 0.18000965]
np_weight_alpha[2] [0.19216877 0.19418094 0.22683336 0.1956821  0.19113484]
np_weight_alpha[3] [0.18428773 0.19027917 0.19558589 0.22446555 0.20538177]
np_weight_alpha[4] [0.17436872 0.17930478 0.19003677 0.20344138 0.2528483 ]
-------------Round number:  500  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5595238095238095
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5860544217687075
Average Global Trainning Loss:  1.1114531017485119
All users are selected
model: 0 tensor([0.2419, 0.2072, 0.1910, 0.1841, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0147, 0.0141, 0.0094, 0.0087, 0.0098],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2079, 0.2288, 0.1935, 0.1898, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0016, -0.0006, -0.0027, -0.0065, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1922, 0.1942, 0.2268, 0.1957, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0339, 0.0345, 0.0393, 0.0353, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1903, 0.1956, 0.2245, 0.2054], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0448, -0.0464, -0.0414, -0.0424, -0.0357],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1744, 0.1793, 0.1900, 0.2034, 0.2528], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0048, -0.0019, -0.0076,  0.0024,  0.0031]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24108942 0.20325372 0.19193706 0.18614    0.17757975]
np_weight_alpha[1] [0.18979916 0.2229471  0.19682786 0.21261781 0.17780815]
np_weight_alpha[2] [0.19264491 0.1939724  0.22302732 0.19464406 0.19571128]
np_weight_alpha[3] [0.18696213 0.19421226 0.19450909 0.22580552 0.19851102]
np_weight_alpha[4] [0.18892373 0.1801607  0.2191569  0.18216185 0.22959672]
-------------Round number:  501  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5515873015873016
client Accurancy:  0.5
client Accurancy:  0.36507936507936506
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5693877551020409
Average Global Trainning Loss:  1.1807885410023384
All users are selected
model: 0 tensor([0.2411, 0.2033, 0.1919, 0.1861, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0138, -0.0043, -0.0115, -0.0124, -0.0050],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1898, 0.2229, 0.1968, 0.2126, 0.1778], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0185, -0.0192, -0.0029,  0.0132, -0.0204],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1940, 0.2230, 0.1946, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0101, -0.0052, -0.0091, -0.0118, -0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1870, 0.1942, 0.1945, 0.2258, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0025,  0.0034, -0.0035,  0.0006,  0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1889, 0.1802, 0.2192, 0.1822, 0.2296], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0456, 0.0205, 0.0539, 0.0125, 0.0119]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26971567 0.17617479 0.19885227 0.1975786  0.15767871]
np_weight_alpha[1] [0.19804318 0.2345985  0.18971173 0.18940695 0.18823962]
np_weight_alpha[2] [0.19853501 0.17654216 0.2255074  0.2090271  0.19038838]
np_weight_alpha[3] [0.19722551 0.17639974 0.20973139 0.22159752 0.1950458 ]
np_weight_alpha[4] [0.17268592 0.18736805 0.19261055 0.19692174 0.25041378]
-------------Round number:  502  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5515873015873016
client Accurancy:  0.503968253968254
client Accurancy:  0.39285714285714285
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.5901360544217688
Average Global Trainning Loss:  1.088275686251063
All users are selected
model: 0 tensor([0.2697, 0.1762, 0.1989, 0.1976, 0.1577], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0361, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0106, -0.0522, -0.0132, -0.0073, -0.0376],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1980, 0.2346, 0.1897, 0.1894, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0270, -0.0097, -0.0207, -0.0173, -0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1985, 0.1765, 0.2255, 0.2090, 0.1904], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0093, 0.0268, 0.0402, 0.0260],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1972, 0.1764, 0.2097, 0.2216, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0339, 0.0069, 0.0348, 0.0189, 0.0104],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1874, 0.1926, 0.1969, 0.2504], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0052, -0.0118, -0.0210, -0.0115]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24173947 0.20728722 0.19104293 0.18428549 0.17564486]
np_weight_alpha[1] [0.20797427 0.22903164 0.19333446 0.18981022 0.17984946]
np_weight_alpha[2] [0.19214866 0.19399314 0.22709171 0.19554926 0.1912173 ]
np_weight_alpha[3] [0.18450896 0.1902939  0.1954491  0.22455923 0.20518881]
np_weight_alpha[4] [0.1741927  0.17912568 0.1900484  0.20330845 0.25332478]
-------------Round number:  503  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5595238095238095
client Accurancy:  0.5198412698412699
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5874149659863945
Average Global Trainning Loss:  1.1051668128188776
All users are selected
model: 0 tensor([0.2417, 0.2073, 0.1910, 0.1843, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0144, 0.0142, 0.0093, 0.0086, 0.0089],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2080, 0.2290, 0.1933, 0.1898, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0025,  0.0002, -0.0024, -0.0059, -0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1921, 0.1940, 0.2271, 0.1955, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0349, 0.0351, 0.0404, 0.0358, 0.0309],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1845, 0.1903, 0.1954, 0.2246, 0.2052], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0449, -0.0466, -0.0421, -0.0425, -0.0363],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1742, 0.1791, 0.1900, 0.2033, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0063, -0.0033, -0.0082,  0.0015,  0.0035]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24099411 0.20301303 0.19183654 0.1861419  0.1780144 ]
np_weight_alpha[1] [0.1882778  0.22149071 0.1978347  0.21213694 0.1802598 ]
np_weight_alpha[2] [0.19253507 0.19402947 0.22305521 0.19487357 0.19550668]
np_weight_alpha[3] [0.18693687 0.19406544 0.19474493 0.22567748 0.19857526]
np_weight_alpha[4] [0.19219202 0.18289515 0.21830249 0.18302119 0.22358912]
-------------Round number:  504  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5515873015873016
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.5697278911564626
Average Global Trainning Loss:  1.1872310301073554
All users are selected
model: 0 tensor([0.2410, 0.2030, 0.1918, 0.1861, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0148, -0.0054, -0.0125, -0.0129, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1883, 0.2215, 0.1978, 0.2121, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0193, -0.0201, -0.0011,  0.0139, -0.0168],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1940, 0.2231, 0.1949, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0116, -0.0063, -0.0103, -0.0125, -0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1869, 0.1941, 0.1947, 0.2257, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0020,  0.0038, -0.0027,  0.0002,  0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 25.0
model: 4 tensor([0.1922, 0.1829, 0.2183, 0.1830, 0.2236], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0501, 0.0244, 0.0541, 0.0142, 0.0063]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24930196 0.19671378 0.19274758 0.1876938  0.17354289]
np_weight_alpha[1] [0.19819929 0.23490174 0.18974662 0.18913773 0.18801458]
np_weight_alpha[2] [0.19987348 0.1767299  0.22540113 0.20717359 0.19082184]
np_weight_alpha[3] [0.22985967 0.11576016 0.26316813 0.21371129 0.1775007 ]
np_weight_alpha[4] [0.1723372  0.18713039 0.19252662 0.19697896 0.25102684]
-------------Round number:  505  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5515873015873016
client Accurancy:  0.49603174603174605
client Accurancy:  0.38095238095238093
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.5863945578231292
Average Global Trainning Loss:  1.1048927774234694
All users are selected
model: 0 tensor([0.2493, 0.1967, 0.1927, 0.1877, 0.1735], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0080, -0.0289, -0.0167, -0.0149, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2349, 0.1897, 0.1891, 0.1880], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0262, -0.0091, -0.0200, -0.0168, -0.0074],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1999, 0.1767, 0.2254, 0.2072, 0.1908], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0332, 0.0079, 0.0250, 0.0364, 0.0248],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2299, 0.1158, 0.2632, 0.2137, 0.1775], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0634, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0647, -0.0574,  0.0872,  0.0083, -0.0105],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1723, 0.1871, 0.1925, 0.1970, 0.2510], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0059, -0.0123, -0.0211, -0.0112]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24262477 0.20698224 0.19098294 0.18449357 0.17491654]
np_weight_alpha[1] [0.20790206 0.22935458 0.19328417 0.18959057 0.1798686 ]
np_weight_alpha[2] [0.19182056 0.19392957 0.22711168 0.19587375 0.19126447]
np_weight_alpha[3] [0.18380997 0.19136097 0.19400999 0.22478056 0.20603855]
np_weight_alpha[4] [0.17438571 0.17916547 0.19007413 0.20312779 0.25324687]
-------------Round number:  506  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5595238095238095
client Accurancy:  0.5198412698412699
client Accurancy:  0.3968253968253968
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.591156462585034
Average Global Trainning Loss:  1.098338847257653
All users are selected
model: 0 tensor([0.2426, 0.2070, 0.1910, 0.1845, 0.1749], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0147, 0.0133, 0.0088, 0.0082, 0.0078],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2079, 0.2294, 0.1933, 0.1896, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0026,  0.0006, -0.0021, -0.0058, -0.0008],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1918, 0.1939, 0.2271, 0.1959, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0330, 0.0335, 0.0387, 0.0346, 0.0294],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1838, 0.1914, 0.1940, 0.2248, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0449, -0.0447, -0.0429, -0.0415, -0.0347],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1744, 0.1792, 0.1901, 0.2031, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0048, -0.0019, -0.0071,  0.0024,  0.0040]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24102752 0.20312287 0.19176233 0.18618704 0.17790021]
np_weight_alpha[1] [0.18913704 0.22131073 0.19783841 0.2127976  0.17891617]
np_weight_alpha[2] [0.19247429 0.19399627 0.22318637 0.19488618 0.19545692]
np_weight_alpha[3] [0.18702158 0.1940078  0.19481385 0.22560269 0.19855408]
np_weight_alpha[4] [0.19042301 0.18137388 0.21788515 0.18376496 0.22655295]
-------------Round number:  507  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5476190476190477
client Accurancy:  0.503968253968254
client Accurancy:  0.373015873015873
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.5744897959183674
Average Global Trainning Loss:  1.1777557995854593
All users are selected
model: 0 tensor([0.2410, 0.2031, 0.1918, 0.1862, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0131, -0.0039, -0.0112, -0.0118, -0.0044],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1891, 0.2213, 0.1978, 0.2128, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0196, -0.0007,  0.0150, -0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1940, 0.2232, 0.1949, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0136, -0.0084, -0.0122, -0.0146, -0.0111],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1870, 0.1940, 0.1948, 0.2256, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0016,  0.0043, -0.0022,  0.0006,  0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1904, 0.1814, 0.2179, 0.1838, 0.2266], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0476, 0.0222, 0.0534, 0.0152, 0.0091]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2683602  0.17656389 0.20015474 0.19756843 0.15735276]
np_weight_alpha[1] [0.19807373 0.23461571 0.18980435 0.18913594 0.18837033]
np_weight_alpha[2] [0.1938093  0.19034037 0.22436592 0.19720109 0.19428334]
np_weight_alpha[3] [0.19698271 0.17599288 0.20796049 0.22622594 0.19283801]
np_weight_alpha[4] [0.17269823 0.18747497 0.19245677 0.1964976  0.25087243]
-------------Round number:  508  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5515873015873016
client Accurancy:  0.503968253968254
client Accurancy:  0.39285714285714285
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.5952380952380952
Average Global Trainning Loss:  1.0805368436437075
All users are selected
model: 0 tensor([0.2684, 0.1766, 0.2002, 0.1976, 0.1574], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0352, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0107, -0.0501, -0.0102, -0.0056, -0.0366],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2346, 0.1898, 0.1891, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0254, -0.0087, -0.0189, -0.0163, -0.0059],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1903, 0.2244, 0.1972, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0276, 0.0228, 0.0240, 0.0271, 0.0289],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1970, 0.1760, 0.2080, 0.2262, 0.1928], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0321, 0.0047, 0.0315, 0.0220, 0.0067],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1875, 0.1925, 0.1965, 0.2509], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0146, -0.0049, -0.0119, -0.0213, -0.0111]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2418708  0.207171   0.19086996 0.1841983  0.17588998]
np_weight_alpha[1] [0.20782931 0.22956769 0.19303358 0.18994801 0.17962141]
np_weight_alpha[2] [0.19198728 0.19329597 0.22773683 0.19579528 0.19118458]
np_weight_alpha[3] [0.18444332 0.19046026 0.19542357 0.22457936 0.20509353]
np_weight_alpha[4] [0.17444132 0.17892124 0.19001669 0.20316748 0.25345328]
-------------Round number:  509  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5595238095238095
client Accurancy:  0.5158730158730159
client Accurancy:  0.3968253968253968
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5928571428571429
Average Global Trainning Loss:  1.0970136785182822
All users are selected
model: 0 tensor([0.2419, 0.2072, 0.1909, 0.1842, 0.1759], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0141, 0.0137, 0.0087, 0.0082, 0.0087],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2078, 0.2296, 0.1930, 0.1899, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0021,  0.0002, -0.0031, -0.0060, -0.0017],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1920, 0.1933, 0.2277, 0.1958, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0328, 0.0325, 0.0391, 0.0344, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1905, 0.1954, 0.2246, 0.2051], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0433, -0.0448, -0.0405, -0.0412, -0.0349],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1744, 0.1789, 0.1900, 0.2032, 0.2535], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0023, -0.0073,  0.0023,  0.0045]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2410619  0.20299472 0.19182867 0.18604344 0.17807133]
np_weight_alpha[1] [0.18877722 0.22027612 0.19951741 0.2113034  0.18012582]
np_weight_alpha[2] [0.19254321 0.19413254 0.22311951 0.19472523 0.19547948]
np_weight_alpha[3] [0.18682341 0.19400069 0.19460005 0.22594585 0.19862998]
np_weight_alpha[4] [0.19155501 0.18262552 0.21840198 0.18379878 0.22361864]
-------------Round number:  510  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.376984126984127
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.576530612244898
Average Global Trainning Loss:  1.1765189865008503
All users are selected
model: 0 tensor([0.2411, 0.2030, 0.1918, 0.1860, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0135, -0.0046, -0.0116, -0.0125, -0.0047],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1888, 0.2203, 0.1995, 0.2113, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0188, -0.0214,  0.0007,  0.0131, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1941, 0.2231, 0.1947, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0138, -0.0086, -0.0128, -0.0150, -0.0115],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1868, 0.1940, 0.1946, 0.2259, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0011,  0.0052, -0.0015,  0.0015,  0.0025],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1916, 0.1826, 0.2184, 0.1838, 0.2236], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0495, 0.0242, 0.0546, 0.0159, 0.0065]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26784003 0.17711736 0.19966064 0.19842769 0.15695426]
np_weight_alpha[1] [0.19812082 0.23492497 0.18966842 0.18905382 0.18823202]
np_weight_alpha[2] [0.19374979 0.19025064 0.22461191 0.19707514 0.19431262]
np_weight_alpha[3] [0.19806921 0.17558011 0.20819822 0.2261184  0.19203407]
np_weight_alpha[4] [0.172603   0.18733832 0.19245675 0.19641247 0.25118944]
-------------Round number:  511  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5515873015873016
client Accurancy:  0.503968253968254
client Accurancy:  0.3888888888888889
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.5969387755102041
Average Global Trainning Loss:  1.0748567542251275
All users are selected
model: 0 tensor([0.2678, 0.1771, 0.1997, 0.1984, 0.1570], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0349, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0099, -0.0495, -0.0108, -0.0052, -0.0373],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2349, 0.1897, 0.1891, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0233, -0.0070, -0.0173, -0.0145, -0.0045],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1903, 0.2246, 0.1971, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0287, 0.0238, 0.0254, 0.0282, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1981, 0.1756, 0.2082, 0.2261, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0306, 0.0021, 0.0296, 0.0194, 0.0036],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1873, 0.1925, 0.1964, 0.2512], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0054, -0.0124, -0.0215, -0.0108]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24192151 0.20688348 0.19084398 0.18442279 0.17592822]
np_weight_alpha[1] [0.20751509 0.22987556 0.1930421  0.18980663 0.17976053]
np_weight_alpha[2] [0.19193675 0.19330959 0.22773372 0.19564804 0.19137189]
np_weight_alpha[3] [0.18463497 0.19030687 0.19526568 0.22473443 0.20505802]
np_weight_alpha[4] [0.17450416 0.17907558 0.1902195  0.20309502 0.25310567]
-------------Round number:  512  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5555555555555556
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.595578231292517
Average Global Trainning Loss:  1.0930211488892432
All users are selected
model: 0 tensor([0.2419, 0.2069, 0.1908, 0.1844, 0.1759], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0141, 0.0136, 0.0091, 0.0086, 0.0090],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2075, 0.2299, 0.1930, 0.1898, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0014,  0.0002, -0.0034, -0.0064, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1919, 0.1933, 0.2277, 0.1956, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0325, 0.0321, 0.0382, 0.0338, 0.0288],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1846, 0.1903, 0.1953, 0.2247, 0.2051], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0420, -0.0438, -0.0394, -0.0400, -0.0339],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1745, 0.1791, 0.1902, 0.2031, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0056, -0.0027, -0.0076,  0.0015,  0.0035]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24133651 0.20305279 0.19163065 0.18600455 0.1779755 ]
np_weight_alpha[1] [0.19032712 0.21924451 0.19931518 0.21154521 0.17956795]
np_weight_alpha[2] [0.1923486  0.19408692 0.22355634 0.19463882 0.1953694 ]
np_weight_alpha[3] [0.1867954  0.1939291  0.19452283 0.22599678 0.1987559 ]
np_weight_alpha[4] [0.19084294 0.18194637 0.21697326 0.1846252  0.2256123 ]
-------------Round number:  513  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.376984126984127
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.5802721088435374
Average Global Trainning Loss:  1.169418646364796
All users are selected
model: 0 tensor([0.2413, 0.2031, 0.1916, 0.1860, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0124, -0.0036, -0.0112, -0.0118, -0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1903, 0.2192, 0.1993, 0.2115, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0213,  0.0011,  0.0135, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1923, 0.1941, 0.2236, 0.1946, 0.1954], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0130, -0.0075, -0.0111, -0.0140, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1868, 0.1939, 0.1945, 0.2260, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019,  0.0039, -0.0023,  0.0012,  0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1908, 0.1819, 0.2170, 0.1846, 0.2256], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0469, 0.0216, 0.0513, 0.0149, 0.0065]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26624453 0.17649223 0.2013131  0.1988327  0.15711753]
np_weight_alpha[1] [0.1979352  0.23446584 0.18974024 0.1895484  0.1883102 ]
np_weight_alpha[2] [0.19391207 0.19030768 0.22447391 0.19707267 0.19423366]
np_weight_alpha[3] [0.19853224 0.17812318 0.2086242  0.22331457 0.19140577]
np_weight_alpha[4] [0.17261876 0.18737175 0.19240968 0.1963313  0.25126854]
-------------Round number:  514  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5555555555555556
client Accurancy:  0.503968253968254
client Accurancy:  0.3968253968253968
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.46904761904761905
Average Global Trainning Accurancy:  0.5986394557823129
Average Global Trainning Loss:  1.0719920878507654
All users are selected
model: 0 tensor([0.2662, 0.1765, 0.2013, 0.1988, 0.1571], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0339, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0084, -0.0501, -0.0090, -0.0045, -0.0367],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1979, 0.2345, 0.1897, 0.1895, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0081, -0.0175, -0.0145, -0.0051],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1903, 0.2245, 0.1971, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0284, 0.0237, 0.0247, 0.0277, 0.0293],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1985, 0.1781, 0.2086, 0.2233, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0064, 0.0316, 0.0179, 0.0045],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1874, 0.1924, 0.1963, 0.2513], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0158, -0.0065, -0.0134, -0.0225, -0.0116]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24208653 0.20702013 0.19084266 0.18428409 0.17576665]
np_weight_alpha[1] [0.20762156 0.23002331 0.19274797 0.1897264  0.17988081]
np_weight_alpha[2] [0.19199939 0.19301017 0.22788908 0.19569777 0.19140351]
np_weight_alpha[3] [0.18443699 0.19012883 0.19529213 0.22502853 0.20511359]
np_weight_alpha[4] [0.17440265 0.17921928 0.19024883 0.20303802 0.2530912 ]
-------------Round number:  515  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5555555555555556
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4634920634920635
Average Global Trainning Accurancy:  0.5982993197278912
Average Global Trainning Loss:  1.0867772108843536
All users are selected
model: 0 tensor([0.2421, 0.2070, 0.1908, 0.1843, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0141, 0.0134, 0.0089, 0.0078, 0.0084],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2300, 0.1927, 0.1897, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0014,  0.0002, -0.0038, -0.0068, -0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1920, 0.1930, 0.2279, 0.1957, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0330, 0.0321, 0.0387, 0.0342, 0.0290],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1901, 0.1953, 0.2250, 0.2051], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0421, -0.0437, -0.0391, -0.0393, -0.0330],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1744, 0.1792, 0.1902, 0.2030, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0058, -0.0026, -0.0077,  0.0019,  0.0030]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24111214 0.20298441 0.19151112 0.18632466 0.17806761]
np_weight_alpha[1] [0.18955144 0.21849093 0.20047928 0.21252103 0.17895731]
np_weight_alpha[2] [0.19221036 0.19408533 0.22355603 0.19466347 0.19548483]
np_weight_alpha[3] [0.18712907 0.19407205 0.19454998 0.2260225  0.19822639]
np_weight_alpha[4] [0.19144163 0.18113741 0.21735935 0.18245776 0.22760381]
-------------Round number:  516  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.36904761904761907
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.5799319727891157
Average Global Trainning Loss:  1.1659888857886904
All users are selected
model: 0 tensor([0.2411, 0.2030, 0.1915, 0.1863, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0115, -0.0019, -0.0092, -0.0090, -0.0020],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1896, 0.2185, 0.2005, 0.2125, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0228,  0.0020,  0.0143, -0.0179],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1922, 0.1941, 0.2236, 0.1947, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0144, -0.0089, -0.0130, -0.0152, -0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1871, 0.1941, 0.1945, 0.2260, 0.1982], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0003,  0.0053, -0.0010,  0.0021,  0.0020],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1914, 0.1811, 0.2174, 0.1825, 0.2276], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0461, 0.0196, 0.0504, 0.0108, 0.0075]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.27188158 0.17684788 0.2005954  0.19415855 0.15651657]
np_weight_alpha[1] [0.19806735 0.23481676 0.18959497 0.18941599 0.18810496]
np_weight_alpha[2] [0.19373657 0.19020607 0.22502664 0.19690034 0.19413033]
np_weight_alpha[3] [0.19392098 0.17717102 0.20765784 0.22499311 0.19625708]
np_weight_alpha[4] [0.17263481 0.1872446  0.19232538 0.19695038 0.25084487]
-------------Round number:  517  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5476190476190477
client Accurancy:  0.5
client Accurancy:  0.4007936507936508
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.46825396825396826
Average Global Trainning Accurancy:  0.6047619047619047
Average Global Trainning Loss:  1.0590603575414541
All users are selected
model: 0 tensor([0.2719, 0.1768, 0.2006, 0.1942, 0.1565], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0381, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0154, -0.0486, -0.0088, -0.0085, -0.0367],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2348, 0.1896, 0.1894, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0233, -0.0070, -0.0170, -0.0141, -0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1902, 0.2250, 0.1969, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0278, 0.0232, 0.0247, 0.0272, 0.0288],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1939, 0.1772, 0.2077, 0.2250, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0275, 0.0049, 0.0303, 0.0194, 0.0095],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1872, 0.1923, 0.1970, 0.2508], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0165, -0.0073, -0.0140, -0.0224, -0.0126]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24157137 0.2068759  0.19089946 0.18457209 0.17608126]
np_weight_alpha[1] [0.20756201 0.2298875  0.19272728 0.18981394 0.18000917]
np_weight_alpha[2] [0.19198756 0.19297564 0.2280388  0.19564766 0.19135027]
np_weight_alpha[3] [0.18485472 0.19039302 0.19528595 0.2248469  0.20461945]
np_weight_alpha[4] [0.17450143 0.17932686 0.19020583 0.20295797 0.25300792]
-------------Round number:  518  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5555555555555556
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.5996598639455782
Average Global Trainning Loss:  1.0820212020355018
All users are selected
model: 0 tensor([0.2416, 0.2069, 0.1909, 0.1846, 0.1761], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0131, 0.0132, 0.0087, 0.0077, 0.0083],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2299, 0.1927, 0.1898, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012, -0.0004, -0.0043, -0.0069, -0.0025],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1920, 0.1930, 0.2280, 0.1956, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0335, 0.0324, 0.0390, 0.0345, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1904, 0.1953, 0.2248, 0.2046], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0415, -0.0430, -0.0388, -0.0393, -0.0333],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1745, 0.1793, 0.1902, 0.2030, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0059, -0.0029, -0.0076,  0.0017,  0.0032]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2413012  0.20273325 0.19143099 0.18637134 0.17816326]
np_weight_alpha[1] [0.18855798 0.21946852 0.20073523 0.21126755 0.1799707 ]
np_weight_alpha[2] [0.19213201 0.19411267 0.22383013 0.19465575 0.19526942]
np_weight_alpha[3] [0.18715645 0.19388236 0.1945489  0.22608602 0.19832627]
np_weight_alpha[4] [0.19181876 0.18231091 0.21650878 0.18307841 0.22628315]
-------------Round number:  519  -------------
client Accurancy:  0.5
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.36904761904761907
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.5806122448979592
Average Global Trainning Loss:  1.1632658043686224
All users are selected
model: 0 tensor([0.2413, 0.2027, 0.1914, 0.1864, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0111, -0.0026, -0.0099, -0.0090, -0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1886, 0.2195, 0.2007, 0.2113, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0207, -0.0238,  0.0006,  0.0113, -0.0185],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1921, 0.1941, 0.2238, 0.1947, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0090, -0.0128, -0.0154, -0.0119],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1872, 0.1939, 0.1945, 0.2261, 0.1983], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0027, 0.0075, 0.0012, 0.0042, 0.0042],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1918, 0.1823, 0.2165, 0.1831, 0.2263], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0464, 0.0210, 0.0497, 0.0113, 0.0063]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26825687 0.17864184 0.20269053 0.19332534 0.15708537]
np_weight_alpha[1] [0.19827163 0.23504755 0.18949562 0.18927057 0.1879147 ]
np_weight_alpha[2] [0.19403456 0.1901205  0.22489628 0.19691323 0.19403538]
np_weight_alpha[3] [0.19284803 0.17710473 0.20770043 0.22572973 0.19661704]
np_weight_alpha[4] [0.17273495 0.18708213 0.19225022 0.1971067  0.250826  ]
-------------Round number:  520  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5515873015873016
client Accurancy:  0.5
client Accurancy:  0.3968253968253968
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.46825396825396826
Average Global Trainning Accurancy:  0.6047619047619047
Average Global Trainning Loss:  1.0560018734056122
All users are selected
model: 0 tensor([0.2683, 0.1786, 0.2027, 0.1933, 0.1571], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0350, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0131, -0.0454, -0.0052, -0.0079, -0.0347],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1983, 0.2350, 0.1895, 0.1893, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0222, -0.0061, -0.0162, -0.0133, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1901, 0.2249, 0.1969, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0267, 0.0217, 0.0234, 0.0258, 0.0273],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1928, 0.1771, 0.2077, 0.2257, 0.1966], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0246, 0.0030, 0.0285, 0.0183, 0.0082],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1871, 0.1923, 0.1971, 0.2508], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0156, -0.0065, -0.0134, -0.0214, -0.0119]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24171288 0.20684348 0.19083536 0.1845542  0.17605406]
np_weight_alpha[1] [0.20751342 0.23012893 0.19277762 0.18975332 0.17982669]
np_weight_alpha[2] [0.19198404 0.19303788 0.22782803 0.19567712 0.19147299]
np_weight_alpha[3] [0.18492162 0.19036211 0.19530551 0.22486688 0.20454383]
np_weight_alpha[4] [0.17453673 0.17913905 0.19030643 0.20293288 0.25308487]
-------------Round number:  521  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5555555555555556
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.6027210884353742
Average Global Trainning Loss:  1.0771150550063775
All users are selected
model: 0 tensor([0.2417, 0.2068, 0.1908, 0.1846, 0.1761], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0133, 0.0132, 0.0088, 0.0074, 0.0084],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2075, 0.2301, 0.1928, 0.1898, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0010, -0.0003, -0.0040, -0.0072, -0.0029],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1920, 0.1930, 0.2278, 0.1957, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0331, 0.0322, 0.0378, 0.0338, 0.0292],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1904, 0.1953, 0.2249, 0.2045], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0416, -0.0430, -0.0388, -0.0389, -0.0328],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1745, 0.1791, 0.1903, 0.2029, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0027, -0.0069,  0.0026,  0.0034]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24125783 0.20274185 0.19128485 0.18669975 0.17801571]
np_weight_alpha[1] [0.18878302 0.21868229 0.19883494 0.21211328 0.18158649]
np_weight_alpha[2] [0.19196194 0.19376095 0.22424558 0.19480754 0.19522399]
np_weight_alpha[3] [0.18750721 0.19400007 0.19472055 0.22589616 0.19787605]
np_weight_alpha[4] [0.19079329 0.18378061 0.21578038 0.18111888 0.22852682]
-------------Round number:  522  -------------
client Accurancy:  0.5
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.36507936507936506
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.5802721088435374
Average Global Trainning Loss:  1.1584750013286564
All users are selected
model: 0 tensor([0.2413, 0.2027, 0.1913, 0.1867, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0095, -0.0012, -0.0085, -0.0089, -0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1888, 0.2187, 0.1988, 0.2121, 0.1816], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0201, -0.0247, -0.0011,  0.0122, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1938, 0.2242, 0.1948, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0154, -0.0098, -0.0132, -0.0163, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1940, 0.1947, 0.2259, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0027, 0.0085, 0.0019, 0.0051, 0.0061],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1908, 0.1838, 0.2158, 0.1811, 0.2285], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0437, 0.0206, 0.0473, 0.0093, 0.0064]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26460335 0.17747808 0.20124842 0.19839524 0.15827492]
np_weight_alpha[1] [0.19796593 0.23522128 0.1893456  0.18925494 0.18821225]
np_weight_alpha[2] [0.19358115 0.18994255 0.22503966 0.19726624 0.1941704 ]
np_weight_alpha[3] [0.19765213 0.17673205 0.20882806 0.22565837 0.19112943]
np_weight_alpha[4] [0.1729169  0.18735729 0.1923947  0.19563934 0.25169173]
-------------Round number:  523  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5555555555555556
client Accurancy:  0.503968253968254
client Accurancy:  0.3888888888888889
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.46825396825396826
Average Global Trainning Accurancy:  0.604421768707483
Average Global Trainning Loss:  1.0594916726456207
All users are selected
model: 0 tensor([0.2646, 0.1775, 0.2012, 0.1984, 0.1583], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0321, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0106, -0.0451, -0.0051, -0.0010, -0.0320],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1980, 0.2352, 0.1893, 0.1893, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0056, -0.0161, -0.0130, -0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1899, 0.2250, 0.1973, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0267, 0.0218, 0.0238, 0.0265, 0.0278],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1977, 0.1767, 0.2088, 0.2257, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0282, 0.0012, 0.0280, 0.0162, 0.0009],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1874, 0.1924, 0.1956, 0.2517], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0071, -0.0140, -0.0234, -0.0115]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2421256  0.20683157 0.19073592 0.18426757 0.17603943]
np_weight_alpha[1] [0.20739402 0.230109   0.19281933 0.1897069  0.17997074]
np_weight_alpha[2] [0.19189645 0.19308372 0.2279029  0.195676   0.1914409 ]
np_weight_alpha[3] [0.18451251 0.19015773 0.195265   0.22537522 0.20468962]
np_weight_alpha[4] [0.17475544 0.17930758 0.1903155  0.20272769 0.2528938 ]
-------------Round number:  524  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5555555555555556
client Accurancy:  0.5158730158730159
client Accurancy:  0.39285714285714285
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.6037414965986394
Average Global Trainning Loss:  1.0740010164221938
All users are selected
model: 0 tensor([0.2421, 0.2068, 0.1907, 0.1843, 0.1760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0130, 0.0126, 0.0080, 0.0064, 0.0077],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2074, 0.2301, 0.1928, 0.1897, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0005, -0.0007, -0.0044, -0.0076, -0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1919, 0.1931, 0.2279, 0.1957, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0325, 0.0318, 0.0374, 0.0334, 0.0287],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1845, 0.1902, 0.1953, 0.2254, 0.2047], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0402, -0.0413, -0.0368, -0.0367, -0.0306],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1748, 0.1793, 0.1903, 0.2027, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0030, -0.0071,  0.0023,  0.0030]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22591351 0.19136925 0.19794938 0.19947742 0.18529037]
np_weight_alpha[1] [0.18892455 0.21813735 0.19878578 0.2120378  0.18211442]
np_weight_alpha[2] [0.19199395 0.19377995 0.22430909 0.19472401 0.195193  ]
np_weight_alpha[3] [0.18753321 0.19395024 0.19463366 0.2261411  0.19774187]
np_weight_alpha[4] [0.18991137 0.18416823 0.21558769 0.18140312 0.22892958]
-------------Round number:  525  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5396825396825397
client Accurancy:  0.5119047619047619
client Accurancy:  0.3611111111111111
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5785714285714286
Average Global Trainning Loss:  1.1657374375531462
All users are selected
model: 0 tensor([0.2259, 0.1914, 0.1979, 0.1995, 0.1853], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0270, -0.0145, -0.0028,  0.0040,  0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1889, 0.2181, 0.1988, 0.2120, 0.1821], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0206, -0.0257, -0.0014,  0.0116, -0.0167],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1938, 0.2243, 0.1947, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0144, -0.0085, -0.0125, -0.0151, -0.0115],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1940, 0.1946, 0.2261, 0.1977], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0033, 0.0082, 0.0020, 0.0049, 0.0057],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1899, 0.1842, 0.2156, 0.1814, 0.2289], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0425, 0.0212, 0.0472, 0.0093, 0.0065]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24963397 0.19735976 0.1923309  0.18734923 0.17332616]
np_weight_alpha[1] [0.19822314 0.2353048  0.18916994 0.18942228 0.18787979]
np_weight_alpha[2] [0.19374143 0.18976124 0.22548375 0.19704646 0.19396707]
np_weight_alpha[3] [0.19481027 0.17777434 0.20812039 0.22664    0.19265497]
np_weight_alpha[4] [0.17307574 0.1870562  0.19219095 0.19582552 0.25185165]
-------------Round number:  526  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5555555555555556
client Accurancy:  0.5
client Accurancy:  0.38492063492063494
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.6034013605442177
Average Global Trainning Loss:  1.0593864596619897
All users are selected
model: 0 tensor([0.2496, 0.1974, 0.1923, 0.1873, 0.1733], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0031, -0.0234, -0.0125, -0.0108, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2353, 0.1892, 0.1894, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0225, -0.0062, -0.0167, -0.0132, -0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1898, 0.2255, 0.1970, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0253, 0.0200, 0.0223, 0.0246, 0.0259],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1948, 0.1778, 0.2081, 0.2266, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0263, 0.0037, 0.0287, 0.0190, 0.0038],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1731, 0.1871, 0.1922, 0.1958, 0.2519], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0073, -0.0144, -0.0235, -0.0118]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24254797 0.20666471 0.1908964  0.18462884 0.17526203]
np_weight_alpha[1] [0.2075662  0.23032776 0.1927457  0.18964463 0.17971571]
np_weight_alpha[2] [0.19173089 0.19300848 0.22819006 0.19565956 0.19141099]
np_weight_alpha[3] [0.18496105 0.19015972 0.19528012 0.22490509 0.20469405]
np_weight_alpha[4] [0.17466967 0.1790433  0.19026498 0.20284194 0.25318015]
-------------Round number:  527  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5515873015873016
client Accurancy:  0.5198412698412699
client Accurancy:  0.39285714285714285
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.6061224489795919
Average Global Trainning Loss:  1.0682902018229166
All users are selected
model: 0 tensor([0.2425, 0.2067, 0.1909, 0.1846, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0136, 0.0125, 0.0084, 0.0072, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2076, 0.2303, 0.1927, 0.1896, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0011,  0.0002, -0.0037, -0.0072, -0.0033],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1917, 0.1930, 0.2282, 0.1957, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0311, 0.0307, 0.0360, 0.0323, 0.0275],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1902, 0.1953, 0.2249, 0.2047], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0393, -0.0410, -0.0365, -0.0370, -0.0305],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1747, 0.1790, 0.1903, 0.2028, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0050, -0.0033, -0.0070,  0.0023,  0.0035]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22460294 0.19291289 0.19720837 0.19738303 0.18789278]
np_weight_alpha[1] [0.18908617 0.21683574 0.19791697 0.21267623 0.18348493]
np_weight_alpha[2] [0.19195591 0.19353484 0.22472802 0.1946321  0.19514908]
np_weight_alpha[3] [0.18737164 0.19399585 0.19455048 0.2261728  0.19790919]
np_weight_alpha[4] [0.18980372 0.18557605 0.21571699 0.1817259  0.22717732]
-------------Round number:  528  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.36507936507936506
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.5802721088435374
Average Global Trainning Loss:  1.159339209316539
All users are selected
model: 0 tensor([0.2246, 0.1929, 0.1972, 0.1974, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0270, -0.0110, -0.0020,  0.0041,  0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1891, 0.2168, 0.1979, 0.2127, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0289, -0.0040,  0.0109, -0.0168],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1935, 0.2247, 0.1946, 0.1951], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0141, -0.0081, -0.0113, -0.0142, -0.0105],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1874, 0.1940, 0.1946, 0.2262, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0046, 0.0096, 0.0032, 0.0061, 0.0060],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1898, 0.1856, 0.2157, 0.1817, 0.2272], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0407, 0.0206, 0.0455, 0.0065, 0.0029]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2502662  0.1972486  0.19264762 0.18698755 0.17285004]
np_weight_alpha[1] [0.19822492 0.23563227 0.1892743  0.18912446 0.18774404]
np_weight_alpha[2] [0.19407146 0.18986905 0.22551529 0.1968429  0.19370124]
np_weight_alpha[3] [0.19351974 0.176358   0.20743267 0.22587672 0.19681276]
np_weight_alpha[4] [0.17273727 0.18697092 0.19193101 0.19680738 0.25155336]
-------------Round number:  529  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5555555555555556
client Accurancy:  0.503968253968254
client Accurancy:  0.3888888888888889
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.6054421768707483
Average Global Trainning Loss:  1.0482229219812924
All users are selected
model: 0 tensor([0.2503, 0.1972, 0.1926, 0.1870, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0016, -0.0231, -0.0118, -0.0104, -0.0145],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2356, 0.1893, 0.1891, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0231, -0.0063, -0.0168, -0.0141, -0.0044],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1899, 0.2255, 0.1968, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0238, 0.0186, 0.0203, 0.0228, 0.0239],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1935, 0.1764, 0.2074, 0.2259, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0037, 0.0299, 0.0197, 0.0101],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1870, 0.1919, 0.1968, 0.2516], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0169, -0.0075, -0.0147, -0.0226, -0.0125]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24219455 0.2069035  0.19108453 0.18446366 0.17535368]
np_weight_alpha[1] [0.20780103 0.23028626 0.19252276 0.18977758 0.17961238]
np_weight_alpha[2] [0.19189346 0.19276835 0.22844161 0.19553638 0.19136019]
np_weight_alpha[3] [0.18491083 0.19041188 0.19517224 0.2251675  0.20433751]
np_weight_alpha[4] [0.17471133 0.17892928 0.19019495 0.20273948 0.25342497]
-------------Round number:  530  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5515873015873016
client Accurancy:  0.5238095238095238
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.610204081632653
Average Global Trainning Loss:  1.0605661405187075
All users are selected
model: 0 tensor([0.2422, 0.2069, 0.1911, 0.1845, 0.1754], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0135, 0.0132, 0.0088, 0.0071, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2078, 0.2303, 0.1925, 0.1898, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0019,  0.0005, -0.0040, -0.0066, -0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1919, 0.1928, 0.2284, 0.1955, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0299, 0.0287, 0.0350, 0.0306, 0.0267],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1904, 0.1952, 0.2252, 0.2043], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0385, -0.0397, -0.0359, -0.0357, -0.0300],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1747, 0.1789, 0.1902, 0.2027, 0.2534], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0053, -0.0035, -0.0066,  0.0021,  0.0033]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2256515  0.19067544 0.19664675 0.19832473 0.18870161]
np_weight_alpha[1] [0.18690209 0.21661048 0.20095822 0.21135157 0.18417759]
np_weight_alpha[2] [0.19201611 0.193963   0.22466743 0.19482587 0.19452758]
np_weight_alpha[3] [0.18742423 0.19384435 0.19475354 0.22604352 0.19793434]
np_weight_alpha[4] [0.19087848 0.18632798 0.2127555  0.18215829 0.22787976]
-------------Round number:  531  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.3611111111111111
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.582312925170068
Average Global Trainning Loss:  1.1571480887276786
All users are selected
model: 0 tensor([0.2257, 0.1907, 0.1966, 0.1983, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0261, -0.0136, -0.0027,  0.0043,  0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1869, 0.2166, 0.2010, 0.2114, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0244, -0.0294, -0.0009,  0.0093, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1940, 0.2247, 0.1948, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0142, -0.0080, -0.0121, -0.0149, -0.0117],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1874, 0.1938, 0.1948, 0.2260, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0049, 0.0100, 0.0038, 0.0067, 0.0075],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1909, 0.1863, 0.2128, 0.1822, 0.2279], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0418, 0.0216, 0.0429, 0.0082, 0.0038]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25002566 0.19714537 0.19233978 0.18731415 0.17317504]
np_weight_alpha[1] [0.1981284  0.23568426 0.189022   0.1892442  0.18792112]
np_weight_alpha[2] [0.19371267 0.18968685 0.22568664 0.1971679  0.193746  ]
np_weight_alpha[3] [0.19507085 0.17742689 0.20828429 0.22649294 0.19272508]
np_weight_alpha[4] [0.173045   0.18717301 0.19203602 0.19600414 0.2517418 ]
-------------Round number:  532  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5515873015873016
client Accurancy:  0.5
client Accurancy:  0.38095238095238093
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.6061224489795919
Average Global Trainning Loss:  1.0460220025510205
All users are selected
model: 0 tensor([0.2500, 0.1971, 0.1923, 0.1873, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0012, -0.0222, -0.0110, -0.0094, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2357, 0.1890, 0.1892, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0219, -0.0054, -0.0157, -0.0127, -0.0033],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1897, 0.2257, 0.1972, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0228, 0.0179, 0.0196, 0.0220, 0.0230],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1951, 0.1774, 0.2083, 0.2265, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0275, 0.0043, 0.0298, 0.0200, 0.0051],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1730, 0.1872, 0.1920, 0.1960, 0.2517], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0170, -0.0079, -0.0153, -0.0239, -0.0126]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24250448 0.2067161  0.19083679 0.18466988 0.17527275]
np_weight_alpha[1] [0.20760325 0.23068283 0.19228403 0.1896974  0.17973247]
np_weight_alpha[2] [0.19165128 0.19253553 0.22852881 0.19576897 0.19151543]
np_weight_alpha[3] [0.18499939 0.19024613 0.19538988 0.22477768 0.20458691]
np_weight_alpha[4] [0.1746686  0.17906812 0.19036922 0.20273733 0.25315672]
-------------Round number:  533  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5515873015873016
client Accurancy:  0.5238095238095238
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.611904761904762
Average Global Trainning Loss:  1.0528406675170068
All users are selected
model: 0 tensor([0.2425, 0.2067, 0.1908, 0.1847, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0138, 0.0127, 0.0084, 0.0069, 0.0065],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2076, 0.2307, 0.1923, 0.1897, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.7062e-05, -9.7167e-04, -5.7867e-03, -8.3460e-03, -5.0179e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1917, 0.1925, 0.2285, 0.1958, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0291, 0.0281, 0.0341, 0.0305, 0.0258],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1902, 0.1954, 0.2248, 0.2046], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0358, -0.0371, -0.0326, -0.0337, -0.0269],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1747, 0.1791, 0.1904, 0.2027, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0057, -0.0036, -0.0068,  0.0022,  0.0041]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22274858 0.1913165  0.19680583 0.19829543 0.1908336 ]
np_weight_alpha[1] [0.18757476 0.21560341 0.20070232 0.21121407 0.18490547]
np_weight_alpha[2] [0.19182627 0.19370852 0.22504699 0.19450176 0.19491646]
np_weight_alpha[3] [0.18754447 0.19374712 0.19442698 0.22639391 0.19788758]
np_weight_alpha[4] [0.19289702 0.18710573 0.21431082 0.1820759  0.22361058]
-------------Round number:  534  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5436507936507936
client Accurancy:  0.503968253968254
client Accurancy:  0.3611111111111111
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.5819727891156462
Average Global Trainning Loss:  1.1577281303146258
All users are selected
model: 0 tensor([0.2227, 0.1913, 0.1968, 0.1983, 0.1908], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0272, -0.0109, -0.0005,  0.0065,  0.0149],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1876, 0.2156, 0.2007, 0.2112, 0.1849], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0243, -0.0311, -0.0017,  0.0085, -0.0161],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1937, 0.2250, 0.1945, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0089, -0.0123, -0.0157, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1937, 0.1944, 0.2264, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0063, 0.0110, 0.0048, 0.0083, 0.0083],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1929, 0.1871, 0.2143, 0.1821, 0.2236], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0421,  0.0206,  0.0424,  0.0057, -0.0027]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25029552 0.19718271 0.1924535  0.18716036 0.17290787]
np_weight_alpha[1] [0.1981601  0.23590155 0.18901299 0.1892734  0.18765205]
np_weight_alpha[2] [0.19386701 0.1896934  0.22568329 0.19700189 0.19375436]
np_weight_alpha[3] [0.19403237 0.17799051 0.20884939 0.22453505 0.19459265]
np_weight_alpha[4] [0.17274788 0.18687342 0.19200067 0.19633614 0.25204194]
-------------Round number:  535  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5595238095238095
client Accurancy:  0.503968253968254
client Accurancy:  0.38492063492063494
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.6081632653061224
Average Global Trainning Loss:  1.0391900510204082
All users are selected
model: 0 tensor([0.2503, 0.1972, 0.1925, 0.1872, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 4.7836e-05, -2.1556e-02, -9.7792e-03, -8.6471e-03, -1.2857e-02],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2359, 0.1890, 0.1893, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0206, -0.0036, -0.0141, -0.0113, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1897, 0.2257, 0.1970, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0234, 0.0181, 0.0196, 0.0223, 0.0228],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1940, 0.1780, 0.2088, 0.2245, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0235, 0.0017, 0.0277, 0.0144, 0.0043],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1869, 0.1920, 0.1963, 0.2520], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0171, -0.0075, -0.0152, -0.0228, -0.0116]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24231228 0.20699215 0.1905953  0.18456951 0.17553076]
np_weight_alpha[1] [0.20787789 0.23057455 0.19224027 0.18976878 0.17953853]
np_weight_alpha[2] [0.19137746 0.19248116 0.22875273 0.19547935 0.19190934]
np_weight_alpha[3] [0.1849341  0.19031818 0.19507022 0.22549549 0.20418198]
np_weight_alpha[4] [0.17494096 0.17890581 0.19076446 0.20246792 0.25292087]
-------------Round number:  536  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5515873015873016
client Accurancy:  0.5238095238095238
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.611904761904762
Average Global Trainning Loss:  1.0515676485437926
All users are selected
model: 0 tensor([0.2423, 0.2070, 0.1906, 0.1846, 0.1755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0146, 0.0141, 0.0094, 0.0084, 0.0082],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2079, 0.2306, 0.1922, 0.1898, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0019,  0.0005, -0.0041, -0.0065, -0.0033],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1914, 0.1925, 0.2288, 0.1955, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0296, 0.0289, 0.0348, 0.0313, 0.0273],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1903, 0.1951, 0.2255, 0.2042], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0383, -0.0397, -0.0355, -0.0358, -0.0307],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1749, 0.1789, 0.1908, 0.2025, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0064, -0.0046, -0.0073,  0.0003,  0.0028]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2412469  0.20268662 0.19123888 0.18643348 0.17839417]
np_weight_alpha[1] [0.18716544 0.21687494 0.2006699  0.21063304 0.18465666]
np_weight_alpha[2] [0.19192095 0.19367573 0.22542183 0.19429147 0.19469005]
np_weight_alpha[3] [0.18717894 0.19367535 0.19422564 0.22647499 0.19844514]
np_weight_alpha[4] [0.19127995 0.18677145 0.21164037 0.18558681 0.22472148]
-------------Round number:  537  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5476190476190477
client Accurancy:  0.5
client Accurancy:  0.36507936507936506
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.5908163265306122
Average Global Trainning Loss:  1.1357095523756378
All users are selected
model: 0 tensor([0.2412, 0.2027, 0.1912, 0.1864, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-7.9766e-03, -6.2869e-05, -7.8926e-03, -7.5285e-03, -1.9035e-04],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1872, 0.2169, 0.2007, 0.2106, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0240, -0.0293, -0.0009,  0.0087, -0.0158],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1937, 0.2254, 0.1943, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0085, -0.0113, -0.0158, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1872, 0.1937, 0.1942, 0.2265, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0072, 0.0126, 0.0060, 0.0098, 0.0110],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1913, 0.1868, 0.2116, 0.1856, 0.2247], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0395,  0.0194,  0.0388,  0.0091, -0.0024]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26269373 0.1777442  0.20414877 0.19749625 0.1579171 ]
np_weight_alpha[1] [0.19809736 0.23607676 0.18885796 0.18919063 0.18777725]
np_weight_alpha[2] [0.19407383 0.18954532 0.22529149 0.19720902 0.1938804 ]
np_weight_alpha[3] [0.19700381 0.17780174 0.21068683 0.22462313 0.18988451]
np_weight_alpha[4] [0.1729867  0.18701863 0.19218302 0.19574665 0.25206497]
-------------Round number:  538  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5515873015873016
client Accurancy:  0.503968253968254
client Accurancy:  0.38095238095238093
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4642857142857143
Average Global Trainning Accurancy:  0.610204081632653
Average Global Trainning Loss:  1.032188861872874
All users are selected
model: 0 tensor([0.2627, 0.1777, 0.2041, 0.1975, 0.1579], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0311, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0124, -0.0420,  0.0015,  0.0010, -0.0292],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1981, 0.2361, 0.1889, 0.1892, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0199, -0.0030, -0.0133, -0.0106, -0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1895, 0.2253, 0.1972, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0225, 0.0172, 0.0180, 0.0213, 0.0220],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1970, 0.1778, 0.2107, 0.2246, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0269,  0.0020,  0.0297,  0.0153, -0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1730, 0.1870, 0.1922, 0.1957, 0.2521], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0168, -0.0074, -0.0149, -0.0236, -0.0117]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24155839 0.2073797  0.19031467 0.18463437 0.17611292]
np_weight_alpha[1] [0.25325677 0.20026177 0.20486371 0.19202057 0.14959718]
np_weight_alpha[2] [0.19149378 0.1922364  0.22891928 0.19562797 0.19172259]
np_weight_alpha[3] [0.18488045 0.19024578 0.1951656  0.22497657 0.20473161]
np_weight_alpha[4] [0.17480281 0.17887513 0.19058199 0.20266405 0.25307605]
-------------Round number:  539  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5595238095238095
client Accurancy:  0.5238095238095238
client Accurancy:  0.3968253968253968
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.6231292517006802
Average Global Trainning Loss:  1.0403636698820153
All users are selected
model: 0 tensor([0.2416, 0.2074, 0.1903, 0.1846, 0.1761], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0129, 0.0133, 0.0081, 0.0068, 0.0075],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2533, 0.2003, 0.2049, 0.1920, 0.1496], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0273, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0438, -0.0353,  0.0029, -0.0104, -0.0414],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1915, 0.1922, 0.2289, 0.1956, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0319, 0.0305, 0.0367, 0.0331, 0.0293],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1902, 0.1952, 0.2250, 0.2047], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0340, -0.0349, -0.0308, -0.0315, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1748, 0.1789, 0.1906, 0.2027, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0075, -0.0059, -0.0081,  0.0003,  0.0015]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22672163 0.18914948 0.1979184  0.19900426 0.18720621]
np_weight_alpha[1] [0.20081708 0.22883691 0.19339727 0.19382699 0.18312179]
np_weight_alpha[2] [0.19166076 0.19379619 0.2256108  0.19451076 0.19442154]
np_weight_alpha[3] [0.1877003  0.19366027 0.19445959 0.2264537  0.1977261 ]
np_weight_alpha[4] [0.19224277 0.1884314  0.21088322 0.1816909  0.22675169]
-------------Round number:  540  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5476190476190477
client Accurancy:  0.49603174603174605
client Accurancy:  0.35714285714285715
client Accurancy:  0.2777777777777778
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.5897959183673469
Average Global Trainning Loss:  1.1427353216677296
All users are selected
model: 0 tensor([0.2267, 0.1891, 0.1979, 0.1990, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0241, -0.0152, -0.0013,  0.0046,  0.0092],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2008, 0.2288, 0.1934, 0.1938, 0.1831], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0105, -0.0175, -0.0094, -0.0095, -0.0186],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1917, 0.1938, 0.2256, 0.1945, 0.1944], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0169, -0.0103, -0.0132, -0.0175, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1877, 0.1937, 0.1945, 0.2265, 0.1977], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0098, 0.0152, 0.0086, 0.0120, 0.0132],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1922, 0.1884, 0.2109, 0.1817, 0.2268], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0415,  0.0219,  0.0387,  0.0063, -0.0005]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24916707 0.19746047 0.19243209 0.18787202 0.17306834]
np_weight_alpha[1] [0.19745263 0.23525806 0.18926644 0.18975878 0.18826401]
np_weight_alpha[2] [0.19383293 0.18958439 0.22547705 0.19722116 0.19388448]
np_weight_alpha[3] [0.18945953 0.19001217 0.19716118 0.22752222 0.19584498]
np_weight_alpha[4] [0.17265753 0.18683678 0.19216882 0.19525275 0.25308415]
-------------Round number:  541  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5476190476190477
client Accurancy:  0.5
client Accurancy:  0.38492063492063494
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4603174603174603
Average Global Trainning Accurancy:  0.6098639455782313
Average Global Trainning Loss:  1.0327268846991922
All users are selected
model: 0 tensor([0.2492, 0.1975, 0.1924, 0.1879, 0.1731], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0013, -0.0220, -0.0103, -0.0084, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1975, 0.2353, 0.1893, 0.1898, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0217, -0.0049, -0.0136, -0.0105, -0.0010],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1896, 0.2255, 0.1972, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0193, 0.0143, 0.0151, 0.0184, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1895, 0.1900, 0.1972, 0.2275, 0.1958], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0238, 0.0194, 0.0204, 0.0224, 0.0102],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1727, 0.1868, 0.1922, 0.1953, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0172, -0.0074, -0.0150, -0.0241, -0.0105]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24199203 0.20729002 0.19066986 0.18457927 0.17546885]
np_weight_alpha[1] [0.20820089 0.23124358 0.19187641 0.18939163 0.17928746]
np_weight_alpha[2] [0.19144857 0.1921585  0.22898613 0.19555943 0.19184737]
np_weight_alpha[3] [0.1850202  0.18966332 0.19555955 0.22536306 0.20439392]
np_weight_alpha[4] [0.17490935 0.17876607 0.19071952 0.20272285 0.2528822 ]
-------------Round number:  542  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5555555555555556
client Accurancy:  0.5238095238095238
client Accurancy:  0.39285714285714285
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4658730158730159
Average Global Trainning Accurancy:  0.6190476190476191
Average Global Trainning Loss:  1.038824836575255
All users are selected
model: 0 tensor([0.2420, 0.2073, 0.1907, 0.1846, 0.1755], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0119, 0.0123, 0.0072, 0.0059, 0.0057],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2082, 0.2312, 0.1919, 0.1894, 0.1793], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0009, -0.0016, -0.0080, -0.0101, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1914, 0.1922, 0.2290, 0.1956, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0317, 0.0302, 0.0369, 0.0331, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1897, 0.1956, 0.2254, 0.2044], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0339, -0.0358, -0.0306, -0.0314, -0.0256],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1749, 0.1788, 0.1907, 0.2027, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-7.3241e-03, -6.0039e-03, -7.6717e-03,  5.9136e-05,  1.7027e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22638859 0.18883064 0.1972453  0.19772053 0.18981493]
np_weight_alpha[1] [0.18497637 0.21128598 0.20385422 0.21206693 0.18781653]
np_weight_alpha[2] [0.19182383 0.1939911  0.2255043  0.19444183 0.1942389 ]
np_weight_alpha[3] [0.18738592 0.19364303 0.19437453 0.2264521  0.1981444 ]
np_weight_alpha[4] [0.1918638  0.18924934 0.20945883 0.18332729 0.22610082]
-------------Round number:  543  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5436507936507936
client Accurancy:  0.5
client Accurancy:  0.36904761904761907
client Accurancy:  0.2777777777777778
Average Global Accurancy:  0.43492063492063493
Average Global Trainning Accurancy:  0.5894557823129252
Average Global Trainning Loss:  1.1395156548947705
All users are selected
model: 0 tensor([0.2264, 0.1888, 0.1972, 0.1977, 0.1898], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0236, -0.0145, -0.0010,  0.0054,  0.0135],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1850, 0.2113, 0.2039, 0.2121, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0287, -0.0367,  0.0004,  0.0083, -0.0139],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1940, 0.2255, 0.1944, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0158, -0.0090, -0.0123, -0.0159, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1874, 0.1936, 0.1944, 0.2265, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0098, 0.0144, 0.0085, 0.0116, 0.0121],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1919, 0.1892, 0.2095, 0.1833, 0.2261], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0397,  0.0214,  0.0359,  0.0053, -0.0024]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24969329 0.19770338 0.19272217 0.1871593  0.1727218 ]
np_weight_alpha[1] [0.19880806 0.2359314  0.18887205 0.18919149 0.18719698]
np_weight_alpha[2] [0.19412108 0.18965758 0.22573656 0.19680773 0.19367705]
np_weight_alpha[3] [0.18876576 0.19025071 0.19675834 0.22733203 0.19689311]
np_weight_alpha[4] [0.17249162 0.18655169 0.19199991 0.19629684 0.25265992]
-------------Round number:  544  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5595238095238095
client Accurancy:  0.503968253968254
client Accurancy:  0.39285714285714285
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.6142857142857143
Average Global Trainning Loss:  1.0212903081154336
All users are selected
model: 0 tensor([0.2497, 0.1977, 0.1927, 0.1872, 0.1727], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0007, -0.0205, -0.0087, -0.0078, -0.0124],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1988, 0.2359, 0.1889, 0.1892, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0201, -0.0041, -0.0138, -0.0111, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1897, 0.2257, 0.1968, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0207, 0.0155, 0.0162, 0.0192, 0.0198],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1888, 0.1903, 0.1968, 0.2273, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0221, 0.0185, 0.0192, 0.0211, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1866, 0.1920, 0.1963, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0192, -0.0091, -0.0168, -0.0246, -0.0127]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2418142  0.20726149 0.19065174 0.18458085 0.17569166]
np_weight_alpha[1] [0.20808117 0.23129497 0.19188909 0.18954113 0.17919359]
np_weight_alpha[2] [0.1913978  0.1921366  0.22921267 0.19542187 0.1918311 ]
np_weight_alpha[3] [0.18502358 0.18978593 0.19542372 0.22550558 0.20426117]
np_weight_alpha[4] [0.17508379 0.17858598 0.19068556 0.20262998 0.25301468]
-------------Round number:  545  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5515873015873016
client Accurancy:  0.5238095238095238
client Accurancy:  0.39285714285714285
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4658730158730159
Average Global Trainning Accurancy:  0.6210884353741497
Average Global Trainning Loss:  1.0325969254889455
All users are selected
model: 0 tensor([0.2418, 0.2073, 0.1907, 0.1846, 0.1757], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0115, 0.0121, 0.0071, 0.0056, 0.0058],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2081, 0.2313, 0.1919, 0.1895, 0.1792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0009, -0.0018, -0.0078, -0.0098, -0.0075],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1914, 0.1921, 0.2292, 0.1954, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0325, 0.0311, 0.0375, 0.0338, 0.0304],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1898, 0.1954, 0.2255, 0.2043], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0340, -0.0356, -0.0308, -0.0315, -0.0258],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1751, 0.1786, 0.1907, 0.2026, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0076, -0.0068, -0.0081, -0.0005,  0.0013]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22768204 0.18851477 0.19696227 0.19810511 0.1887358 ]
np_weight_alpha[1] [0.18506187 0.21266969 0.2028467  0.21074054 0.18868114]
np_weight_alpha[2] [0.19175078 0.19379564 0.22593987 0.1943842  0.19412951]
np_weight_alpha[3] [0.18746497 0.193509   0.19432494 0.22661078 0.19809033]
np_weight_alpha[4] [0.1910735  0.19046544 0.2090975  0.18342702 0.22593659]
-------------Round number:  546  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5396825396825397
client Accurancy:  0.49603174603174605
client Accurancy:  0.36507936507936506
client Accurancy:  0.2777777777777778
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.591156462585034
Average Global Trainning Loss:  1.1342469507334183
All users are selected
model: 0 tensor([0.2277, 0.1885, 0.1970, 0.1981, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0217, -0.0144, -0.0003,  0.0065,  0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1851, 0.2127, 0.2028, 0.2107, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0290, -0.0352, -0.0008,  0.0069, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1938, 0.2259, 0.1944, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0148, -0.0085, -0.0112, -0.0153, -0.0125],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1935, 0.1943, 0.2266, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0107, 0.0152, 0.0092, 0.0124, 0.0131],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1911, 0.1905, 0.2091, 0.1834, 0.2259], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0367,  0.0206,  0.0331,  0.0034, -0.0049]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24970661 0.19795676 0.19241309 0.18711472 0.17280877]
np_weight_alpha[1] [0.19907896 0.23574696 0.18897502 0.18915737 0.18704167]
np_weight_alpha[2] [0.19380412 0.18972753 0.22577682 0.19685662 0.19383489]
np_weight_alpha[3] [0.18871349 0.19017045 0.19679707 0.22763355 0.19668542]
np_weight_alpha[4] [0.17252937 0.18636782 0.19216026 0.1960876  0.25285494]
-------------Round number:  547  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5555555555555556
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.6173469387755102
Average Global Trainning Loss:  1.0151326497395834
All users are selected
model: 0 tensor([0.2497, 0.1980, 0.1924, 0.1871, 0.1728], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0012, -0.0200, -0.0089, -0.0078, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1991, 0.2357, 0.1890, 0.1892, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0192, -0.0039, -0.0127, -0.0104, -0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1938, 0.1897, 0.2258, 0.1969, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0213, 0.0170, 0.0167, 0.0204, 0.0212],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1887, 0.1902, 0.1968, 0.2276, 0.1967], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0199, 0.0164, 0.0172, 0.0193, 0.0082],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1864, 0.1922, 0.1961, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0191, -0.0093, -0.0162, -0.0246, -0.0121]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24151717 0.20726487 0.19072662 0.18468298 0.17580828]
np_weight_alpha[1] [0.25004977 0.2051939  0.2021918  0.19098212 0.15158245]
np_weight_alpha[2] [0.19144493 0.1917389  0.22992253 0.19531317 0.19158038]
np_weight_alpha[3] [0.18510997 0.18971847 0.19533883 0.22557443 0.20425823]
np_weight_alpha[4] [0.17519748 0.17879374 0.19048437 0.20263614 0.25288826]
-------------Round number:  548  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5595238095238095
client Accurancy:  0.5238095238095238
client Accurancy:  0.3888888888888889
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4658730158730159
Average Global Trainning Accurancy:  0.6285714285714286
Average Global Trainning Loss:  1.0229553637861395
All users are selected
model: 0 tensor([0.2415, 0.2073, 0.1907, 0.1847, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0117, 0.0129, 0.0076, 0.0066, 0.0065],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2500, 0.2052, 0.2022, 0.1910, 0.1516], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0248, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0397, -0.0314, -0.0013, -0.0125, -0.0408],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1917, 0.2299, 0.1953, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0329, 0.0309, 0.0387, 0.0346, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1897, 0.1953, 0.2256, 0.2043], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0335, -0.0354, -0.0304, -0.0312, -0.0264],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1752, 0.1788, 0.1905, 0.2026, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-6.3380e-03, -5.4805e-03, -6.8920e-03,  4.8833e-05,  3.0162e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22983748 0.18787533 0.19730034 0.1965877  0.18839915]
np_weight_alpha[1] [0.20054573 0.22867212 0.19376846 0.19370468 0.1833091 ]
np_weight_alpha[2] [0.19190037 0.19412144 0.22603536 0.19402298 0.19391987]
np_weight_alpha[3] [0.18725176 0.19344454 0.19396444 0.22652538 0.19881381]
np_weight_alpha[4] [0.19098555 0.19032644 0.20903075 0.18674056 0.22291666]
-------------Round number:  549  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5515873015873016
client Accurancy:  0.49603174603174605
client Accurancy:  0.36507936507936506
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.5986394557823129
Average Global Trainning Loss:  1.1154228781356292
All users are selected
model: 0 tensor([0.2298, 0.1879, 0.1973, 0.1966, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0189, -0.0149,  0.0003,  0.0058,  0.0128],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2005, 0.2287, 0.1938, 0.1937, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0122, -0.0181, -0.0102, -0.0102, -0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1941, 0.2260, 0.1940, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0142, -0.0078, -0.0104, -0.0148, -0.0117],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1873, 0.1934, 0.1940, 0.2265, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0117, 0.0161, 0.0097, 0.0127, 0.0137],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1910, 0.1903, 0.2090, 0.1867, 0.2229], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0236, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0348,  0.0193,  0.0317,  0.0044, -0.0095]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24946043 0.19819325 0.19262509 0.18671425 0.17300692]
np_weight_alpha[1] [0.1982076  0.23496042 0.18966806 0.18967699 0.18748696]
np_weight_alpha[2] [0.19399877 0.18997999 0.22578509 0.19667052 0.19356567]
np_weight_alpha[3] [0.18824919 0.18990463 0.19659798 0.22786902 0.19737923]
np_weight_alpha[4] [0.17261896 0.18599671 0.19186471 0.19674116 0.25277844]
-------------Round number:  550  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5476190476190477
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4587301587301587
Average Global Trainning Accurancy:  0.6193877551020408
Average Global Trainning Loss:  1.0080436862244897
All users are selected
model: 0 tensor([0.2495, 0.1982, 0.1926, 0.1867, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0017, -0.0192, -0.0080, -0.0075, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1982, 0.2350, 0.1897, 0.1897, 0.1875], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0204, -0.0052, -0.0118, -0.0100, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1940, 0.1900, 0.2258, 0.1967, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0204, 0.0165, 0.0150, 0.0191, 0.0199],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1882, 0.1899, 0.1966, 0.2279, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0211, 0.0179, 0.0189, 0.0212, 0.0107],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1860, 0.1919, 0.1967, 0.2528], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0201, -0.0109, -0.0176, -0.0251, -0.0135]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19506495 0.2546005  0.1870286  0.17943813 0.18386777]
np_weight_alpha[1] [0.25537932 0.20946227 0.1969451  0.1883445  0.14986883]
np_weight_alpha[2] [0.1914003  0.19132519 0.23050533 0.19524477 0.19152439]
np_weight_alpha[3] [0.18518193 0.18972374 0.19528227 0.22562735 0.20418468]
np_weight_alpha[4] [0.1751136  0.17883953 0.19042325 0.202595   0.25302866]
-------------Round number:  551  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5634920634920635
client Accurancy:  0.5238095238095238
client Accurancy:  0.38492063492063494
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.6238095238095238
Average Global Trainning Loss:  1.0314016329187925
All users are selected
model: 0 tensor([0.1951, 0.2546, 0.1870, 0.1794, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0349,  0.0624,  0.0054,  0.0030,  0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2554, 0.2095, 0.1969, 0.1883, 0.1499], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0291, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0422, -0.0296, -0.0092, -0.0178, -0.0459],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1913, 0.2305, 0.1952, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0334, 0.0312, 0.0392, 0.0349, 0.0313],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1852, 0.1897, 0.1953, 0.2256, 0.2042], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0324, -0.0277, -0.0289, -0.0235],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1751, 0.1788, 0.1904, 0.2026, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0073, -0.0065, -0.0077, -0.0006,  0.0026]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24331963 0.20149985 0.19105348 0.18617414 0.17795296]
np_weight_alpha[1] [0.20055482 0.22827789 0.19368088 0.19361676 0.18386967]
np_weight_alpha[2] [0.1917998  0.19384715 0.22645974 0.19400966 0.19388366]
np_weight_alpha[3] [0.18714944 0.19318642 0.19394696 0.22708605 0.1986312 ]
np_weight_alpha[4] [0.19178073 0.19176753 0.20920315 0.18608697 0.22116165]
-------------Round number:  552  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5515873015873016
client Accurancy:  0.49206349206349204
client Accurancy:  0.36507936507936506
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.6034013605442177
Average Global Trainning Loss:  1.1039011014562075
All users are selected
model: 0 tensor([0.2433, 0.2015, 0.1911, 0.1862, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0029,  0.0010, -0.0046, -0.0042,  0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2006, 0.2283, 0.1937, 0.1936, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0123, -0.0186, -0.0104, -0.0107, -0.0179],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1938, 0.2265, 0.1940, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0128, -0.0066, -0.0091, -0.0134, -0.0103],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1871, 0.1932, 0.1939, 0.2271, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0097, 0.0143, 0.0084, 0.0121, 0.0127],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1918, 0.1918, 0.2092, 0.1861, 0.2212], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0241, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0352,  0.0200,  0.0313,  0.0034, -0.0130]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2539557  0.18684453 0.20434493 0.19708872 0.15776618]
np_weight_alpha[1] [0.1981853  0.23487869 0.18959482 0.18987118 0.18746999]
np_weight_alpha[2] [0.1938296  0.1899002  0.22628286 0.19656584 0.1934215 ]
np_weight_alpha[3] [0.18870066 0.1901246  0.19651589 0.22773203 0.19692673]
np_weight_alpha[4] [0.17224461 0.18586583 0.19166672 0.19625562 0.25396723]
-------------Round number:  553  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5436507936507936
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.6234693877551021
Average Global Trainning Loss:  1.0002541885894982
All users are selected
model: 0 tensor([0.2540, 0.1868, 0.2043, 0.1971, 0.1578], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0068, -0.0304,  0.0047,  0.0036, -0.0265],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1982, 0.2349, 0.1896, 0.1899, 0.1875], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0214, -0.0059, -0.0128, -0.0105, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1899, 0.2263, 0.1966, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0205, 0.0165, 0.0157, 0.0194, 0.0201],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1887, 0.1901, 0.1965, 0.2277, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0199, 0.0164, 0.0171, 0.0191, 0.0083],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1722, 0.1859, 0.1917, 0.1963, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0192, -0.0097, -0.0166, -0.0246, -0.0116]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24131252 0.2078016  0.19026604 0.18444186 0.1761779 ]
np_weight_alpha[1] [0.20846985 0.23174374 0.1912822  0.18935274 0.17915152]
np_weight_alpha[2] [0.19142717 0.19152361 0.2305605  0.19510534 0.19138335]
np_weight_alpha[3] [0.18502036 0.18965437 0.19513851 0.2258501  0.20433673]
np_weight_alpha[4] [0.17493331 0.17863895 0.19026586 0.20267649 0.25348532]
-------------Round number:  554  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5515873015873016
client Accurancy:  0.5238095238095238
client Accurancy:  0.38492063492063494
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.6289115646258503
Average Global Trainning Loss:  1.0132115785767433
All users are selected
model: 0 tensor([0.2413, 0.2078, 0.1903, 0.1844, 0.1762], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0109, 0.0132, 0.0067, 0.0055, 0.0064],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2085, 0.2317, 0.1913, 0.1894, 0.1792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004, -0.0016, -0.0090, -0.0101, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1914, 0.1915, 0.2306, 0.1951, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0327, 0.0305, 0.0385, 0.0341, 0.0306],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1897, 0.1951, 0.2259, 0.2043], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0359, -0.0372, -0.0324, -0.0330, -0.0281],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1749, 0.1786, 0.1903, 0.2027, 0.2535], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0056, -0.0064,  0.0008,  0.0044]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23099767 0.18450439 0.19865197 0.19895178 0.18689425]
np_weight_alpha[1] [0.18164606 0.21000761 0.2065206  0.20996982 0.19185588]
np_weight_alpha[2] [0.19179757 0.1940095  0.22651505 0.19393049 0.19374745]
np_weight_alpha[3] [0.18753776 0.19319445 0.19388114 0.22673948 0.19864716]
np_weight_alpha[4] [0.19227795 0.19342984 0.20918725 0.18592045 0.21918456]
-------------Round number:  555  -------------
client Accurancy:  0.5
client Accurancy:  0.5396825396825397
client Accurancy:  0.4880952380952381
client Accurancy:  0.36507936507936506
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.5986394557823129
Average Global Trainning Loss:  1.1237900922087585
All users are selected
model: 0 tensor([0.2310, 0.1845, 0.1987, 0.1990, 0.1869], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0168, -0.0172,  0.0027,  0.0109,  0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1816, 0.2100, 0.2065, 0.2100, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0337, -0.0389,  0.0022,  0.0062, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1940, 0.2265, 0.1939, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0154, -0.0087, -0.0110, -0.0148, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1932, 0.1939, 0.2267, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0140, 0.0168, 0.0112, 0.0133, 0.0130],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1923, 0.1934, 0.2092, 0.1859, 0.2192], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0353,  0.0219,  0.0309,  0.0007, -0.0149]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2501389  0.1986433  0.19296817 0.18553175 0.17271787]
np_weight_alpha[1] [0.19993074 0.23644863 0.18921757 0.18874526 0.18565777]
np_weight_alpha[2] [0.19444817 0.19008969 0.2262927  0.19595693 0.19321251]
np_weight_alpha[3] [0.18713225 0.18982936 0.1958767  0.22838086 0.19878073]
np_weight_alpha[4] [0.1721138  0.18512377 0.19147497 0.19820239 0.25308502]
-------------Round number:  556  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5436507936507936
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.38492063492063494
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.6255102040816326
Average Global Trainning Loss:  0.9898069628241922
All users are selected
model: 0 tensor([0.2501, 0.1986, 0.1930, 0.1855, 0.1727], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0017, -0.0197, -0.0081, -0.0092, -0.0128],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1999, 0.2364, 0.1892, 0.1887, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0204, -0.0052, -0.0138, -0.0124, -0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1901, 0.2263, 0.1960, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0246, 0.0200, 0.0184, 0.0219, 0.0230],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1871, 0.1898, 0.1959, 0.2284, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0219, 0.0196, 0.0199, 0.0226, 0.0140],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1721, 0.1851, 0.1915, 0.1982, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0143, -0.0204, -0.0260, -0.0157]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24127834 0.20763248 0.1904521  0.18450768 0.1761294 ]
np_weight_alpha[1] [0.20836826 0.2318001  0.19111401 0.18931288 0.17940474]
np_weight_alpha[2] [0.19107836 0.19128612 0.23114625 0.19508739 0.1914018 ]
np_weight_alpha[3] [0.1849623  0.18958417 0.19511883 0.22643024 0.20390448]
np_weight_alpha[4] [0.1755281  0.1787948  0.19030333 0.20239869 0.2529751 ]
-------------Round number:  557  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5515873015873016
client Accurancy:  0.5238095238095238
client Accurancy:  0.38492063492063494
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4658730158730159
Average Global Trainning Accurancy:  0.6302721088435375
Average Global Trainning Loss:  1.0074833253613946
All users are selected
model: 0 tensor([0.2413, 0.2076, 0.1905, 0.1845, 0.1761], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0116, 0.0133, 0.0074, 0.0059, 0.0067],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2084, 0.2318, 0.1911, 0.1893, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0002, -0.0008, -0.0080, -0.0092, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1911, 0.1913, 0.2311, 0.1951, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0323, 0.0304, 0.0386, 0.0341, 0.0306],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1896, 0.1951, 0.2264, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0379, -0.0392, -0.0343, -0.0344, -0.0304],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1755, 0.1788, 0.1903, 0.2024, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0049, -0.0048, -0.0058,  0.0011,  0.0043]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22982377 0.1859785  0.1978325  0.19917488 0.1871903 ]
np_weight_alpha[1] [0.1828615  0.2104575  0.20579536 0.21015313 0.19073252]
np_weight_alpha[2] [0.19177867 0.19373363 0.22697788 0.19383694 0.19367285]
np_weight_alpha[3] [0.18762113 0.19319822 0.1938017  0.22677304 0.19860591]
np_weight_alpha[4] [0.189784   0.1925903  0.2086729  0.18670462 0.22224823]
-------------Round number:  558  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5357142857142857
client Accurancy:  0.48412698412698413
client Accurancy:  0.36507936507936506
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.42936507936507934
Average Global Trainning Accurancy:  0.6003401360544217
Average Global Trainning Loss:  1.1155775005314625
All users are selected
model: 0 tensor([0.2298, 0.1860, 0.1978, 0.1992, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0164, -0.0143,  0.0030,  0.0111,  0.0139],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1829, 0.2105, 0.2058, 0.2102, 0.1907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0314, -0.0378,  0.0021,  0.0066, -0.0101],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1937, 0.2270, 0.1938, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0080, -0.0101, -0.0145, -0.0114],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1876, 0.1932, 0.1938, 0.2268, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0132, 0.0167, 0.0109, 0.0135, 0.0145],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1898, 0.1926, 0.2087, 0.1867, 0.2222], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0298,  0.0180,  0.0282,  0.0007, -0.0142]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24940231 0.19812135 0.19286978 0.1864205  0.17318603]
np_weight_alpha[1] [0.19929379 0.23626985 0.1890548  0.18896359 0.18641792]
np_weight_alpha[2] [0.19425786 0.18990304 0.22653705 0.19623433 0.19306774]
np_weight_alpha[3] [0.18799616 0.19001798 0.19617297 0.2283938  0.19741917]
np_weight_alpha[4] [0.17275995 0.18583143 0.19136581 0.19677491 0.25326788]
-------------Round number:  559  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5357142857142857
client Accurancy:  0.5
client Accurancy:  0.38492063492063494
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.6302721088435375
Average Global Trainning Loss:  0.9894775390625
All users are selected
model: 0 tensor([0.2494, 0.1981, 0.1929, 0.1864, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0021, -0.0190, -0.0068, -0.0070, -0.0108],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1993, 0.2363, 0.1891, 0.1890, 0.1864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0199, -0.0045, -0.0128, -0.0109, -0.0027],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1899, 0.2265, 0.1962, 0.1931], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0237, 0.0191, 0.0176, 0.0215, 0.0221],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1880, 0.1900, 0.1962, 0.2284, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0194, 0.0166, 0.0170, 0.0192, 0.0092],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1858, 0.1914, 0.1968, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0212, -0.0118, -0.0188, -0.0258, -0.0141]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19550948 0.25640532 0.18426    0.1792162  0.184609  ]
np_weight_alpha[1] [0.20841752 0.23205602 0.19104855 0.18919295 0.179285  ]
np_weight_alpha[2] [0.19099091 0.19122735 0.23139869 0.19501601 0.19136702]
np_weight_alpha[3] [0.18491076 0.18945001 0.19504794 0.22661816 0.20397319]
np_weight_alpha[4] [0.17540753 0.17869298 0.19027148 0.20241101 0.25321695]
-------------Round number:  560  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5476190476190477
client Accurancy:  0.5238095238095238
client Accurancy:  0.38492063492063494
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.6265306122448979
Average Global Trainning Loss:  1.0189683148650086
All users are selected
model: 0 tensor([0.1955, 0.2564, 0.1843, 0.1792, 0.1846], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0368,  0.0623,  0.0005, -0.0003,  0.0147],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2084, 0.2321, 0.1910, 0.1892, 0.1793], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0018, -0.0025, -0.0101, -0.0110, -0.0097],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1910, 0.1912, 0.2314, 0.1950, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0306, 0.0284, 0.0367, 0.0321, 0.0286],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1895, 0.1950, 0.2266, 0.2040], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0296, -0.0304, -0.0258, -0.0262, -0.0213],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1754, 0.1787, 0.1903, 0.2024, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0081, -0.0081, -0.0087, -0.0012,  0.0018]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24324982 0.2009962  0.19080578 0.18686104 0.17808715]
np_weight_alpha[1] [0.18275256 0.20942222 0.20641077 0.20891076 0.1925037 ]
np_weight_alpha[2] [0.19145031 0.19377963 0.22721478 0.19382225 0.19373304]
np_weight_alpha[3] [0.187789   0.19285741 0.19377662 0.22744706 0.19812992]
np_weight_alpha[4] [0.1913379  0.19430412 0.20915568 0.18456057 0.22064182]
-------------Round number:  561  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.48412698412698413
client Accurancy:  0.36904761904761907
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.6047619047619047
Average Global Trainning Loss:  1.1047426392431974
All users are selected
model: 0 tensor([0.2432, 0.2010, 0.1908, 0.1869, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0013,  0.0023, -0.0032,  0.0004,  0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1828, 0.2094, 0.2064, 0.2089, 0.1925], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0313, -0.0381,  0.0036,  0.0060, -0.0065],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1915, 0.1938, 0.2272, 0.1938, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0146, -0.0076, -0.0098, -0.0137, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1878, 0.1929, 0.1938, 0.2274, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0143, 0.0160, 0.0112, 0.0138, 0.0129],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1913, 0.1943, 0.2092, 0.1846, 0.2206], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0300,  0.0188,  0.0270, -0.0044, -0.0184]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25755402 0.19075406 0.20804271 0.18640505 0.15724416]
np_weight_alpha[1] [0.19995095 0.23639178 0.18905255 0.1891331  0.1854717 ]
np_weight_alpha[2] [0.19439715 0.18992256 0.2269842  0.1958332  0.19286281]
np_weight_alpha[3] [0.18706866 0.1901855  0.19577265 0.22861058 0.19836257]
np_weight_alpha[4] [0.17221925 0.18487717 0.19110857 0.19775513 0.25403988]
-------------Round number:  562  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5357142857142857
client Accurancy:  0.5
client Accurancy:  0.39285714285714285
client Accurancy:  0.38095238095238093
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.6353741496598639
Average Global Trainning Loss:  0.9715103668420493
All users are selected
model: 0 tensor([0.2576, 0.1908, 0.2080, 0.1864, 0.1572], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0274, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0103, -0.0270,  0.0084, -0.0076, -0.0284],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2000, 0.2364, 0.1891, 0.1891, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0212, -0.0060, -0.0145, -0.0127, -0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1899, 0.2270, 0.1958, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0216, 0.0170, 0.0158, 0.0190, 0.0193],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1871, 0.1902, 0.1958, 0.2286, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0244, 0.0225, 0.0224, 0.0248, 0.0161],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1722, 0.1849, 0.1911, 0.1978, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0146, -0.0212, -0.0264, -0.0147]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24089003 0.20776168 0.18979631 0.18455715 0.17699489]
np_weight_alpha[1] [0.20848842 0.23189564 0.19096242 0.18926913 0.17938443]
np_weight_alpha[2] [0.19093859 0.19112563 0.23139824 0.19487633 0.19166121]
np_weight_alpha[3] [0.18481164 0.18952222 0.19489542 0.22699317 0.20377758]
np_weight_alpha[4] [0.17555209 0.17880645 0.19056652 0.2022768  0.2527982 ]
-------------Round number:  563  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5396825396825397
client Accurancy:  0.5238095238095238
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4634920634920635
Average Global Trainning Accurancy:  0.6377551020408163
Average Global Trainning Loss:  0.9972892086522109
All users are selected
model: 0 tensor([0.2409, 0.2078, 0.1898, 0.1846, 0.1770], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0076, 0.0101, 0.0032, 0.0027, 0.0037],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2085, 0.2319, 0.1910, 0.1893, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0017, -0.0030, -0.0105, -0.0109, -0.0099],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1909, 0.1911, 0.2314, 0.1949, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0302, 0.0282, 0.0367, 0.0322, 0.0293],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1848, 0.1895, 0.1949, 0.2270, 0.2038], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0267, -0.0276, -0.0233, -0.0235, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1756, 0.1788, 0.1906, 0.2023, 0.2528], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0085, -0.0084, -0.0025,  0.0015]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23185529 0.18458134 0.20049904 0.19744553 0.18561876]
np_weight_alpha[1] [0.1815351  0.21083106 0.20747182 0.20757715 0.19258489]
np_weight_alpha[2] [0.19180162 0.19393454 0.22725147 0.19368842 0.19332395]
np_weight_alpha[3] [0.18731466 0.19264337 0.19364303 0.22756812 0.19883086]
np_weight_alpha[4] [0.19190034 0.1944905  0.20600371 0.1883025  0.21930292]
-------------Round number:  564  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5357142857142857
client Accurancy:  0.48412698412698413
client Accurancy:  0.36904761904761907
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.6027210884353742
Average Global Trainning Loss:  1.1037854253029338
All users are selected
model: 0 tensor([0.2319, 0.1846, 0.2005, 0.1974, 0.1856], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0112, -0.0131,  0.0084,  0.0119,  0.0151],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1815, 0.2108, 0.2075, 0.2076, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0352,  0.0063,  0.0058, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1918, 0.1939, 0.2273, 0.1937, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0151, -0.0082, -0.0107, -0.0150, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1873, 0.1926, 0.1936, 0.2276, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0113, 0.0143, 0.0096, 0.0129, 0.0136],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1919, 0.1945, 0.2060, 0.1883, 0.2193], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0245, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0294,  0.0176,  0.0227, -0.0003, -0.0213]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24884072 0.19836436 0.19292033 0.18667036 0.17320426]
np_weight_alpha[1] [0.19955629 0.23636074 0.18887152 0.18937121 0.18584028]
np_weight_alpha[2] [0.19435105 0.18975131 0.22688735 0.19600281 0.19300747]
np_weight_alpha[3] [0.1881906  0.1903966  0.1959533  0.22833136 0.19712813]
np_weight_alpha[4] [0.17240638 0.18519416 0.1912924  0.19641787 0.2546892 ]
-------------Round number:  565  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5396825396825397
client Accurancy:  0.49603174603174605
client Accurancy:  0.3888888888888889
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.6336734693877552
Average Global Trainning Loss:  0.9781546456473215
All users are selected
model: 0 tensor([0.2488, 0.1984, 0.1929, 0.1867, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0008, -0.0199, -0.0070, -0.0076, -0.0118],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1996, 0.2364, 0.1889, 0.1894, 0.1858], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0220, -0.0062, -0.0146, -0.0124, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1898, 0.2269, 0.1960, 0.1930], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0277, 0.0227, 0.0207, 0.0247, 0.0253],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1882, 0.1904, 0.1960, 0.2283, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0215, 0.0190, 0.0186, 0.0207, 0.0111],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1724, 0.1852, 0.1913, 0.1964, 0.2547], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0243, -0.0152, -0.0216, -0.0285, -0.0150]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19737203 0.25748986 0.18163909 0.17834061 0.18515842]
np_weight_alpha[1] [0.20879547 0.23190509 0.19075741 0.18912244 0.17941958]
np_weight_alpha[2] [0.19045943 0.1908952  0.23215647 0.1949948  0.19149412]
np_weight_alpha[3] [0.1849219  0.18935525 0.19504273 0.2269454  0.20373465]
np_weight_alpha[4] [0.17562684 0.17887042 0.19042963 0.20217426 0.25289884]
-------------Round number:  566  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5396825396825397
client Accurancy:  0.5238095238095238
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4603174603174603
Average Global Trainning Accurancy:  0.6306122448979592
Average Global Trainning Loss:  1.0071539846407314
All users are selected
model: 0 tensor([0.1974, 0.2575, 0.1816, 0.1783, 0.1852], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0347,  0.0633, -0.0023, -0.0013,  0.0150],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2088, 0.2319, 0.1908, 0.1891, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0003, -0.0014, -0.0096, -0.0097, -0.0085],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1905, 0.1909, 0.2322, 0.1950, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0280, 0.0258, 0.0353, 0.0305, 0.0271],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1894, 0.1950, 0.2269, 0.2037], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0285, -0.0292, -0.0245, -0.0252, -0.0207],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1756, 0.1789, 0.1904, 0.2022, 0.2529], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0082, -0.0081, -0.0084, -0.0019,  0.0014]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24291456 0.20097455 0.19094838 0.18690214 0.17826042]
np_weight_alpha[1] [0.18131015 0.2094407  0.20901139 0.2079872  0.1922506 ]
np_weight_alpha[2] [0.19153148 0.1940548  0.22744699 0.19354828 0.19341843]
np_weight_alpha[3] [0.18774234 0.19261855 0.19350626 0.22776854 0.19836426]
np_weight_alpha[4] [0.19115025 0.19392268 0.20703591 0.1865377  0.22135349]
-------------Round number:  567  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5436507936507936
client Accurancy:  0.48412698412698413
client Accurancy:  0.36904761904761907
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.6095238095238096
Average Global Trainning Loss:  1.0878777536405186
All users are selected
model: 0 tensor([0.2429, 0.2010, 0.1909, 0.1869, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0023,  0.0057, -0.0002,  0.0038,  0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1813, 0.2094, 0.2090, 0.2080, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0301, -0.0354,  0.0086,  0.0079, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1915, 0.1941, 0.2274, 0.1935, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0105, -0.0126, -0.0166, -0.0134],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1877, 0.1926, 0.1935, 0.2278, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0145, 0.0162, 0.0114, 0.0142, 0.0129],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1912, 0.1939, 0.2070, 0.1865, 0.2214], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0263,  0.0151,  0.0222, -0.0060, -0.0206]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25546587 0.19059874 0.21001685 0.18604296 0.15787558]
np_weight_alpha[1] [0.19992436 0.23632064 0.1892368  0.18897456 0.18554367]
np_weight_alpha[2] [0.19486107 0.1901534  0.2271039  0.19554336 0.19233817]
np_weight_alpha[3] [0.18700364 0.19001232 0.19548087 0.22873452 0.19876866]
np_weight_alpha[4] [0.17253397 0.18498553 0.19064571 0.19814284 0.25369197]
-------------Round number:  568  -------------
client Accurancy:  0.5
client Accurancy:  0.5317460317460317
client Accurancy:  0.49206349206349204
client Accurancy:  0.39285714285714285
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.6394557823129252
Average Global Trainning Loss:  0.9609028718909439
All users are selected
model: 0 tensor([0.2555, 0.1906, 0.2100, 0.1860, 0.1579], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0057, -0.0299,  0.0086, -0.0105, -0.0304],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1999, 0.2363, 0.1892, 0.1890, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0237, -0.0086, -0.0158, -0.0149, -0.0079],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1949, 0.1902, 0.2271, 0.1955, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0314, 0.0267, 0.0231, 0.0275, 0.0277],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1870, 0.1900, 0.1955, 0.2287, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0236, 0.0218, 0.0217, 0.0240, 0.0162],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1725, 0.1850, 0.1906, 0.1981, 0.2537], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0185, -0.0252, -0.0296, -0.0187]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24091178 0.20813522 0.18917698 0.18463193 0.177144  ]
np_weight_alpha[1] [0.20878458 0.23222871 0.19026844 0.1891514  0.17956693]
np_weight_alpha[2] [0.19031554 0.19035313 0.23312151 0.19471426 0.19149555]
np_weight_alpha[3] [0.1849226  0.18942566 0.19477132 0.22735125 0.20352913]
np_weight_alpha[4] [0.17576462 0.17901216 0.19043733 0.20207879 0.2527071 ]
-------------Round number:  569  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5396825396825397
client Accurancy:  0.5198412698412699
client Accurancy:  0.39285714285714285
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.6384353741496599
Average Global Trainning Loss:  0.9845970517113095
All users are selected
model: 0 tensor([0.2409, 0.2081, 0.1892, 0.1846, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0099, 0.0122, 0.0046, 0.0038, 0.0053],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2088, 0.2322, 0.1903, 0.1892, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012, -0.0004, -0.0086, -0.0081, -0.0071],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1903, 0.1904, 0.2331, 0.1947, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0272, 0.0247, 0.0353, 0.0294, 0.0264],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1894, 0.1948, 0.2274, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0292, -0.0293, -0.0251, -0.0254, -0.0211],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1758, 0.1790, 0.1904, 0.2021, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0085, -0.0081, -0.0084, -0.0018,  0.0012]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22843853 0.18307963 0.20123026 0.20080796 0.18644358]
np_weight_alpha[1] [0.18030092 0.2110438  0.21031436 0.20644599 0.19189495]
np_weight_alpha[2] [0.19144478 0.19391923 0.22773068 0.19354156 0.19336377]
np_weight_alpha[3] [0.18798712 0.1923593  0.19350329 0.228027   0.19812326]
np_weight_alpha[4] [0.19218728 0.19366166 0.20677234 0.18576282 0.22161584]
-------------Round number:  570  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5396825396825397
client Accurancy:  0.4880952380952381
client Accurancy:  0.373015873015873
client Accurancy:  0.26587301587301587
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.6068027210884354
Average Global Trainning Loss:  1.099030911192602
All users are selected
model: 0 tensor([0.2284, 0.1831, 0.2012, 0.2008, 0.1864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0131, -0.0124,  0.0109,  0.0206,  0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1803, 0.2110, 0.2103, 0.2064, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0315, -0.0342,  0.0096,  0.0061, -0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1939, 0.2277, 0.1935, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0176, -0.0099, -0.0119, -0.0151, -0.0121],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1880, 0.1924, 0.1935, 0.2280, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0151, 0.0150, 0.0111, 0.0132, 0.0102],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1922, 0.1937, 0.2068, 0.1858, 0.2216], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0266,  0.0144,  0.0215, -0.0093, -0.0210]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2502992  0.19884823 0.1937743  0.18420395 0.17287436]
np_weight_alpha[1] [0.20010978 0.23650214 0.18934089 0.18901536 0.18503183]
np_weight_alpha[2] [0.19534424 0.19028373 0.22763355 0.1948956  0.19184281]
np_weight_alpha[3] [0.18582235 0.19000725 0.19482845 0.22907837 0.20026359]
np_weight_alpha[4] [0.17234808 0.18448447 0.19016302 0.19969726 0.2533072 ]
-------------Round number:  571  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5317460317460317
client Accurancy:  0.4880952380952381
client Accurancy:  0.40476190476190477
client Accurancy:  0.38492063492063494
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.6421768707482993
Average Global Trainning Loss:  0.9551145800116921
All users are selected
model: 0 tensor([0.2503, 0.1988, 0.1938, 0.1842, 0.1729], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0005, -0.0227, -0.0087, -0.0130, -0.0154],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2001, 0.2365, 0.1893, 0.1890, 0.1850], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0258, -0.0105, -0.0172, -0.0167, -0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1953, 0.1903, 0.2276, 0.1949, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0401, 0.0351, 0.0300, 0.0348, 0.0353],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1900, 0.1948, 0.2291, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0212, 0.0208, 0.0200, 0.0230, 0.0167],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1723, 0.1845, 0.1902, 0.1997, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0222, -0.0283, -0.0309, -0.0221]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24119265 0.20839073 0.18942285 0.18450657 0.1764872 ]
np_weight_alpha[1] [0.2091015  0.23235184 0.18977147 0.18901798 0.17975724]
np_weight_alpha[2] [0.18985306 0.18977976 0.23470819 0.19454077 0.1911182 ]
np_weight_alpha[3] [0.18497829 0.18932787 0.194639   0.22765332 0.20340155]
np_weight_alpha[4] [0.17592336 0.17920592 0.19009152 0.2020233  0.2527559 ]
-------------Round number:  572  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5396825396825397
client Accurancy:  0.5238095238095238
client Accurancy:  0.3888888888888889
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4650793650793651
Average Global Trainning Accurancy:  0.6387755102040816
Average Global Trainning Loss:  0.9769592700361395
All users are selected
model: 0 tensor([0.2412, 0.2084, 0.1894, 0.1845, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0104, 0.0127, 0.0053, 0.0039, 0.0050],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2091, 0.2324, 0.1898, 0.1890, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0027,  0.0010, -0.0082, -0.0071, -0.0054],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1899, 0.1898, 0.2347, 0.1945, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0262, 0.0232, 0.0363, 0.0287, 0.0255],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1893, 0.1946, 0.2277, 0.2034], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0321, -0.0323, -0.0281, -0.0281, -0.0240],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1759, 0.1792, 0.1901, 0.2020, 0.2528], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0056, -0.0067,  0.0002,  0.0026]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22781672 0.1823086  0.1997639  0.20151821 0.18859252]
np_weight_alpha[1] [0.17924859 0.21031244 0.21391433 0.20704952 0.18947503]
np_weight_alpha[2] [0.19138607 0.19421127 0.22767708 0.19347978 0.19324581]
np_weight_alpha[3] [0.18800992 0.19238347 0.19343919 0.22815019 0.19801722]
np_weight_alpha[4] [0.19079459 0.1911414  0.2075008  0.18542507 0.2251382 ]
-------------Round number:  573  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5357142857142857
client Accurancy:  0.48412698412698413
client Accurancy:  0.36904761904761907
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.42857142857142855
Average Global Trainning Accurancy:  0.6085034013605443
Average Global Trainning Loss:  1.0936452852625425
All users are selected
model: 0 tensor([0.2278, 0.1823, 0.1998, 0.2015, 0.1886], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0129, -0.0126,  0.0105,  0.0238,  0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1792, 0.2103, 0.2139, 0.2070, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0314, -0.0333,  0.0149,  0.0088, -0.0045],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1942, 0.2277, 0.1935, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0103, -0.0126, -0.0154, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1880, 0.1924, 0.1934, 0.2282, 0.1980], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0148, 0.0138, 0.0098, 0.0112, 0.0075],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1908, 0.1911, 0.2075, 0.1854, 0.2251], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0240,  0.0115,  0.0216, -0.0115, -0.0171]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25073886 0.19941165 0.19388841 0.18299231 0.17296875]
np_weight_alpha[1] [0.20068274 0.23663549 0.18935189 0.18864046 0.18468946]
np_weight_alpha[2] [0.1954378  0.19041008 0.22772782 0.19465882 0.19176549]
np_weight_alpha[3] [0.18463726 0.1896482  0.1945537  0.22977716 0.2013837 ]
np_weight_alpha[4] [0.1728141  0.18426639 0.19011961 0.20088519 0.2519147 ]
-------------Round number:  574  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5357142857142857
client Accurancy:  0.47619047619047616
client Accurancy:  0.4166666666666667
client Accurancy:  0.38492063492063494
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.6438775510204081
Average Global Trainning Loss:  0.9474705702593538
All users are selected
model: 0 tensor([0.2507, 0.1994, 0.1939, 0.1830, 0.1730], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0003, -0.0215, -0.0078, -0.0137, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2007, 0.2366, 0.1894, 0.1886, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0254, -0.0104, -0.0178, -0.0173, -0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1954, 0.1904, 0.2277, 0.1947, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0372, 0.0316, 0.0271, 0.0313, 0.0318],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1846, 0.1896, 0.1946, 0.2298, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0250, 0.0243, 0.0281, 0.0225],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1843, 0.1901, 0.2009, 0.2519], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0317, -0.0239, -0.0300, -0.0312, -0.0250]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24144332 0.20826904 0.18922159 0.18454418 0.17652181]
np_weight_alpha[1] [0.20898983 0.23208584 0.19014655 0.18894847 0.17982931]
np_weight_alpha[2] [0.18965498 0.19014639 0.23437826 0.19456746 0.19125293]
np_weight_alpha[3] [0.1850641  0.18927039 0.19464757 0.22780108 0.20321687]
np_weight_alpha[4] [0.17591982 0.1792188  0.19019793 0.20192605 0.2527374 ]
-------------Round number:  575  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5317460317460317
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.6418367346938776
Average Global Trainning Loss:  0.9728641016953656
All users are selected
model: 0 tensor([0.2414, 0.2083, 0.1892, 0.1845, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0106, 0.0124, 0.0047, 0.0042, 0.0049],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2090, 0.2321, 0.1901, 0.1889, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 1.8929e-03,  2.1847e-05, -8.2883e-03, -7.3691e-03, -5.9694e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1897, 0.1901, 0.2344, 0.1946, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0225, 0.0204, 0.0326, 0.0256, 0.0226],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1893, 0.1946, 0.2278, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0265, -0.0224, -0.0227, -0.0192],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1759, 0.1792, 0.1902, 0.2019, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0078, -0.0073, -0.0081, -0.0020,  0.0014]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22626999 0.18349776 0.2018881  0.19985154 0.18849261]
np_weight_alpha[1] [0.18042503 0.21220917 0.2117974  0.20574945 0.1898189 ]
np_weight_alpha[2] [0.19162524 0.1941148  0.2278615  0.19332486 0.19307363]
np_weight_alpha[3] [0.18767582 0.19204906 0.1932804  0.2284821  0.19851264]
np_weight_alpha[4] [0.19093263 0.19185749 0.20633543 0.1881059  0.22276855]
-------------Round number:  576  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5357142857142857
client Accurancy:  0.4801587301587302
client Accurancy:  0.36904761904761907
client Accurancy:  0.2698412698412698
Average Global Accurancy:  0.42777777777777776
Average Global Trainning Accurancy:  0.6095238095238096
Average Global Trainning Loss:  1.0878336588541666
All users are selected
model: 0 tensor([0.2263, 0.1835, 0.2019, 0.1999, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0143, -0.0111,  0.0129,  0.0242,  0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1804, 0.2122, 0.2118, 0.2057, 0.1898], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0308, -0.0316,  0.0123,  0.0078, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1941, 0.2279, 0.1933, 0.1931], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0190, -0.0110, -0.0132, -0.0153, -0.0128],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1877, 0.1920, 0.1933, 0.2285, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0163, 0.0126, 0.0132, 0.0086],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1909, 0.1919, 0.2063, 0.1881, 0.2228], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0217,  0.0101,  0.0182, -0.0132, -0.0216]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25149632 0.19980322 0.1942748  0.18172275 0.17270292]
np_weight_alpha[1] [0.20110665 0.2367497  0.18966405 0.18823323 0.18424632]
np_weight_alpha[2] [0.19591658 0.19064084 0.22811915 0.19401237 0.19131106]
np_weight_alpha[3] [0.18335488 0.18917875 0.1938724  0.23047556 0.20311834]
np_weight_alpha[4] [0.17257437 0.18378744 0.18969195 0.20266189 0.25128433]
-------------Round number:  577  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.5277777777777778
client Accurancy:  0.47619047619047616
client Accurancy:  0.42063492063492064
client Accurancy:  0.3888888888888889
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.6438775510204081
Average Global Trainning Loss:  0.9359876567814626
All users are selected
model: 0 tensor([0.2515, 0.1998, 0.1943, 0.1817, 0.1727], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0013, -0.0212, -0.0072, -0.0148, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2011, 0.2367, 0.1897, 0.1882, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0266, -0.0115, -0.0190, -0.0191, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1959, 0.1906, 0.2281, 0.1940, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0402, 0.0343, 0.0292, 0.0330, 0.0342],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1834, 0.1892, 0.1939, 0.2305, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0257, 0.0249, 0.0297, 0.0255],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1726, 0.1838, 0.1897, 0.2027, 0.2513], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0344, -0.0268, -0.0321, -0.0315, -0.0275]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24118674 0.20841634 0.18907292 0.18440175 0.17692226]
np_weight_alpha[1] [0.20913965 0.23174517 0.19012994 0.1888939  0.18009143]
np_weight_alpha[2] [0.18944295 0.19007343 0.23516807 0.19448982 0.1908257 ]
np_weight_alpha[3] [0.1849332  0.18922971 0.1945836  0.22812882 0.2031247 ]
np_weight_alpha[4] [0.17630571 0.1794736  0.18979985 0.2019363  0.25248453]
-------------Round number:  578  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5317460317460317
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4634920634920635
Average Global Trainning Accurancy:  0.6435374149659864
Average Global Trainning Loss:  0.966367718962585
All users are selected
model: 0 tensor([0.2412, 0.2084, 0.1891, 0.1844, 0.1769], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0111, 0.0137, 0.0057, 0.0054, 0.0066],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2091, 0.2317, 0.1901, 0.1889, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0037,  0.0011, -0.0068, -0.0056, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1894, 0.1901, 0.2352, 0.1945, 0.1908], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0154, 0.0133, 0.0264, 0.0189, 0.0155],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1849, 0.1892, 0.1946, 0.2281, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0241, -0.0244, -0.0204, -0.0206, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1763, 0.1795, 0.1898, 0.2019, 0.2525], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0052, -0.0048, -0.0062, -0.0002,  0.0030]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.22952852 0.18263598 0.20243078 0.19929427 0.1861105 ]
np_weight_alpha[1] [0.17959224 0.21481065 0.21265948 0.20507121 0.18786643]
np_weight_alpha[2] [0.19164263 0.19427136 0.22799066 0.19319405 0.19290125]
np_weight_alpha[3] [0.18747821 0.19188166 0.19314495 0.22868715 0.19880801]
np_weight_alpha[4] [0.18861891 0.18992274 0.20700996 0.18939932 0.2250491 ]
-------------Round number:  579  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5357142857142857
client Accurancy:  0.4801587301587302
client Accurancy:  0.373015873015873
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.6149659863945578
Average Global Trainning Loss:  1.0710774739583333
All users are selected
model: 0 tensor([0.2295, 0.1826, 0.2024, 0.1993, 0.1861], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0085, -0.0101,  0.0155,  0.0245,  0.0219],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1796, 0.2148, 0.2127, 0.2051, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0278,  0.0142,  0.0075, -0.0053],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1943, 0.2280, 0.1932, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0193, -0.0114, -0.0136, -0.0163, -0.0139],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1919, 0.1931, 0.2287, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0163, 0.0148, 0.0114, 0.0128, 0.0089],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1886, 0.1899, 0.2070, 0.1894, 0.2250], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0181,  0.0071,  0.0178, -0.0116, -0.0201]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25047567 0.19976605 0.19402526 0.18254334 0.17318965]
np_weight_alpha[1] [0.20099534 0.23630781 0.18953119 0.18863271 0.18453287]
np_weight_alpha[2] [0.19562261 0.19050875 0.22805715 0.19419977 0.19161169]
np_weight_alpha[3] [0.18408968 0.18954137 0.19407856 0.230176   0.2021144 ]
np_weight_alpha[4] [0.1730184  0.18406515 0.18997699 0.20156531 0.25137416]
-------------Round number:  580  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5317460317460317
client Accurancy:  0.47619047619047616
client Accurancy:  0.42063492063492064
client Accurancy:  0.38492063492063494
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.6476190476190476
Average Global Trainning Loss:  0.9340168440423045
All users are selected
model: 0 tensor([0.2505, 0.1998, 0.1940, 0.1825, 0.1732], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0038, -0.0178, -0.0040, -0.0103, -0.0114],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2010, 0.2363, 0.1895, 0.1886, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0239, -0.0092, -0.0160, -0.0159, -0.0102],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1956, 0.1905, 0.2281, 0.1942, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0364, 0.0308, 0.0258, 0.0297, 0.0306],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1895, 0.1941, 0.2302, 0.2021], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0191, 0.0198, 0.0188, 0.0232, 0.0180],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1730, 0.1841, 0.1900, 0.2016, 0.2514], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0230, -0.0288, -0.0294, -0.0238]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19018981 0.25343212 0.17433856 0.1928303  0.18920922]
np_weight_alpha[1] [0.20925127 0.23197062 0.18995057 0.18892165 0.17990586]
np_weight_alpha[2] [0.18950544 0.18992324 0.23491648 0.19451083 0.19114403]
np_weight_alpha[3] [0.1848183  0.18925215 0.19459917 0.22797039 0.20335996]
np_weight_alpha[4] [0.17628814 0.1793269  0.19013165 0.20213793 0.25211534]
-------------Round number:  581  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5396825396825397
client Accurancy:  0.5158730158730159
client Accurancy:  0.4007936507936508
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.6394557823129252
Average Global Trainning Loss:  0.9860969387755102
All users are selected
model: 0 tensor([0.1902, 0.2534, 0.1743, 0.1928, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0416,  0.0601, -0.0086,  0.0152,  0.0204],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2093, 0.2320, 0.1900, 0.1889, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0013, -0.0013, -0.0094, -0.0080, -0.0067],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1895, 0.1899, 0.2349, 0.1945, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0241, 0.0217, 0.0335, 0.0276, 0.0247],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1848, 0.1893, 0.1946, 0.2280, 0.2034], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0275, -0.0233, -0.0244, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1763, 0.1793, 0.1901, 0.2021, 0.2521], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0073, -0.0071, -0.0074, -0.0021,  0.0006]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24385968 0.20116283 0.19104938 0.18596113 0.17796698]
np_weight_alpha[1] [0.17946899 0.21417409 0.21269612 0.20439905 0.1892618 ]
np_weight_alpha[2] [0.19144641 0.19410343 0.22912319 0.1928906  0.1924364 ]
np_weight_alpha[3] [0.18731186 0.19175157 0.19286309 0.22914079 0.19893265]
np_weight_alpha[4] [0.18933181 0.19110084 0.20343529 0.1892729  0.22685915]
-------------Round number:  582  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.4801587301587302
client Accurancy:  0.36904761904761907
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.43492063492063493
Average Global Trainning Accurancy:  0.6190476190476191
Average Global Trainning Loss:  1.0575613839285714
All users are selected
model: 0 tensor([0.2439, 0.2012, 0.1910, 0.1860, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0081, 0.0099, 0.0039, 0.0102, 0.0133],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1795, 0.2142, 0.2127, 0.2044, 0.1893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0295, -0.0272,  0.0155,  0.0078, -0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1914, 0.1941, 0.2291, 0.1929, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0202, -0.0120, -0.0129, -0.0174, -0.0146],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1873, 0.1918, 0.1929, 0.2291, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0132, 0.0121, 0.0085, 0.0117, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1893, 0.1911, 0.2034, 0.1893, 0.2269], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0203,  0.0096,  0.0156, -0.0100, -0.0182]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25234747 0.1946711  0.21485563 0.17894404 0.15918177]
np_weight_alpha[1] [0.20095877 0.23628119 0.1894859  0.18894775 0.1843263 ]
np_weight_alpha[2] [0.19581646 0.19047245 0.22786653 0.19448933 0.19135524]
np_weight_alpha[3] [0.18472773 0.18988204 0.1944008  0.22937366 0.20161578]
np_weight_alpha[4] [0.17278196 0.18381597 0.18975449 0.20098676 0.25266084]
-------------Round number:  583  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5317460317460317
client Accurancy:  0.4801587301587302
client Accurancy:  0.4166666666666667
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.6530612244897959
Average Global Trainning Loss:  0.9233526320684524
All users are selected
model: 0 tensor([0.2523, 0.1947, 0.2149, 0.1789, 0.1592], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0255, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0075, -0.0211,  0.0193, -0.0124, -0.0243],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2363, 0.1895, 0.1889, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0214, -0.0068, -0.0138, -0.0130, -0.0076],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1958, 0.1905, 0.2279, 0.1945, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0286, 0.0226, 0.0186, 0.0221, 0.0222],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1847, 0.1899, 0.1944, 0.2294, 0.2016], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0208, 0.0212, 0.0201, 0.0234, 0.0184],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1838, 0.1898, 0.2010, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0290, -0.0214, -0.0277, -0.0284, -0.0209]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24111749 0.20849922 0.18844451 0.1845342  0.17740458]
np_weight_alpha[1] [0.20920298 0.23201585 0.19020662 0.18889026 0.1796843 ]
np_weight_alpha[2] [0.1896536  0.19021285 0.23402359 0.19458641 0.1915236 ]
np_weight_alpha[3] [0.18476446 0.18919994 0.19463593 0.22793198 0.20346774]
np_weight_alpha[4] [0.17608425 0.17912228 0.1904582  0.20218594 0.25214928]
-------------Round number:  584  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5436507936507936
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.46190476190476193
Average Global Trainning Accurancy:  0.6489795918367347
Average Global Trainning Loss:  0.9584155439519558
All users are selected
model: 0 tensor([0.2411, 0.2085, 0.1884, 0.1845, 0.1774], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0086, 0.0117, 0.0026, 0.0042, 0.0051],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2092, 0.2320, 0.1902, 0.1889, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.1493e-05, -2.5308e-03, -1.0968e-02, -9.2845e-03, -7.9983e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1897, 0.1902, 0.2340, 0.1946, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0177, 0.0156, 0.0268, 0.0223, 0.0197],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1848, 0.1892, 0.1946, 0.2279, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0178, -0.0186, -0.0139, -0.0155, -0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1761, 0.1791, 0.1905, 0.2022, 0.2521], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0076, -0.0073, -0.0068, -0.0036,  0.0007]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23207025 0.18207932 0.20716873 0.19481201 0.18386975]
np_weight_alpha[1] [0.179141   0.21383844 0.21423951 0.20406406 0.18871702]
np_weight_alpha[2] [0.19204964 0.19461103 0.2290817  0.19235072 0.19190687]
np_weight_alpha[3] [0.18671493 0.19163513 0.1923242  0.22907922 0.20024642]
np_weight_alpha[4] [0.18945599 0.19060828 0.19965096 0.19534557 0.22493915]
-------------Round number:  585  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.38492063492063494
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.43492063492063493
Average Global Trainning Accurancy:  0.6214285714285714
Average Global Trainning Loss:  1.0482418553358843
All users are selected
model: 0 tensor([0.2321, 0.1821, 0.2072, 0.1948, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0027, -0.0079,  0.0226,  0.0237,  0.0224],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1791, 0.2138, 0.2142, 0.2041, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0295, -0.0269,  0.0175,  0.0082, -0.0022],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1946, 0.2291, 0.1924, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0208, -0.0123, -0.0135, -0.0181, -0.0157],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1916, 0.1923, 0.2291, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0123, 0.0104, 0.0067, 0.0090, 0.0055],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1895, 0.1906, 0.1997, 0.1953, 0.2249], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0196,  0.0088,  0.0113, -0.0058, -0.0195]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25017646 0.19992845 0.19459036 0.18191041 0.17339431]
np_weight_alpha[1] [0.20120698 0.2362911  0.18963136 0.18873829 0.18413223]
np_weight_alpha[2] [0.19629997 0.19062836 0.22776681 0.19404252 0.1912624 ]
np_weight_alpha[3] [0.17044988 0.1831647  0.20177709 0.22838633 0.21622197]
np_weight_alpha[4] [0.1730361  0.18368962 0.18978381 0.20229395 0.25119653]
-------------Round number:  586  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.43253968253968256
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.6564625850340136
Average Global Trainning Loss:  0.9164378055909864
All users are selected
model: 0 tensor([0.2502, 0.1999, 0.1946, 0.1819, 0.1734], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0018, -0.0188, -0.0041, -0.0119, -0.0126],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2012, 0.2363, 0.1896, 0.1887, 0.1841], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0257, -0.0115, -0.0179, -0.0177, -0.0126],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1963, 0.1906, 0.2278, 0.1940, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0456, 0.0391, 0.0324, 0.0379, 0.0384],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1704, 0.1832, 0.2018, 0.2284, 0.2162], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0043, 0.0125, 0.0269, 0.0207, 0.0329],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1730, 0.1837, 0.1898, 0.2023, 0.2512], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0353, -0.0279, -0.0334, -0.0333, -0.0284]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19386287 0.25244978 0.17015646 0.19426319 0.18926771]
np_weight_alpha[1] [0.20920524 0.23222025 0.18981835 0.18883018 0.17992593]
np_weight_alpha[2] [0.18894997 0.18972628 0.236229   0.19409668 0.19099809]
np_weight_alpha[3] [0.18560216 0.18985507 0.19386356 0.22841527 0.2022639 ]
np_weight_alpha[4] [0.17648752 0.17935833 0.19001637 0.20216419 0.2519736 ]
-------------Round number:  587  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.4007936507936508
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.6421768707482993
Average Global Trainning Loss:  0.9738042922247023
All users are selected
model: 0 tensor([0.1939, 0.2524, 0.1702, 0.1943, 0.1893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0393,  0.0578, -0.0150,  0.0161,  0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2322, 0.1898, 0.1888, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0008, -0.0018, -0.0106, -0.0083, -0.0070],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1889, 0.1897, 0.2362, 0.1941, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0147, 0.0128, 0.0269, 0.0194, 0.0171],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1856, 0.1899, 0.1939, 0.2284, 0.2023], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0142, -0.0150, -0.0123, -0.0127, -0.0119],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1765, 0.1794, 0.1900, 0.2022, 0.2520], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0087, -0.0083, -0.0084, -0.0049, -0.0007]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24386232 0.20107926 0.19180566 0.18522227 0.17803049]
np_weight_alpha[1] [0.17921382 0.21427608 0.21602501 0.2027599  0.18772516]
np_weight_alpha[2] [0.19209655 0.19464684 0.22895098 0.19255145 0.19175418]
np_weight_alpha[3] [0.18652499 0.1912912  0.19252498 0.22931498 0.20034379]
np_weight_alpha[4] [0.18883392 0.18967561 0.20056412 0.19547948 0.22544686]
-------------Round number:  588  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5317460317460317
client Accurancy:  0.46825396825396826
client Accurancy:  0.38492063492063494
client Accurancy:  0.28174603174603174
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.6251700680272109
Average Global Trainning Loss:  1.031465076264881
All users are selected
model: 0 tensor([0.2439, 0.2011, 0.1918, 0.1852, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0116, 0.0133, 0.0086, 0.0135, 0.0171],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1792, 0.2143, 0.2160, 0.2028, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0278, -0.0243,  0.0209,  0.0083, -0.0020],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1921, 0.1946, 0.2290, 0.1926, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0204, -0.0127, -0.0139, -0.0188, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1865, 0.1913, 0.1925, 0.2293, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0095, 0.0085, 0.0050, 0.0086, 0.0054],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1888, 0.1897, 0.2006, 0.1955, 0.2254], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0180,  0.0064,  0.0109, -0.0055, -0.0209]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24859501 0.19908406 0.19458039 0.18366647 0.17407404]
np_weight_alpha[1] [0.20122391 0.23564433 0.18963578 0.18896817 0.18452781]
np_weight_alpha[2] [0.19563863 0.19067672 0.2276683  0.19453342 0.19148296]
np_weight_alpha[3] [0.17679635 0.18555439 0.20387447 0.22399937 0.20977545]
np_weight_alpha[4] [0.17290725 0.18398656 0.18992707 0.20103353 0.25214565]
-------------Round number:  589  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5277777777777778
client Accurancy:  0.4801587301587302
client Accurancy:  0.4126984126984127
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.6571428571428571
Average Global Trainning Loss:  0.9172056029443028
All users are selected
model: 0 tensor([0.2486, 0.1991, 0.1946, 0.1837, 0.1741], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0036, -0.0167, -0.0014, -0.0074, -0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2012, 0.2356, 0.1896, 0.1890, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0244, -0.0107, -0.0165, -0.0163, -0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1956, 0.1907, 0.2277, 0.1945, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0413, 0.0358, 0.0291, 0.0351, 0.0354],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1768, 0.1856, 0.2039, 0.2240, 0.2098], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0063, 0.0106, 0.0245, 0.0120, 0.0214],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1840, 0.1899, 0.2010, 0.2521], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0320, -0.0244, -0.0296, -0.0310, -0.0238]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19788344 0.25650185 0.17110021 0.18848704 0.18602747]
np_weight_alpha[1] [0.2091588  0.23200837 0.18976715 0.18888582 0.18017986]
np_weight_alpha[2] [0.18925428 0.18968888 0.23608354 0.19413997 0.1908333 ]
np_weight_alpha[3] [0.1854322  0.18960822 0.19387165 0.2282611  0.20282681]
np_weight_alpha[4] [0.17649703 0.17963628 0.18989317 0.20218578 0.25178772]
-------------Round number:  590  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5436507936507936
client Accurancy:  0.503968253968254
client Accurancy:  0.3968253968253968
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.45634920634920634
Average Global Trainning Accurancy:  0.6459183673469387
Average Global Trainning Loss:  0.9636266176392432
All users are selected
model: 0 tensor([0.1979, 0.2565, 0.1711, 0.1885, 0.1860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0338,  0.0630, -0.0130,  0.0107,  0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2320, 0.1898, 0.1889, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0014, -0.0014, -0.0096, -0.0074, -0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1893, 0.1897, 0.2361, 0.1941, 0.1908], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0133, 0.0112, 0.0244, 0.0176, 0.0151],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1896, 0.1939, 0.2283, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0169, -0.0176, -0.0145, -0.0152, -0.0134],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1765, 0.1796, 0.1899, 0.2022, 0.2518], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0066, -0.0056, -0.0061, -0.0024,  0.0014]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24313194 0.20090152 0.19166751 0.18570074 0.17859834]
np_weight_alpha[1] [0.17965479 0.21651003 0.21506597 0.20237868 0.18639044]
np_weight_alpha[2] [0.19190189 0.19441316 0.22951226 0.19247064 0.19170207]
np_weight_alpha[3] [0.18671703 0.19129658 0.19245854 0.22937453 0.2001534 ]
np_weight_alpha[4] [0.1897449  0.18829714 0.20077522 0.19463973 0.22654295]
-------------Round number:  591  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5317460317460317
client Accurancy:  0.46825396825396826
client Accurancy:  0.38492063492063494
client Accurancy:  0.28174603174603174
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.6278911564625851
Average Global Trainning Loss:  1.0246906721673044
All users are selected
model: 0 tensor([0.2431, 0.2009, 0.1917, 0.1857, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0108, 0.0127, 0.0090, 0.0174, 0.0186],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1797, 0.2165, 0.2151, 0.2024, 0.1864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0278, -0.0217,  0.0201,  0.0100, -0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1944, 0.2295, 0.1925, 0.1917], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0147, -0.0147, -0.0192, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1913, 0.1925, 0.2294, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0148, 0.0124, 0.0083, 0.0090, 0.0054],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1897, 0.1883, 0.2008, 0.1946, 0.2265], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0158,  0.0029,  0.0084, -0.0119, -0.0218]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2496672  0.20025489 0.19483265 0.18132338 0.1739219 ]
np_weight_alpha[1] [0.20245852 0.23605327 0.19018652 0.18767355 0.18362817]
np_weight_alpha[2] [0.19599397 0.1912259  0.22792435 0.19371656 0.19113918]
np_weight_alpha[3] [0.16436623 0.1785625  0.19890465 0.2355138  0.22265287]
np_weight_alpha[4] [0.1728849  0.18314143 0.18961373 0.20353028 0.25082964]
-------------Round number:  592  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.43253968253968256
client Accurancy:  0.38492063492063494
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.6646258503401361
Average Global Trainning Loss:  0.8996053890306123
All users are selected
model: 0 tensor([0.2497, 0.2003, 0.1948, 0.1813, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0046, -0.0156, -0.0007, -0.0091, -0.0094],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2025, 0.2361, 0.1902, 0.1877, 0.1836], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0248, -0.0116, -0.0174, -0.0187, -0.0138],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1960, 0.1912, 0.2279, 0.1937, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0404, 0.0347, 0.0275, 0.0323, 0.0333],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1644, 0.1786, 0.1989, 0.2355, 0.2227], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0005,  0.0092,  0.0252,  0.0293,  0.0415],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1831, 0.1896, 0.2035, 0.2508], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0352, -0.0281, -0.0327, -0.0311, -0.0273]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19480658 0.2520514  0.16876784 0.19500886 0.1893653 ]
np_weight_alpha[1] [0.20935322 0.23186123 0.18981265 0.18864064 0.18033223]
np_weight_alpha[2] [0.18883519 0.18970321 0.23617111 0.1943687  0.19092178]
np_weight_alpha[3] [0.18580516 0.18997858 0.1942082  0.22845234 0.20155573]
np_weight_alpha[4] [0.17699035 0.1797725  0.18997803 0.20206183 0.25119728]
-------------Round number:  593  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.3968253968253968
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.6462585034013606
Average Global Trainning Loss:  0.964958263578869
All users are selected
model: 0 tensor([0.1948, 0.2521, 0.1688, 0.1950, 0.1894], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0374,  0.0582, -0.0156,  0.0181,  0.0196],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2319, 0.1898, 0.1886, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0002, -0.0030, -0.0117, -0.0092, -0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1888, 0.1897, 0.2362, 0.1944, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0116, 0.0098, 0.0234, 0.0170, 0.0144],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1900, 0.1942, 0.2285, 0.2016], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0113, -0.0123, -0.0094, -0.0110, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1770, 0.1798, 0.1900, 0.2021, 0.2512], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0077, -0.0073, -0.0073, -0.0045, -0.0001]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24374396 0.2011922  0.19191182 0.1848288  0.17832322]
np_weight_alpha[1] [0.17903551 0.21485314 0.21662961 0.20221834 0.1872634 ]
np_weight_alpha[2] [0.19213283 0.19474474 0.22945566 0.19225262 0.19141419]
np_weight_alpha[3] [0.18609674 0.19098505 0.1922149  0.23001312 0.2006901 ]
np_weight_alpha[4] [0.18831517 0.1891949  0.19907057 0.19738983 0.22602947]
-------------Round number:  594  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5357142857142857
client Accurancy:  0.46825396825396826
client Accurancy:  0.3888888888888889
client Accurancy:  0.28174603174603174
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.6302721088435375
Average Global Trainning Loss:  1.0161212531887756
All users are selected
model: 0 tensor([0.2437, 0.2012, 0.1919, 0.1848, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0141, 0.0154, 0.0110, 0.0173, 0.0198],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1790, 0.2149, 0.2166, 0.2022, 0.1873], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0213,  0.0237,  0.0111,  0.0008],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1921, 0.1947, 0.2295, 0.1923, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0224, -0.0146, -0.0151, -0.0201, -0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1861, 0.1910, 0.1922, 0.2300, 0.2007], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0096, 0.0079, 0.0043, 0.0069, 0.0033],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1883, 0.1892, 0.1991, 0.1974, 0.2260], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0145,  0.0039,  0.0071, -0.0077, -0.0221]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24866346 0.19978721 0.19496809 0.18229868 0.17428252]
np_weight_alpha[1] [0.20196882 0.23586395 0.18999349 0.18825385 0.18391986]
np_weight_alpha[2] [0.19604848 0.19105105 0.22782323 0.19389938 0.19117786]
np_weight_alpha[3] [0.17140979 0.18310602 0.20147868 0.22827187 0.21573359]
np_weight_alpha[4] [0.17324103 0.18345305 0.18969186 0.20250164 0.25111243]
-------------Round number:  595  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5277777777777778
client Accurancy:  0.4801587301587302
client Accurancy:  0.43253968253968256
client Accurancy:  0.38492063492063494
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.6656462585034013
Average Global Trainning Loss:  0.9012672061011905
All users are selected
model: 0 tensor([0.2487, 0.1998, 0.1950, 0.1823, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0088, -0.0108,  0.0038, -0.0037, -0.0036],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2020, 0.2359, 0.1900, 0.1883, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0069, -0.0135, -0.0139, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1960, 0.1911, 0.2278, 0.1939, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0272, 0.0215, 0.0165, 0.0199, 0.0203],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1714, 0.1831, 0.2015, 0.2283, 0.2157], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0040, 0.0112, 0.0251, 0.0200, 0.0311],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1732, 0.1835, 0.1897, 0.2025, 0.2511], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0220, -0.0276, -0.0267, -0.0215]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.19753    0.2523802  0.17101444 0.19338536 0.18569005]
np_weight_alpha[1] [0.20901519 0.23160037 0.19023839 0.1889761  0.18016998]
np_weight_alpha[2] [0.18952066 0.19019559 0.2343367  0.19446297 0.19148412]
np_weight_alpha[3] [0.18571714 0.189932   0.19420573 0.22778937 0.20235571]
np_weight_alpha[4] [0.17655452 0.17958863 0.1904636  0.2022231  0.2511701 ]
-------------Round number:  596  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5436507936507936
client Accurancy:  0.5119047619047619
client Accurancy:  0.39285714285714285
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4531746031746032
Average Global Trainning Accurancy:  0.6513605442176871
Average Global Trainning Loss:  0.9560061915391157
All users are selected
model: 0 tensor([0.1975, 0.2524, 0.1710, 0.1934, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0348,  0.0581, -0.0135,  0.0151,  0.0152],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2316, 0.1902, 0.1890, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013, -0.0044, -0.0113, -0.0095, -0.0092],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1895, 0.1902, 0.2343, 0.1945, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0223, 0.0206, 0.0305, 0.0263, 0.0243],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1899, 0.1942, 0.2278, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0191, -0.0194, -0.0168, -0.0190, -0.0157],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1766, 0.1796, 0.1905, 0.2022, 0.2512], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0091, -0.0089, -0.0080, -0.0042, -0.0015]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2431966  0.20111336 0.19151829 0.18561356 0.1785582 ]
np_weight_alpha[1] [0.1805579  0.21826576 0.21066502 0.2004105  0.1901008 ]
np_weight_alpha[2] [0.19168837 0.19394128 0.23017517 0.19254912 0.19164607]
np_weight_alpha[3] [0.18673776 0.19092993 0.19253455 0.23028813 0.1995097 ]
np_weight_alpha[4] [0.1898577  0.19203305 0.19826852 0.19131193 0.2285287 ]
-------------Round number:  597  -------------
client Accurancy:  0.5238095238095238
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.373015873015873
client Accurancy:  0.28174603174603174
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.6309523809523809
Average Global Trainning Loss:  1.0172966159119898
All users are selected
model: 0 tensor([0.2432, 0.2011, 0.1915, 0.1856, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0154, 0.0163, 0.0117, 0.0151, 0.0199],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1806, 0.2183, 0.2107, 0.2004, 0.1901], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0227, -0.0163,  0.0190,  0.0090,  0.0038],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1917, 0.1939, 0.2302, 0.1925, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0216, -0.0147, -0.0141, -0.0206, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1909, 0.1925, 0.2303, 0.1995], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0069, 0.0067, 0.0035, 0.0086, 0.0059],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1899, 0.1920, 0.1983, 0.1913, 0.2285], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0144,  0.0047,  0.0045, -0.0113, -0.0232]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24677747 0.19907814 0.19415945 0.18531363 0.17467128]
np_weight_alpha[1] [0.20102319 0.23509471 0.18972284 0.18946497 0.18469433]
np_weight_alpha[2] [0.1950987  0.19059545 0.2277728  0.19496006 0.191573  ]
np_weight_alpha[3] [0.18412761 0.18906726 0.20643118 0.21942116 0.20095271]
np_weight_alpha[4] [0.17336094 0.18400593 0.19005379 0.1986319  0.25394744]
-------------Round number:  598  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.3968253968253968
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.6625850340136055
Average Global Trainning Loss:  0.9132930418261055
All users are selected
model: 0 tensor([0.2468, 0.1991, 0.1942, 0.1853, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0076, -0.0106,  0.0045,  0.0003, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2010, 0.2351, 0.1897, 0.1895, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0068, -0.0128, -0.0121, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1951, 0.1906, 0.2278, 0.1950, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0350, 0.0294, 0.0240, 0.0295, 0.0293],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1891, 0.2064, 0.2194, 0.2010], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0055,  0.0054,  0.0183, -0.0009,  0.0029],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1734, 0.1840, 0.1901, 0.1986, 0.2539], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0198, -0.0256, -0.0295, -0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20659874 0.25645295 0.1714666  0.18206634 0.18341535]
np_weight_alpha[1] [0.20917052 0.23154949 0.19020998 0.18928573 0.17978431]
np_weight_alpha[2] [0.1890867  0.1901686  0.23528899 0.19422548 0.19123018]
np_weight_alpha[3] [0.18514541 0.19029409 0.15017785 0.25924653 0.21513613]
np_weight_alpha[4] [0.17652662 0.17927238 0.19027983 0.20247348 0.25144768]
-------------Round number:  599  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5476190476190477
client Accurancy:  0.5119047619047619
client Accurancy:  0.4007936507936508
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.6619047619047619
Average Global Trainning Loss:  0.9327478940795068
All users are selected
model: 0 tensor([0.2066, 0.2565, 0.1715, 0.1821, 0.1834], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0235,  0.0640, -0.0118,  0.0047,  0.0137],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2315, 0.1902, 0.1893, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0016, -0.0019, -0.0090, -0.0063, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1891, 0.1902, 0.2353, 0.1942, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0171, 0.0156, 0.0271, 0.0220, 0.0196],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1903, 0.1502, 0.2592, 0.2151], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0327, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0191, -0.0180, -0.0610,  0.0142, -0.0011],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1765, 0.1793, 0.1903, 0.2025, 0.2514], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0085, -0.0075, -0.0035, -0.0004]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24228376 0.20068733 0.19175547 0.18611507 0.17915833]
np_weight_alpha[1] [0.17919257 0.21891584 0.2128531  0.19766043 0.19137803]
np_weight_alpha[2] [0.19193304 0.19434252 0.22998144 0.1921478  0.19159523]
np_weight_alpha[3] [0.187096   0.19097114 0.1937532  0.22949404 0.19868565]
np_weight_alpha[4] [0.19098091 0.19321378 0.19884893 0.19112936 0.22582705]
-------------Round number:  600  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.376984126984127
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.6306122448979592
Average Global Trainning Loss:  1.0142131364264455
All users are selected
model: 0 tensor([0.2423, 0.2007, 0.1918, 0.1861, 0.1792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0157, 0.0172, 0.0137, 0.0202, 0.0228],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1792, 0.2189, 0.2129, 0.1977, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0150,  0.0217,  0.0079,  0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1943, 0.2300, 0.1921, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0238, -0.0167, -0.0168, -0.0221, -0.0193],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1871, 0.1910, 0.1938, 0.2295, 0.1987], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0085, 0.0063, 0.0043, 0.0054, 0.0010],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1910, 0.1932, 0.1988, 0.1911, 0.2258], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0158,  0.0069,  0.0059, -0.0142, -0.0248]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24794629 0.19990079 0.19451982 0.18309474 0.17453846]
np_weight_alpha[1] [0.20200187 0.23539476 0.19007349 0.18872346 0.18380636]
np_weight_alpha[2] [0.19553281 0.19099337 0.22841504 0.1941699  0.1908888 ]
np_weight_alpha[3] [0.17146102 0.18447566 0.19650705 0.2288306  0.21872559]
np_weight_alpha[4] [0.17325532 0.1831743  0.18937682 0.2015199  0.25267363]
-------------Round number:  601  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5277777777777778
client Accurancy:  0.4801587301587302
client Accurancy:  0.43253968253968256
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.6687074829931973
Average Global Trainning Loss:  0.8916740573182398
All users are selected
model: 0 tensor([0.2479, 0.1999, 0.1945, 0.1831, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0004, -0.0186, -0.0024, -0.0100, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2020, 0.2354, 0.1901, 0.1887, 0.1838], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0302, -0.0172, -0.0209, -0.0229, -0.0179],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1955, 0.1910, 0.2284, 0.1942, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0051, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0606, 0.0556, 0.0443, 0.0538, 0.0537],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1715, 0.1845, 0.1965, 0.2288, 0.2187], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019,  0.0063,  0.0151,  0.0142,  0.0281],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1733, 0.1832, 0.1894, 0.2015, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0390, -0.0323, -0.0367, -0.0380, -0.0306]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20240305 0.25626788 0.16618545 0.18999287 0.18515077]
np_weight_alpha[1] [0.20978458 0.23226613 0.18863115 0.18922764 0.18009052]
np_weight_alpha[2] [0.19363156 0.19023484 0.23199348 0.19363484 0.19050525]
np_weight_alpha[3] [0.185769   0.19023813 0.19331187 0.22823879 0.20244223]
np_weight_alpha[4] [0.17670873 0.17954987 0.18932904 0.20246628 0.2519461 ]
-------------Round number:  602  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.3968253968253968
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.6605442176870748
Average Global Trainning Loss:  0.9349723971619898
All users are selected
model: 0 tensor([0.2024, 0.2563, 0.1662, 0.1900, 0.1852], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0263,  0.0656, -0.0162,  0.0164,  0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2098, 0.2323, 0.1886, 0.1892, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0044,  0.0009, -0.0088, -0.0039, -0.0033],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1936, 0.1902, 0.2320, 0.1936, 0.1905], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0062, 0.0006, 0.0100, 0.0069, 0.0045],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1858, 0.1902, 0.1933, 0.2282, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0077, -0.0085, -0.0070, -0.0086, -0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1767, 0.1795, 0.1893, 0.2025, 0.2519], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0088, -0.0081, -0.0088, -0.0061, -0.0002]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24306025 0.20096014 0.19285564 0.18454164 0.17858231]
np_weight_alpha[1] [0.17761776 0.21713072 0.22246236 0.19707915 0.18570998]
np_weight_alpha[2] [0.19084552 0.21557526 0.21029302 0.18742776 0.19585839]
np_weight_alpha[3] [0.18448226 0.19263898 0.18826538 0.23380324 0.20081012]
np_weight_alpha[4] [0.18862128 0.18794656 0.20092626 0.20066161 0.22184432]
-------------Round number:  603  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5436507936507936
client Accurancy:  0.46825396825396826
client Accurancy:  0.39285714285714285
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.6418367346938776
Average Global Trainning Loss:  0.9914035926870748
All users are selected
model: 0 tensor([0.2431, 0.2010, 0.1929, 0.1845, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0193, 0.0204, 0.0178, 0.0244, 0.0255],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1776, 0.2171, 0.2225, 0.1971, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0146,  0.0339,  0.0111,  0.0042],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1908, 0.2156, 0.2103, 0.1874, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0270,  0.0035, -0.0386, -0.0280, -0.0163],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1845, 0.1926, 0.1883, 0.2338, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0043,  0.0054, -0.0044,  0.0047, -0.0026],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1886, 0.1879, 0.2009, 0.2007, 0.2218], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0118,  0.0006,  0.0071, -0.0080, -0.0282]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2488282  0.2004054  0.1950196  0.18103862 0.17470825]
np_weight_alpha[1] [0.20256713 0.23593907 0.19013765 0.1877461  0.1836101 ]
np_weight_alpha[2] [0.19608782 0.19053528 0.2290295  0.19377176 0.19057561]
np_weight_alpha[3] [0.17124355 0.17371027 0.21684861 0.21707822 0.22111934]
np_weight_alpha[4] [0.17368744 0.18306087 0.18912806 0.20365848 0.25046515]
-------------Round number:  604  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.42857142857142855
client Accurancy:  0.3888888888888889
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.6714285714285714
Average Global Trainning Loss:  0.8803076504039116
All users are selected
model: 0 tensor([0.2488, 0.2004, 0.1950, 0.1810, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0051, -0.0147,  0.0010, -0.0084, -0.0075],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2026, 0.2359, 0.1901, 0.1877, 0.1836], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0140, -0.0192, -0.0214, -0.0161],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1961, 0.1905, 0.2290, 0.1938, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0508, 0.0447, 0.0365, 0.0432, 0.0431],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1712, 0.1737, 0.2168, 0.2171, 0.2211], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0017, -0.0009,  0.0399,  0.0055,  0.0342],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1737, 0.1831, 0.1891, 0.2037, 0.2505], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0390, -0.0327, -0.0374, -0.0360, -0.0321]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.1970761  0.25329423 0.16646838 0.19671725 0.18644401]
np_weight_alpha[1] [0.20969123 0.23181634 0.18918727 0.18902855 0.18027663]
np_weight_alpha[2] [0.18841656 0.18899937 0.23860773 0.19345328 0.19052309]
np_weight_alpha[3] [0.18557288 0.19039553 0.19259958 0.22898698 0.2024451 ]
np_weight_alpha[4] [0.17702913 0.17970897 0.18968761 0.20256229 0.251012  ]
-------------Round number:  605  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5476190476190477
client Accurancy:  0.5079365079365079
client Accurancy:  0.38492063492063494
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.6595238095238095
Average Global Trainning Loss:  0.9372743775244473
All users are selected
model: 0 tensor([0.1971, 0.2533, 0.1665, 0.1967, 0.1864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0345,  0.0600, -0.0172,  0.0196,  0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2097, 0.2318, 0.1892, 0.1890, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0009, -0.0036, -0.0109, -0.0074, -0.0072],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1884, 0.1890, 0.2386, 0.1935, 0.1905], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0172, 0.0153, 0.0298, 0.0219, 0.0196],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1856, 0.1904, 0.1926, 0.2290, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0161, -0.0152, -0.0146, -0.0152, -0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1770, 0.1797, 0.1897, 0.2026, 0.2510], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0101, -0.0099, -0.0100, -0.0060, -0.0031]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24348083 0.2010002  0.19156069 0.18542026 0.17853795]
np_weight_alpha[1] [0.1776132  0.22197746 0.21523696 0.19728678 0.18788555]
np_weight_alpha[2] [0.19157474 0.19396847 0.23120011 0.19189823 0.1913585 ]
np_weight_alpha[3] [0.18664613 0.19036779 0.19191028 0.23093557 0.2001402 ]
np_weight_alpha[4] [0.18815613 0.1899663  0.20005077 0.19301502 0.22881174]
-------------Round number:  606  -------------
client Accurancy:  0.5238095238095238
client Accurancy:  0.5317460317460317
client Accurancy:  0.4642857142857143
client Accurancy:  0.38492063492063494
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.6404761904761904
Average Global Trainning Loss:  0.993659817442602
All users are selected
model: 0 tensor([0.2435, 0.2010, 0.1916, 0.1854, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0186, 0.0184, 0.0125, 0.0213, 0.0231],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1776, 0.2220, 0.2152, 0.1973, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0239, -0.0098,  0.0257,  0.0094,  0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1940, 0.2312, 0.1919, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0241, -0.0153, -0.0146, -0.0192, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1866, 0.1904, 0.1919, 0.2309, 0.2001], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0096, 0.0064, 0.0042, 0.0067, 0.0017],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1882, 0.1900, 0.2001, 0.1930, 0.2288], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0076, -0.0019,  0.0040, -0.0190, -0.0273]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24692188 0.19992232 0.19640581 0.18221816 0.17453182]
np_weight_alpha[1] [0.20196381 0.23493363 0.19027083 0.18867633 0.18415543]
np_weight_alpha[2] [0.19742191 0.19121602 0.22948909 0.19298698 0.18888602]
np_weight_alpha[3] [0.16870414 0.18629463 0.19839445 0.22637103 0.22023574]
np_weight_alpha[4] [0.17332739 0.1834233  0.18735762 0.20293288 0.25295883]
-------------Round number:  607  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5277777777777778
client Accurancy:  0.46825396825396826
client Accurancy:  0.43253968253968256
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.45634920634920634
Average Global Trainning Accurancy:  0.677891156462585
Average Global Trainning Loss:  0.8784834050807823
All users are selected
model: 0 tensor([0.2469, 0.1999, 0.1964, 0.1822, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0150, -0.0034,  0.0119,  0.0040,  0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2020, 0.2349, 0.1903, 0.1887, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0148, -0.0023, -0.0079, -0.0078, -0.0025],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1974, 0.1912, 0.2295, 0.1930, 0.1889], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0137, 0.0071, 0.0054, 0.0044, 0.0035],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1687, 0.1863, 0.1984, 0.2264, 0.2202], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0016, 0.0144, 0.0216, 0.0180, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1733, 0.1834, 0.1874, 0.2029, 0.2530], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0274, -0.0200, -0.0283, -0.0245, -0.0176]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20104912 0.25207937 0.1687349  0.19159785 0.18653873]
np_weight_alpha[1] [0.2431197  0.20955849 0.19303398 0.19100483 0.16328311]
np_weight_alpha[2] [0.16492066 0.18866709 0.23832798 0.20393261 0.20415169]
np_weight_alpha[3] [0.18541837 0.18989234 0.19465895 0.22791895 0.20211135]
np_weight_alpha[4] [0.17697428 0.17932582 0.19063526 0.20219947 0.2508652 ]
-------------Round number:  608  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5357142857142857
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.6646258503401361
Average Global Trainning Loss:  0.9285317349596088
All users are selected
model: 0 tensor([0.2010, 0.2521, 0.1687, 0.1916, 0.1865], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0342,  0.0543, -0.0181,  0.0113,  0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2431, 0.2096, 0.1930, 0.1910, 0.1633], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0246, -0.0363, -0.0171, -0.0161, -0.0361],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1649, 0.1887, 0.2383, 0.2039, 0.2042], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0082, 0.0303, 0.0433, 0.0487, 0.0505],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1854, 0.1899, 0.1947, 0.2279, 0.2021], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0117, -0.0117, -0.0086, -0.0128, -0.0106],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1770, 0.1793, 0.1906, 0.2022, 0.2509], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0155, -0.0156, -0.0135, -0.0122, -0.0077]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24337468 0.20181924 0.19103831 0.18489553 0.17887227]
np_weight_alpha[1] [0.20168835 0.23115805 0.1933832  0.19048381 0.18328659]
np_weight_alpha[2] [0.19241364 0.19401304 0.23301564 0.1910431  0.1895146 ]
np_weight_alpha[3] [0.18590349 0.19015157 0.19170588 0.23126748 0.20097159]
np_weight_alpha[4] [0.17925252 0.18141297 0.18993916 0.20001236 0.249383  ]
-------------Round number:  609  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5436507936507936
client Accurancy:  0.4603174603174603
client Accurancy:  0.38095238095238093
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.6547619047619048
Average Global Trainning Loss:  0.9448408269557823
All users are selected
model: 0 tensor([0.2434, 0.2018, 0.1910, 0.1849, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0228, 0.0231, 0.0169, 0.0272, 0.0276],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2312, 0.1934, 0.1905, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0023, 0.0014, 0.0046, 0.0041, 0.0016],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1924, 0.1940, 0.2330, 0.1910, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0234, -0.0158, -0.0130, -0.0204, -0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1859, 0.1902, 0.1917, 0.2313, 0.2010], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0050,  0.0013, -0.0013,  0.0008, -0.0047],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1793, 0.1814, 0.1899, 0.2000, 0.2494], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0040, -0.0115, -0.0081, -0.0141, -0.0042]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2474878  0.20068489 0.19617453 0.1807137  0.17493902]
np_weight_alpha[1] [0.20302919 0.24095961 0.18411574 0.1834264  0.18846916]
np_weight_alpha[2] [0.1971099  0.19130751 0.22928855 0.19286871 0.18942535]
np_weight_alpha[3] [0.16407558 0.18384816 0.19784366 0.2286879  0.22554469]
np_weight_alpha[4] [0.16013081 0.19533688 0.1871863  0.22887313 0.22847292]
-------------Round number:  610  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5317460317460317
client Accurancy:  0.4801587301587302
client Accurancy:  0.44047619047619047
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4587301587301587
Average Global Trainning Accurancy:  0.6802721088435374
Average Global Trainning Loss:  0.8719371146896259
All users are selected
model: 0 tensor([0.2475, 0.2007, 0.1962, 0.1807, 0.1749], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0018, -0.0198, -0.0011, -0.0135, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2030, 0.2410, 0.1841, 0.1834, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0312, -0.0134, -0.0275, -0.0300, -0.0150],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1971, 0.1913, 0.2293, 0.1929, 0.1894], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0763, 0.0704, 0.0541, 0.0663, 0.0660],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1641, 0.1838, 0.1978, 0.2287, 0.2255], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0129,  0.0019,  0.0140,  0.0099,  0.0315],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1601, 0.1953, 0.1872, 0.2289, 0.2285], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0594, -0.0265, -0.0445, -0.0167, -0.0618]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20569488 0.25536665 0.15617412 0.19712049 0.18564384]
np_weight_alpha[1] [0.21021026 0.23241004 0.18769483 0.18941145 0.18027341]
np_weight_alpha[2] [0.19457585 0.19014147 0.23367836 0.19241418 0.1891902 ]
np_weight_alpha[3] [0.18579629 0.19051784 0.19233464 0.2290212  0.20233005]
np_weight_alpha[4] [0.17734805 0.17941222 0.18850407 0.2020482  0.25268748]
-------------Round number:  611  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5436507936507936
client Accurancy:  0.503968253968254
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.6670068027210885
Average Global Trainning Loss:  0.9134232501594388
All users are selected
model: 0 tensor([0.2057, 0.2554, 0.1562, 0.1971, 0.1856], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0215,  0.0660, -0.0248,  0.0240,  0.0192],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2102, 0.2324, 0.1877, 0.1894, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0064,  0.0026, -0.0087, -0.0018, -0.0026],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1946, 0.1901, 0.2337, 0.1924, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0003, -0.0078,  0.0032, -0.0024, -0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1858, 0.1905, 0.1923, 0.2290, 0.2023], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034, -0.0027, -0.0029, -0.0042, -0.0014],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1773, 0.1794, 0.1885, 0.2020, 0.2527], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0082, -0.0085, -0.0096, -0.0047,  0.0013]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24258481 0.20081498 0.19252788 0.18507308 0.17899927]
np_weight_alpha[1] [0.1748896  0.21512315 0.22780487 0.19364694 0.18853551]
np_weight_alpha[2] [0.18355432 0.21673651 0.20449579 0.19166285 0.20355059]
np_weight_alpha[3] [0.18783367 0.18904163 0.19136502 0.23756446 0.19419524]
np_weight_alpha[4] [0.18855186 0.19231729 0.20646401 0.19556557 0.21710125]
-------------Round number:  612  -------------
client Accurancy:  0.5277777777777778
client Accurancy:  0.5317460317460317
client Accurancy:  0.4642857142857143
client Accurancy:  0.38492063492063494
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.6431972789115646
Average Global Trainning Loss:  0.9981287534545068
All users are selected
model: 0 tensor([0.2426, 0.2008, 0.1925, 0.1851, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0216, 0.0219, 0.0176, 0.0261, 0.0280],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1749, 0.2151, 0.2278, 0.1936, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0247, -0.0146,  0.0408,  0.0087,  0.0088],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1836, 0.2167, 0.2045, 0.1917, 0.2036], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0371,  0.0036, -0.0460, -0.0232, -0.0072],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1878, 0.1890, 0.1914, 0.2376, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0095,  0.0033,  0.0017,  0.0105, -0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1886, 0.1923, 0.2065, 0.1956, 0.2171], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0084,  0.0012,  0.0102, -0.0176, -0.0392]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24734703 0.20039591 0.19651036 0.1814143  0.17433245]
np_weight_alpha[1] [0.20257467 0.23546602 0.19024274 0.18824589 0.1834707 ]
np_weight_alpha[2] [0.19816996 0.19085969 0.22995135 0.19249278 0.18852621]
np_weight_alpha[3] [0.15993464 0.18805803 0.19772777 0.19994397 0.25433552]
np_weight_alpha[4] [0.17290762 0.18264294 0.18743812 0.20394015 0.25307116]
-------------Round number:  613  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.44047619047619047
client Accurancy:  0.376984126984127
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.6850340136054421
Average Global Trainning Loss:  0.8593882035235969
All users are selected
model: 0 tensor([0.2473, 0.2004, 0.1965, 0.1814, 0.1743], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0140, -0.0044,  0.0114,  0.0028,  0.0022],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2026, 0.2355, 0.1902, 0.1882, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0177, -0.0048, -0.0107, -0.0113, -0.0064],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1982, 0.1909, 0.2300, 0.1925, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0104, 0.0075, 0.0076, 0.0069],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1599, 0.1881, 0.1977, 0.1999, 0.2543], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0013,  0.0218,  0.0272, -0.0036,  0.0773],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1729, 0.1826, 0.1874, 0.2039, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0315, -0.0244, -0.0312, -0.0273, -0.0208]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20159177 0.25219476 0.1665909  0.1919239  0.18769865]
np_weight_alpha[1] [0.20949882 0.23146063 0.19020677 0.18888795 0.17994581]
np_weight_alpha[2] [0.18964632 0.190109   0.2345379  0.1944464  0.19126037]
np_weight_alpha[3] [0.18550465 0.19024606 0.19432625 0.22917092 0.20075214]
np_weight_alpha[4] [0.17709352 0.1794451  0.19017868 0.20257592 0.25070682]
-------------Round number:  614  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5396825396825397
client Accurancy:  0.5079365079365079
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.6680272108843538
Average Global Trainning Loss:  0.9157425860969388
All users are selected
model: 0 tensor([0.2016, 0.2522, 0.1666, 0.1919, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0273,  0.0615, -0.0158,  0.0193,  0.0210],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2095, 0.2315, 0.1902, 0.1889, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0031, -0.0013, -0.0082, -0.0043, -0.0047],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1896, 0.1901, 0.2345, 0.1944, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0108, -0.0122, -0.0009, -0.0038, -0.0070],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1855, 0.1902, 0.1943, 0.2292, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0086, 0.0083, 0.0109, 0.0058, 0.0061],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1771, 0.1794, 0.1902, 0.2026, 0.2507], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0113, -0.0113, -0.0106, -0.0090, -0.0039]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24349797 0.20120831 0.19302085 0.18383235 0.17844056]
np_weight_alpha[1] [0.17917456 0.22315793 0.21560696 0.19421524 0.18784535]
np_weight_alpha[2] [0.20856103 0.21661137 0.20407322 0.17933698 0.19141738]
np_weight_alpha[3] [0.18197994 0.18767034 0.17918076 0.24246947 0.20869946]
np_weight_alpha[4] [0.1875831  0.1898394  0.19656278 0.2010212  0.22499353]
-------------Round number:  615  -------------
client Accurancy:  0.5238095238095238
client Accurancy:  0.5357142857142857
client Accurancy:  0.4603174603174603
client Accurancy:  0.4007936507936508
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.6534013605442177
Average Global Trainning Loss:  0.9571579706101191
All users are selected
model: 0 tensor([0.2435, 0.2012, 0.1930, 0.1838, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0219, 0.0210, 0.0164, 0.0272, 0.0264],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1792, 0.2232, 0.2156, 0.1942, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0220, -0.0072,  0.0271,  0.0093,  0.0071],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2086, 0.2166, 0.2041, 0.1793, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0029,  0.0182, -0.0338, -0.0206, -0.0039],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1820, 0.1877, 0.1792, 0.2425, 0.2087], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0083, -0.0206,  0.0027, -0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1876, 0.1898, 0.1966, 0.2010, 0.2250], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0033, -0.0046, -0.0012, -0.0181, -0.0330]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2474935  0.20122635 0.19767246 0.1788701  0.1747376 ]
np_weight_alpha[1] [0.20325288 0.2351532  0.1907491  0.18735449 0.18349032]
np_weight_alpha[2] [0.19762594 0.19050992 0.23216435 0.19205534 0.1876445 ]
np_weight_alpha[3] [0.17098956 0.19046056 0.24828707 0.19017403 0.20008874]
np_weight_alpha[4] [0.17367645 0.18273604 0.18579383 0.20672077 0.25107294]
-------------Round number:  616  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5317460317460317
client Accurancy:  0.47619047619047616
client Accurancy:  0.4246031746031746
client Accurancy:  0.38095238095238093
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.6782312925170068
Average Global Trainning Loss:  0.8615182059151786
All users are selected
model: 0 tensor([0.2475, 0.2012, 0.1977, 0.1789, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0197, 0.0019, 0.0185, 0.0047, 0.0079],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2033, 0.2352, 0.1907, 0.1874, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0134, -0.0010, -0.0065, -0.0091, -0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1976, 0.1905, 0.2322, 0.1921, 0.1876], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0238, 0.0158, 0.0154, 0.0125, 0.0113],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1710, 0.1905, 0.2483, 0.1902, 0.2001], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0095,  0.0048,  0.0597, -0.0333, -0.0001],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1737, 0.1827, 0.1858, 0.2067, 0.2511], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0283, -0.0221, -0.0308, -0.0218, -0.0202]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24072973 0.20883417 0.18882675 0.18407631 0.17753305]
np_weight_alpha[1] [0.23905082 0.2058258  0.18929142 0.19837171 0.16746025]
np_weight_alpha[2] [0.18917918 0.19002283 0.23450233 0.194675   0.19162068]
np_weight_alpha[3] [0.1847888  0.18966457 0.19246215 0.22910845 0.2039761 ]
np_weight_alpha[4] [0.17712979 0.17964295 0.19055451 0.20223589 0.25043687]
-------------Round number:  617  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5277777777777778
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.6758503401360544
Average Global Trainning Loss:  0.8941517524978742
All users are selected
model: 0 tensor([0.2407, 0.2088, 0.1888, 0.1841, 0.1775], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0172, 0.0203, 0.0101, 0.0125, 0.0123],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2391, 0.2058, 0.1893, 0.1984, 0.1675], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0389, -0.0232, -0.0045,  0.0101, -0.0137],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1892, 0.1900, 0.2345, 0.1947, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0079, -0.0090,  0.0026, -0.0008, -0.0034],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1848, 0.1897, 0.1925, 0.2291, 0.2040], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0083, -0.0073, -0.0065, -0.0091, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1771, 0.1796, 0.1906, 0.2022, 0.2504], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0082, -0.0078, -0.0065, -0.0046, -0.0010]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24055488 0.20190293 0.19232309 0.185509   0.17971015]
np_weight_alpha[1] [0.20097014 0.23219877 0.19471754 0.18936789 0.18274556]
np_weight_alpha[2] [0.21004337 0.21683885 0.20278294 0.18065517 0.18967971]
np_weight_alpha[3] [0.19009873 0.18980859 0.18894567 0.24198228 0.18916467]
np_weight_alpha[4] [0.18964268 0.19051218 0.19466652 0.19659106 0.22858752]
-------------Round number:  618  -------------
client Accurancy:  0.5317460317460317
client Accurancy:  0.5357142857142857
client Accurancy:  0.45634920634920634
client Accurancy:  0.38492063492063494
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.6476190476190476
Average Global Trainning Loss:  0.974217753507653
All users are selected
model: 0 tensor([0.2406, 0.2019, 0.1923, 0.1855, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0120, 0.0139, 0.0079, 0.0219, 0.0203],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2322, 0.1947, 0.1894, 0.1827], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0045, -0.0028,  0.0005, -0.0005, -0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2100, 0.2168, 0.2028, 0.1807, 0.1897], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0110,  0.0255, -0.0291, -0.0115,  0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1901, 0.1898, 0.1889, 0.2420, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0196,  0.0103,  0.0059,  0.0147, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1896, 0.1905, 0.1947, 0.1966, 0.2286], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0054, -0.0147, -0.0135, -0.0329, -0.0403]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24694166 0.20165846 0.19807431 0.1784974  0.17482811]
np_weight_alpha[1] [0.21100432 0.23665501 0.18076526 0.18057635 0.190999  ]
np_weight_alpha[2] [0.1978488  0.19039772 0.23322934 0.19118442 0.18733977]
np_weight_alpha[3] [0.17857856 0.18678494 0.19011146 0.23719025 0.20733483]
np_weight_alpha[4] [0.17379804 0.18287829 0.1855231  0.20643348 0.25136712]
-------------Round number:  619  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5317460317460317
client Accurancy:  0.47619047619047616
client Accurancy:  0.4523809523809524
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.6925170068027211
Average Global Trainning Loss:  0.8384759812127976
All users are selected
model: 0 tensor([0.2469, 0.2017, 0.1981, 0.1785, 0.1748], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0212, 0.0044, 0.0198, 0.0069, 0.0096],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2110, 0.2367, 0.1808, 0.1806, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0030,  0.0025, -0.0154, -0.0134,  0.0067],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1978, 0.1904, 0.2332, 0.1912, 0.1873], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0032, -0.0048, -0.0009, -0.0089, -0.0096],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1786, 0.1868, 0.1901, 0.2372, 0.2073], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0199, 0.0169, 0.0324, 0.0268],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1738, 0.1829, 0.1855, 0.2064, 0.2514], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0297, -0.0234, -0.0330, -0.0230, -0.0209]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24048893 0.20864612 0.189678   0.18349095 0.17769599]
np_weight_alpha[1] [0.20047028 0.19857211 0.2348595  0.22354038 0.14255771]
np_weight_alpha[2] [0.16351195 0.19235168 0.21643528 0.21423759 0.21346354]
np_weight_alpha[3] [0.18426242 0.18921562 0.19528599 0.22868419 0.20255181]
np_weight_alpha[4] [0.17732675 0.17974015 0.19108842 0.20179914 0.25004557]
-------------Round number:  620  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5238095238095238
client Accurancy:  0.49603174603174605
client Accurancy:  0.3888888888888889
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.672108843537415
Average Global Trainning Loss:  0.9039474383503401
All users are selected
model: 0 tensor([0.2405, 0.2086, 0.1897, 0.1835, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0083, 0.0117, 0.0044, 0.0054, 0.0050],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2005, 0.1986, 0.2349, 0.2235, 0.1426], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0254, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0069, -0.0357,  0.0391,  0.0319, -0.0433],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1635, 0.1924, 0.2164, 0.2142, 0.2135], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0125,  0.0152,  0.0034,  0.0417,  0.0424],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1892, 0.1953, 0.2287, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0084, -0.0044, -0.0104, -0.0075],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1773, 0.1797, 0.1911, 0.2018, 0.2500], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0165, -0.0160, -0.0141, -0.0145, -0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23585868 0.18453003 0.20145032 0.1908996  0.18726131]
np_weight_alpha[1] [0.20367591 0.23298821 0.19218709 0.18826917 0.18287964]
np_weight_alpha[2] [0.19353285 0.19462453 0.23290323 0.19018076 0.18875857]
np_weight_alpha[3] [0.18723689 0.19080743 0.17808723 0.24429943 0.19956899]
np_weight_alpha[4] [0.17931676 0.18098885 0.18980624 0.20063588 0.2492523 ]
-------------Round number:  621  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5436507936507936
client Accurancy:  0.4603174603174603
client Accurancy:  0.4007936507936508
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.6612244897959184
Average Global Trainning Loss:  0.9223407771311649
All users are selected
model: 0 tensor([0.2359, 0.1845, 0.2015, 0.1909, 0.1873], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0216, 0.0108, 0.0341, 0.0404, 0.0430],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2037, 0.2330, 0.1922, 0.1883, 0.1829], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0097, 0.0099, 0.0089, 0.0076, 0.0069],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1935, 0.1946, 0.2329, 0.1902, 0.1888], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0152, -0.0132, -0.0209, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1872, 0.1908, 0.1781, 0.2443, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012, -0.0033, -0.0203,  0.0082, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1793, 0.1810, 0.1898, 0.2006, 0.2493], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0188, -0.0150, -0.0200, -0.0111]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24760684 0.2021213  0.19580735 0.18000923 0.17445529]
np_weight_alpha[1] [0.19774838 0.227861   0.19024812 0.19286896 0.19127363]
np_weight_alpha[2] [0.1970108  0.19144554 0.22947872 0.19258296 0.18948197]
np_weight_alpha[3] [0.15796636 0.17970435 0.25834036 0.17623882 0.22775008]
np_weight_alpha[4] [0.17527755 0.1837259  0.18842722 0.20393568 0.24863374]
-------------Round number:  622  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5277777777777778
client Accurancy:  0.46825396825396826
client Accurancy:  0.4365079365079365
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.686734693877551
Average Global Trainning Loss:  0.8548124767485119
All users are selected
model: 0 tensor([0.2476, 0.2021, 0.1958, 0.1800, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0021, -0.0150,  0.0034, -0.0102, -0.0102],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.1977, 0.2279, 0.1902, 0.1929, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0385, -0.0279, -0.0212, -0.0207, -0.0132],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1970, 0.1914, 0.2295, 0.1926, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0843, 0.0781, 0.0584, 0.0726, 0.0743],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1580, 0.1797, 0.2583, 0.1762, 0.2278], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0346, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0143,  0.0657, -0.0563,  0.0212],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1753, 0.1837, 0.1884, 0.2039, 0.2486], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0473, -0.0414, -0.0443, -0.0448, -0.0427]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20469855 0.2505335  0.15293303 0.1986182  0.19321667]
np_weight_alpha[1] [0.21134473 0.23299176 0.1867038  0.18867414 0.18028556]
np_weight_alpha[2] [0.19424218 0.1901008  0.23447427 0.19222763 0.1889551 ]
np_weight_alpha[3] [0.18566011 0.19065383 0.18941328 0.23120904 0.20306376]
np_weight_alpha[4] [0.1780776  0.1803709  0.18737817 0.20296188 0.25121143]
-------------Round number:  623  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5357142857142857
client Accurancy:  0.49603174603174605
client Accurancy:  0.38492063492063494
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.676530612244898
Average Global Trainning Loss:  0.8943361035820578
All users are selected
model: 0 tensor([0.2047, 0.2505, 0.1529, 0.1986, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0228,  0.0608, -0.0276,  0.0271,  0.0277],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2113, 0.2330, 0.1867, 0.1887, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0085,  0.0036, -0.0086, -0.0004, -0.0002],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1942, 0.1901, 0.2345, 0.1922, 0.1890], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0062, -0.0016,  0.0090,  0.0049,  0.0016],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1857, 0.1907, 0.1894, 0.2312, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0053, -0.0085, -0.0061, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1781, 0.1804, 0.1874, 0.2030, 0.2512], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0119, -0.0111, -0.0145, -0.0101, -0.0045]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24346791 0.20156877 0.19244829 0.18396887 0.17854616]
np_weight_alpha[1] [0.17262205 0.21722724 0.23377755 0.1926991  0.18367401]
np_weight_alpha[2] [0.18378861 0.21829596 0.20941788 0.18791674 0.20058079]
np_weight_alpha[3] [0.18415679 0.18509729 0.19890966 0.23100117 0.20083514]
np_weight_alpha[4] [0.17923306 0.18051131 0.19016671 0.20115748 0.24893147]
-------------Round number:  624  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.45634920634920634
client Accurancy:  0.4007936507936508
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.6659863945578232
Average Global Trainning Loss:  0.9198248830782313
All users are selected
model: 0 tensor([0.2435, 0.2016, 0.1924, 0.1840, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0306, 0.0298, 0.0284, 0.0327, 0.0341],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1726, 0.2172, 0.2338, 0.1927, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0193, -0.0031,  0.0561,  0.0164,  0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1838, 0.2183, 0.2094, 0.1879, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0343,  0.0049, -0.0408, -0.0289, -0.0136],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1851, 0.1989, 0.2310, 0.2008], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-3.1128e-03, -9.4144e-03,  4.5479e-05, -4.0766e-03, -7.9050e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1792, 0.1805, 0.1902, 0.2012, 0.2489], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0108, -0.0180, -0.0163, -0.0170, -0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24738933 0.20142178 0.19375587 0.1817704  0.17566262]
np_weight_alpha[1] [0.20377015 0.23483045 0.18974593 0.18841605 0.18323743]
np_weight_alpha[2] [0.19506574 0.190542   0.22914486 0.19388089 0.19136655]
np_weight_alpha[3] [0.17571518 0.20666645 0.17480513 0.22750707 0.2153061 ]
np_weight_alpha[4] [0.175751   0.18339638 0.19082266 0.20229699 0.24773288]
-------------Round number:  625  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5357142857142857
client Accurancy:  0.4801587301587302
client Accurancy:  0.4523809523809524
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.685374149659864
Average Global Trainning Loss:  0.8498787600977891
All users are selected
model: 0 tensor([0.2474, 0.2014, 0.1938, 0.1818, 0.1757], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0087, -0.0085,  0.0060, -0.0020, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2038, 0.2348, 0.1897, 0.1884, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0231, -0.0118, -0.0161, -0.0173, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1951, 0.1905, 0.2291, 0.1939, 0.1914], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0563, 0.0507, 0.0382, 0.0501, 0.0510],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1757, 0.2067, 0.1748, 0.2275, 0.2153], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019,  0.0244, -0.0126,  0.0050,  0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1758, 0.1834, 0.1908, 0.2023, 0.2477], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0402, -0.0355, -0.0366, -0.0401, -0.0368]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20440023 0.24927555 0.16694602 0.19224586 0.18713234]
np_weight_alpha[1] [0.20980287 0.23157603 0.18879674 0.18874401 0.18108028]
np_weight_alpha[2] [0.18738219 0.18840946 0.24323577 0.19211371 0.18885893]
np_weight_alpha[3] [0.18419583 0.18850474 0.19342147 0.2305905  0.2032874 ]
np_weight_alpha[4] [0.17778352 0.18044125 0.18827997 0.20292108 0.25057417]
-------------Round number:  626  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5357142857142857
client Accurancy:  0.49206349206349204
client Accurancy:  0.3888888888888889
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.6789115646258503
Average Global Trainning Loss:  0.8925514688297194
All users are selected
model: 0 tensor([0.2044, 0.2493, 0.1669, 0.1922, 0.1871], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0209,  0.0619, -0.0117,  0.0227,  0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2098, 0.2316, 0.1888, 0.1887, 0.1811], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0078,  0.0029, -0.0051,  0.0002,  0.0004],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1874, 0.1884, 0.2432, 0.1921, 0.1889], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0030, -0.0041,  0.0168,  0.0030,  0.0006],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1842, 0.1885, 0.1934, 0.2306, 0.2033], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0092, -0.0094, -0.0066, -0.0089, -0.0069],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1778, 0.1804, 0.1883, 0.2029, 0.2506], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0120, -0.0115, -0.0128, -0.0091, -0.0049]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24321252 0.20116135 0.19258061 0.1840406  0.17900495]
np_weight_alpha[1] [0.17742954 0.22399226 0.22050707 0.19308381 0.18498737]
np_weight_alpha[2] [0.21558021 0.22252665 0.17374611 0.190051   0.19809602]
np_weight_alpha[3] [0.1886616  0.1939401  0.18508144 0.2362112  0.19610558]
np_weight_alpha[4] [0.17936702 0.18133782 0.18975993 0.20047574 0.24905944]
-------------Round number:  627  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5357142857142857
client Accurancy:  0.4603174603174603
client Accurancy:  0.39285714285714285
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.6649659863945578
Average Global Trainning Loss:  0.9241626973054847
All users are selected
model: 0 tensor([0.2432, 0.2012, 0.1926, 0.1840, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0252, 0.0228, 0.0179, 0.0248, 0.0270],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1774, 0.2240, 0.2205, 0.1931, 0.1850], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0031,  0.0352,  0.0090,  0.0058],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2156, 0.2225, 0.1737, 0.1901, 0.1981], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0175,  0.0315, -0.0589, -0.0037,  0.0095],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1887, 0.1939, 0.1851, 0.2362, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0020, -0.0037, -0.0160, -0.0024, -0.0166],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1794, 0.1813, 0.1898, 0.2005, 0.2491], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0161, -0.0237, -0.0181, -0.0237, -0.0181]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24452859 0.20052321 0.19689184 0.18229719 0.17575917]
np_weight_alpha[1] [0.20229676 0.23423365 0.19012885 0.1889462  0.18439458]
np_weight_alpha[2] [0.19662113 0.1897905  0.23370194 0.19240089 0.18748546]
np_weight_alpha[3] [0.1601548  0.17179066 0.223064   0.20526981 0.23972073]
np_weight_alpha[4] [0.17551357 0.18406083 0.18670328 0.20258221 0.25114006]
-------------Round number:  628  -------------
client Accurancy:  0.5
client Accurancy:  0.5396825396825397
client Accurancy:  0.4603174603174603
client Accurancy:  0.44047619047619047
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4603174603174603
Average Global Trainning Accurancy:  0.6979591836734694
Average Global Trainning Loss:  0.840252228821216
All users are selected
model: 0 tensor([0.2445, 0.2005, 0.1969, 0.1823, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0219, 0.0067, 0.0257, 0.0152, 0.0150],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2023, 0.2342, 0.1901, 0.1889, 0.1844], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0102,  0.0028, -0.0023, -0.0015,  0.0027],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1966, 0.1898, 0.2337, 0.1924, 0.1875], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0085, -0.0009,  0.0039, -0.0052, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1602, 0.1718, 0.2231, 0.2053, 0.2397], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0073,  0.0384, -0.0100,  0.0500],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1755, 0.1841, 0.1867, 0.2026, 0.2511], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0269, -0.0209, -0.0323, -0.0255, -0.0179]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24210304 0.20961086 0.18724175 0.18338144 0.17766292]
np_weight_alpha[1] [0.24798621 0.21001403 0.19148992 0.1864344  0.1640754 ]
np_weight_alpha[2] [0.15700535 0.19210707 0.2118008  0.21646565 0.22262114]
np_weight_alpha[3] [0.18598363 0.19016936 0.19552118 0.22785929 0.20046657]
np_weight_alpha[4] [0.17754218 0.17983198 0.19294186 0.20191571 0.2477683 ]
-------------Round number:  629  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5317460317460317
client Accurancy:  0.503968253968254
client Accurancy:  0.4007936507936508
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.682312925170068
Average Global Trainning Loss:  0.881459429474915
All users are selected
model: 0 tensor([0.2421, 0.2096, 0.1872, 0.1834, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0091, 0.0116, 0.0021, 0.0032, 0.0034],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2480, 0.2100, 0.1915, 0.1864, 0.1641], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0350, -0.0322, -0.0122, -0.0153, -0.0305],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1570, 0.1921, 0.2118, 0.2165, 0.2226], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0193, 0.0540, 0.0314, 0.0816, 0.0908],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1860, 0.1902, 0.1955, 0.2279, 0.2005], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0296, -0.0296, -0.0259, -0.0322, -0.0313],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1775, 0.1798, 0.1929, 0.2019, 0.2478], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0214, -0.0213, -0.0157, -0.0188, -0.0170]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2267952  0.18119499 0.2057577  0.19644324 0.18980888]
np_weight_alpha[1] [0.20126757 0.23291443 0.19210027 0.19017318 0.18354455]
np_weight_alpha[2] [0.16645287 0.19160567 0.21626489 0.21053609 0.2151405 ]
np_weight_alpha[3] [0.18577771 0.18963097 0.19121693 0.23197673 0.20139769]
np_weight_alpha[4] [0.17965837 0.18161273 0.18862982 0.200366   0.24973314]
-------------Round number:  630  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5396825396825397
client Accurancy:  0.45634920634920634
client Accurancy:  0.39285714285714285
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.6632653061224489
Average Global Trainning Loss:  0.924491954985119
All users are selected
model: 0 tensor([0.2268, 0.1812, 0.2058, 0.1964, 0.1898], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0093, 0.0039, 0.0419, 0.0361, 0.0418],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2013, 0.2329, 0.1921, 0.1902, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0033, 0.0058, 0.0078, 0.0035, 0.0030],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1665, 0.1916, 0.2163, 0.2105, 0.2151], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0140,  0.0147, -0.0054,  0.0301,  0.0371],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1896, 0.1912, 0.2320, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0226, -0.0225, -0.0233, -0.0164, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1797, 0.1816, 0.1886, 0.2004, 0.2497], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0219, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0164, -0.0239, -0.0242, -0.0192, -0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24747562 0.20240453 0.18925352 0.18601665 0.17484969]
np_weight_alpha[1] [0.2076572  0.22843793 0.17711914 0.19548956 0.19129613]
np_weight_alpha[2] [0.19234344 0.18896721 0.23631665 0.19230749 0.19006515]
np_weight_alpha[3] [0.18760109 0.1911032  0.19348969 0.2291747  0.1986313 ]
np_weight_alpha[4] [0.17583282 0.18427858 0.19120947 0.19772893 0.25095025]
-------------Round number:  631  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5357142857142857
client Accurancy:  0.46825396825396826
client Accurancy:  0.4087301587301587
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.6880952380952381
Average Global Trainning Loss:  0.8570858909970238
All users are selected
model: 0 tensor([0.2475, 0.2024, 0.1893, 0.1860, 0.1748], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0186, 0.0015, 0.0093, 0.0112, 0.0063],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2077, 0.2284, 0.1771, 0.1955, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0140, -0.0121, -0.0242, -0.0051, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1923, 0.1890, 0.2363, 0.1923, 0.1901], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0403, 0.0366, 0.0351, 0.0363, 0.0374],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1876, 0.1911, 0.1935, 0.2292, 0.1986], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0005, -0.0018, -0.0028, -0.0024, -0.0097],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1758, 0.1843, 0.1912, 0.1977, 0.2510], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0336, -0.0285, -0.0302, -0.0388, -0.0272]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.20012924 0.24496503 0.18860945 0.17692067 0.18937556]
np_weight_alpha[1] [0.20996067 0.23072751 0.18968372 0.18900077 0.18062736]
np_weight_alpha[2] [0.18854542 0.18890384 0.2410774  0.19232175 0.18915163]
np_weight_alpha[3] [0.16993988 0.18318565 0.19016133 0.22505386 0.23165922]
np_weight_alpha[4] [0.17753862 0.18050541 0.18844518 0.20324253 0.25026828]
-------------Round number:  632  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5317460317460317
client Accurancy:  0.49206349206349204
client Accurancy:  0.4126984126984127
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.6894557823129251
Average Global Trainning Loss:  0.8758279190582483
All users are selected
model: 0 tensor([0.2001, 0.2450, 0.1886, 0.1769, 0.1894], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0194,  0.0634,  0.0170,  0.0137,  0.0316],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2100, 0.2307, 0.1897, 0.1890, 0.1806], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0132, 0.0086, 0.0013, 0.0045, 0.0061],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1885, 0.1889, 0.2411, 0.1923, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0104, 0.0087, 0.0251, 0.0164, 0.0139],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1699, 0.1832, 0.1902, 0.2251, 0.2317], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0525, -0.0454, -0.0375, -0.0393, -0.0083],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1775, 0.1805, 0.1884, 0.2032, 0.2503], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0077, -0.0063, -0.0074, -0.0074,  0.0011]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24368764 0.2016277  0.19175202 0.18394952 0.17898312]
np_weight_alpha[1] [0.17808287 0.22177295 0.21666396 0.1996427  0.18383747]
np_weight_alpha[2] [0.19253172 0.19459276 0.23264907 0.19044365 0.18978286]
np_weight_alpha[3] [0.18578139 0.1915687  0.19066578 0.2291425  0.2028416 ]
np_weight_alpha[4] [0.18835823 0.18447196 0.19731088 0.21243462 0.21742438]
-------------Round number:  633  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5317460317460317
client Accurancy:  0.44841269841269843
client Accurancy:  0.4007936507936508
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.6666666666666666
Average Global Trainning Loss:  0.9224476509353742
All users are selected
model: 0 tensor([0.2437, 0.2016, 0.1918, 0.1839, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0382, 0.0357, 0.0345, 0.0307, 0.0386],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1781, 0.2218, 0.2167, 0.1996, 0.1838], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0060,  0.0086,  0.0459,  0.0270,  0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1946, 0.2326, 0.1904, 0.1898], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0175, -0.0131, -0.0122, -0.0226, -0.0216],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1858, 0.1916, 0.1907, 0.2291, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0309, -0.0282, -0.0328, -0.0246, -0.0228],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1884, 0.1845, 0.1973, 0.2124, 0.2174], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0238, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0057, -0.0079, -0.0040,  0.0068, -0.0393]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24402766 0.2001961  0.19170761 0.18785645 0.17621218]
np_weight_alpha[1] [0.20204683 0.23366784 0.18908653 0.19085656 0.1843422 ]
np_weight_alpha[2] [0.19228528 0.19008517 0.22883129 0.19519179 0.1936065 ]
np_weight_alpha[3] [0.18870838 0.19164082 0.19520433 0.2270674  0.19737908]
np_weight_alpha[4] [0.1749026  0.18361095 0.19200096 0.1961894  0.2532961 ]
-------------Round number:  634  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5357142857142857
client Accurancy:  0.46825396825396826
client Accurancy:  0.3968253968253968
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.6891156462585034
Average Global Trainning Loss:  0.860994798309949
All users are selected
model: 0 tensor([0.2440, 0.2002, 0.1917, 0.1879, 0.1762], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0265, 0.0110, 0.0208, 0.0246, 0.0191],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2020, 0.2337, 0.1891, 0.1909, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0059,  0.0065, -0.0011,  0.0037,  0.0056],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1923, 0.1901, 0.2288, 0.1952, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0015, -0.0013, -0.0020,  0.0009,  0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 25.0
model: 3 tensor([0.1887, 0.1916, 0.1952, 0.2271, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0030,  0.0005, -0.0020, -0.0034, -0.0101],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1749, 0.1836, 0.1920, 0.1962, 0.2533], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0229, -0.0174, -0.0190, -0.0287, -0.0130]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24031708 0.20855387 0.1903145  0.18316871 0.17764582]
np_weight_alpha[1] [0.24262455 0.20872536 0.20158    0.18040022 0.16666986]
np_weight_alpha[2] [0.16387554 0.2283285  0.3029624  0.17730504 0.12752856]
np_weight_alpha[3] [0.1634947  0.17658502 0.19122088 0.23209386 0.23660545]
np_weight_alpha[4] [0.17739642 0.18024096 0.18945296 0.20312664 0.24978305]
-------------Round number:  635  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5317460317460317
client Accurancy:  0.5
client Accurancy:  0.4166666666666667
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.7034013605442176
Average Global Trainning Loss:  0.8435613307823129
All users are selected
model: 0 tensor([0.2403, 0.2086, 0.1903, 0.1832, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0047, -0.0008, -0.0044, -0.0076, -0.0082],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2426, 0.2087, 0.2016, 0.1804, 0.1667], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0122, -0.0492, -0.0189, -0.0390, -0.0446],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1639, 0.2283, 0.3030, 0.1773, 0.1275], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0924, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0749, 0.1379, 0.1660, 0.0879, 0.0372],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1635, 0.1766, 0.1912, 0.2321, 0.2366], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0691, -0.0605, -0.0429, -0.0431, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1774, 0.1802, 0.1895, 0.2031, 0.2498], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0371, -0.0358, -0.0314, -0.0353, -0.0296]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24079882 0.18642612 0.18601917 0.19469312 0.19206284]
np_weight_alpha[1] [0.20186384 0.23160687 0.19208929 0.19100296 0.18343712]
np_weight_alpha[2] [0.16535303 0.21430607 0.30260828 0.17455609 0.14317653]
np_weight_alpha[3] [0.18704851 0.19133346 0.18849745 0.23149134 0.20162931]
np_weight_alpha[4] [0.1801829  0.18156716 0.18600665 0.20302325 0.24922007]
-------------Round number:  636  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5277777777777778
client Accurancy:  0.4603174603174603
client Accurancy:  0.40476190476190477
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.6710884353741496
Average Global Trainning Loss:  0.8960762283428997
All users are selected
model: 0 tensor([0.2408, 0.1864, 0.1860, 0.1947, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0259, 0.0108, 0.0151, 0.0396, 0.0441],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2019, 0.2316, 0.1921, 0.1910, 0.1834], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0051, 0.0050, 0.0068, 0.0059, 0.0030],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1654, 0.2143, 0.3026, 0.1746, 0.1432], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0790, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0117,  0.0452,  0.0922,  0.0020, -0.0254],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1870, 0.1913, 0.1885, 0.2315, 0.2016], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0257, -0.0289, -0.0336, -0.0281, -0.0340],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1802, 0.1816, 0.1860, 0.2030, 0.2492], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0283, -0.0244, -0.0266, -0.0216]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24495748 0.20134674 0.19663829 0.18172061 0.17533693]
np_weight_alpha[1] [0.20142657 0.23455557 0.18361264 0.18698743 0.19341782]
np_weight_alpha[2] [0.1968735  0.18926434 0.23261333 0.19251715 0.18873172]
np_weight_alpha[3] [0.18279964 0.18972844 0.19154705 0.23098533 0.20493959]
np_weight_alpha[4] [0.17613225 0.18456982 0.18514553 0.20380326 0.25034913]
-------------Round number:  637  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5317460317460317
client Accurancy:  0.45634920634920634
client Accurancy:  0.4166666666666667
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.4531746031746032
Average Global Trainning Accurancy:  0.6948979591836735
Average Global Trainning Loss:  0.8383608863467262
All users are selected
model: 0 tensor([0.2450, 0.2013, 0.1966, 0.1817, 0.1753], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0241, 0.0090, 0.0277, 0.0159, 0.0159],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2014, 0.2346, 0.1836, 0.1870, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0140,  0.0015, -0.0115, -0.0066,  0.0093],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1969, 0.1893, 0.2326, 0.1925, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0265, 0.0158, 0.0177, 0.0127, 0.0118],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1828, 0.1897, 0.1915, 0.2310, 0.2049], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0040, -0.0022, -0.0076,  0.0021, -0.0007],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1761, 0.1846, 0.1851, 0.2038, 0.2503], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0299, -0.0241, -0.0367, -0.0276, -0.0224]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24194838 0.2098132  0.18658987 0.18371572 0.1779328 ]
np_weight_alpha[1] [0.2519132  0.20178504 0.21649931 0.19471867 0.1350838 ]
np_weight_alpha[2] [0.1869995  0.18998869 0.23366572 0.19606696 0.19327909]
np_weight_alpha[3] [0.19045083 0.18847378 0.21727303 0.20789853 0.19590382]
np_weight_alpha[4] [0.17770159 0.18008511 0.19237298 0.20178935 0.24805093]
-------------Round number:  638  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5277777777777778
client Accurancy:  0.49603174603174605
client Accurancy:  0.3968253968253968
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.6887755102040817
Average Global Trainning Loss:  0.8598514894238946
All users are selected
model: 0 tensor([0.2419, 0.2098, 0.1866, 0.1837, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0150, 0.0184, 0.0042, 0.0137, 0.0105],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2519, 0.2018, 0.2165, 0.1947, 0.1351], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0361, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0445, -0.0345,  0.0165, -0.0012, -0.0555],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1870, 0.1900, 0.2337, 0.1961, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0247, -0.0219, -0.0127, -0.0099, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1905, 0.1885, 0.2173, 0.2079, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0403, 0.0311, 0.0602, 0.0011, 0.0243],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1777, 0.1801, 0.1924, 0.2018, 0.2481], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0237, -0.0233, -0.0205, -0.0220, -0.0187]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24202864 0.20260932 0.19362444 0.18205337 0.17968427]
np_weight_alpha[1] [0.20069274 0.23191871 0.19338678 0.1894866  0.18451518]
np_weight_alpha[2] [0.19445078 0.19467664 0.23126638 0.18901435 0.19059189]
np_weight_alpha[3] [0.18139121 0.18808618 0.18782549 0.24077252 0.20192456]
np_weight_alpha[4] [0.17938988 0.18117905 0.19002025 0.20064339 0.24876747]
-------------Round number:  639  -------------
client Accurancy:  0.5
client Accurancy:  0.5317460317460317
client Accurancy:  0.4444444444444444
client Accurancy:  0.4087301587301587
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.6857142857142857
Average Global Trainning Loss:  0.8579113188244047
All users are selected
model: 0 tensor([0.2420, 0.2026, 0.1936, 0.1821, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0331, 0.0338, 0.0360, 0.0425, 0.0409],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2007, 0.2319, 0.1934, 0.1895, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0083, 0.0127, 0.0159, 0.0170, 0.0153],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1945, 0.1947, 0.2313, 0.1890, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0171, -0.0134, -0.0149, -0.0206, -0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1814, 0.1881, 0.1878, 0.2408, 0.2019], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0135, -0.0163, -0.0229, -0.0126, -0.0247],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1794, 0.1812, 0.1900, 0.2006, 0.2488], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0130, -0.0183, -0.0179, -0.0240, -0.0074]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2497813  0.20440444 0.19334705 0.17658937 0.17587788]
np_weight_alpha[1] [0.20539327 0.234938   0.19073202 0.18597904 0.18295762]
np_weight_alpha[2] [0.19430012 0.19092193 0.23092806 0.19234629 0.19150367]
np_weight_alpha[3] [0.17723756 0.1858669  0.19182678 0.2374168  0.20765187]
np_weight_alpha[4] [0.17642641 0.18279795 0.19068404 0.20729668 0.24279492]
-------------Round number:  640  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.5158730158730159
client Accurancy:  0.4880952380952381
client Accurancy:  0.4523809523809524
client Accurancy:  0.3888888888888889
Average Global Accurancy:  0.45714285714285713
Average Global Trainning Accurancy:  0.7013605442176871
Average Global Trainning Loss:  0.8124753368144133
All users are selected
model: 0 tensor([0.2498, 0.2044, 0.1933, 0.1766, 0.1759], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0020, -0.0188, -0.0018, -0.0180, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2054, 0.2349, 0.1907, 0.1860, 0.1830], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0413, -0.0303, -0.0283, -0.0378, -0.0346],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1909, 0.2309, 0.1923, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0269, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1098, 0.1060, 0.0745, 0.1010, 0.1061],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1772, 0.1859, 0.1918, 0.2374, 0.2077], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034, -0.0007,  0.0040,  0.0085,  0.0064],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1764, 0.1828, 0.1907, 0.2073, 0.2428], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0226, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0595, -0.0570, -0.0508, -0.0539, -0.0620]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24339382 0.2110096  0.18341099 0.1828937  0.17929189]
np_weight_alpha[1] [0.21171446 0.23221523 0.18433294 0.18872713 0.18301025]
np_weight_alpha[2] [0.19157171 0.18908277 0.23834525 0.19138598 0.18961427]
np_weight_alpha[3] [0.20914161 0.20389242 0.1867757  0.2096171  0.19057311]
np_weight_alpha[4] [0.17693685 0.18220678 0.18836103 0.20530969 0.24718562]
-------------Round number:  641  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5277777777777778
client Accurancy:  0.5
client Accurancy:  0.38492063492063494
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.6870748299319728
Average Global Trainning Loss:  0.869613875823767
All users are selected
model: 0 tensor([0.2434, 0.2110, 0.1834, 0.1829, 0.1793], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0219, 0.0248, 0.0063, 0.0165, 0.0166],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2117, 0.2322, 0.1843, 0.1887, 0.1830], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0095,  0.0039, -0.0102,  0.0006,  0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1916, 0.1891, 0.2383, 0.1914, 0.1896], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0160, -0.0200, -0.0042, -0.0124, -0.0148],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2091, 0.2039, 0.1868, 0.2096, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0384,  0.0267,  0.0074, -0.0146, -0.0030],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1769, 0.1822, 0.1884, 0.2053, 0.2472], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0198, -0.0166, -0.0195, -0.0143, -0.0135]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24129164 0.20232755 0.19329038 0.18321872 0.17987168]
np_weight_alpha[1] [0.17063233 0.21751484 0.243647   0.19034049 0.17786533]
np_weight_alpha[2] [0.19366334 0.1950545  0.23063149 0.19001694 0.1906337 ]
np_weight_alpha[3] [0.18163319 0.18762198 0.18967193 0.2374164  0.20365652]
np_weight_alpha[4] [0.1796534  0.18155178 0.1899395  0.20147514 0.24738011]
-------------Round number:  642  -------------
client Accurancy:  0.5
client Accurancy:  0.5357142857142857
client Accurancy:  0.44841269841269843
client Accurancy:  0.40476190476190477
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.682312925170068
Average Global Trainning Loss:  0.8708001169217687
All users are selected
model: 0 tensor([0.2413, 0.2023, 0.1933, 0.1832, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0368, 0.0373, 0.0350, 0.0409, 0.0426],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1706, 0.2175, 0.2436, 0.1903, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0156,  0.0036,  0.0721,  0.0208,  0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1937, 0.1951, 0.2306, 0.1900, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0245, -0.0183, -0.0190, -0.0241, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1816, 0.1876, 0.1897, 0.2374, 0.2037], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0190, -0.0208, -0.0228, -0.0133, -0.0223],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1797, 0.1816, 0.1899, 0.2015, 0.2474], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0099, -0.0161, -0.0139, -0.0186, -0.0098]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24615087 0.20210253 0.19542086 0.1804086  0.17591709]
np_weight_alpha[1] [0.204268   0.2345822  0.18974943 0.18787122 0.18352912]
np_weight_alpha[2] [0.19627878 0.19164658 0.22979826 0.19240694 0.1898694 ]
np_weight_alpha[3] [0.18119423 0.18837535 0.19218467 0.23267202 0.20557375]
np_weight_alpha[4] [0.17601308 0.18326187 0.18897228 0.20499457 0.24675816]
-------------Round number:  643  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5317460317460317
client Accurancy:  0.4722222222222222
client Accurancy:  0.44841269841269843
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.7051020408163265
Average Global Trainning Loss:  0.8106963488520408
All users are selected
model: 0 tensor([0.2462, 0.2021, 0.1954, 0.1804, 0.1759], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0313, 0.0148, 0.0271, 0.0196, 0.0207],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2043, 0.2346, 0.1897, 0.1879, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0057,  0.0071, -0.0027, -0.0010,  0.0029],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1963, 0.1916, 0.2298, 0.1924, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0052, -0.0113, -0.0103, -0.0133, -0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1812, 0.1884, 0.1922, 0.2327, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0068, 0.0084, 0.0063, 0.0135, 0.0106],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1760, 0.1833, 0.1890, 0.2050, 0.2468], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0232, -0.0191, -0.0245, -0.0207, -0.0198]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23986696 0.20896402 0.19010676 0.18307799 0.1779843 ]
np_weight_alpha[1] [0.23484957 0.1986865  0.20288616 0.19259258 0.1709852 ]
np_weight_alpha[2] [0.19057667 0.19197449 0.23110431 0.19458805 0.19175643]
np_weight_alpha[3] [0.1928482  0.19206843 0.20623854 0.21090505 0.19793977]
np_weight_alpha[4] [0.17757893 0.18035369 0.19071046 0.2026681  0.24868885]
-------------Round number:  644  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5198412698412699
client Accurancy:  0.4801587301587302
client Accurancy:  0.3888888888888889
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.6880952380952381
Average Global Trainning Loss:  0.8646725193983843
All users are selected
model: 0 tensor([0.2399, 0.2090, 0.1901, 0.1831, 0.1780], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0100, 0.0156, 0.0048, 0.0104, 0.0068],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2348, 0.1987, 0.2029, 0.1926, 0.1710], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0330, -0.0362,  0.0086,  0.0048, -0.0099],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1906, 0.1920, 0.2311, 0.1946, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0248, -0.0233, -0.0199, -0.0143, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1928, 0.1921, 0.2062, 0.2109, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0472, 0.0404, 0.0537, 0.0059, 0.0304],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1776, 0.1804, 0.1907, 0.2027, 0.2487], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0274, -0.0246, -0.0249, -0.0239, -0.0209]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2395897  0.17869228 0.21263112 0.17865787 0.19042899]
np_weight_alpha[1] [0.20104359 0.23713921 0.19349326 0.18733136 0.18099263]
np_weight_alpha[2] [0.19439353 0.19427484 0.23237738 0.18825166 0.19070251]
np_weight_alpha[3] [0.1809673  0.18646157 0.18723902 0.24345322 0.20187889]
np_weight_alpha[4] [0.18022148 0.18013376 0.19007158 0.20069872 0.24887452]
-------------Round number:  645  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5277777777777778
client Accurancy:  0.4444444444444444
client Accurancy:  0.4126984126984127
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.6887755102040817
Average Global Trainning Loss:  0.8532295486553997
All users are selected
model: 0 tensor([0.2396, 0.1787, 0.2126, 0.1787, 0.1904], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0310, 0.0079, 0.0487, 0.0357, 0.0490],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2371, 0.1935, 0.1873, 0.1810], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0095, 0.0177, 0.0140, 0.0121, 0.0093],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1943, 0.2324, 0.1883, 0.1907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0058, -0.0086, -0.0094, -0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1810, 0.1865, 0.1872, 0.2435, 0.2019], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0222, -0.0236, -0.0130, -0.0286],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1802, 0.1801, 0.1901, 0.2007, 0.2489], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0136, -0.0212, -0.0133, -0.0259, -0.0117]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24612273 0.20373574 0.19684975 0.17733403 0.17595772]
np_weight_alpha[1] [0.20328419 0.23372312 0.19147334 0.18737298 0.18414639]
np_weight_alpha[2] [0.21711858 0.1828011  0.23705667 0.193853   0.16917063]
np_weight_alpha[3] [0.1780088  0.18702486 0.18902043 0.23742962 0.20851636]
np_weight_alpha[4] [0.17662062 0.18339968 0.1852942  0.20809582 0.24658968]
-------------Round number:  646  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5277777777777778
client Accurancy:  0.45634920634920634
client Accurancy:  0.4603174603174603
client Accurancy:  0.38095238095238093
Average Global Accurancy:  0.46111111111111114
Average Global Trainning Accurancy:  0.7139455782312926
Average Global Trainning Loss:  0.7905026805644133
All users are selected
model: 0 tensor([0.2461, 0.2037, 0.1968, 0.1773, 0.1760], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0221, 0.0076, 0.0260, 0.0089, 0.0129],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2033, 0.2337, 0.1915, 0.1874, 0.1841], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0147, -0.0015, -0.0042, -0.0076, -0.0028],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2171, 0.1828, 0.2371, 0.1939, 0.1692], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0541,  0.0158,  0.0254,  0.0186, -0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1780, 0.1870, 0.1890, 0.2374, 0.2085], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0030, -0.0086,  0.0095,  0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1766, 0.1834, 0.1853, 0.2081, 0.2466], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0332, -0.0290, -0.0400, -0.0264, -0.0282]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24206191 0.21052743 0.18557163 0.18336214 0.17847688]
np_weight_alpha[1] [0.24932218 0.2085484  0.18070626 0.19299547 0.16842768]
np_weight_alpha[2] [0.18479481 0.1884859  0.23559146 0.19644867 0.19467911]
np_weight_alpha[3] [0.20827602 0.19703943 0.22897238 0.18531612 0.18039607]
np_weight_alpha[4] [0.17828783 0.18059361 0.19266333 0.20173739 0.24671781]
-------------Round number:  647  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5238095238095238
client Accurancy:  0.5
client Accurancy:  0.3888888888888889
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.6901360544217687
Average Global Trainning Loss:  0.856227495881165
All users are selected
model: 0 tensor([0.2421, 0.2105, 0.1856, 0.1834, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0126, 0.0171, 0.0016, 0.0112, 0.0083],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2493, 0.2085, 0.1807, 0.1930, 0.1684], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0391, -0.0318, -0.0223, -0.0040, -0.0234],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1848, 0.1885, 0.2356, 0.1964, 0.1947], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0171, -0.0134, -0.0028, -0.0007, -0.0033],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.2083, 0.1970, 0.2290, 0.1853, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0627,  0.0444,  0.0750, -0.0210,  0.0108],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1783, 0.1806, 0.1927, 0.2017, 0.2467], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0308, -0.0305, -0.0270, -0.0287, -0.0268]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24234827 0.20239547 0.19307624 0.18198633 0.1801937 ]
np_weight_alpha[1] [0.20102848 0.2336544  0.1938601  0.18816671 0.1832903 ]
np_weight_alpha[2] [0.23398587 0.21709082 0.2105598  0.1644366  0.17392695]
np_weight_alpha[3] [0.17981096 0.18626891 0.18752983 0.24363017 0.20276013]
np_weight_alpha[4] [0.17992474 0.18177284 0.18972725 0.20021358 0.24836151]
-------------Round number:  648  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5277777777777778
client Accurancy:  0.4365079365079365
client Accurancy:  0.4246031746031746
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.6904761904761905
Average Global Trainning Loss:  0.8447731485172194
All users are selected
model: 0 tensor([0.2423, 0.2024, 0.1931, 0.1820, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0401, 0.0381, 0.0346, 0.0376, 0.0425],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2337, 0.1939, 0.1882, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0135, 0.0181, 0.0177, 0.0134, 0.0138],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2340, 0.2171, 0.2106, 0.1644, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0238,  0.0112, -0.0356, -0.0461, -0.0332],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1798, 0.1863, 0.1875, 0.2436, 0.2028], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0289, -0.0293, -0.0308, -0.0105, -0.0274],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1799, 0.1818, 0.1897, 0.2002, 0.2484], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0119, -0.0185, -0.0149, -0.0204, -0.0119]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24373177 0.20155273 0.19576658 0.18248594 0.17646295]
np_weight_alpha[1] [0.20214602 0.23255545 0.19098957 0.18963604 0.18467289]
np_weight_alpha[2] [0.19369699 0.18956015 0.23192516 0.1940486  0.1907691 ]
np_weight_alpha[3] [0.18340193 0.1898048  0.19247986 0.23016262 0.20415077]
np_weight_alpha[4] [0.17631401 0.18390296 0.18790868 0.20360953 0.24826476]
-------------Round number:  649  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5277777777777778
client Accurancy:  0.4603174603174603
client Accurancy:  0.4365079365079365
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.7068027210884353
Average Global Trainning Loss:  0.8139782963966836
All users are selected
model: 0 tensor([0.2437, 0.2016, 0.1958, 0.1825, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0324, 0.0173, 0.0299, 0.0244, 0.0241],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2021, 0.2326, 0.1910, 0.1896, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034,  0.0096,  0.0032,  0.0049,  0.0080],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1937, 0.1896, 0.2319, 0.1940, 0.1908], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0080, -0.0128, -0.0084, -0.0110, -0.0102],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1834, 0.1898, 0.1925, 0.2302, 0.2042], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0005,  0.0002, -0.0028,  0.0026, -0.0010],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 25.0
model: 4 tensor([0.1763, 0.1839, 0.1879, 0.2036, 0.2483], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0212, -0.0170, -0.0227, -0.0208, -0.0162]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2391617  0.20889129 0.19055615 0.18327641 0.17811441]
np_weight_alpha[1] [0.2443339  0.20514758 0.1958253  0.18642259 0.16827069]
np_weight_alpha[2] [0.19119859 0.19183451 0.23200437 0.1944206  0.19054197]
np_weight_alpha[3] [0.1866742  0.17575435 0.25956145 0.15870652 0.2193035 ]
np_weight_alpha[4] [0.17775348 0.1808112  0.18975316 0.20334259 0.24833955]
-------------Round number:  650  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5277777777777778
client Accurancy:  0.47619047619047616
client Accurancy:  0.3968253968253968
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.6965986394557823
Average Global Trainning Loss:  0.8448722164647109
All users are selected
model: 0 tensor([0.2392, 0.2089, 0.1906, 0.1833, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0062, 0.0112, 0.0039, 0.0070, 0.0033],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2443, 0.2051, 0.1958, 0.1864, 0.1683], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0241, -0.0433, -0.0163, -0.0205, -0.0337],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1912, 0.1918, 0.2320, 0.1944, 0.1905], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0133, 0.0126, 0.0124, 0.0216, 0.0161],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1867, 0.1758, 0.2596, 0.1587, 0.2193], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0320, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0362,  0.0186,  0.1060, -0.0532,  0.0493],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1778, 0.1808, 0.1898, 0.2033, 0.2483], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0379, -0.0368, -0.0345, -0.0324, -0.0308]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24268869 0.18401991 0.20155898 0.17966402 0.19206847]
np_weight_alpha[1] [0.20165868 0.23212789 0.19359045 0.1886286  0.18399438]
np_weight_alpha[2] [0.19244221 0.1937292  0.23708779 0.18762663 0.18911421]
np_weight_alpha[3] [0.18453005 0.1778298  0.24776678 0.17545967 0.21441364]
np_weight_alpha[4] [0.18072987 0.18246503 0.18869475 0.19984192 0.24826846]
-------------Round number:  651  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5277777777777778
client Accurancy:  0.43253968253968256
client Accurancy:  0.40476190476190477
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.6836734693877551
Average Global Trainning Loss:  0.8689953031994048
All users are selected
model: 0 tensor([0.2427, 0.1840, 0.2016, 0.1797, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0224, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0340, 0.0143, 0.0453, 0.0456, 0.0548],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2321, 0.1936, 0.1886, 0.1840], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0049, 0.0096, 0.0122, 0.0159, 0.0121],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1924, 0.1937, 0.2371, 0.1876, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0219, -0.0161, -0.0267, -0.0256],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1845, 0.1778, 0.2478, 0.1755, 0.2144], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0116, -0.0069,  0.0581, -0.0718,  0.0031],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1807, 0.1825, 0.1887, 0.1998, 0.2483], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0191, -0.0235, -0.0255, -0.0324, -0.0137]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25122732 0.20671216 0.1933007  0.17298885 0.17577097]
np_weight_alpha[1] [0.20685814 0.23535876 0.19160292 0.18344988 0.18273033]
np_weight_alpha[2] [0.19477722 0.19188333 0.23156403 0.1907112  0.19106424]
np_weight_alpha[3] [0.17210798 0.18256813 0.1871765  0.2495722  0.20857522]
np_weight_alpha[4] [0.17712282 0.18258816 0.19033545 0.2082482  0.24170534]
-------------Round number:  652  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.5198412698412699
client Accurancy:  0.49206349206349204
client Accurancy:  0.4603174603174603
client Accurancy:  0.4007936507936508
Average Global Accurancy:  0.4626984126984127
Average Global Trainning Accurancy:  0.7098639455782313
Average Global Trainning Loss:  0.7915651074883078
All users are selected
model: 0 tensor([0.2512, 0.2067, 0.1933, 0.1730, 0.1758], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0003, -0.0163, -0.0009, -0.0226, -0.0155],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2069, 0.2354, 0.1916, 0.1834, 0.1827], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0370, -0.0267, -0.0237, -0.0381, -0.0327],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1948, 0.1919, 0.2316, 0.1907, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0290, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1195, 0.1161, 0.0790, 0.1084, 0.1156],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1721, 0.1826, 0.1872, 0.2496, 0.2086], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0152, -0.0105,  0.0114, -0.0029],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1771, 0.1826, 0.1903, 0.2082, 0.2417], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0596, -0.0580, -0.0496, -0.0532, -0.0637]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2425654  0.21093488 0.18261264 0.18389122 0.1799958 ]
np_weight_alpha[1] [0.21163557 0.2318626  0.18353884 0.1893087  0.18365432]
np_weight_alpha[2] [0.19168355 0.18958057 0.23991789 0.18991734 0.18890066]
np_weight_alpha[3] [0.18481334 0.1898005  0.18973373 0.2323555  0.20329688]
np_weight_alpha[4] [0.17756638 0.18219481 0.1878146  0.20615686 0.2462673 ]
-------------Round number:  653  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5317460317460317
client Accurancy:  0.49206349206349204
client Accurancy:  0.3968253968253968
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.704421768707483
Average Global Trainning Loss:  0.8314128434576956
All users are selected
model: 0 tensor([0.2426, 0.2109, 0.1826, 0.1839, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0291, 0.0319, 0.0119, 0.0229, 0.0238],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2116, 0.2319, 0.1835, 0.1893, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0194,  0.0128, -0.0013,  0.0098,  0.0124],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1917, 0.1896, 0.2399, 0.1899, 0.1889], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0083, -0.0112,  0.0059, -0.0065, -0.0079],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1848, 0.1898, 0.1897, 0.2324, 0.2033], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0135, -0.0137, -0.0145, -0.0117, -0.0137],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1776, 0.1822, 0.1878, 0.2062, 0.2463], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0184, -0.0156, -0.0193, -0.0132, -0.0128]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23987661 0.20185827 0.19367458 0.1844876  0.18010297]
np_weight_alpha[1] [0.20218666 0.23117664 0.19480415 0.1897499  0.18208267]
np_weight_alpha[2] [0.20476629 0.21805069 0.18298133 0.19415252 0.20004918]
np_weight_alpha[3] [0.18476644 0.18968546 0.19035111 0.23227294 0.20292406]
np_weight_alpha[4] [0.17983402 0.18146317 0.19014673 0.20206888 0.24648723]
-------------Round number:  654  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5396825396825397
client Accurancy:  0.4365079365079365
client Accurancy:  0.40476190476190477
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.6914965986394558
Average Global Trainning Loss:  0.8457997017166241
All users are selected
model: 0 tensor([0.2399, 0.2019, 0.1937, 0.1845, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0405, 0.0408, 0.0419, 0.0437, 0.0465],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2022, 0.2312, 0.1948, 0.1897, 0.1821], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0173, 0.0190, 0.0221, 0.0191, 0.0166],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2048, 0.2181, 0.1830, 0.1942, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0128,  0.0037, -0.0705, -0.0236, -0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1848, 0.1897, 0.1904, 0.2323, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0222, -0.0232, -0.0270, -0.0199, -0.0251],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1798, 0.1815, 0.1901, 0.2021, 0.2465], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0126, -0.0188, -0.0181, -0.0184, -0.0118]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24511185 0.20241879 0.19318385 0.1828418  0.17644374]
np_weight_alpha[1] [0.20297512 0.23270649 0.19099706 0.18903892 0.18428242]
np_weight_alpha[2] [0.19331305 0.19014157 0.2313165  0.19344656 0.19178236]
np_weight_alpha[3] [0.18355529 0.18908204 0.19335589 0.23010199 0.20390487]
np_weight_alpha[4] [0.1765784  0.18368135 0.19108161 0.20315945 0.24549921]
-------------Round number:  655  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5198412698412699
client Accurancy:  0.4722222222222222
client Accurancy:  0.4365079365079365
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.7095238095238096
Average Global Trainning Loss:  0.8041326198448129
All users are selected
model: 0 tensor([0.2451, 0.2024, 0.1932, 0.1828, 0.1764], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0347, 0.0194, 0.0290, 0.0261, 0.0250],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2030, 0.2327, 0.1910, 0.1890, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0004, 0.0129, 0.0055, 0.0078, 0.0106],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1933, 0.1901, 0.2313, 0.1934, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0078, -0.0129, -0.0071, -0.0122, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1836, 0.1891, 0.1934, 0.2301, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0052, -0.0049, -0.0075, -0.0032, -0.0055],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1766, 0.1837, 0.1911, 0.2032, 0.2455], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0165, -0.0199, -0.0199, -0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23947965 0.208823   0.1901258  0.1831855  0.17838602]
np_weight_alpha[1] [0.24027091 0.20418525 0.1994724  0.18619125 0.1698802 ]
np_weight_alpha[2] [0.19073829 0.19256285 0.2297922  0.19509922 0.19180751]
np_weight_alpha[3] [0.18371612 0.18723509 0.20394352 0.22047555 0.20462972]
np_weight_alpha[4] [0.17803138 0.1808272  0.19088237 0.20268859 0.24757043]
-------------Round number:  656  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5198412698412699
client Accurancy:  0.49206349206349204
client Accurancy:  0.4007936507936508
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.7037414965986395
Average Global Trainning Loss:  0.836921619233631
All users are selected
model: 0 tensor([0.2395, 0.2088, 0.1901, 0.1832, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0045, 0.0093, 0.0026, 0.0038, 0.0014],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2403, 0.2042, 0.1995, 0.1862, 0.1699], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0240, -0.0441, -0.0062, -0.0143, -0.0282],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1907, 0.1926, 0.2298, 0.1951, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0341, 0.0355, 0.0284, 0.0401, 0.0383],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1837, 0.1872, 0.2039, 0.2205, 0.2046], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0072,  0.0079,  0.0210, -0.0121,  0.0109],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1780, 0.1808, 0.1909, 0.2027, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0374, -0.0368, -0.0321, -0.0320, -0.0320]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24126333 0.18366684 0.19755352 0.1851747  0.19234167]
np_weight_alpha[1] [0.20165011 0.23664702 0.19125977 0.1863323  0.18411076]
np_weight_alpha[2] [0.19119129 0.19164975 0.23920605 0.18967706 0.1882758 ]
np_weight_alpha[3] [0.18310788 0.18571109 0.18911317 0.24241395 0.19965388]
np_weight_alpha[4] [0.18088643 0.18285544 0.18787007 0.19912344 0.2492646 ]
-------------Round number:  657  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5277777777777778
client Accurancy:  0.4444444444444444
client Accurancy:  0.4166666666666667
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4396825396825397
Average Global Trainning Accurancy:  0.6877551020408164
Average Global Trainning Loss:  0.8498435507015306
All users are selected
model: 0 tensor([0.2413, 0.1837, 0.1976, 0.1852, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0333, 0.0133, 0.0335, 0.0435, 0.0509],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2366, 0.1913, 0.1863, 0.1841], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0081, 0.0154, 0.0101, 0.0100, 0.0103],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1912, 0.1916, 0.2392, 0.1897, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0088, -0.0011,  0.0029,  0.0011,  0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1831, 0.1857, 0.1891, 0.2424, 0.1997], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0097, -0.0171, -0.0146, -0.0118, -0.0257],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1809, 0.1829, 0.1879, 0.1991, 0.2493], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0248, -0.0302, -0.0260, -0.0388, -0.0224]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24590729 0.20378798 0.19748786 0.17651922 0.17629771]
np_weight_alpha[1] [0.20355082 0.2337953  0.19136399 0.18680064 0.1844893 ]
np_weight_alpha[2] [0.23258372 0.19251879 0.22068344 0.18031083 0.17390327]
np_weight_alpha[3] [0.17714946 0.18627124 0.18714547 0.24089855 0.20853528]
np_weight_alpha[4] [0.17712513 0.18379964 0.1845493  0.2081498  0.24637608]
-------------Round number:  658  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5198412698412699
client Accurancy:  0.4444444444444444
client Accurancy:  0.46825396825396826
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.4579365079365079
Average Global Trainning Accurancy:  0.726530612244898
Average Global Trainning Loss:  0.7718283309417517
All users are selected
model: 0 tensor([0.2459, 0.2038, 0.1975, 0.1765, 0.1763], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0175, 0.0033, 0.0217, 0.0036, 0.0075],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2036, 0.2338, 0.1914, 0.1868, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0180, -0.0048, -0.0081, -0.0120, -0.0081],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2326, 0.1925, 0.2207, 0.1803, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0749, 0.0309, 0.0110, 0.0091, 0.0059],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1771, 0.1863, 0.1871, 0.2409, 0.2085], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0043, 0.0084, 0.0017, 0.0226, 0.0184],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1771, 0.1838, 0.1845, 0.2081, 0.2464], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0405, -0.0369, -0.0464, -0.0316, -0.0355]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24166077 0.21010585 0.18572961 0.18312466 0.17937921]
np_weight_alpha[1] [0.21085781 0.22964011 0.18880221 0.1882504  0.18244953]
np_weight_alpha[2] [0.18383595 0.1874685  0.238448   0.19669324 0.19355436]
np_weight_alpha[3] [0.18393034 0.18865512 0.1959216  0.23093641 0.20055658]
np_weight_alpha[4] [0.17918214 0.18200998 0.19154984 0.20014119 0.24711682]
-------------Round number:  659  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5317460317460317
client Accurancy:  0.49206349206349204
client Accurancy:  0.4126984126984127
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.7023809523809523
Average Global Trainning Loss:  0.8328257865646258
All users are selected
model: 0 tensor([0.2417, 0.2101, 0.1857, 0.1831, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0337, 0.0368, 0.0209, 0.0284, 0.0296],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2109, 0.2296, 0.1888, 0.1883, 0.1824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0237, 0.0158, 0.0095, 0.0143, 0.0165],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1838, 0.1875, 0.2384, 0.1967, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0271, -0.0238, -0.0053, -0.0100, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1887, 0.1959, 0.2309, 0.2006], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0182, -0.0188, -0.0128, -0.0166, -0.0217],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1792, 0.1820, 0.1915, 0.2001, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0122, -0.0116, -0.0167, -0.0084]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2403195  0.20210144 0.19374637 0.18415976 0.17967285]
np_weight_alpha[1] [0.20244958 0.23130949 0.19464451 0.18952128 0.18207513]
np_weight_alpha[2] [0.19466837 0.19503632 0.22945344 0.1906651  0.19017677]
np_weight_alpha[3] [0.18442924 0.18941464 0.19067198 0.23151027 0.20397389]
np_weight_alpha[4] [0.1792881  0.18136984 0.18972488 0.2031701  0.24644707]
-------------Round number:  660  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5357142857142857
client Accurancy:  0.42857142857142855
client Accurancy:  0.42063492063492064
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.6969387755102041
Average Global Trainning Loss:  0.8419707629145409
All users are selected
model: 0 tensor([0.2403, 0.2021, 0.1937, 0.1842, 0.1797], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0251, 0.0246, 0.0304, 0.0243, 0.0285],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2024, 0.2313, 0.1946, 0.1895, 0.1821], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0037, 0.0051, 0.0129, 0.0028, 0.0019],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1947, 0.1950, 0.2295, 0.1907, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0532, 0.0564, 0.0354, 0.0481, 0.0486],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1894, 0.1907, 0.2315, 0.2040], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0490, -0.0494, -0.0470, -0.0431, -0.0455],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1793, 0.1814, 0.1897, 0.2032, 0.2464], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0319, -0.0374, -0.0334, -0.0330, -0.0310]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2448103  0.20279431 0.1889401  0.1856927  0.1777626 ]
np_weight_alpha[1] [0.20890728 0.23346816 0.15980947 0.2002778  0.19753726]
np_weight_alpha[2] [0.18890841 0.186299   0.24583578 0.18994711 0.18900967]
np_weight_alpha[3] [0.18649717 0.19159068 0.19052015 0.22923708 0.20215483]
np_weight_alpha[4] [0.1777571  0.18460976 0.188693   0.20140469 0.2475354 ]
-------------Round number:  661  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5277777777777778
client Accurancy:  0.46825396825396826
client Accurancy:  0.4246031746031746
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.7122448979591837
Average Global Trainning Loss:  0.7953155725180697
All users are selected
model: 0 tensor([0.2448, 0.2028, 0.1889, 0.1857, 0.1778], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0317, 0.0168, 0.0223, 0.0258, 0.0234],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2089, 0.2335, 0.1598, 0.2003, 0.1975], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0012,  0.0090, -0.0304,  0.0135,  0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1889, 0.1863, 0.2458, 0.1899, 0.1890], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0039, 0.0007, 0.0175, 0.0016, 0.0048],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1865, 0.1916, 0.1905, 0.2292, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0057, -0.0064, -0.0120, -0.0070, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1778, 0.1846, 0.1887, 0.2014, 0.2475], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0238, -0.0211, -0.0245, -0.0266, -0.0202]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23935162 0.20896511 0.18977597 0.18345298 0.17845432]
np_weight_alpha[1] [0.2095759  0.22791757 0.1919987  0.1887706  0.18173721]
np_weight_alpha[2] [0.19789754 0.21140824 0.18692748 0.21037748 0.19338918]
np_weight_alpha[3] [0.17356035 0.18116742 0.20744076 0.22238585 0.21544565]
np_weight_alpha[4] [0.17812882 0.18186699 0.18875515 0.2033285  0.24792054]
-------------Round number:  662  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5158730158730159
client Accurancy:  0.49603174603174605
client Accurancy:  0.4126984126984127
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4515873015873016
Average Global Trainning Accurancy:  0.7074829931972789
Average Global Trainning Loss:  0.8304824517697704
All users are selected
model: 0 tensor([0.2394, 0.2090, 0.1898, 0.1835, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0343, 0.0389, 0.0275, 0.0316, 0.0312],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2096, 0.2279, 0.1920, 0.1888, 0.1817], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0233, 0.0154, 0.0129, 0.0144, 0.0162],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1979, 0.2114, 0.1869, 0.2104, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0137, -0.0004, -0.0596,  0.0042, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1736, 0.1812, 0.2074, 0.2224, 0.2154], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0359, -0.0344, -0.0066, -0.0323, -0.0126],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1781, 0.1819, 0.1888, 0.2033, 0.2479], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0102, -0.0085, -0.0109, -0.0094, -0.0028]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24024051 0.20166703 0.19399409 0.18411353 0.17998482]
np_weight_alpha[1] [0.20203494 0.23041484 0.19500148 0.19036703 0.18218175]
np_weight_alpha[2] [0.1943094  0.19453187 0.23141937 0.18912378 0.19061558]
np_weight_alpha[3] [0.1850354  0.19073421 0.18929327 0.23192571 0.20301141]
np_weight_alpha[4] [0.18730876 0.18268935 0.20094316 0.20814282 0.22091593]
-------------Round number:  663  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5357142857142857
client Accurancy:  0.4365079365079365
client Accurancy:  0.4166666666666667
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.6931972789115646
Average Global Trainning Loss:  0.8634017425329507
All users are selected
model: 0 tensor([0.2402, 0.2017, 0.1940, 0.1841, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0285, 0.0283, 0.0351, 0.0458, 0.0377],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2020, 0.2304, 0.1950, 0.1904, 0.1822], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0064, 0.0095, 0.0180, 0.0181, 0.0119],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1945, 0.2314, 0.1891, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0113, 0.0156, 0.0030, 0.0121, 0.0125],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1907, 0.1893, 0.2319, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0208, -0.0268, -0.0314, -0.0436, -0.0412],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1873, 0.1827, 0.2009, 0.2081, 0.2209], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0166, -0.0272, -0.0145, -0.0303, -0.0466]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.25044483 0.20677677 0.1923136  0.17350933 0.17695546]
np_weight_alpha[1] [0.2076832  0.23559664 0.18914776 0.18469545 0.18287694]
np_weight_alpha[2] [0.1929933  0.18908691 0.24223568 0.18736367 0.18832052]
np_weight_alpha[3] [0.17345019 0.18391086 0.1867901  0.24573493 0.21011396]
np_weight_alpha[4] [0.17693026 0.18230043 0.18739456 0.21022247 0.24315232]
-------------Round number:  664  -------------
client Accurancy:  0.4365079365079365
client Accurancy:  0.5238095238095238
client Accurancy:  0.4801587301587302
client Accurancy:  0.46825396825396826
client Accurancy:  0.3888888888888889
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.7217687074829932
Average Global Trainning Loss:  0.7626265545280613
All users are selected
model: 0 tensor([0.2504, 0.2068, 0.1923, 0.1735, 0.1770], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0034, -0.0122,  0.0018, -0.0186, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2077, 0.2356, 0.1891, 0.1847, 0.1829], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0335, -0.0233, -0.0244, -0.0352, -0.0312],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1891, 0.2422, 0.1874, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0287, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1070, 0.1024, 0.0788, 0.0952, 0.1024],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1735, 0.1839, 0.1868, 0.2457, 0.2101], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0181, -0.0132, -0.0091,  0.0073,  0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1769, 0.1823, 0.1874, 0.2102, 0.2432], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0571, -0.0558, -0.0492, -0.0467, -0.0594]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.19451475 0.23098326 0.15146217 0.22976285 0.19327699]
np_weight_alpha[1] [0.21119165 0.23070784 0.1838862  0.18986624 0.18434808]
np_weight_alpha[2] [0.18988915 0.18708394 0.24984944 0.1868199  0.18635757]
np_weight_alpha[3] [0.23272577 0.21732825 0.19871868 0.17732544 0.17390193]
np_weight_alpha[4] [0.17743069 0.18202475 0.18549292 0.20740654 0.24764507]
-------------Round number:  665  -------------
client Accurancy:  0.44841269841269843
client Accurancy:  0.5198412698412699
client Accurancy:  0.4880952380952381
client Accurancy:  0.3531746031746032
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.6860544217687075
Average Global Trainning Loss:  0.8955295692495748
All users are selected
model: 0 tensor([0.1945, 0.2310, 0.1515, 0.2298, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0301,  0.0427, -0.0281,  0.0657,  0.0301],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2112, 0.2307, 0.1839, 0.1899, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0101,  0.0026, -0.0090,  0.0064,  0.0046],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1899, 0.1871, 0.2498, 0.1868, 0.1864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0249, -0.0293,  0.0008, -0.0243, -0.0259],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2327, 0.2173, 0.1987, 0.1773, 0.1739], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0793,  0.0591,  0.0349, -0.0401, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1774, 0.1820, 0.1855, 0.2074, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0286, -0.0259, -0.0312, -0.0186, -0.0208]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24354665 0.2030339  0.19438663 0.1799226  0.17911023]
np_weight_alpha[1] [0.17442453 0.23246156 0.24569528 0.17206123 0.17535739]
np_weight_alpha[2] [0.19361493 0.19517659 0.2298689  0.19009915 0.19124039]
np_weight_alpha[3] [0.17891684 0.18322732 0.18846476 0.24630551 0.20308551]
np_weight_alpha[4] [0.18066172 0.18240136 0.19050348 0.19958703 0.2468465 ]
-------------Round number:  666  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5277777777777778
client Accurancy:  0.44047619047619047
client Accurancy:  0.42857142857142855
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.7010204081632653
Average Global Trainning Loss:  0.8192719959077381
All users are selected
model: 0 tensor([0.2435, 0.2030, 0.1944, 0.1799, 0.1791], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0420, 0.0382, 0.0348, 0.0334, 0.0390],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1744, 0.2325, 0.2457, 0.1721, 0.1754], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0259, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0141,  0.0158,  0.0715, -0.0037,  0.0035],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1952, 0.2299, 0.1901, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0041, 0.0118, 0.0014, 0.0066, 0.0146],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1789, 0.1832, 0.1885, 0.2463, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0431, -0.0445, -0.0407, -0.0197, -0.0407],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1807, 0.1824, 0.1905, 0.1996, 0.2468], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0186, -0.0251, -0.0158, -0.0288, -0.0208]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24161124 0.20113629 0.19593306 0.18353333 0.17778605]
np_weight_alpha[1] [0.20244017 0.2330453  0.18838237 0.18988013 0.18625204]
np_weight_alpha[2] [0.20849647 0.17345938 0.2672388  0.1923405  0.15846486]
np_weight_alpha[3] [0.18428384 0.18966636 0.19097315 0.22960018 0.20547648]
np_weight_alpha[4] [0.1772054  0.1847033  0.18358809 0.20499893 0.2495043 ]
-------------Round number:  667  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5277777777777778
client Accurancy:  0.44841269841269843
client Accurancy:  0.4365079365079365
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.7023809523809523
Average Global Trainning Loss:  0.8124422034438775
All users are selected
model: 0 tensor([0.2416, 0.2011, 0.1959, 0.1835, 0.1778], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0274, 0.0148, 0.0328, 0.0232, 0.0236],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2024, 0.2330, 0.1884, 0.1899, 0.1863], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070,  0.0076, -0.0015,  0.0016,  0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2085, 0.1735, 0.2672, 0.1923, 0.1585], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0354, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0412,  0.0019,  0.0554,  0.0154, -0.0164],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1897, 0.1910, 0.2296, 0.2055], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0171, -0.0168, -0.0219, -0.0126, -0.0153],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1772, 0.1847, 0.1836, 0.2050, 0.2495], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0315, -0.0273, -0.0393, -0.0292, -0.0233]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24104361 0.20969747 0.1867242  0.18405685 0.17847791]
np_weight_alpha[1] [0.24723053 0.200089   0.20088391 0.18704149 0.16475508]
np_weight_alpha[2] [0.18661404 0.19058461 0.23315927 0.19583552 0.19380651]
np_weight_alpha[3] [0.18477464 0.18947452 0.1956194  0.22658166 0.20354988]
np_weight_alpha[4] [0.17843786 0.18140951 0.1915442  0.20271254 0.24589582]
-------------Round number:  668  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5198412698412699
client Accurancy:  0.4801587301587302
client Accurancy:  0.4126984126984127
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.7119047619047619
Average Global Trainning Loss:  0.8147994891315902
All users are selected
model: 0 tensor([0.2410, 0.2097, 0.1867, 0.1841, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0352, 0.0407, 0.0261, 0.0334, 0.0328],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2472, 0.2001, 0.2009, 0.1870, 0.1648], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0610, -0.0155,  0.0209,  0.0107, -0.0044],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1866, 0.1906, 0.2332, 0.1958, 0.1938], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0255, -0.0222, -0.0128, -0.0135, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1848, 0.1895, 0.1956, 0.2266, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0223, -0.0177, -0.0242, -0.0225],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1784, 0.1814, 0.1915, 0.2027, 0.2459], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0108, -0.0110, -0.0093, -0.0117, -0.0070]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24220845 0.20148744 0.1931893  0.18382697 0.17928784]
np_weight_alpha[1] [0.20009665 0.23172684 0.19397311 0.19048165 0.1837217 ]
np_weight_alpha[2] [0.19405182 0.19463323 0.22975276 0.1913202  0.1902419 ]
np_weight_alpha[3] [0.18420567 0.18982685 0.19130829 0.23073757 0.20392159]
np_weight_alpha[4] [0.18246716 0.18609709 0.18763897 0.21093383 0.23286293]
-------------Round number:  669  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.4246031746031746
client Accurancy:  0.4246031746031746
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.6979591836734694
Average Global Trainning Loss:  0.8439385031356292
All users are selected
model: 0 tensor([0.2422, 0.2015, 0.1932, 0.1838, 0.1793], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0461, 0.0430, 0.0455, 0.0421, 0.0471],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2001, 0.2317, 0.1940, 0.1905, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0206, 0.0248, 0.0269, 0.0230, 0.0234],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1946, 0.2298, 0.1913, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0200, -0.0238, -0.0261, -0.0274],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1898, 0.1913, 0.2307, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0318, -0.0308, -0.0315, -0.0263, -0.0263],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1825, 0.1861, 0.1876, 0.2109, 0.2329], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0098, -0.0134, -0.0218, -0.0056, -0.0276]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24379104 0.2019572  0.19135065 0.18575904 0.17714207]
np_weight_alpha[1] [0.20259541 0.23228735 0.1903504  0.19070917 0.18405776]
np_weight_alpha[2] [0.19185787 0.1903907  0.23130952 0.19310386 0.19333808]
np_weight_alpha[3] [0.18653871 0.19095102 0.19307742 0.22910117 0.20033163]
np_weight_alpha[4] [0.17665009 0.18313006 0.19242965 0.19941628 0.24837396]
-------------Round number:  670  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5238095238095238
client Accurancy:  0.4642857142857143
client Accurancy:  0.42857142857142855
client Accurancy:  0.373015873015873
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.7166666666666667
Average Global Trainning Loss:  0.7801282817814625
All users are selected
model: 0 tensor([0.2438, 0.2020, 0.1914, 0.1858, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0077, -0.0076,  0.0111,  0.0030, -0.0009],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2026, 0.2323, 0.1904, 0.1907, 0.1841], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0292, -0.0163, -0.0133, -0.0191, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1919, 0.1904, 0.2313, 0.1931, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0289, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1237, 0.1211, 0.0860, 0.1185, 0.1244],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1865, 0.1910, 0.1931, 0.2291, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0478, -0.0484, -0.0454, -0.0488, -0.0551],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1767, 0.1831, 0.1924, 0.1994, 0.2484], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0527, -0.0498, -0.0398, -0.0553, -0.0453]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.21622194 0.2570053  0.15277717 0.18187742 0.19211811]
np_weight_alpha[1] [0.21186116 0.23041879 0.18398568 0.18977296 0.18396136]
np_weight_alpha[2] [0.18944888 0.18856089 0.23963678 0.19163688 0.19071649]
np_weight_alpha[3] [0.18514906 0.18990763 0.18902248 0.23019452 0.2057263 ]
np_weight_alpha[4] [0.18027033 0.18352355 0.18288592 0.2046515  0.2486687 ]
-------------Round number:  671  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5198412698412699
client Accurancy:  0.49206349206349204
client Accurancy:  0.4126984126984127
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.7129251700680272
Average Global Trainning Loss:  0.8129921011373299
All users are selected
model: 0 tensor([0.2162, 0.2570, 0.1528, 0.1819, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0307, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0072,  0.0841, -0.0138,  0.0275,  0.0414],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2119, 0.2304, 0.1840, 0.1898, 0.1840], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0232, 0.0162, 0.0028, 0.0146, 0.0168],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1894, 0.1886, 0.2396, 0.1916, 0.1907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0166, -0.0186, -0.0003, -0.0094, -0.0121],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1899, 0.1890, 0.2302, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0184, -0.0197, -0.0204, -0.0218, -0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1803, 0.1835, 0.1829, 0.2047, 0.2487], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0137, -0.0120, -0.0226, -0.0130, -0.0067]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24084267 0.20110986 0.19477977 0.18330754 0.17996016]
np_weight_alpha[1] [0.20272456 0.2303851  0.19526696 0.18956265 0.18206073]
np_weight_alpha[2] [0.19422339 0.19526365 0.23002367 0.18938048 0.19110878]
np_weight_alpha[3] [0.1837717  0.18941844 0.18926069 0.23418811 0.20336103]
np_weight_alpha[4] [0.18013656 0.18149942 0.1907922  0.20273477 0.24483708]
-------------Round number:  672  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5357142857142857
client Accurancy:  0.43253968253968256
client Accurancy:  0.43253968253968256
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7119047619047619
Average Global Trainning Loss:  0.8101332476349915
All users are selected
model: 0 tensor([0.2408, 0.2011, 0.1948, 0.1833, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0471, 0.0441, 0.0435, 0.0463, 0.0483],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2027, 0.2304, 0.1953, 0.1896, 0.1821], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0224, 0.0227, 0.0260, 0.0222, 0.0189],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1953, 0.2300, 0.1894, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0153, -0.0088, -0.0154, -0.0144, -0.0074],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1838, 0.1894, 0.1893, 0.2342, 0.2034], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0398, -0.0411, -0.0430, -0.0344, -0.0452],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1801, 0.1815, 0.1908, 0.2027, 0.2448], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0193, -0.0109, -0.0205, -0.0133]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24229549 0.20165317 0.19596708 0.18246956 0.17761466]
np_weight_alpha[1] [0.20207684 0.23170349 0.19127825 0.18947694 0.18546452]
np_weight_alpha[2] [0.19650902 0.1912909  0.23518002 0.19096652 0.18605362]
np_weight_alpha[3] [0.18299712 0.18939975 0.1911265  0.22917965 0.2072969 ]
np_weight_alpha[4] [0.17743692 0.18466906 0.18545811 0.2065351  0.24590078]
-------------Round number:  673  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5317460317460317
client Accurancy:  0.44841269841269843
client Accurancy:  0.4365079365079365
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.7207482993197278
Average Global Trainning Loss:  0.7824300960618622
All users are selected
model: 0 tensor([0.2423, 0.2017, 0.1960, 0.1825, 0.1776], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0252, 0.0120, 0.0316, 0.0189, 0.0196],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2021, 0.2317, 0.1913, 0.1895, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-1.1528e-02,  1.9144e-03, -5.1854e-06, -3.0936e-03,  7.4581e-04],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1965, 0.1913, 0.2352, 0.1910, 0.1861], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0557, 0.0474, 0.0405, 0.0410, 0.0395],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1830, 0.1894, 0.1911, 0.2292, 0.2073], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0334, -0.0322, -0.0348, -0.0277, -0.0282],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1774, 0.1847, 0.1855, 0.2065, 0.2459], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0346, -0.0304, -0.0383, -0.0304, -0.0292]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24100563 0.21007241 0.18515284 0.18443364 0.1793354 ]
np_weight_alpha[1] [0.25147426 0.20839132 0.17862375 0.19123174 0.17027894]
np_weight_alpha[2] [0.18517606 0.18800002 0.24239978 0.19387282 0.19055125]
np_weight_alpha[3] [0.1851836  0.19009    0.19424723 0.22670095 0.20377827]
np_weight_alpha[4] [0.17922843 0.18202232 0.19004294 0.20304504 0.24566124]
-------------Round number:  674  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5158730158730159
client Accurancy:  0.4880952380952381
client Accurancy:  0.4246031746031746
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.7187074829931973
Average Global Trainning Loss:  0.7977641202965561
All users are selected
model: 0 tensor([0.2410, 0.2101, 0.1852, 0.1844, 0.1793], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0129, 0.0197, 0.0016, 0.0157, 0.0086],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2515, 0.2084, 0.1786, 0.1912, 0.1703], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0555, -0.0275, -0.0131,  0.0128, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1852, 0.1880, 0.2424, 0.1939, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0475, -0.0451, -0.0218, -0.0324, -0.0394],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1852, 0.1901, 0.1942, 0.2267, 0.2038], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0234, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0610, 0.0637, 0.0610, 0.0339, 0.0598],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1792, 0.1820, 0.1900, 0.2030, 0.2457], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0390, -0.0339, -0.0387, -0.0323, -0.0353]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2426054  0.20085484 0.19413573 0.18031871 0.18208525]
np_weight_alpha[1] [0.19913587 0.2430581  0.19491124 0.18237972 0.18051507]
np_weight_alpha[2] [0.19504352 0.19544354 0.22832318 0.18883365 0.1923562 ]
np_weight_alpha[3] [0.18410303 0.18817335 0.19263694 0.23280534 0.20228133]
np_weight_alpha[4] [0.18177916 0.17969884 0.19165277 0.19806279 0.24880645]
-------------Round number:  675  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5119047619047619
client Accurancy:  0.4523809523809524
client Accurancy:  0.4166666666666667
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.7129251700680272
Average Global Trainning Loss:  0.7966243821747448
All users are selected
model: 0 tensor([0.2426, 0.2009, 0.1941, 0.1803, 0.1821], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0439, 0.0384, 0.0366, 0.0420, 0.0456],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1991, 0.2431, 0.1949, 0.1824, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0161, 0.0334, 0.0235, 0.0137, 0.0159],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1950, 0.1954, 0.2283, 0.1888, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0094, -0.0021, -0.0119, -0.0054,  0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1841, 0.1882, 0.1926, 0.2328, 0.2023], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0359, -0.0314, -0.0365, -0.0422],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1818, 0.1797, 0.1917, 0.1981, 0.2488], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0178, -0.0269, -0.0158, -0.0328, -0.0154]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2426998  0.20248204 0.19755296 0.17942767 0.17783748]
np_weight_alpha[1] [0.20288116 0.23179501 0.19144544 0.18886994 0.18500836]
np_weight_alpha[2] [0.21151079 0.17675461 0.2659756  0.18585221 0.1599068 ]
np_weight_alpha[3] [0.1794709  0.18816629 0.18808363 0.23591964 0.20835951]
np_weight_alpha[4] [0.17772166 0.18408258 0.18486075 0.20782098 0.24551393]
-------------Round number:  676  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5119047619047619
client Accurancy:  0.4444444444444444
client Accurancy:  0.4523809523809524
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.7278911564625851
Average Global Trainning Loss:  0.7521725193983844
All users are selected
model: 0 tensor([0.2427, 0.2025, 0.1976, 0.1794, 0.1778], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0265, 0.0138, 0.0334, 0.0169, 0.0205],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2029, 0.2318, 0.1914, 0.1889, 0.1850], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0087,  0.0039,  0.0016, -0.0018,  0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2115, 0.1768, 0.2660, 0.1859, 0.1599], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0342, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0528,  0.0145,  0.0565,  0.0166, -0.0065],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1795, 0.1882, 0.1881, 0.2359, 0.2084], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0235, -0.0201, -0.0253, -0.0078, -0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1777, 0.1841, 0.1849, 0.2078, 0.2455], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0345, -0.0311, -0.0392, -0.0285, -0.0299]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24079052 0.20991357 0.18561512 0.18419854 0.17948233]
np_weight_alpha[1] [0.24673991 0.20799437 0.17986561 0.19323038 0.17216973]
np_weight_alpha[2] [0.18518761 0.18851188 0.23867823 0.19517517 0.19244702]
np_weight_alpha[3] [0.18506609 0.1900608  0.19500549 0.22696087 0.20290674]
np_weight_alpha[4] [0.17932267 0.18200509 0.19028796 0.20235074 0.24603353]
-------------Round number:  677  -------------
client Accurancy:  0.48412698412698413
client Accurancy:  0.5158730158730159
client Accurancy:  0.4801587301587302
client Accurancy:  0.4166666666666667
client Accurancy:  0.36904761904761907
Average Global Accurancy:  0.4531746031746032
Average Global Trainning Accurancy:  0.7204081632653061
Average Global Trainning Loss:  0.7916370210193452
All users are selected
model: 0 tensor([0.2408, 0.2099, 0.1856, 0.1842, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0221, 0.0273, 0.0101, 0.0234, 0.0184],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2467, 0.2080, 0.1799, 0.1932, 0.1722], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0338, -0.0363, -0.0287, -0.0036, -0.0232],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1852, 0.1885, 0.2387, 0.1952, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0465, -0.0439, -0.0261, -0.0271, -0.0342],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1901, 0.1950, 0.2270, 0.2029], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0225, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0582, 0.0589, 0.0619, 0.0340, 0.0557],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1793, 0.1820, 0.1903, 0.2024, 0.2460], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0297, -0.0297, -0.0268, -0.0260]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24158792 0.20175248 0.19470637 0.18083546 0.18111779]
np_weight_alpha[1] [0.20051697 0.23455888 0.19624962 0.18498813 0.1836864 ]
np_weight_alpha[2] [0.19558494 0.19632412 0.23081748 0.1865619  0.19071157]
np_weight_alpha[3] [0.18414244 0.18865003 0.19279692 0.23259872 0.201812  ]
np_weight_alpha[4] [0.18095565 0.18255581 0.19035926 0.19925609 0.2468732 ]
-------------Round number:  678  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5238095238095238
client Accurancy:  0.44047619047619047
client Accurancy:  0.42063492063492064
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.710204081632653
Average Global Trainning Loss:  0.7990452772906037
All users are selected
model: 0 tensor([0.2416, 0.2018, 0.1947, 0.1808, 0.1811], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0331, 0.0289, 0.0379, 0.0242, 0.0339],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2005, 0.2346, 0.1962, 0.1850, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0052, 0.0130, 0.0185, 0.0017, 0.0073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1956, 0.1963, 0.2308, 0.1866, 0.1907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0471, 0.0492, 0.0261, 0.0360, 0.0403],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1887, 0.1928, 0.2326, 0.2018], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0561, -0.0558, -0.0493, -0.0460, -0.0532],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1810, 0.1826, 0.1904, 0.1993, 0.2469], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0272, -0.0323, -0.0290, -0.0332, -0.0253]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24294811 0.20327683 0.18762304 0.18738542 0.17876656]
np_weight_alpha[1] [0.219284   0.21406472 0.15382668 0.22170718 0.19111745]
np_weight_alpha[2] [0.18736939 0.1860411  0.24819955 0.18929066 0.18909925]
np_weight_alpha[3] [0.18484436 0.1889972  0.19170167 0.23313901 0.20131782]
np_weight_alpha[4] [0.17864059 0.18470047 0.18889657 0.2017305  0.24603184]
-------------Round number:  679  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5079365079365079
client Accurancy:  0.4722222222222222
client Accurancy:  0.43253968253968256
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.7248299319727891
Average Global Trainning Loss:  0.7685905612244898
All users are selected
model: 0 tensor([0.2429, 0.2033, 0.1876, 0.1874, 0.1788], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0377, 0.0244, 0.0258, 0.0338, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2193, 0.2141, 0.1538, 0.2217, 0.1911], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0200, -0.0015, -0.0305,  0.0431,  0.0201],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1874, 0.1860, 0.2482, 0.1893, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115, -0.0137,  0.0124, -0.0120, -0.0070],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1848, 0.1890, 0.1917, 0.2331, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0166, -0.0190, -0.0082, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1786, 0.1847, 0.1889, 0.2017, 0.2460], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0180, -0.0159, -0.0193, -0.0221, -0.0168]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23787536 0.20850663 0.19145736 0.18373492 0.17842579]
np_weight_alpha[1] [0.20906729 0.22685301 0.19405101 0.18850182 0.18152684]
np_weight_alpha[2] [0.19208206 0.19296159 0.23104149 0.19446273 0.18945214]
np_weight_alpha[3] [0.1842966  0.18960962 0.1944924  0.22670919 0.2048922 ]
np_weight_alpha[4] [0.17804365 0.18159966 0.18859929 0.20391372 0.2478437 ]
-------------Round number:  680  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5158730158730159
client Accurancy:  0.4722222222222222
client Accurancy:  0.42063492063492064
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7173469387755103
Average Global Trainning Loss:  0.8095013054049744
All users are selected
model: 0 tensor([0.2379, 0.2085, 0.1915, 0.1837, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0227, 0.0275, 0.0188, 0.0251, 0.0206],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2091, 0.2269, 0.1941, 0.1885, 0.1815], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0054, -0.0030, -0.0014,  0.0024, -0.0019],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1921, 0.1930, 0.2310, 0.1945, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0385, -0.0378, -0.0333, -0.0288, -0.0362],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1843, 0.1896, 0.1945, 0.2267, 0.2049], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0375, 0.0379, 0.0407, 0.0188, 0.0377],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1780, 0.1816, 0.1886, 0.2039, 0.2478], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0256, -0.0250, -0.0251, -0.0203, -0.0180]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24058169 0.20287731 0.19455108 0.18136379 0.1806261 ]
np_weight_alpha[1] [0.18289389 0.24668862 0.20104553 0.17805542 0.1913165 ]
np_weight_alpha[2] [0.19518697 0.19531342 0.23102519 0.18809003 0.19038443]
np_weight_alpha[3] [0.18099259 0.18549861 0.1874597  0.24565013 0.200399  ]
np_weight_alpha[4] [0.18054469 0.18319477 0.18983176 0.20007645 0.24635237]
-------------Round number:  681  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5317460317460317
client Accurancy:  0.43253968253968256
client Accurancy:  0.42857142857142855
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.7122448979591837
Average Global Trainning Loss:  0.8046571900244472
All users are selected
model: 0 tensor([0.2406, 0.2029, 0.1946, 0.1814, 0.1806], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0446, 0.0428, 0.0397, 0.0373, 0.0445],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1829, 0.2467, 0.2010, 0.1781, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0004,  0.0372,  0.0292,  0.0058,  0.0248],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1952, 0.1953, 0.2310, 0.1881, 0.1904], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0068, -0.0014, -0.0076, -0.0089, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1810, 0.1855, 0.1875, 0.2457, 0.2004], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0409, -0.0419, -0.0401, -0.0174, -0.0390],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1805, 0.1832, 0.1898, 0.2001, 0.2464], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0166, -0.0222, -0.0166, -0.0230, -0.0179]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24022308 0.20078802 0.19560151 0.18527357 0.17811383]
np_weight_alpha[1] [0.2020106  0.23028252 0.19079065 0.19118609 0.18573016]
np_weight_alpha[2] [0.20080346 0.17555264 0.24505176 0.20411056 0.17448159]
np_weight_alpha[3] [0.18599749 0.19119309 0.19134483 0.22849238 0.20297219]
np_weight_alpha[4] [0.17770371 0.18522364 0.18617797 0.20232864 0.24856599]
-------------Round number:  682  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5158730158730159
client Accurancy:  0.4444444444444444
client Accurancy:  0.42857142857142855
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44206349206349205
Average Global Trainning Accurancy:  0.7153061224489796
Average Global Trainning Loss:  0.7910492566167092
All users are selected
model: 0 tensor([0.2402, 0.2008, 0.1956, 0.1853, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0338, 0.0217, 0.0393, 0.0329, 0.0314],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2020, 0.2303, 0.1908, 0.1912, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0005, 0.0130, 0.0093, 0.0110, 0.0137],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.2008, 0.1756, 0.2451, 0.2041, 0.1745], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0070, -0.0215,  0.0098,  0.0014, -0.0261],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1860, 0.1912, 0.1913, 0.2285, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0091, -0.0162, -0.0076, -0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1777, 0.1852, 0.1862, 0.2023, 0.2486], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0217, -0.0330, -0.0262, -0.0185]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24068098 0.20988896 0.18725209 0.1836114  0.17856663]
np_weight_alpha[1] [0.2503937  0.21123837 0.19002628 0.18241048 0.16593115]
np_weight_alpha[2] [0.1877213  0.19079082 0.23101324 0.19625072 0.19422397]
np_weight_alpha[3] [0.18423733 0.1895     0.19653592 0.22673978 0.20298706]
np_weight_alpha[4] [0.17858402 0.18136933 0.1928823  0.20211543 0.2450489 ]
-------------Round number:  683  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.503968253968254
client Accurancy:  0.49206349206349204
client Accurancy:  0.4246031746031746
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.7289115646258504
Average Global Trainning Loss:  0.778240510071216
All users are selected
model: 0 tensor([0.2407, 0.2099, 0.1873, 0.1836, 0.1786], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0429, 0.0469, 0.0316, 0.0370, 0.0377],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2504, 0.2112, 0.1900, 0.1824, 0.1659], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0585, -0.0087,  0.0026, -0.0013, -0.0097],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1877, 0.1908, 0.2310, 0.1963, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0265, -0.0241, -0.0149, -0.0139, -0.0160],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1842, 0.1895, 0.1965, 0.2267, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0248, -0.0177, -0.0253, -0.0229],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1786, 0.1814, 0.1929, 0.2021, 0.2450], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0202, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0086, -0.0083, -0.0058, -0.0079, -0.0053]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23934351 0.201211   0.1939627  0.18533625 0.18014656]
np_weight_alpha[1] [0.19960578 0.22965394 0.19514008 0.19161206 0.18398817]
np_weight_alpha[2] [0.19471565 0.1954166  0.22811486 0.1908462  0.19090669]
np_weight_alpha[3] [0.18565606 0.19082186 0.19079483 0.23050553 0.20222177]
np_weight_alpha[4] [0.18521729 0.18649882 0.18542027 0.20483603 0.23802759]
-------------Round number:  684  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.43253968253968256
client Accurancy:  0.4246031746031746
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.7068027210884353
Average Global Trainning Loss:  0.8265686450361395
All users are selected
model: 0 tensor([0.2393, 0.2012, 0.1940, 0.1853, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0128, 0.0119, 0.0248, 0.0372, 0.0223],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1996, 0.2297, 0.1951, 0.1916, 0.1840], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0149, -0.0082,  0.0043,  0.0066, -0.0037],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1947, 0.1954, 0.2281, 0.1908, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0253, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0693, 0.0733, 0.0412, 0.0733, 0.0705],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1857, 0.1908, 0.1908, 0.2305, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0254, -0.0268, -0.0564, -0.0456],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1852, 0.1865, 0.1854, 0.2048, 0.2380], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0438, -0.0475, -0.0503, -0.0572, -0.0481]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2521685  0.20929722 0.18927343 0.17038012 0.17888068]
np_weight_alpha[1] [0.25957733 0.2555868  0.15715437 0.14592567 0.18175581]
np_weight_alpha[2] [0.1933499  0.19326183 0.23500748 0.18890153 0.1894793 ]
np_weight_alpha[3] [0.16968653 0.18040308 0.18163271 0.2569397  0.21133797]
np_weight_alpha[4] [0.17958769 0.18405503 0.18567921 0.21180704 0.23887108]
-------------Round number:  685  -------------
client Accurancy:  0.42063492063492064
client Accurancy:  0.5357142857142857
client Accurancy:  0.4801587301587302
client Accurancy:  0.48412698412698413
client Accurancy:  0.4126984126984127
Average Global Accurancy:  0.4666666666666667
Average Global Trainning Accurancy:  0.7462585034013606
Average Global Trainning Loss:  0.6992679102891156
All users are selected
model: 0 tensor([0.2522, 0.2093, 0.1893, 0.1704, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0084, -0.0070,  0.0020, -0.0182, -0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2596, 0.2556, 0.1572, 0.1459, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0587, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0292,  0.0067, -0.0512, -0.0681, -0.0262],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1933, 0.2350, 0.1889, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0309, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1058, 0.1052, 0.0654, 0.0957, 0.1033],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1697, 0.1804, 0.1816, 0.2569, 0.2113], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0251, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0290, -0.0239, -0.0211,  0.0096, -0.0050],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1796, 0.1841, 0.1857, 0.2118, 0.2389], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0235, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0505, -0.0503, -0.0453, -0.0411, -0.0607]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.18750863 0.22203456 0.16076766 0.24224505 0.1874441 ]
np_weight_alpha[1] [0.20797719 0.22814672 0.1863061  0.191653   0.185917  ]
np_weight_alpha[2] [0.19034445 0.19037497 0.24408293 0.18804117 0.18715648]
np_weight_alpha[3] [0.18461978 0.18988988 0.18839599 0.23543903 0.20165525]
np_weight_alpha[4] [0.1797689  0.18365303 0.18061352 0.201519   0.25444555]
-------------Round number:  686  -------------
client Accurancy:  0.44047619047619047
client Accurancy:  0.5198412698412699
client Accurancy:  0.4880952380952381
client Accurancy:  0.4126984126984127
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.7139455782312926
Average Global Trainning Loss:  0.8242417523650085
All users are selected
model: 0 tensor([0.1875, 0.2220, 0.1608, 0.2422, 0.1874], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0204,  0.0484, -0.0025,  0.0902,  0.0358],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2080, 0.2281, 0.1863, 0.1917, 0.1859], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0182, 0.0105, 0.0045, 0.0217, 0.0128],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1903, 0.1904, 0.2441, 0.1880, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0202, -0.0228, -0.0028, -0.0205, -0.0243],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1846, 0.1899, 0.1884, 0.2354, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0106, -0.0031, -0.0111, -0.0254,  0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1798, 0.1837, 0.1806, 0.2015, 0.2544], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0181, -0.0184, -0.0280, -0.0017, -0.0094]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24078532 0.2028022  0.19262798 0.18207909 0.1817054 ]
np_weight_alpha[1] [0.20256512 0.2328512  0.19464417 0.1835136  0.1864259 ]
np_weight_alpha[2] [0.19200632 0.19459844 0.23035513 0.19014286 0.19289725]
np_weight_alpha[3] [0.1848885  0.1827582  0.18888587 0.25663143 0.18683594]
np_weight_alpha[4] [0.18198468 0.18584543 0.19209811 0.18697692 0.25309488]
-------------Round number:  687  -------------
client Accurancy:  0.5436507936507936
client Accurancy:  0.5079365079365079
client Accurancy:  0.44047619047619047
client Accurancy:  0.373015873015873
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.4253968253968254
Average Global Trainning Accurancy:  0.6700680272108843
Average Global Trainning Loss:  0.9277861926020409
All users are selected
model: 0 tensor([0.2408, 0.2028, 0.1926, 0.1821, 0.1817], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0345, 0.0329, 0.0297, 0.0237, 0.0360],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2026, 0.2329, 0.1946, 0.1835, 0.1864], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0222, 0.0222, 0.0248, 0.0139, 0.0211],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1946, 0.2304, 0.1901, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0063, -0.0001, -0.0066, -0.0065, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1849, 0.1828, 0.1889, 0.2566, 0.1868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0250, -0.0211,  0.0077, -0.0260],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1820, 0.1858, 0.1921, 0.1870, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0312, -0.0283, -0.0396, -0.0299]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24009725 0.20016663 0.19336931 0.18896118 0.17740563]
np_weight_alpha[1] [0.20051901 0.23330064 0.19025046 0.18998483 0.18594503]
np_weight_alpha[2] [0.20224304 0.17539223 0.24641791 0.20119986 0.174747  ]
np_weight_alpha[3] [0.18928285 0.1900818  0.19220114 0.23348123 0.19495295]
np_weight_alpha[4] [0.17666069 0.18477643 0.18786114 0.19380769 0.25689405]
-------------Round number:  688  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5079365079365079
client Accurancy:  0.44047619047619047
client Accurancy:  0.4126984126984127
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.7017006802721089
Average Global Trainning Loss:  0.8261141614849065
All users are selected
model: 0 tensor([0.2401, 0.2002, 0.1934, 0.1890, 0.1774], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0382, 0.0256, 0.0401, 0.0405, 0.0352],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2005, 0.2333, 0.1903, 0.1900, 0.1859], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0016, 0.0197, 0.0092, 0.0111, 0.0163],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.2022, 0.1754, 0.2464, 0.2012, 0.1747], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0137, -0.0171,  0.0197,  0.0047, -0.0197],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1893, 0.1901, 0.1922, 0.2335, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0192, -0.0245, -0.0288, -0.0157, -0.0328],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1767, 0.1848, 0.1879, 0.1938, 0.2569], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0255, -0.0205, -0.0299, -0.0333, -0.0097]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24017133 0.20944335 0.18831418 0.18387952 0.17819165]
np_weight_alpha[1] [0.21013567 0.22614515 0.19218627 0.19005333 0.18147965]
np_weight_alpha[2] [0.18869463 0.19239065 0.22835074 0.19629395 0.19427003]
np_weight_alpha[3] [0.18442191 0.19011137 0.19637476 0.22600082 0.20309111]
np_weight_alpha[4] [0.17823505 0.18110129 0.19270225 0.20193934 0.24602205]
-------------Round number:  689  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5277777777777778
client Accurancy:  0.47619047619047616
client Accurancy:  0.4246031746031746
client Accurancy:  0.35714285714285715
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.7275510204081632
Average Global Trainning Loss:  0.7826138658588435
All users are selected
model: 0 tensor([0.2402, 0.2094, 0.1883, 0.1839, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0347, 0.0382, 0.0249, 0.0337, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2101, 0.2261, 0.1922, 0.1901, 0.1815], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0239, 0.0117, 0.0142, 0.0211, 0.0156],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1887, 0.1924, 0.2284, 0.1963, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0360, -0.0318, -0.0299, -0.0221, -0.0240],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1901, 0.1964, 0.2260, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0021, -0.0004,  0.0022, -0.0165, -0.0052],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1782, 0.1811, 0.1927, 0.2019, 0.2460], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0189, -0.0186, -0.0136, -0.0182, -0.0130]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24015334 0.20241131 0.19463405 0.1821794  0.18062186]
np_weight_alpha[1] [0.20278406 0.23353419 0.1945629  0.18598303 0.1831358 ]
np_weight_alpha[2] [0.19537506 0.19492386 0.23115191 0.18933728 0.1892119 ]
np_weight_alpha[3] [0.16979934 0.16732697 0.16188587 0.29948825 0.20149955]
np_weight_alpha[4] [0.18037602 0.18267749 0.18881725 0.20232823 0.24580094]
-------------Round number:  690  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5317460317460317
client Accurancy:  0.4444444444444444
client Accurancy:  0.4365079365079365
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.7343537414965986
Average Global Trainning Loss:  0.7613452314519558
All users are selected
model: 0 tensor([0.2402, 0.2024, 0.1946, 0.1822, 0.1806], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0520, 0.0494, 0.0467, 0.0363, 0.0496],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2028, 0.2335, 0.1946, 0.1860, 0.1831], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0245, 0.0271, 0.0253, 0.0140, 0.0161],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1954, 0.1949, 0.2312, 0.1893, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0092, -0.0126, -0.0186, -0.0140],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1698, 0.1673, 0.1619, 0.2995, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0667, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0647, -0.0676, -0.0744,  0.0367, -0.0339],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1804, 0.1827, 0.1888, 0.2023, 0.2458], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0229, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0080, -0.0161, -0.0115, -0.0038, -0.0136]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23709257 0.19891588 0.19392893 0.19187136 0.1781913 ]
np_weight_alpha[1] [0.19915187 0.2292464  0.1903819  0.19293413 0.18828566]
np_weight_alpha[2] [0.19414026 0.19030465 0.23207955 0.19401915 0.18945633]
np_weight_alpha[3] [0.17165717 0.17004399 0.16661097 0.29665917 0.19502868]
np_weight_alpha[4] [0.17747463 0.18700565 0.18838929 0.19400135 0.2531291 ]
-------------Round number:  691  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.503968253968254
client Accurancy:  0.4444444444444444
client Accurancy:  0.4246031746031746
client Accurancy:  0.28174603174603174
Average Global Accurancy:  0.43253968253968256
Average Global Trainning Accurancy:  0.6962585034013605
Average Global Trainning Loss:  0.8464858697385204
All users are selected
model: 0 tensor([0.2371, 0.1989, 0.1939, 0.1919, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0352, 0.0247, 0.0414, 0.0439, 0.0366],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1992, 0.2292, 0.1904, 0.1929, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0015,  0.0127,  0.0081,  0.0135,  0.0174],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1903, 0.2321, 0.1940, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0025, -0.0047,  0.0016, -0.0058, -0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1717, 0.1700, 0.1666, 0.2967, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0609, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0339, -0.0403, -0.0505,  0.0545, -0.0275],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1775, 0.1870, 0.1884, 0.1940, 0.2531], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0222, -0.0158, -0.0273, -0.0315, -0.0103]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24061897 0.2095229  0.18802163 0.18378454 0.17805193]
np_weight_alpha[1] [0.21028334 0.22763816 0.19178183 0.18907535 0.18122135]
np_weight_alpha[2] [0.16947454 0.19910392 0.2094471  0.20842294 0.21355146]
np_weight_alpha[3] [0.18612061 0.1906077  0.19717304 0.22348906 0.20260957]
np_weight_alpha[4] [0.17816143 0.18101802 0.19299178 0.2027193  0.24510947]
-------------Round number:  692  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5277777777777778
client Accurancy:  0.503968253968254
client Accurancy:  0.42857142857142855
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.4587301587301587
Average Global Trainning Accurancy:  0.7248299319727891
Average Global Trainning Loss:  0.7813481544961735
All users are selected
model: 0 tensor([0.2406, 0.2095, 0.1880, 0.1838, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0185, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0381, 0.0422, 0.0328, 0.0362, 0.0348],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2103, 0.2276, 0.1918, 0.1891, 0.1812], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0254, 0.0149, 0.0186, 0.0195, 0.0178],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1695, 0.1991, 0.2094, 0.2084, 0.2136], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0524, -0.0222, -0.0557, -0.0118, -0.0005],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1861, 0.1906, 0.1972, 0.2235, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0206, -0.0206, -0.0179, -0.0291, -0.0245],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1782, 0.1810, 0.1930, 0.2027, 0.2451], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0214, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0067, -0.0065,  0.0008, -0.0065, -0.0055]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.24205534 0.20297645 0.19106151 0.18393084 0.17997591]
np_weight_alpha[1] [0.2033707  0.23374352 0.1918437  0.18837477 0.18266724]
np_weight_alpha[2] [0.19263135 0.1920707  0.2391346  0.19097804 0.1851854 ]
np_weight_alpha[3] [0.18411884 0.18827759 0.19204499 0.23166835 0.20389022]
np_weight_alpha[4] [0.1858373  0.18741216 0.16588315 0.2090287  0.25183868]
-------------Round number:  693  -------------
client Accurancy:  0.5
client Accurancy:  0.5198412698412699
client Accurancy:  0.44047619047619047
client Accurancy:  0.4365079365079365
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.7183673469387755
Average Global Trainning Loss:  0.798046875
All users are selected
model: 0 tensor([0.2421, 0.2030, 0.1911, 0.1839, 0.1800], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0539, 0.0512, 0.0442, 0.0398, 0.0499],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2034, 0.2337, 0.1918, 0.1884, 0.1827], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0278, 0.0306, 0.0234, 0.0190, 0.0187],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1921, 0.2391, 0.1910, 0.1852], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0167, -0.0065, -0.0187, -0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1883, 0.1920, 0.2317, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0523, -0.0493, -0.0454, -0.0379, -0.0362],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1858, 0.1874, 0.1659, 0.2090, 0.2518], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0215, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0035, -0.0117, -0.0370,  0.0013, -0.0075]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2382041  0.19861595 0.19382335 0.19115242 0.17820422]
np_weight_alpha[1] [0.19892251 0.22834449 0.19202974 0.19292827 0.18777497]
np_weight_alpha[2] [0.19407433 0.19197334 0.23086259 0.19281825 0.19027156]
np_weight_alpha[3] [0.1919195  0.19309811 0.1929403  0.22651471 0.19552732]
np_weight_alpha[4] [0.17743084 0.1863435  0.18988721 0.1945741  0.25176436]
-------------Round number:  694  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5119047619047619
client Accurancy:  0.43253968253968256
client Accurancy:  0.4087301587301587
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.6945578231292517
Average Global Trainning Loss:  0.8471983617665816
All users are selected
model: 0 tensor([0.2382, 0.1986, 0.1938, 0.1912, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0264, 0.0142, 0.0365, 0.0332, 0.0260],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1989, 0.2283, 0.1920, 0.1929, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115,  0.0029,  0.0061,  0.0029,  0.0068],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1920, 0.2309, 0.1928, 0.1903], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0519, 0.0470, 0.0296, 0.0407, 0.0424],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1919, 0.1931, 0.1929, 0.2265, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0335, -0.0387, -0.0419, -0.0384, -0.0496],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1774, 0.1863, 0.1899, 0.1946, 0.2518], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0328, -0.0271, -0.0308, -0.0404, -0.0219]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24153967 0.21063982 0.1839587  0.18457162 0.17929018]
np_weight_alpha[1] [0.2697883  0.21827509 0.16790654 0.1826462  0.16138387]
np_weight_alpha[2] [0.18390468 0.1864856  0.24715059 0.1932744  0.18918474]
np_weight_alpha[3] [0.18508935 0.19110374 0.19400586 0.22552142 0.20427965]
np_weight_alpha[4] [0.17938589 0.1822554  0.18897663 0.20299712 0.24638498]
-------------Round number:  695  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5198412698412699
client Accurancy:  0.4801587301587302
client Accurancy:  0.4246031746031746
client Accurancy:  0.36507936507936506
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.7377551020408163
Average Global Trainning Loss:  0.748114470397534
All users are selected
model: 0 tensor([0.2415, 0.2106, 0.1840, 0.1846, 0.1793], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0378, 0.0397, 0.0226, 0.0331, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2698, 0.2183, 0.1679, 0.1826, 0.1614], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0401, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0604, -0.0201, -0.0371, -0.0121, -0.0349],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1839, 0.1865, 0.2472, 0.1933, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0215, -0.0204,  0.0030, -0.0040, -0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1911, 0.1940, 0.2255, 0.2043], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0230, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0057,  0.0106,  0.0124, -0.0176,  0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1794, 0.1823, 0.1890, 0.2030, 0.2464], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0225, -0.0234, -0.0222, -0.0142, -0.0171]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23865446 0.20255214 0.19310442 0.18379314 0.18189585]
np_weight_alpha[1] [0.20001397 0.23114681 0.19568616 0.18586549 0.18728766]
np_weight_alpha[2] [0.19355616 0.19500601 0.235022   0.18588363 0.19053215]
np_weight_alpha[3] [0.18303588 0.1840669  0.18510112 0.25177535 0.19602077]
np_weight_alpha[4] [0.18161793 0.1850248  0.19020793 0.19604425 0.24710506]
-------------Round number:  696  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.49603174603174605
client Accurancy:  0.45634920634920634
client Accurancy:  0.42063492063492064
client Accurancy:  0.29365079365079366
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.7268707482993197
Average Global Trainning Loss:  0.7845666586947279
All users are selected
model: 0 tensor([0.2387, 0.2026, 0.1931, 0.1838, 0.1819], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0500, 0.0485, 0.0457, 0.0404, 0.0510],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2000, 0.2311, 0.1957, 0.1859, 0.1873], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0241, 0.0292, 0.0289, 0.0185, 0.0261],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1936, 0.1950, 0.2350, 0.1859, 0.1905], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0252, -0.0215, -0.0159, -0.0329, -0.0261],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1830, 0.1841, 0.1851, 0.2518, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0429, -0.0440, -0.0445, -0.0076, -0.0367],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1816, 0.1850, 0.1902, 0.1960, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0090, -0.0142, -0.0147, -0.0145, -0.0109]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23796318 0.20022637 0.19368915 0.189848   0.17827328]
np_weight_alpha[1] [0.20071971 0.22865644 0.1917917  0.19234586 0.1864863 ]
np_weight_alpha[2] [0.19408274 0.19187142 0.22789748 0.19412513 0.19202326]
np_weight_alpha[3] [0.19064827 0.19263394 0.19420676 0.22529766 0.19721341]
np_weight_alpha[4] [0.17783986 0.18565434 0.19098744 0.19644934 0.24906906]
-------------Round number:  697  -------------
client Accurancy:  0.5
client Accurancy:  0.5
client Accurancy:  0.4444444444444444
client Accurancy:  0.42063492063492064
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.7156462585034014
Average Global Trainning Loss:  0.7970816891209609
All users are selected
model: 0 tensor([0.2380, 0.2002, 0.1937, 0.1898, 0.1783], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0178, 0.0064, 0.0240, 0.0214, 0.0147],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2007, 0.2287, 0.1918, 0.1923, 0.1865], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0143, -0.0018, -0.0005, -0.0030, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1919, 0.2279, 0.1941, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0653, 0.0615, 0.0404, 0.0587, 0.0630],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1906, 0.1926, 0.1942, 0.2253, 0.1972], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0277, -0.0317, -0.0322, -0.0341, -0.0406],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1778, 0.1857, 0.1910, 0.1964, 0.2491], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0207, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0398, -0.0353, -0.0330, -0.0449, -0.0324]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2392543  0.20977527 0.18592007 0.18473978 0.1803106 ]
np_weight_alpha[1] [0.25537583 0.21483603 0.1732743  0.1845668  0.17194706]
np_weight_alpha[2] [0.1920959  0.19069804 0.23321836 0.19341296 0.19057472]
np_weight_alpha[3] [0.18510942 0.19075081 0.19278076 0.22732729 0.20403174]
np_weight_alpha[4] [0.18012418 0.18318415 0.18596247 0.20279749 0.24793181]
-------------Round number:  698  -------------
client Accurancy:  0.5
client Accurancy:  0.5158730158730159
client Accurancy:  0.49206349206349204
client Accurancy:  0.4246031746031746
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.7333333333333333
Average Global Trainning Loss:  0.7695789155505952
All users are selected
model: 0 tensor([0.2393, 0.2098, 0.1859, 0.1847, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0213, 0.0320, 0.0134, 0.0166, 0.0164],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2554, 0.2148, 0.1733, 0.1846, 0.1719], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0251, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0956, 0.0059, 0.0139, 0.0347, 0.0299],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1921, 0.1907, 0.2332, 0.1934, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0200, 0.0163, 0.0162, 0.0257, 0.0229],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1908, 0.1928, 0.2273, 0.2040], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0494, -0.0413, -0.0418, -0.0529, -0.0478],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1801, 0.1832, 0.1860, 0.2028, 0.2479], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0336, -0.0244, -0.0325, -0.0324, -0.0279]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24056716 0.19673924 0.1916587  0.18749087 0.18354397]
np_weight_alpha[1] [0.19442984 0.24864453 0.1940101  0.18499893 0.17791657]
np_weight_alpha[2] [0.1915728  0.19379418 0.23982324 0.18738978 0.18742009]
np_weight_alpha[3] [0.18744864 0.18513632 0.18749544 0.23554851 0.2043711 ]
np_weight_alpha[4] [0.18277319 0.17726837 0.18716466 0.20349589 0.2492979 ]
-------------Round number:  699  -------------
client Accurancy:  0.5
client Accurancy:  0.5119047619047619
client Accurancy:  0.44841269841269843
client Accurancy:  0.4166666666666667
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.7180272108843537
Average Global Trainning Loss:  0.8134906794749149
All users are selected
model: 0 tensor([0.2406, 0.1967, 0.1917, 0.1875, 0.1835], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0540, 0.0431, 0.0468, 0.0443, 0.0539],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1944, 0.2486, 0.1940, 0.1850, 0.1779], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0214, 0.0510, 0.0304, 0.0204, 0.0208],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1916, 0.1938, 0.2398, 0.1874, 0.1874], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0237, -0.0206, -0.0067, -0.0305, -0.0289],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1874, 0.1851, 0.1875, 0.2355, 0.2044], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0450, -0.0489, -0.0489, -0.0274, -0.0323],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1828, 0.1773, 0.1872, 0.2035, 0.2493], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0100, -0.0229, -0.0214, -0.0076, -0.0106]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2371219  0.20108613 0.19248806 0.1908972  0.1784067 ]
np_weight_alpha[1] [0.20132536 0.22764245 0.1920438  0.19304995 0.1859384 ]
np_weight_alpha[2] [0.1929068  0.1920965  0.22554441 0.19553396 0.19391835]
np_weight_alpha[3] [0.19175336 0.19333968 0.19557568 0.22340544 0.1959259 ]
np_weight_alpha[4] [0.17810579 0.18483922 0.19271722 0.19522159 0.24911618]
-------------Round number:  700  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.49603174603174605
client Accurancy:  0.44047619047619047
client Accurancy:  0.4166666666666667
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.7142857142857143
Average Global Trainning Loss:  0.8031208479485544
All users are selected
model: 0 tensor([0.2371, 0.2011, 0.1925, 0.1909, 0.1784], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0196, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0113, -0.0209, -0.0050,  0.0149, -0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2013, 0.2276, 0.1920, 0.1930, 0.1859], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0400, -0.0285, -0.0254, -0.0093, -0.0276],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1929, 0.1921, 0.2255, 0.1955, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0031, -0.0046, -0.0210,  0.0036, -0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1918, 0.1933, 0.1956, 0.2234, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0381, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1250, 0.1191, 0.1107, 0.0466, 0.1073],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1781, 0.1848, 0.1927, 0.1952, 0.2491], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0691, -0.0657, -0.0606, -0.0575, -0.0612]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.2439637  0.21375051 0.18918158 0.16989423 0.18320991]
np_weight_alpha[1] [0.21464957 0.23124197 0.19052069 0.1766984  0.18688935]
np_weight_alpha[2] [0.17519511 0.18114734 0.32272273 0.15015966 0.17077515]
np_weight_alpha[3] [0.18676555 0.18937032 0.19311985 0.23662993 0.19411437]
np_weight_alpha[4] [0.1789094  0.18442115 0.19084463 0.19265294 0.2531719 ]
-------------Round number:  701  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5158730158730159
client Accurancy:  0.49603174603174605
client Accurancy:  0.4166666666666667
client Accurancy:  0.3531746031746032
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.7360544217687075
Average Global Trainning Loss:  0.746468431122449
All users are selected
model: 0 tensor([0.2440, 0.2138, 0.1892, 0.1699, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0414, 0.0455, 0.0295, 0.0168, 0.0349],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2146, 0.2312, 0.1905, 0.1767, 0.1869], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0189,  0.0090,  0.0017, -0.0092,  0.0091],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1752, 0.1811, 0.3227, 0.1502, 0.1708], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0968, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0225, -0.0178,  0.0873, -0.0444, -0.0230],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1868, 0.1894, 0.1931, 0.2366, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0213, -0.0238, -0.0172, -0.0162, -0.0318],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1789, 0.1844, 0.1908, 0.1927, 0.2532], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0179, -0.0141, -0.0122, -0.0260, -0.0045]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23849453 0.20086932 0.1924896  0.18628055 0.181866  ]
np_weight_alpha[1] [0.15308236 0.21290259 0.20842837 0.25548485 0.17010179]
np_weight_alpha[2] [0.19311556 0.19428971 0.23318833 0.19007318 0.18933323]
np_weight_alpha[3] [0.1858002  0.19066712 0.18793225 0.23241977 0.20318069]
np_weight_alpha[4] [0.18139452 0.18301757 0.18718448 0.20239131 0.24601212]
-------------Round number:  702  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5357142857142857
client Accurancy:  0.44047619047619047
client Accurancy:  0.42063492063492064
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.7163265306122449
Average Global Trainning Loss:  0.8102826384460035
All users are selected
model: 0 tensor([0.2385, 0.2009, 0.1925, 0.1863, 0.1819], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0471, 0.0423, 0.0476, 0.0297, 0.0441],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1531, 0.2129, 0.2084, 0.2555, 0.1701], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0321, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0249,  0.0086,  0.0454,  0.0871,  0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1943, 0.2332, 0.1901, 0.1893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0026,  0.0024, -0.0082, -0.0039, -0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1858, 0.1907, 0.1879, 0.2324, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0555, -0.0469, -0.0447, -0.0395, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1814, 0.1830, 0.1872, 0.2024, 0.2460], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0138, -0.0202, -0.0250,  0.0010, -0.0188]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23547642 0.19990183 0.18664458 0.19790407 0.18007314]
np_weight_alpha[1] [0.20183718 0.2302659  0.18729143 0.19242872 0.18817674]
np_weight_alpha[2] [0.16255195 0.16417187 0.2598278  0.1882872  0.22516122]
np_weight_alpha[3] [0.1984679  0.1947356  0.1900154  0.23129375 0.18548739]
np_weight_alpha[4] [0.1792732  0.18662864 0.19517049 0.1849748  0.2539528 ]
-------------Round number:  703  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5119047619047619
client Accurancy:  0.45634920634920634
client Accurancy:  0.376984126984127
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.42857142857142855
Average Global Trainning Accurancy:  0.6870748299319728
Average Global Trainning Loss:  0.8734978708280187
All users are selected
model: 0 tensor([0.2355, 0.1999, 0.1866, 0.1979, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0230, 0.0143, 0.0198, 0.0472, 0.0266],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2018, 0.2303, 0.1873, 0.1924, 0.1882], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0006,  0.0140,  0.0024,  0.0163,  0.0141],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1626, 0.1642, 0.2598, 0.1883, 0.2252], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0352, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0488, -0.0478,  0.0142, -0.0185,  0.0202],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1985, 0.1947, 0.1900, 0.2313, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0301,  0.0181,  0.0069, -0.0076, -0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1793, 0.1866, 0.1952, 0.1850, 0.2540], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0258, -0.0222, -0.0214, -0.0399, -0.0172]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24104619 0.2106974  0.1918255  0.17699568 0.17943528]
np_weight_alpha[1] [0.25418815 0.20341337 0.21940035 0.15878193 0.16421622]
np_weight_alpha[2] [0.1946979  0.1952818  0.23115756 0.19029357 0.18856922]
np_weight_alpha[3] [0.17646827 0.18397458 0.19003014 0.25109342 0.19843365]
np_weight_alpha[4] [0.1794488  0.18284398 0.19000368 0.19804926 0.2496543 ]
-------------Round number:  704  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5079365079365079
client Accurancy:  0.4801587301587302
client Accurancy:  0.4246031746031746
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.7374149659863946
Average Global Trainning Loss:  0.7542174877763606
All users are selected
model: 0 tensor([0.2410, 0.2107, 0.1918, 0.1770, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0424, 0.0452, 0.0344, 0.0274, 0.0351],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2542, 0.2034, 0.2194, 0.1588, 0.1642], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0315, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0567, -0.0189,  0.0273, -0.0332, -0.0188],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1947, 0.1953, 0.2312, 0.1903, 0.1886], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0163, -0.0155, -0.0142, -0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1765, 0.1840, 0.1900, 0.2511, 0.1984], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0176, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0244, -0.0232, -0.0131,  0.0071, -0.0172],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1794, 0.1828, 0.1900, 0.1980, 0.2497], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0132, -0.0126, -0.0115, -0.0154, -0.0056]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23778442 0.20147333 0.19350997 0.1860386  0.18119378]
np_weight_alpha[1] [0.19964196 0.226036   0.19438979 0.19423325 0.18569899]
np_weight_alpha[2] [0.19377159 0.19534174 0.23282892 0.18856248 0.18949525]
np_weight_alpha[3] [0.18654305 0.19246791 0.18867563 0.23146218 0.20085122]
np_weight_alpha[4] [0.18064144 0.18315618 0.18875493 0.20042716 0.24702018]
-------------Round number:  705  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5357142857142857
client Accurancy:  0.4523809523809524
client Accurancy:  0.42063492063492064
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7278911564625851
Average Global Trainning Loss:  0.7864123286033163
All users are selected
model: 0 tensor([0.2378, 0.2015, 0.1935, 0.1860, 0.1812], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0144,  0.0083,  0.0187, -0.0063,  0.0063],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1996, 0.2260, 0.1944, 0.1942, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0109, -0.0122,  0.0036, -0.0083, -0.0176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1953, 0.2328, 0.1886, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0295, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1192, 0.1220, 0.0799, 0.1107, 0.1104],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1865, 0.1925, 0.1887, 0.2315, 0.2009], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0198, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0802, -0.0671, -0.0636, -0.0755, -0.0430],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1806, 0.1832, 0.1888, 0.2004, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0267, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0438, -0.0522, -0.0402, -0.0195, -0.0510]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23333342 0.20064846 0.18300751 0.19985482 0.18315573]
np_weight_alpha[1] [0.20086811 0.2306632  0.1819247  0.1929027  0.19364126]
np_weight_alpha[2] [0.19085251 0.1918171  0.24132268 0.18753062 0.18847704]
np_weight_alpha[3] [0.18897475 0.19211985 0.18785644 0.23546214 0.19558683]
np_weight_alpha[4] [0.18178046 0.1919617  0.18590315 0.17769744 0.26265725]
-------------Round number:  706  -------------
client Accurancy:  0.5277777777777778
client Accurancy:  0.5158730158730159
client Accurancy:  0.44841269841269843
client Accurancy:  0.3611111111111111
client Accurancy:  0.21825396825396826
Average Global Accurancy:  0.4142857142857143
Average Global Trainning Accurancy:  0.6394557823129252
Average Global Trainning Loss:  1.0438562925170067
All users are selected
model: 0 tensor([0.2333, 0.2006, 0.1830, 0.1999, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0207, 0.0161, 0.0210, 0.0440, 0.0339],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2009, 0.2307, 0.1819, 0.1929, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0043,  0.0108, -0.0037,  0.0106,  0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1909, 0.1918, 0.2413, 0.1875, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0286, 0.0268, 0.0340, 0.0187, 0.0246],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1890, 0.1921, 0.1879, 0.2355, 0.1956], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0277, -0.0300, -0.0408, -0.0275, -0.0406],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1818, 0.1920, 0.1859, 0.1777, 0.2627], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0251, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0208, -0.0155, -0.0304, -0.0514, -0.0110]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24232632 0.2105883  0.18813962 0.18241517 0.17653053]
np_weight_alpha[1] [0.2572043  0.20425335 0.22998802 0.17009173 0.13846257]
np_weight_alpha[2] [0.1883758  0.19102445 0.23597741 0.19467564 0.18994664]
np_weight_alpha[3] [0.18339221 0.18850718 0.19475195 0.23116946 0.20217918]
np_weight_alpha[4] [0.17653449 0.1809165  0.18912414 0.20158614 0.25183874]
-------------Round number:  707  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5079365079365079
client Accurancy:  0.48412698412698413
client Accurancy:  0.4166666666666667
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.7438775510204082
Average Global Trainning Loss:  0.7445671237244897
All users are selected
model: 0 tensor([0.2423, 0.2106, 0.1881, 0.1824, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0463, 0.0465, 0.0360, 0.0378, 0.0360],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2572, 0.2043, 0.2300, 0.1701, 0.1385], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0444, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0640, -0.0141,  0.0487, -0.0141, -0.0402],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1884, 0.1910, 0.2360, 0.1947, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0320, -0.0290, -0.0298, -0.0245, -0.0227],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1834, 0.1885, 0.1948, 0.2312, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0223, -0.0163, -0.0173, -0.0200],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1765, 0.1809, 0.1891, 0.2016, 0.2518], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0218, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-8.2020e-03, -6.8931e-03,  9.4721e-05, -4.8938e-03,  1.2552e-03]],
       device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23882897 0.20365678 0.19179285 0.1846999  0.18102148]
np_weight_alpha[1] [0.20152752 0.22857146 0.18983263 0.19266815 0.18740018]
np_weight_alpha[2] [0.19196065 0.19164218 0.24085721 0.19083136 0.18470863]
np_weight_alpha[3] [0.18499684 0.19100195 0.19121209 0.23062049 0.20216864]
np_weight_alpha[4] [0.19807589 0.19594525 0.1714307  0.20668633 0.22786184]
-------------Round number:  708  -------------
client Accurancy:  0.5
client Accurancy:  0.5277777777777778
client Accurancy:  0.42857142857142855
client Accurancy:  0.4246031746031746
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.7085034013605442
Average Global Trainning Loss:  0.8495035807291667
All users are selected
model: 0 tensor([0.2388, 0.2037, 0.1918, 0.1847, 0.1810], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0431, 0.0433, 0.0379, 0.0298, 0.0441],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2015, 0.2286, 0.1898, 0.1927, 0.1874], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0254, 0.0236, 0.0241, 0.0217, 0.0250],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1920, 0.1916, 0.2409, 0.1908, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0032,  0.0003,  0.0057, -0.0057, -0.0059],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1850, 0.1910, 0.1912, 0.2306, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0590, -0.0533, -0.0528, -0.0449, -0.0358],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1981, 0.1959, 0.1714, 0.2067, 0.2279], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0294, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0092, -0.0033, -0.0314,  0.0039, -0.0466]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23750348 0.19904841 0.19269583 0.19367884 0.17707334]
np_weight_alpha[1] [0.19948666 0.2304324  0.18938473 0.19442244 0.18627374]
np_weight_alpha[2] [0.19882922 0.18217753 0.20312732 0.2105694  0.2052966 ]
np_weight_alpha[3] [0.19447744 0.19475445 0.19447565 0.2276392  0.18865326]
np_weight_alpha[4] [0.17449585 0.18373354 0.18703842 0.18702625 0.26770595]
-------------Round number:  709  -------------
client Accurancy:  0.5238095238095238
client Accurancy:  0.5
client Accurancy:  0.44841269841269843
client Accurancy:  0.3611111111111111
client Accurancy:  0.2896825396825397
Average Global Accurancy:  0.4246031746031746
Average Global Trainning Accurancy:  0.6795918367346939
Average Global Trainning Loss:  0.8893072219122024
All users are selected
model: 0 tensor([0.2375, 0.1990, 0.1927, 0.1937, 0.1771], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0391, 0.0275, 0.0412, 0.0474, 0.0371],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1995, 0.2304, 0.1894, 0.1944, 0.1863], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0087, 0.0247, 0.0161, 0.0237, 0.0233],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1988, 0.1822, 0.2031, 0.2106, 0.2053], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034, -0.0227, -0.0388,  0.0034,  0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1945, 0.1948, 0.1945, 0.2276, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0171, -0.0223, -0.0286, -0.0255, -0.0429],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1745, 0.1837, 0.1870, 0.1870, 0.2677], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0292, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0225, -0.0171, -0.0240, -0.0346,  0.0081]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23907308 0.2090654  0.18914369 0.1842141  0.17850369]
np_weight_alpha[1] [0.20975308 0.22601105 0.1921291  0.18966976 0.18243708]
np_weight_alpha[2] [0.18984272 0.1924315  0.23152076 0.19464834 0.19155674]
np_weight_alpha[3] [0.1843854  0.18950686 0.19527657 0.2270213  0.20380981]
np_weight_alpha[4] [0.17884868 0.18235837 0.19188493 0.2023104  0.24459755]
-------------Round number:  710  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5277777777777778
client Accurancy:  0.49206349206349204
client Accurancy:  0.4166666666666667
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4523809523809524
Average Global Trainning Accurancy:  0.7414965986394558
Average Global Trainning Loss:  0.7596710412680697
All users are selected
model: 0 tensor([0.2391, 0.2091, 0.1891, 0.1842, 0.1785], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0415, 0.0456, 0.0310, 0.0368, 0.0362],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2098, 0.2260, 0.1921, 0.1897, 0.1824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0307, 0.0185, 0.0189, 0.0226, 0.0228],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1898, 0.1924, 0.2315, 0.1946, 0.1916], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0326, -0.0296, -0.0207, -0.0219, -0.0249],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1895, 0.1953, 0.2270, 0.2038], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0056, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0277, -0.0267, -0.0219, -0.0300, -0.0263],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1788, 0.1824, 0.1919, 0.2023, 0.2446], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0101, -0.0086, -0.0074, -0.0099, -0.0070]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23805892 0.20072542 0.19545789 0.18521953 0.1805383 ]
np_weight_alpha[1] [0.20101932 0.23183961 0.1953408  0.18933335 0.18246695]
np_weight_alpha[2] [0.19609864 0.19565384 0.22756286 0.19039714 0.1902875 ]
np_weight_alpha[3] [0.18539134 0.18929116 0.19023092 0.23213445 0.20295213]
np_weight_alpha[4] [0.18578255 0.18193527 0.18531796 0.20793901 0.23902524]
-------------Round number:  711  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5357142857142857
client Accurancy:  0.45634920634920634
client Accurancy:  0.4126984126984127
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7401360544217687
Average Global Trainning Loss:  0.7624043367346939
All users are selected
model: 0 tensor([0.2381, 0.2007, 0.1955, 0.1852, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0151,  0.0083,  0.0233, -0.0047,  0.0080],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2318, 0.1953, 0.1893, 0.1825], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0097, -0.0052,  0.0062, -0.0143, -0.0191],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1961, 0.1957, 0.2276, 0.1904, 0.1903], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0049, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0316, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1263, 0.1273, 0.0744, 0.1162, 0.1176],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1854, 0.1893, 0.1902, 0.2321, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0895, -0.0808, -0.0712, -0.0736, -0.0586],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1858, 0.1819, 0.1853, 0.2079, 0.2390], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0346, -0.0491, -0.0384, -0.0174, -0.0522]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2348151  0.20153707 0.18214679 0.19903745 0.18246363]
np_weight_alpha[1] [0.20167029 0.23004147 0.18104468 0.19464232 0.19260119]
np_weight_alpha[2] [0.19263257 0.19202444 0.23746853 0.18912351 0.18875088]
np_weight_alpha[3] [0.18801884 0.19005914 0.18912864 0.23376712 0.19902632]
np_weight_alpha[4] [0.18106337 0.19102712 0.18415728 0.18567763 0.25807458]
-------------Round number:  712  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5158730158730159
client Accurancy:  0.44047619047619047
client Accurancy:  0.35714285714285715
client Accurancy:  0.2619047619047619
Average Global Accurancy:  0.41825396825396827
Average Global Trainning Accurancy:  0.6710884353741496
Average Global Trainning Loss:  0.9256156661883503
All users are selected
model: 0 tensor([0.2348, 0.2015, 0.1821, 0.1990, 0.1825], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0172, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0354, 0.0285, 0.0267, 0.0519, 0.0419],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2300, 0.1810, 0.1946, 0.1926], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0085, 0.0229, 0.0034, 0.0214, 0.0277],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1926, 0.1920, 0.2375, 0.1891, 0.1888], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0068, -0.0095,  0.0039, -0.0150, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1880, 0.1901, 0.1891, 0.2338, 0.1990], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0266, -0.0304, -0.0377, -0.0206, -0.0359],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1811, 0.1910, 0.1842, 0.1857, 0.2581], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0213, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0123, -0.0067, -0.0231, -0.0349, -0.0010]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23843509 0.20896716 0.19134499 0.18359901 0.17765372]
np_weight_alpha[1] [0.20962511 0.22477747 0.19391699 0.1897418  0.18193865]
np_weight_alpha[2] [0.18868871 0.20103651 0.18048914 0.22752805 0.2022575 ]
np_weight_alpha[3] [0.18454334 0.19001545 0.19611678 0.22506596 0.2042584 ]
np_weight_alpha[4] [0.17766276 0.18157332 0.19045363 0.20357421 0.2467361 ]
-------------Round number:  713  -------------
client Accurancy:  0.5
client Accurancy:  0.5317460317460317
client Accurancy:  0.48412698412698413
client Accurancy:  0.4126984126984127
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.7380952380952381
Average Global Trainning Loss:  0.758420028167517
All users are selected
model: 0 tensor([0.2384, 0.2090, 0.1913, 0.1836, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0435, 0.0473, 0.0340, 0.0381, 0.0373],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2096, 0.2248, 0.1939, 0.1897, 0.1819], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0217, 0.0111, 0.0110, 0.0119, 0.0132],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1887, 0.2010, 0.1805, 0.2275, 0.2023], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0344, -0.0208, -0.0710,  0.0138, -0.0120],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1845, 0.1900, 0.1961, 0.2251, 0.2043], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0253, -0.0180, -0.0284, -0.0223],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1777, 0.1816, 0.1905, 0.2036, 0.2467], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0083, -0.0066, -0.0058, -0.0049, -0.0028]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23711342 0.20081195 0.19643903 0.18517041 0.18046516]
np_weight_alpha[1] [0.20114076 0.2287224  0.19614908 0.1912531  0.18273471]
np_weight_alpha[2] [0.19774684 0.19648063 0.22791503 0.18870893 0.18914858]
np_weight_alpha[3] [0.18533412 0.19111279 0.19001448 0.23135698 0.20218164]
np_weight_alpha[4] [0.19028544 0.18599176 0.1906708  0.19890808 0.23414396]
-------------Round number:  714  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5317460317460317
client Accurancy:  0.4523809523809524
client Accurancy:  0.4126984126984127
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.736734693877551
Average Global Trainning Loss:  0.7746387715242347
All users are selected
model: 0 tensor([0.2371, 0.2008, 0.1964, 0.1852, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0162,  0.0112,  0.0264, -0.0008,  0.0115],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2011, 0.2287, 0.1961, 0.1913, 0.1827], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0050,  0.0089, -0.0110, -0.0146],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1977, 0.1965, 0.2279, 0.1887, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0307, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1200, 0.1201, 0.0694, 0.1083, 0.1081],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1853, 0.1911, 0.1900, 0.2314, 0.2022], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0874, -0.0791, -0.0693, -0.0710, -0.0613],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1903, 0.1860, 0.1907, 0.1989, 0.2341], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0246, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0449, -0.0352, -0.0313, -0.0570]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23576738 0.20163475 0.18282017 0.19798425 0.18179342]
np_weight_alpha[1] [0.20415819 0.22286132 0.13373156 0.21442772 0.22482117]
np_weight_alpha[2] [0.19404973 0.19281302 0.23735113 0.18766913 0.18811695]
np_weight_alpha[3] [0.1878157  0.19172788 0.1888238  0.23257115 0.19906148]
np_weight_alpha[4] [0.18037337 0.18956304 0.1849222  0.1888845  0.25625688]
-------------Round number:  715  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5119047619047619
client Accurancy:  0.4444444444444444
client Accurancy:  0.38492063492063494
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.4261904761904762
Average Global Trainning Accurancy:  0.6918367346938775
Average Global Trainning Loss:  0.8765864988573554
All users are selected
model: 0 tensor([0.2358, 0.2016, 0.1828, 0.1980, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0399, 0.0318, 0.0293, 0.0541, 0.0436],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2042, 0.2229, 0.1337, 0.2144, 0.2248], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0288, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0063,  0.0111, -0.0500,  0.0379,  0.0573],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1928, 0.2374, 0.1877, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047, -0.0074,  0.0070, -0.0152, -0.0095],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1878, 0.1917, 0.1888, 0.2326, 0.1991], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0279, -0.0301, -0.0398, -0.0248, -0.0363],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1804, 0.1896, 0.1849, 0.1889, 0.2563], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0203, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0115, -0.0067, -0.0203, -0.0285, -0.0010]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23761484 0.20864812 0.19233005 0.18327399 0.1781331 ]
np_weight_alpha[1] [0.21002589 0.2250888  0.19569638 0.1887599  0.18042907]
np_weight_alpha[2] [0.18727967 0.1989182  0.1733203  0.2355791  0.2049028 ]
np_weight_alpha[3] [0.18407409 0.18979195 0.19632219 0.22672668 0.20308508]
np_weight_alpha[4] [0.17809008 0.18204921 0.1904462  0.20236364 0.2470509 ]
-------------Round number:  716  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5277777777777778
client Accurancy:  0.48412698412698413
client Accurancy:  0.4126984126984127
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.7374149659863946
Average Global Trainning Loss:  0.7660561490221088
All users are selected
model: 0 tensor([0.2376, 0.2086, 0.1923, 0.1833, 0.1781], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0439, 0.0480, 0.0366, 0.0383, 0.0388],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2100, 0.2251, 0.1957, 0.1888, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0169, 0.0080, 0.0071, 0.0051, 0.0059],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1873, 0.1989, 0.1733, 0.2356, 0.2049], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0350, -0.0231, -0.0766,  0.0215, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1841, 0.1898, 0.1963, 0.2267, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0239, -0.0167, -0.0223, -0.0215],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1781, 0.1820, 0.1904, 0.2024, 0.2471], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0200, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0062, -0.0049, -0.0043, -0.0046,  0.0002]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2369198  0.2009135  0.19596124 0.18568872 0.18051675]
np_weight_alpha[1] [0.16995634 0.22929154 0.20214446 0.20531206 0.19329561]
np_weight_alpha[2] [0.19747409 0.1972048  0.22672887 0.18950738 0.18908486]
np_weight_alpha[3] [0.18597473 0.19172864 0.19107313 0.22876923 0.20245427]
np_weight_alpha[4] [0.1891126  0.18666883 0.19159178 0.2050419  0.22758484]
-------------Round number:  717  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5357142857142857
client Accurancy:  0.4603174603174603
client Accurancy:  0.4126984126984127
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.7360544217687075
Average Global Trainning Loss:  0.7851966909810799
All users are selected
model: 0 tensor([0.2369, 0.2009, 0.1960, 0.1857, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0159,  0.0104,  0.0254, -0.0009,  0.0110],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1700, 0.2293, 0.2021, 0.2053, 0.1933], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0382, -0.0031,  0.0181,  0.0046, -0.0013],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1975, 0.1972, 0.2267, 0.1895, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0323, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1218, 0.1237, 0.0670, 0.1121, 0.1111],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1860, 0.1917, 0.1911, 0.2288, 0.2025], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0866, -0.0788, -0.0669, -0.0748, -0.0598],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1891, 0.1867, 0.1916, 0.2050, 0.2276], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0260, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0338, -0.0462, -0.0352, -0.0260, -0.0681]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23530945 0.20196079 0.18280634 0.1980832  0.18184026]
np_weight_alpha[1] [0.20353681 0.22971557 0.18042205 0.19611226 0.19021323]
np_weight_alpha[2] [0.19384156 0.19321035 0.23700154 0.18807624 0.18787032]
np_weight_alpha[3] [0.1883871  0.1923729  0.18948264 0.23059282 0.1991645 ]
np_weight_alpha[4] [0.18017638 0.1893578  0.18366523 0.18762438 0.2591762 ]
-------------Round number:  718  -------------
client Accurancy:  0.5238095238095238
client Accurancy:  0.5158730158730159
client Accurancy:  0.4365079365079365
client Accurancy:  0.376984126984127
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.4253968253968254
Average Global Trainning Accurancy:  0.6884353741496598
Average Global Trainning Loss:  0.885592879730017
All users are selected
model: 0 tensor([0.2353, 0.2020, 0.1828, 0.1981, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0366, 0.0293, 0.0267, 0.0517, 0.0414],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2035, 0.2297, 0.1804, 0.1961, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0105, 0.0230, 0.0016, 0.0236, 0.0250],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1938, 0.1932, 0.2370, 0.1881, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0027, -0.0056,  0.0106, -0.0125, -0.0086],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1884, 0.1924, 0.1895, 0.2306, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0287, -0.0303, -0.0405, -0.0291, -0.0379],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1802, 0.1894, 0.1837, 0.1876, 0.2592], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0221, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0145, -0.0098, -0.0258, -0.0331, -0.0007]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23797631 0.20885825 0.19228506 0.1831333  0.17774701]
np_weight_alpha[1] [0.20943505 0.2242751  0.19503869 0.18900502 0.18224618]
np_weight_alpha[2] [0.18785267 0.20112708 0.16702925 0.23294103 0.21104996]
np_weight_alpha[3] [0.18388337 0.189108   0.19618165 0.2276111  0.2032159 ]
np_weight_alpha[4] [0.177802   0.18183711 0.1914484  0.20251787 0.24639453]
-------------Round number:  719  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5277777777777778
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.45476190476190476
Average Global Trainning Accurancy:  0.7384353741496599
Average Global Trainning Loss:  0.763211744658801
All users are selected
model: 0 tensor([0.2380, 0.2089, 0.1923, 0.1831, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0440, 0.0471, 0.0356, 0.0367, 0.0372],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2243, 0.1950, 0.1890, 0.1822], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0170, 0.0080, 0.0070, 0.0064, 0.0084],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1879, 0.2011, 0.1670, 0.2329, 0.2110], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0345, -0.0213, -0.0823,  0.0184, -0.0029],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1891, 0.1962, 0.2276, 0.2032], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0058, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0222, -0.0223, -0.0151, -0.0197, -0.0184],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1778, 0.1818, 0.1914, 0.2025, 0.2464], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0087, -0.0073, -0.0056, -0.0056, -0.0026]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23617007 0.20096397 0.19594185 0.1861846  0.18073948]
np_weight_alpha[1] [0.17237289 0.23246607 0.2058904  0.2027344  0.18653627]
np_weight_alpha[2] [0.19745345 0.19744106 0.2259678  0.18984856 0.18928903]
np_weight_alpha[3] [0.18645416 0.1915247  0.19135608 0.22911648 0.20154856]
np_weight_alpha[4] [0.19099054 0.1881882  0.1894797  0.20004721 0.23129436]
-------------Round number:  720  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5357142857142857
client Accurancy:  0.4642857142857143
client Accurancy:  0.4126984126984127
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7401360544217687
Average Global Trainning Loss:  0.781843494233631
All users are selected
model: 0 tensor([0.2362, 0.2010, 0.1959, 0.1862, 0.1807], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0193, 0.0143, 0.0295, 0.0052, 0.0159],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1724, 0.2325, 0.2059, 0.2027, 0.1865], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306,  0.0068,  0.0272,  0.0073, -0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1975, 0.1974, 0.2260, 0.1898, 0.1893], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0302, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1004, 0.1023, 0.0497, 0.0898, 0.0883],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1865, 0.1915, 0.1914, 0.2291, 0.2015], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0799, -0.0742, -0.0631, -0.0668, -0.0576],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1910, 0.1882, 0.1895, 0.2000, 0.2313], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0243, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0266, -0.0387, -0.0343, -0.0278, -0.0561]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23566853 0.20264788 0.18315296 0.19690426 0.18162635]
np_weight_alpha[1] [0.20411882 0.22862026 0.18080361 0.19652498 0.18993229]
np_weight_alpha[2] [0.19395827 0.1935794  0.23529856 0.1887016  0.18846226]
np_weight_alpha[3] [0.18853597 0.19229259 0.19000784 0.23032667 0.198837  ]
np_weight_alpha[4] [0.18019135 0.18878956 0.18585247 0.18972488 0.2554417 ]
-------------Round number:  721  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5158730158730159
client Accurancy:  0.44047619047619047
client Accurancy:  0.38492063492063494
client Accurancy:  0.27380952380952384
Average Global Accurancy:  0.42698412698412697
Average Global Trainning Accurancy:  0.6976190476190476
Average Global Trainning Loss:  0.8650598227572279
All users are selected
model: 0 tensor([0.2357, 0.2026, 0.1832, 0.1969, 0.1816], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0077,  0.0001, -0.0022,  0.0417,  0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2041, 0.2286, 0.1808, 0.1965, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0205, -0.0090, -0.0283,  0.0123, -0.0062],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1936, 0.2353, 0.1887, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0385, -0.0405, -0.0267, -0.0317, -0.0424],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1885, 0.1923, 0.1900, 0.2303, 0.1988], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0401, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0980, 0.0948, 0.0827, 0.0237, 0.0848],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1802, 0.1888, 0.1859, 0.1897, 0.2554], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0212, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0448, -0.0400, -0.0517, -0.0441, -0.0328]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24194086 0.21302623 0.1954741  0.16813606 0.18142277]
np_weight_alpha[1] [0.21379645 0.22815306 0.1978428  0.17472322 0.18548453]
np_weight_alpha[2] [0.19601287 0.1976501  0.22731575 0.1845535  0.19446774]
np_weight_alpha[3] [0.1838495  0.18792392 0.18804573 0.24404345 0.19613743]
np_weight_alpha[4] [0.18175317 0.18528649 0.19356483 0.18995361 0.24944189]
-------------Round number:  722  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5238095238095238
client Accurancy:  0.4801587301587302
client Accurancy:  0.4126984126984127
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4531746031746032
Average Global Trainning Accurancy:  0.7479591836734694
Average Global Trainning Loss:  0.7361047446322279
All users are selected
model: 0 tensor([0.2419, 0.2130, 0.1955, 0.1681, 0.1814], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0434, 0.0471, 0.0350, 0.0175, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2138, 0.2282, 0.1978, 0.1747, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0220,  0.0126,  0.0103, -0.0076,  0.0116],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1960, 0.1977, 0.2273, 0.1846, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0329, -0.0324, -0.0298, -0.0389, -0.0289],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1838, 0.1879, 0.1880, 0.2440, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0125, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0099, -0.0115, -0.0107,  0.0068, -0.0144],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1818, 0.1853, 0.1936, 0.1900, 0.2494], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0197, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0052, -0.0041, -0.0032, -0.0190,  0.0013]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23635842 0.20086604 0.19538656 0.18603094 0.18135795]
np_weight_alpha[1] [0.20107424 0.22641894 0.19686908 0.1917949  0.18384282]
np_weight_alpha[2] [0.19595017 0.1970731  0.22569475 0.19069353 0.19058843]
np_weight_alpha[3] [0.18572743 0.19108872 0.19041555 0.23079662 0.20197175]
np_weight_alpha[4] [0.17647254 0.17497124 0.1784148  0.25969538 0.21044602]
-------------Round number:  723  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5357142857142857
client Accurancy:  0.46825396825396826
client Accurancy:  0.4126984126984127
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.7506802721088436
Average Global Trainning Loss:  0.7616224224064626
All users are selected
model: 0 tensor([0.2364, 0.2009, 0.1954, 0.1860, 0.1814], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0237, 0.0174, 0.0252, 0.0070, 0.0180],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2011, 0.2264, 0.1969, 0.1918, 0.1838], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0128, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0004,  0.0009,  0.0143, -0.0037, -0.0073],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1960, 0.1971, 0.2257, 0.1907, 0.1906], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0256, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0771, 0.0830, 0.0424, 0.0703, 0.0749],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1857, 0.1911, 0.1904, 0.2308, 0.2020], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0701, -0.0636, -0.0579, -0.0538, -0.0457],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1765, 0.1750, 0.1784, 0.2597, 0.2104], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0266, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0264, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0314, -0.0436, -0.0342,  0.0450, -0.0700]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23260948 0.20097768 0.18803567 0.19660042 0.18177676]
np_weight_alpha[1] [0.20092222 0.22498138 0.13892144 0.212024   0.22315094]
np_weight_alpha[2] [0.19389033 0.19384146 0.23292445 0.19015981 0.1891839 ]
np_weight_alpha[3] [0.18786167 0.19172804 0.18999907 0.23155439 0.19885683]
np_weight_alpha[4] [0.18015604 0.19004704 0.18448618 0.18638842 0.2589223 ]
-------------Round number:  724  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5198412698412699
client Accurancy:  0.4365079365079365
client Accurancy:  0.38095238095238093
client Accurancy:  0.24206349206349206
Average Global Accurancy:  0.41984126984126985
Average Global Trainning Accurancy:  0.6840136054421768
Average Global Trainning Loss:  0.9118645700467687
All users are selected
model: 0 tensor([0.2326, 0.2010, 0.1880, 0.1966, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-9.7182e-05, -6.7470e-03, -3.6254e-04,  3.0877e-02,  7.8876e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2009, 0.2250, 0.1389, 0.2120, 0.2232], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0252, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0356, -0.0261, -0.0813,  0.0168,  0.0189],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1938, 0.2329, 0.1902, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0336, -0.0361, -0.0255, -0.0302, -0.0405],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1879, 0.1917, 0.1900, 0.2316, 0.1989], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0340, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1099, 0.1104, 0.0976, 0.0552, 0.0997],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1802, 0.1900, 0.1845, 0.1864, 0.2589], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0220, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0204, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0477, -0.0422, -0.0594, -0.0553, -0.0326]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.26082876 0.26294664 0.21010953 0.10043109 0.16568391]
np_weight_alpha[1] [0.21451312 0.23068781 0.19773145 0.17450915 0.18255842]
np_weight_alpha[2] [0.19399016 0.19637038 0.22637637 0.18714912 0.196114  ]
np_weight_alpha[3] [0.18437909 0.18787825 0.18866512 0.24228804 0.19678955]
np_weight_alpha[4] [0.18011884 0.18410195 0.19516456 0.19298013 0.24763443]
-------------Round number:  725  -------------
client Accurancy:  0.5317460317460317
client Accurancy:  0.5277777777777778
client Accurancy:  0.48412698412698413
client Accurancy:  0.43253968253968256
client Accurancy:  0.3611111111111111
Average Global Accurancy:  0.46746031746031746
Average Global Trainning Accurancy:  0.7639455782312925
Average Global Trainning Loss:  0.6867529629039115
All users are selected
model: 0 tensor([0.2608, 0.2629, 0.2101, 0.1004, 0.1657], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0943, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0583,  0.0916,  0.0423, -0.0598,  0.0098],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 0.2
model: 1 tensor([0.2145, 0.2307, 0.1977, 0.1745, 0.1826], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0254,  0.0181,  0.0135, -0.0046,  0.0112],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1964, 0.2264, 0.1871, 0.1961], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0307, -0.0281, -0.0250, -0.0311, -0.0211],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1844, 0.1879, 0.1887, 0.2423, 0.1968], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0128, -0.0154, -0.0146,  0.0019, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1801, 0.1841, 0.1952, 0.1930, 0.2476], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0061, -0.0043,  0.0003, -0.0164,  0.0029]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.25491098 0.24918342 0.20099089 0.12863752 0.16627721]
np_weight_alpha[1] [0.20132841 0.22641593 0.1965308  0.19149433 0.18423055]
np_weight_alpha[2] [0.19706395 0.19686075 0.22529435 0.19089161 0.18988939]
np_weight_alpha[3] [0.18499583 0.1907421  0.19074072 0.2295752  0.20394614]
np_weight_alpha[4] [0.1853424  0.18058881 0.17039584 0.25600746 0.20766549]
-------------Round number:  726  -------------
client Accurancy:  0.5595238095238095
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.7551020408163265
Average Global Trainning Loss:  0.7292614164806548
All users are selected
model: 0 tensor([0.2549, 0.2492, 0.2010, 0.1286, 0.1663], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0583, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0625,  0.0871,  0.0445, -0.0318,  0.0218],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2013, 0.2264, 0.1965, 0.1915, 0.1842], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0273, 0.0295, 0.0305, 0.0228, 0.0219],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1971, 0.1969, 0.2253, 0.1909, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0166, -0.0159, -0.0206, -0.0240, -0.0252],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1907, 0.1907, 0.2296, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0479, -0.0415, -0.0407, -0.0313, -0.0233],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1853, 0.1806, 0.1704, 0.2560, 0.2077], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0239, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0030, -0.0168, -0.0337,  0.0579, -0.0497]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23077814 0.19821471 0.19275762 0.19668053 0.18156894]
np_weight_alpha[1] [0.20000695 0.22434612 0.19216721 0.19481136 0.18866834]
np_weight_alpha[2] [0.19286801 0.19207889 0.22665386 0.19413961 0.19425958]
np_weight_alpha[3] [0.19565237 0.1949952  0.1941939  0.22496465 0.19019382]
np_weight_alpha[4] [0.17884023 0.187151   0.19353282 0.18785538 0.25262052]
-------------Round number:  727  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5119047619047619
client Accurancy:  0.4444444444444444
client Accurancy:  0.3968253968253968
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.7040816326530612
Average Global Trainning Loss:  0.858702699829932
All users are selected
model: 0 tensor([0.2308, 0.1982, 0.1928, 0.1967, 0.1816], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0259, 0.0176, 0.0292, 0.0467, 0.0332],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2000, 0.2243, 0.1922, 0.1948, 0.1887], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0039,  0.0066,  0.0034,  0.0174,  0.0129],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1929, 0.1921, 0.2267, 0.1941, 0.1943], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0242, -0.0268, -0.0197, -0.0226, -0.0207],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1957, 0.1950, 0.1942, 0.2250, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0237,  0.0187,  0.0084, -0.0045, -0.0052],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1788, 0.1872, 0.1935, 0.1879, 0.2526], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0195, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0235, -0.0193, -0.0217, -0.0383, -0.0123]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23736452 0.21023123 0.19311406 0.18037263 0.17891768]
np_weight_alpha[1] [0.25868934 0.22474991 0.20757782 0.14823404 0.1607489 ]
np_weight_alpha[2] [0.19395089 0.1957953  0.22463371 0.19371033 0.19190973]
np_weight_alpha[3] [0.1801786  0.18410656 0.19304033 0.24011424 0.20256029]
np_weight_alpha[4] [0.17911483 0.18291421 0.19112721 0.20181473 0.24502897]
-------------Round number:  728  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5198412698412699
client Accurancy:  0.49603174603174605
client Accurancy:  0.4126984126984127
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7608843537414965
Average Global Trainning Loss:  0.7247377564306973
All users are selected
model: 0 tensor([0.2374, 0.2102, 0.1931, 0.1804, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0335, 0.0372, 0.0271, 0.0245, 0.0307],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2587, 0.2247, 0.2076, 0.1482, 0.1607], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0417, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0623,  0.0070,  0.0148, -0.0441, -0.0186],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1940, 0.1958, 0.2246, 0.1937, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0331, -0.0325, -0.0338, -0.0256, -0.0260],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1802, 0.1841, 0.1930, 0.2401, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0191, -0.0231, -0.0089, -0.0028, -0.0090],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1791, 0.1829, 0.1911, 0.2018, 0.2450], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0250, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0069,  0.0083,  0.0095,  0.0087, -0.0020]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23649825 0.20267598 0.19575292 0.18604384 0.17902906]
np_weight_alpha[1] [0.20027548 0.22284093 0.1966987  0.19625567 0.18392922]
np_weight_alpha[2] [0.19632275 0.19756453 0.22965193 0.18888696 0.1875738 ]
np_weight_alpha[3] [0.18657391 0.1940601  0.18902318 0.23203112 0.19831167]
np_weight_alpha[4] [0.17280227 0.16989768 0.17207463 0.18508069 0.30014473]
-------------Round number:  729  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5317460317460317
client Accurancy:  0.47619047619047616
client Accurancy:  0.40476190476190477
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.45555555555555555
Average Global Trainning Accurancy:  0.763265306122449
Average Global Trainning Loss:  0.6780937765731293
All users are selected
model: 0 tensor([0.2365, 0.2027, 0.1958, 0.1860, 0.1790], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0424, 0.0389, 0.0388, 0.0282, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2003, 0.2228, 0.1967, 0.1963, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0187, 0.0167, 0.0278, 0.0194, 0.0126],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1963, 0.1976, 0.2297, 0.1889, 0.1876], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0164, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0081, -0.0012, -0.0152, -0.0170, -0.0125],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1866, 0.1941, 0.1890, 0.2320, 0.1983], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0490, -0.0427, -0.0469, -0.0295, -0.0357],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1728, 0.1699, 0.1721, 0.1851, 0.3001], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0634, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0125, -0.0252, -0.0221, -0.0131,  0.0519]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23261963 0.19987006 0.19317009 0.19405402 0.1802862 ]
np_weight_alpha[1] [0.20016015 0.22631773 0.18784072 0.19547927 0.19020203]
np_weight_alpha[2] [0.19301222 0.18759997 0.23619486 0.19439892 0.18879408]
np_weight_alpha[3] [0.19465049 0.19574562 0.19497278 0.22155128 0.19307986]
np_weight_alpha[4] [0.18074133 0.18982215 0.18896446 0.1927858  0.24768619]
-------------Round number:  730  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5079365079365079
client Accurancy:  0.4444444444444444
client Accurancy:  0.38095238095238093
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4261904761904762
Average Global Trainning Accurancy:  0.7081632653061225
Average Global Trainning Loss:  0.8560196441857993
All users are selected
model: 0 tensor([0.2326, 0.1999, 0.1932, 0.1941, 0.1803], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0288, 0.0196, 0.0309, 0.0445, 0.0321],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2002, 0.2263, 0.1878, 0.1955, 0.1902], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0053,  0.0077, -0.0018,  0.0170,  0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1930, 0.1876, 0.2362, 0.1944, 0.1888], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0270, -0.0346, -0.0137, -0.0258, -0.0315],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1947, 0.1957, 0.1950, 0.2216, 0.1931], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0262,  0.0232,  0.0132, -0.0055,  0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1807, 0.1898, 0.1890, 0.1928, 0.2477], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0214, -0.0165, -0.0275, -0.0320, -0.0161]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23694566 0.21058506 0.19245644 0.1806513  0.17936152]
np_weight_alpha[1] [0.26000464 0.21414979 0.22385947 0.14549023 0.15649584]
np_weight_alpha[2] [0.19327003 0.19540317 0.22436123 0.1934353  0.19353032]
np_weight_alpha[3] [0.18027546 0.1839834  0.19269162 0.24163607 0.20141342]
np_weight_alpha[4] [0.179347   0.18315132 0.19264767 0.20081486 0.2440392 ]
-------------Round number:  731  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5158730158730159
client Accurancy:  0.49603174603174605
client Accurancy:  0.4166666666666667
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.7605442176870748
Average Global Trainning Loss:  0.7166732269079507
All users are selected
model: 0 tensor([0.2369, 0.2106, 0.1925, 0.1807, 0.1794], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0363, 0.0411, 0.0301, 0.0277, 0.0334],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2600, 0.2141, 0.2239, 0.1455, 0.1565], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0462, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0653, -0.0024,  0.0327, -0.0452, -0.0226],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1933, 0.1954, 0.2244, 0.1934, 0.1935], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0302, -0.0301, -0.0296, -0.0231, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1803, 0.1840, 0.1927, 0.2416, 0.2014], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0142, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0185, -0.0053,  0.0032, -0.0064],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1793, 0.1832, 0.1926, 0.2008, 0.2440], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0135, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0051, -0.0037, -0.0020, -0.0041, -0.0103]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23640387 0.20231518 0.19522439 0.18623598 0.17982064]
np_weight_alpha[1] [0.19987588 0.22293557 0.19639952 0.19592206 0.18486696]
np_weight_alpha[2] [0.19583121 0.19775656 0.22802685 0.18915798 0.18922737]
np_weight_alpha[3] [0.21270826 0.23604304 0.17732058 0.18325754 0.19067055]
np_weight_alpha[4] [0.17751107 0.17465582 0.1756999  0.1925649  0.27956834]
-------------Round number:  732  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5277777777777778
client Accurancy:  0.47619047619047616
client Accurancy:  0.39285714285714285
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.7476190476190476
Average Global Trainning Loss:  0.7326578776041667
All users are selected
model: 0 tensor([0.2364, 0.2023, 0.1952, 0.1862, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0318, 0.0285, 0.0301, 0.0208, 0.0264],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1999, 0.2229, 0.1964, 0.1959, 0.1849], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0085, 0.0085, 0.0184, 0.0101, 0.0046],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1958, 0.1978, 0.2280, 0.1892, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0052, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0335, 0.0399, 0.0186, 0.0264, 0.0328],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2127, 0.2360, 0.1773, 0.1833, 0.1907], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0296, -0.0091, -0.0673, -0.0885, -0.0597],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1775, 0.1747, 0.1757, 0.1926, 0.2796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0406, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0232, -0.0351, -0.0310, -0.0252,  0.0186]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23389958 0.2005623  0.19205965 0.19234641 0.18113199]
np_weight_alpha[1] [0.20094356 0.22551842 0.18798922 0.1954206  0.1901282 ]
np_weight_alpha[2] [0.19173883 0.18747677 0.24255532 0.19209692 0.18613215]
np_weight_alpha[3] [0.20792611 0.22891112 0.18090457 0.19033921 0.191919  ]
np_weight_alpha[4] [0.18125191 0.1896749  0.18672955 0.19736731 0.24497633]
-------------Round number:  733  -------------
client Accurancy:  0.5
client Accurancy:  0.503968253968254
client Accurancy:  0.4523809523809524
client Accurancy:  0.3968253968253968
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.7197278911564626
Average Global Trainning Loss:  0.8119702812765731
All users are selected
model: 0 tensor([0.2339, 0.2006, 0.1921, 0.1923, 0.1811], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0291, 0.0197, 0.0284, 0.0475, 0.0310],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2009, 0.2255, 0.1880, 0.1954, 0.1901], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0081,  0.0036, -0.0057,  0.0166,  0.0092],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1917, 0.1875, 0.2426, 0.1921, 0.1861], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0299, -0.0360, -0.0079, -0.0253, -0.0347],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2079, 0.2289, 0.1809, 0.1903, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0281, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0489,  0.0635,  0.0048, -0.0501,  0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1813, 0.1897, 0.1867, 0.1974, 0.2450], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0229, -0.0176, -0.0301, -0.0244, -0.0189]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23792693 0.2110442  0.1937007  0.17632096 0.18100724]
np_weight_alpha[1] [0.25865963 0.21821414 0.22818433 0.13566832 0.15927355]
np_weight_alpha[2] [0.19455598 0.19635919 0.22474189 0.19049232 0.19385064]
np_weight_alpha[3] [0.17336386 0.17902552 0.18881181 0.26054934 0.19824944]
np_weight_alpha[4] [0.18115406 0.18395595 0.19300516 0.19777079 0.24411404]
-------------Round number:  734  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5158730158730159
client Accurancy:  0.503968253968254
client Accurancy:  0.4246031746031746
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4531746031746032
Average Global Trainning Accurancy:  0.7615646258503401
Average Global Trainning Loss:  0.7148547944568452
All users are selected
model: 0 tensor([0.2379, 0.2110, 0.1937, 0.1763, 0.1810], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0389, 0.0418, 0.0330, 0.0233, 0.0326],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2587, 0.2182, 0.2282, 0.1357, 0.1593], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0518, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0634,  0.0017,  0.0376, -0.0550, -0.0221],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1964, 0.2247, 0.1905, 0.1939], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0239, -0.0246, -0.0280, -0.0221, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1734, 0.1790, 0.1888, 0.2605, 0.1982], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0247, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0225, -0.0086,  0.0259, -0.0130],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1812, 0.1840, 0.1930, 0.1978, 0.2441], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0098, -0.0088, -0.0057, -0.0149, -0.0052]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23483083 0.2023371  0.19392945 0.18658248 0.18232022]
np_weight_alpha[1] [0.20003732 0.22242643 0.19540522 0.1955186  0.18661249]
np_weight_alpha[2] [0.19430768 0.19681002 0.23065434 0.18877119 0.18945679]
np_weight_alpha[3] [0.18730122 0.19305903 0.18912883 0.22781125 0.20269963]
np_weight_alpha[4] [0.18498667 0.18309966 0.17739259 0.22854806 0.22597307]
-------------Round number:  735  -------------
client Accurancy:  0.5317460317460317
client Accurancy:  0.5238095238095238
client Accurancy:  0.48412698412698413
client Accurancy:  0.4166666666666667
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.7561224489795918
Average Global Trainning Loss:  0.7403403353528911
All users are selected
model: 0 tensor([0.2348, 0.2023, 0.1939, 0.1866, 0.1823], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0409, 0.0386, 0.0388, 0.0311, 0.0396],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2000, 0.2224, 0.1954, 0.1955, 0.1866], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0190, 0.0191, 0.0266, 0.0199, 0.0179],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1968, 0.2307, 0.1888, 0.1895], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0154, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0077, -0.0017, -0.0106, -0.0158, -0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 5.0
model: 3 tensor([0.1873, 0.1931, 0.1891, 0.2278, 0.2027], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0422, -0.0392, -0.0423, -0.0268, -0.0298],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1850, 0.1831, 0.1774, 0.2285, 0.2260], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0210, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0075, -0.0182, -0.0258,  0.0201, -0.0300]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23353513 0.20074221 0.19231543 0.1926437  0.1807635 ]
np_weight_alpha[1] [0.2011484  0.2248833  0.1891484  0.19570947 0.18911041]
np_weight_alpha[2] [0.18550907 0.16154869 0.23876193 0.22062218 0.19355805]
np_weight_alpha[3] [0.19334023 0.1960063  0.19522208 0.21919124 0.19624013]
np_weight_alpha[4] [0.17995021 0.18807192 0.18983163 0.19490466 0.24724163]
-------------Round number:  736  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.503968253968254
client Accurancy:  0.4523809523809524
client Accurancy:  0.4007936507936508
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.7292517006802721
Average Global Trainning Loss:  0.8025450414540817
All users are selected
model: 0 tensor([0.2335, 0.2007, 0.1923, 0.1926, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0036, -0.0063,  0.0026,  0.0305,  0.0041],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2011, 0.2249, 0.1891, 0.1957, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0044, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0321, -0.0226, -0.0290,  0.0050, -0.0167],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1855, 0.1615, 0.2388, 0.2206, 0.1936], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0696, -0.0960, -0.0415, -0.0168, -0.0600],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1933, 0.1960, 0.1952, 0.2192, 0.1962], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0426, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1381, 0.1378, 0.1247, 0.0453, 0.1207],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1800, 0.1881, 0.1898, 0.1949, 0.2472], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0507, -0.0459, -0.0543, -0.0405, -0.0432]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24421816 0.26542914 0.20357098 0.10165954 0.18512218]
np_weight_alpha[1] [0.21362351 0.22934628 0.19811116 0.17271107 0.18620801]
np_weight_alpha[2] [0.18720677 0.17052642 0.23755418 0.21166457 0.19304806]
np_weight_alpha[3] [0.1880366  0.19062683 0.1923928  0.23480706 0.1941367 ]
np_weight_alpha[4] [0.18320352 0.18626405 0.19593605 0.18757066 0.24702571]
-------------Round number:  737  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5317460317460317
client Accurancy:  0.4801587301587302
client Accurancy:  0.42063492063492064
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4595238095238095
Average Global Trainning Accurancy:  0.7625850340136054
Average Global Trainning Loss:  0.6971568412521258
All users are selected
model: 0 tensor([0.2442, 0.2654, 0.2036, 0.1017, 0.1851], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0807, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0095,  0.0549,  0.0052, -0.1073, -0.0228],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2136, 0.2293, 0.1981, 0.1727, 0.1862], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0257, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0248, -0.0141,  0.0248, -0.0021,  0.0181],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1872, 0.1705, 0.2376, 0.2117, 0.1930], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0377, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0820, 0.0642, 0.0384, 0.1159, 0.0982],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1880, 0.1906, 0.1924, 0.2348, 0.1941], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0190, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0430, -0.0366, -0.0275, -0.0481, -0.0609],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1832, 0.1863, 0.1959, 0.1876, 0.2470], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0432, -0.0294, -0.0165, -0.0618, -0.0363]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24043636 0.19372539 0.18230516 0.19227964 0.1912535 ]
np_weight_alpha[1] [0.19710326 0.2590207  0.1823842  0.18377964 0.17771222]
np_weight_alpha[2] [0.1856819  0.1738908  0.24947093 0.20284031 0.18811616]
np_weight_alpha[3] [0.18690196 0.18340576 0.17672695 0.24223742 0.21072792]
np_weight_alpha[4] [0.18756688 0.17774083 0.17496349 0.21037814 0.24935062]
-------------Round number:  738  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5357142857142857
client Accurancy:  0.4603174603174603
client Accurancy:  0.42063492063492064
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.45396825396825397
Average Global Trainning Accurancy:  0.7598639455782313
Average Global Trainning Loss:  0.6924986547353317
All users are selected
model: 0 tensor([0.2404, 0.1937, 0.1823, 0.1923, 0.1913], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0403, 0.0277, 0.0290, 0.0370, 0.0491],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1971, 0.2590, 0.1824, 0.1838, 0.1777], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0228, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0176, 0.0570, 0.0145, 0.0107, 0.0132],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1857, 0.1739, 0.2495, 0.2028, 0.1881], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0174, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0073, -0.0198,  0.0124,  0.0074, -0.0079],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1869, 0.1834, 0.1767, 0.2422, 0.2107], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0408, -0.0477, -0.0518, -0.0117, -0.0244],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1876, 0.1777, 0.1750, 0.2104, 0.2494], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0106, -0.0280, -0.0378, -0.0090, -0.0098]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23914473 0.20165803 0.18921453 0.1910603  0.17892241]
np_weight_alpha[1] [0.20163761 0.2256456  0.19027233 0.1953129  0.18713163]
np_weight_alpha[2] [0.18949673 0.1901315  0.23622876 0.19181228 0.19233079]
np_weight_alpha[3] [0.19234674 0.19564654 0.19312087 0.2192944  0.19959149]
np_weight_alpha[4] [0.17913981 0.18598804 0.1927109  0.19920322 0.24295805]
-------------Round number:  739  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5277777777777778
client Accurancy:  0.4642857142857143
client Accurancy:  0.4087301587301587
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.7479591836734694
Average Global Trainning Loss:  0.7239109999468537
All users are selected
model: 0 tensor([0.2391, 0.2017, 0.1892, 0.1911, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0109, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0177, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0015, -0.0133,  0.0113,  0.0030, -0.0032],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2016, 0.2256, 0.1903, 0.1953, 0.1871], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0301, -0.0173, -0.0028, -0.0165, -0.0167],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1895, 0.1901, 0.2362, 0.1918, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0439, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1494, 0.1513, 0.0819, 0.1499, 0.1554],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1923, 0.1956, 0.1931, 0.2193, 0.1996], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0658, -0.0699, -0.0567, -0.0800, -0.0799],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1791, 0.1860, 0.1927, 0.1992, 0.2430], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0223, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0536, -0.0521, -0.0324, -0.0601, -0.0551]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.22739659 0.2727769  0.13842855 0.17228046 0.1891175 ]
np_weight_alpha[1] [0.21475396 0.22710691 0.17697202 0.19440205 0.186765  ]
np_weight_alpha[2] [0.18614464 0.18638295 0.25156564 0.1882313  0.18767546]
np_weight_alpha[3] [0.19128032 0.19527207 0.19029626 0.22200227 0.20114914]
np_weight_alpha[4] [0.17947082 0.18545471 0.18804179 0.1997149  0.24731785]
-------------Round number:  740  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5277777777777778
client Accurancy:  0.48412698412698413
client Accurancy:  0.4007936507936508
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.7568027210884354
Average Global Trainning Loss:  0.7159897161989796
All users are selected
model: 0 tensor([0.2274, 0.2728, 0.1384, 0.1723, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0536, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0183, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0065,  0.0747, -0.0542,  0.0006,  0.0104],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2148, 0.2271, 0.1770, 0.1944, 0.1868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0081, -0.0185, -0.0380, -0.0077, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1861, 0.1864, 0.2516, 0.1882, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0226, -0.0011, -0.0046, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1913, 0.1953, 0.1903, 0.2220, 0.2011], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0274, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0747, 0.0700, 0.0692, 0.0241, 0.0558],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1795, 0.1855, 0.1880, 0.1997, 0.2473], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0357, -0.0319, -0.0305, -0.0347, -0.0222]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.24140874 0.20188548 0.19648364 0.1769395  0.18328273]
np_weight_alpha[1] [0.20435427 0.22898613 0.19646184 0.18422167 0.1859761 ]
np_weight_alpha[2] [0.19465216 0.19541322 0.24304244 0.18021692 0.18667528]
np_weight_alpha[3] [0.18787432 0.19255832 0.18799055 0.23042701 0.2011498 ]
np_weight_alpha[4] [0.18375854 0.18581519 0.18689592 0.20235735 0.24117304]
-------------Round number:  741  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.42063492063492064
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.7663265306122449
Average Global Trainning Loss:  0.6947625192655187
All users are selected
model: 0 tensor([0.2414, 0.2019, 0.1965, 0.1769, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0464, 0.0391, 0.0424, 0.0227, 0.0432],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2044, 0.2290, 0.1965, 0.1842, 0.1860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0257, 0.0284, 0.0267, 0.0110, 0.0218],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1947, 0.1954, 0.2430, 0.1802, 0.1867], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0202, -0.0192, -0.0036, -0.0363, -0.0315],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1879, 0.1926, 0.1880, 0.2304, 0.2011], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0356, -0.0338, -0.0367, -0.0193, -0.0274],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1838, 0.1858, 0.1869, 0.2024, 0.2412], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0048, -0.0108, -0.0188, -0.0057, -0.0093]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23575135 0.20066959 0.19214606 0.19228148 0.17915158]
np_weight_alpha[1] [0.20095068 0.22423682 0.1922196  0.19561099 0.18698186]
np_weight_alpha[2] [0.192482   0.19222498 0.22556524 0.19404618 0.19568163]
np_weight_alpha[3] [0.19276801 0.19559957 0.19397105 0.21989368 0.19776775]
np_weight_alpha[4] [0.16056915 0.18846677 0.23123749 0.18022113 0.23950548]
-------------Round number:  742  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5277777777777778
client Accurancy:  0.46825396825396826
client Accurancy:  0.4007936507936508
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.7493197278911564
Average Global Trainning Loss:  0.7372469739849065
All users are selected
model: 0 tensor([0.2358, 0.2007, 0.1921, 0.1923, 0.1792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0400, 0.0274, 0.0409, 0.0453, 0.0385],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2010, 0.2242, 0.1922, 0.1956, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0055, 0.0188, 0.0167, 0.0209, 0.0204],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1925, 0.1922, 0.2256, 0.1940, 0.1957], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0084, -0.0110, -0.0163, -0.0129, -0.0075],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1928, 0.1956, 0.1940, 0.2199, 0.1978], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0185, -0.0217, -0.0279, -0.0291, -0.0336],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1606, 0.1885, 0.2312, 0.1802, 0.2395], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0231, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0193, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0362, -0.0120,  0.0238, -0.0419, -0.0181]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2359678  0.21094543 0.18889424 0.18498975 0.17920287]
np_weight_alpha[1] [0.21169949 0.22251922 0.19166167 0.19086668 0.18325287]
np_weight_alpha[2] [0.18932176 0.19159414 0.23243065 0.1951271  0.19152631]
np_weight_alpha[3] [0.18526915 0.19086336 0.19535862 0.2236539  0.20485495]
np_weight_alpha[4] [0.17972416 0.18309857 0.18957867 0.2039824  0.24361609]
-------------Round number:  743  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5357142857142857
client Accurancy:  0.4880952380952381
client Accurancy:  0.4087301587301587
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7598639455782313
Average Global Trainning Loss:  0.7133517518335459
All users are selected
model: 0 tensor([0.2360, 0.2109, 0.1889, 0.1850, 0.1792], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0327, 0.0418, 0.0245, 0.0316, 0.0297],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2117, 0.2225, 0.1917, 0.1909, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0054, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0190, 0.0065, 0.0031, 0.0076, 0.0059],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1893, 0.1916, 0.2324, 0.1951, 0.1915], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0361, -0.0342, -0.0193, -0.0258, -0.0284],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1853, 0.1909, 0.1954, 0.2237, 0.2049], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0064, -0.0070, -0.0031, -0.0089, -0.0060],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1797, 0.1831, 0.1896, 0.2040, 0.2436], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0074, -0.0082, -0.0074, -0.0061,  0.0011]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23750247 0.20031995 0.19559364 0.18506762 0.18151632]
np_weight_alpha[1] [0.16146201 0.23319432 0.21746823 0.19371547 0.19416   ]
np_weight_alpha[2] [0.1963287  0.19673558 0.22396669 0.19194092 0.1910281 ]
np_weight_alpha[3] [0.18518394 0.1936209  0.17961411 0.23896483 0.20261624]
np_weight_alpha[4] [0.1889991  0.19579625 0.19863282 0.2066015  0.20997036]
-------------Round number:  744  -------------
client Accurancy:  0.5079365079365079
client Accurancy:  0.5436507936507936
client Accurancy:  0.47619047619047616
client Accurancy:  0.42063492063492064
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4507936507936508
Average Global Trainning Accurancy:  0.7493197278911564
Average Global Trainning Loss:  0.7666849356930272
All users are selected
model: 0 tensor([0.2375, 0.2003, 0.1956, 0.1851, 0.1815], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0156, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0468, 0.0404, 0.0442, 0.0351, 0.0445],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1615, 0.2332, 0.2175, 0.1937, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0151,  0.0383,  0.0513,  0.0255,  0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1963, 0.1967, 0.2240, 0.1919, 0.1910], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0204, -0.0205, -0.0199, -0.0274, -0.0285],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1852, 0.1936, 0.1796, 0.2390, 0.2026], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0383, -0.0330, -0.0476, -0.0096, -0.0265],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1890, 0.1958, 0.1986, 0.2066, 0.2100], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0205, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0029, -0.0035, -0.0109, -0.0055, -0.0453]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23476326 0.20131329 0.19287165 0.19157064 0.17948118]
np_weight_alpha[1] [0.20342818 0.22294393 0.19304855 0.19505906 0.18552026]
np_weight_alpha[2] [0.19323829 0.19368549 0.22135387 0.19573085 0.19599155]
np_weight_alpha[3] [0.1923959  0.19550219 0.19606999 0.21810754 0.19792445]
np_weight_alpha[4] [0.17826344 0.18505096 0.19469191 0.19721541 0.24477822]
-------------Round number:  745  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5158730158730159
client Accurancy:  0.45634920634920634
client Accurancy:  0.4007936507936508
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.7520408163265306
Average Global Trainning Loss:  0.73377303558142
All users are selected
model: 0 tensor([0.2348, 0.2013, 0.1929, 0.1916, 0.1795], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0324, 0.0211, 0.0286, 0.0421, 0.0302],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2034, 0.2229, 0.1930, 0.1951, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0007,  0.0083,  0.0027,  0.0169,  0.0083],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1932, 0.1937, 0.2214, 0.1957, 0.1960], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0286, -0.0304, -0.0268, -0.0237, -0.0231],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1924, 0.1955, 0.1961, 0.2181, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0257,  0.0236,  0.0163, -0.0079,  0.0082],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1783, 0.1851, 0.1947, 0.1972, 0.2448], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0187, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0266, -0.0241, -0.0227, -0.0298, -0.0197]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2349758  0.21030428 0.19422355 0.18036506 0.18013136]
np_weight_alpha[1] [0.24357285 0.21488757 0.21290517 0.15046592 0.17816845]
np_weight_alpha[2] [0.19505157 0.19725992 0.22254175 0.19272229 0.19242445]
np_weight_alpha[3] [0.17984596 0.18450496 0.1919633  0.24189776 0.201788  ]
np_weight_alpha[4] [0.18018784 0.1840869  0.19177535 0.20124353 0.24270643]
-------------Round number:  746  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5238095238095238
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.7700680272108843
Average Global Trainning Loss:  0.6983227372980442
All users are selected
model: 0 tensor([0.2350, 0.2103, 0.1942, 0.1804, 0.1801], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0318, 0.0385, 0.0285, 0.0251, 0.0281],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2436, 0.2149, 0.2129, 0.1505, 0.1782], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0261, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0539,  0.0047,  0.0257, -0.0336,  0.0023],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1951, 0.1973, 0.2225, 0.1927, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0320, -0.0321, -0.0314, -0.0288, -0.0297],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1798, 0.1845, 0.1920, 0.2419, 0.2018], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0126, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0122, -0.0147, -0.0051,  0.0089, -0.0078],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1802, 0.1841, 0.1918, 0.2012, 0.2427], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0070, -0.0060, -0.0045, -0.0072,  0.0007]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23557386 0.2013165  0.1953213  0.1853641  0.18242429]
np_weight_alpha[1] [0.1999068  0.22156624 0.19749841 0.19441175 0.1866168 ]
np_weight_alpha[2] [0.19589327 0.19818053 0.22411418 0.19061911 0.19119284]
np_weight_alpha[3] [0.20901342 0.22751236 0.18610774 0.16823004 0.20913638]
np_weight_alpha[4] [0.19093099 0.19000451 0.19009067 0.21341644 0.21555741]
-------------Round number:  747  -------------
client Accurancy:  0.5119047619047619
client Accurancy:  0.5317460317460317
client Accurancy:  0.48412698412698413
client Accurancy:  0.39285714285714285
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.7482993197278912
Average Global Trainning Loss:  0.7703911398543792
All users are selected
model: 0 tensor([0.2356, 0.2013, 0.1953, 0.1854, 0.1824], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0452, 0.0398, 0.0410, 0.0363, 0.0429],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1999, 0.2216, 0.1975, 0.1944, 0.1866], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0214, 0.0241, 0.0286, 0.0243, 0.0225],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1959, 0.1982, 0.2241, 0.1906, 0.1912], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0199, -0.0155, -0.0177, -0.0283, -0.0214],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2090, 0.2275, 0.1861, 0.1682, 0.2091], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0170, -0.0029, -0.0498, -0.0893, -0.0266],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1909, 0.1900, 0.1901, 0.2134, 0.2156], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0008, -0.0098, -0.0137,  0.0033, -0.0385]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23312451 0.20183615 0.19464009 0.18963899 0.18076028]
np_weight_alpha[1] [0.20231734 0.22242643 0.19290134 0.19406623 0.18828867]
np_weight_alpha[2] [0.19496089 0.19292468 0.22207868 0.19809917 0.19193664]
np_weight_alpha[3] [0.18891725 0.19312683 0.19849612 0.22115663 0.19830315]
np_weight_alpha[4] [0.17967844 0.1871017  0.19083008 0.19697414 0.24541564]
-------------Round number:  748  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.49603174603174605
client Accurancy:  0.45634920634920634
client Accurancy:  0.39285714285714285
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.430952380952381
Average Global Trainning Accurancy:  0.7479591836734694
Average Global Trainning Loss:  0.7720473931760204
All users are selected
model: 0 tensor([0.2331, 0.2018, 0.1946, 0.1896, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0025, -0.0121, -0.0029,  0.0249, -0.0030],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2023, 0.2224, 0.1929, 0.1941, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0393, -0.0312, -0.0348, -0.0010, -0.0266],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1950, 0.1929, 0.2221, 0.1981, 0.1919], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0623, -0.0669, -0.0599, -0.0413, -0.0625],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1889, 0.1931, 0.1985, 0.2212, 0.1983], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0471, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1650, 0.1657, 0.1583, 0.0653, 0.1505],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1797, 0.1871, 0.1908, 0.1970, 0.2454], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0618, -0.0580, -0.0616, -0.0477, -0.0532]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24356207 0.2645917  0.2031754  0.09872366 0.18994722]
np_weight_alpha[1] [0.21453375 0.22781615 0.2000775  0.1699541  0.18761851]
np_weight_alpha[2] [0.19544008 0.19434327 0.22327186 0.19440259 0.19254223]
np_weight_alpha[3] [0.18388936 0.18766627 0.19420426 0.23870338 0.19553667]
np_weight_alpha[4] [0.18039182 0.18651481 0.19069898 0.19393487 0.2484595 ]
-------------Round number:  749  -------------
client Accurancy:  0.5198412698412699
client Accurancy:  0.5238095238095238
client Accurancy:  0.4880952380952381
client Accurancy:  0.42857142857142855
client Accurancy:  0.38095238095238093
Average Global Accurancy:  0.46825396825396826
Average Global Trainning Accurancy:  0.777891156462585
Average Global Trainning Loss:  0.6604740480176445
All users are selected
model: 0 tensor([0.2436, 0.2646, 0.2032, 0.0987, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0822, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0349,  0.0862,  0.0290, -0.0697,  0.0269],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2145, 0.2278, 0.2001, 0.1700, 0.1876], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0178,  0.0093,  0.0075, -0.0184,  0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1954, 0.1943, 0.2233, 0.1944, 0.1925], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0123, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0303, -0.0324, -0.0314, -0.0254, -0.0266],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1877, 0.1942, 0.2387, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0001, -0.0013,  0.0068,  0.0166, -0.0061],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1804, 0.1865, 0.1907, 0.1939, 0.2485], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0028,  0.0012,  0.0005, -0.0109,  0.0118]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23175012 0.19918615 0.19505359 0.1895522  0.18445793]
np_weight_alpha[1] [0.20090708 0.22400932 0.19678491 0.19262856 0.18567005]
np_weight_alpha[2] [0.19613434 0.19709402 0.22663225 0.19036043 0.18977904]
np_weight_alpha[3] [0.19772838 0.20871617 0.1763119  0.17235427 0.24488935]
np_weight_alpha[4] [0.19263047 0.17969628 0.18677244 0.2529423  0.18795855]
-------------Round number:  750  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5357142857142857
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.7578231292517007
Average Global Trainning Loss:  0.7616134539753401
All users are selected
model: 0 tensor([0.2318, 0.1992, 0.1951, 0.1896, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0411, 0.0388, 0.0432, 0.0375, 0.0466],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2009, 0.2240, 0.1968, 0.1926, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0102, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0246, 0.0282, 0.0276, 0.0221, 0.0245],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1961, 0.1971, 0.2266, 0.1904, 0.1898], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0047, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0224, -0.0228, -0.0183, -0.0303, -0.0333],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1977, 0.2087, 0.1763, 0.1724, 0.2449], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0230, -0.0141, -0.0460, -0.0749,  0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1926, 0.1797, 0.1868, 0.2529, 0.1880], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0179, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0019, -0.0227, -0.0272,  0.0417, -0.0715]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23389024 0.20102775 0.19263428 0.19285801 0.17958976]
np_weight_alpha[1] [0.20135401 0.22200939 0.19429193 0.19566748 0.18667717]
np_weight_alpha[2] [0.1929753  0.19429155 0.2202274  0.19506069 0.19744505]
np_weight_alpha[3] [0.19371156 0.1957687  0.19528079 0.22121921 0.19401976]
np_weight_alpha[4] [0.17820811 0.1852901  0.19636728 0.1936866  0.24644792]
-------------Round number:  751  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5119047619047619
client Accurancy:  0.4523809523809524
client Accurancy:  0.4166666666666667
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.751360544217687
Average Global Trainning Loss:  0.7356190376541242
All users are selected
model: 0 tensor([0.2339, 0.2010, 0.1926, 0.1929, 0.1796], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0440, 0.0330, 0.0397, 0.0480, 0.0407],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2014, 0.2220, 0.1943, 0.1957, 0.1867], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0064, 0.0149, 0.0124, 0.0196, 0.0179],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1930, 0.1943, 0.2202, 0.1951, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0125, -0.0133, -0.0131, -0.0129, -0.0049],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1937, 0.1958, 0.1953, 0.2212, 0.1940], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0210, -0.0234, -0.0305, -0.0290, -0.0416],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1782, 0.1853, 0.1964, 0.1937, 0.2464], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0168, -0.0129, -0.0097, -0.0271, -0.0077]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23249857 0.20839809 0.19327356 0.18564606 0.18018366]
np_weight_alpha[1] [0.20897873 0.22201794 0.19568014 0.19006029 0.18326288]
np_weight_alpha[2] [0.19389755 0.19591983 0.22289748 0.19636507 0.19092011]
np_weight_alpha[3] [0.18571264 0.18997091 0.19631752 0.22181813 0.20618078]
np_weight_alpha[4] [0.1800098  0.18290386 0.19028743 0.204837   0.24196187]
-------------Round number:  752  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5198412698412699
client Accurancy:  0.49603174603174605
client Accurancy:  0.4166666666666667
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7656462585034014
Average Global Trainning Loss:  0.7152271504304847
All users are selected
model: 0 tensor([0.2325, 0.2084, 0.1933, 0.1856, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0161, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0120, 0.0187, 0.0154, 0.0115, 0.0088],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2090, 0.2220, 0.1957, 0.1901, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0048, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0006, -0.0062, -0.0048, -0.0111, -0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1959, 0.2229, 0.1964, 0.1909], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0222, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0386, 0.0381, 0.0132, 0.0467, 0.0434],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1857, 0.1900, 0.1963, 0.2218, 0.2062], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0217, -0.0242, -0.0093, -0.0251, -0.0195],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1800, 0.1829, 0.1903, 0.2048, 0.2420], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0180, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0271, -0.0272, -0.0161, -0.0232, -0.0188]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23583642 0.20214011 0.19057028 0.18702088 0.18443231]
np_weight_alpha[1] [0.17877294 0.21920076 0.1854863  0.21125564 0.2052843 ]
np_weight_alpha[2] [0.19014181 0.19250533 0.24960135 0.18484749 0.18290412]
np_weight_alpha[3] [0.18724224 0.19375655 0.18562724 0.2281998  0.20517418]
np_weight_alpha[4] [0.18419574 0.18697284 0.18348598 0.20454285 0.24080257]
-------------Round number:  753  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5317460317460317
client Accurancy:  0.47619047619047616
client Accurancy:  0.3968253968253968
client Accurancy:  0.3055555555555556
Average Global Accurancy:  0.4452380952380952
Average Global Trainning Accurancy:  0.7581632653061224
Average Global Trainning Loss:  0.7385416666666667
All users are selected
model: 0 tensor([0.2358, 0.2021, 0.1906, 0.1870, 0.1844], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0423, 0.0374, 0.0333, 0.0341, 0.0424],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1788, 0.2192, 0.1855, 0.2113, 0.2053], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0059, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0012,  0.0221,  0.0151,  0.0400,  0.0439],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1901, 0.1925, 0.2496, 0.1848, 0.1829], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0202, -0.0170,  0.0146, -0.0266, -0.0277],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1872, 0.1938, 0.1856, 0.2282, 0.2052], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0332, -0.0315, -0.0398, -0.0178, -0.0246],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1842, 0.1870, 0.1835, 0.2045, 0.2408], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0119, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0150, -0.0268, -0.0114, -0.0122]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2331036  0.20192339 0.19444558 0.19030455 0.18022287]
np_weight_alpha[1] [0.20363033 0.22186008 0.1940499  0.19493337 0.18552627]
np_weight_alpha[2] [0.1947948  0.19397002 0.22036268 0.19584318 0.19502924]
np_weight_alpha[3] [0.191035   0.19575611 0.19587305 0.21714535 0.20019042]
np_weight_alpha[4] [0.17998452 0.18611449 0.19403091 0.19961175 0.24025828]
-------------Round number:  754  -------------
client Accurancy:  0.5
client Accurancy:  0.5079365079365079
client Accurancy:  0.44841269841269843
client Accurancy:  0.4087301587301587
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.7578231292517007
Average Global Trainning Loss:  0.7282084562340562
All users are selected
model: 0 tensor([0.2331, 0.2019, 0.1944, 0.1903, 0.1802], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0143, 0.0049, 0.0124, 0.0392, 0.0126],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2036, 0.2219, 0.1940, 0.1949, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0117, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0203, -0.0124, -0.0168,  0.0113, -0.0121],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1948, 0.1940, 0.2204, 0.1958, 0.1950], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0440, -0.0468, -0.0416, -0.0267, -0.0406],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1910, 0.1958, 0.1959, 0.2171, 0.2002], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0416, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0999, 0.0982, 0.0890, 0.0078, 0.0842],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1800, 0.1861, 0.1940, 0.1996, 0.2403], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0192, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0471, -0.0442, -0.0443, -0.0340, -0.0428]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2372404  0.21268618 0.19735932 0.1690716  0.18364252]
np_weight_alpha[1] [0.2134733  0.2248599  0.19994384 0.17455128 0.18717167]
np_weight_alpha[2] [0.19849211 0.20041369 0.22282465 0.1829716  0.19529794]
np_weight_alpha[3] [0.1860832  0.19084358 0.19271578 0.23247878 0.19787873]
np_weight_alpha[4] [0.18414144 0.18713899 0.19479577 0.19024882 0.24367496]
-------------Round number:  755  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5238095238095238
client Accurancy:  0.49603174603174605
client Accurancy:  0.4166666666666667
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.44841269841269843
Average Global Trainning Accurancy:  0.7676870748299319
Average Global Trainning Loss:  0.6983204121492347
All users are selected
model: 0 tensor([0.2372, 0.2127, 0.1974, 0.1691, 0.1836], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0139, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0353, 0.0408, 0.0302, 0.0126, 0.0302],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2135, 0.2249, 0.1999, 0.1746, 0.1872], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0149,  0.0055,  0.0042, -0.0149,  0.0048],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1985, 0.2004, 0.2228, 0.1830, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0042, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0252, -0.0249, -0.0233, -0.0361, -0.0239],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1861, 0.1908, 0.1927, 0.2325, 0.1979], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0130, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00],
        [-9.0171e-05, -1.3247e-03,  6.2078e-05,  4.7648e-03, -6.0870e-03],
        [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00,  0.0000e+00]],
       device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1841, 0.1871, 0.1948, 0.1902, 0.2437], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0122, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0170, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0047, -0.0038, -0.0035, -0.0193,  0.0016]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23347034 0.20094492 0.19627196 0.18605825 0.18325453]
np_weight_alpha[1] [0.15577492 0.20870097 0.19000262 0.26987776 0.17564368]
np_weight_alpha[2] [0.19674909 0.19840254 0.22012678 0.19233686 0.19238473]
np_weight_alpha[3] [0.18398407 0.1943218  0.1894653  0.20550142 0.22672747]
np_weight_alpha[4] [0.17677803 0.17545474 0.18127559 0.262988   0.2035037 ]
-------------Round number:  756  -------------
client Accurancy:  0.5
client Accurancy:  0.5277777777777778
client Accurancy:  0.48412698412698413
client Accurancy:  0.4126984126984127
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.44761904761904764
Average Global Trainning Accurancy:  0.7561224489795918
Average Global Trainning Loss:  0.7356385522959183
All users are selected
model: 0 tensor([0.2335, 0.2009, 0.1963, 0.1861, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0394, 0.0365, 0.0406, 0.0359, 0.0427],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1558, 0.2087, 0.1900, 0.2699, 0.1756], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0380, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0275,  0.0095,  0.0183,  0.0987,  0.0127],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1967, 0.1984, 0.2201, 0.1923, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0198, -0.0234, -0.0291, -0.0272],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1840, 0.1943, 0.1895, 0.2055, 0.2267], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0057, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0256, -0.0210, -0.0275, -0.0300,  0.0050],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1768, 0.1755, 0.1813, 0.2630, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0274, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0160, -0.0239, -0.0270,  0.0481, -0.0462]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23494919 0.20260133 0.1939261  0.18870187 0.17982149]
np_weight_alpha[1] [0.2053108  0.22233093 0.1936846  0.1932049  0.1854688 ]
np_weight_alpha[2] [0.19436999 0.1937684  0.2198705  0.19690879 0.19508232]
np_weight_alpha[3] [0.1898122  0.19541702 0.19702488 0.21606202 0.20168395]
np_weight_alpha[4] [0.17984842 0.18589616 0.19430517 0.20090754 0.2390427 ]
-------------Round number:  757  -------------
client Accurancy:  0.49206349206349204
client Accurancy:  0.5158730158730159
client Accurancy:  0.4523809523809524
client Accurancy:  0.4087301587301587
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.7622448979591837
Average Global Trainning Loss:  0.7029233763818027
All users are selected
model: 0 tensor([0.2349, 0.2026, 0.1939, 0.1887, 0.1798], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0090, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0471, 0.0360, 0.0424, 0.0464, 0.0424],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2053, 0.2223, 0.1937, 0.1932, 0.1855], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0116, 0.0185, 0.0128, 0.0192, 0.0172],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1938, 0.2199, 0.1969, 0.1951], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0174, -0.0204, -0.0175, -0.0167, -0.0146],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1898, 0.1954, 0.1970, 0.2161, 0.2017], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0219, -0.0211, -0.0261, -0.0350, -0.0301],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1798, 0.1859, 0.1943, 0.2009, 0.2390], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0153, -0.0131, -0.0130, -0.0186, -0.0141]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23218217 0.2088127  0.19364192 0.18489783 0.1804655 ]
np_weight_alpha[1] [0.20930092 0.22025794 0.19638158 0.18973172 0.18432789]
np_weight_alpha[2] [0.19428132 0.1965787  0.22083746 0.19603507 0.1922674 ]
np_weight_alpha[3] [0.18496124 0.18952554 0.19585435 0.2251786  0.20448029]
np_weight_alpha[4] [0.1802056  0.18375371 0.19154748 0.20356879 0.2409244 ]
-------------Round number:  758  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5238095238095238
client Accurancy:  0.4880952380952381
client Accurancy:  0.4126984126984127
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.4444444444444444
Average Global Trainning Accurancy:  0.7680272108843538
Average Global Trainning Loss:  0.7094608644238946
All users are selected
model: 0 tensor([0.2322, 0.2088, 0.1936, 0.1849, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0301, 0.0368, 0.0283, 0.0273, 0.0271],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2093, 0.2203, 0.1964, 0.1897, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0043, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0168, 0.0095, 0.0087, 0.0048, 0.0063],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1943, 0.1966, 0.2208, 0.1960, 0.1923], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0239, -0.0324, -0.0167, -0.0198],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1850, 0.1895, 0.1959, 0.2252, 0.2045], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0050, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0101, -0.0121, -0.0010, -0.0065, -0.0080],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1802, 0.1838, 0.1915, 0.2036, 0.2409], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0121, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0168, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0112, -0.0115, -0.0054, -0.0095, -0.0030]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23379979 0.20113473 0.19459262 0.1871904  0.18328248]
np_weight_alpha[1] [0.17288606 0.21904448 0.19837281 0.2114743  0.19822234]
np_weight_alpha[2] [0.19488017 0.19643866 0.2313565  0.18895084 0.18837386]
np_weight_alpha[3] [0.19697884 0.21151893 0.16555922 0.21995224 0.20599079]
np_weight_alpha[4] [0.19533752 0.20018157 0.17884044 0.21030837 0.21533212]
-------------Round number:  759  -------------
client Accurancy:  0.5158730158730159
client Accurancy:  0.5317460317460317
client Accurancy:  0.48412698412698413
client Accurancy:  0.40476190476190477
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.7581632653061224
Average Global Trainning Loss:  0.7536805444834184
All users are selected
model: 0 tensor([0.2338, 0.2011, 0.1946, 0.1872, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0395, 0.0346, 0.0364, 0.0337, 0.0394],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1729, 0.2190, 0.1984, 0.2115, 0.1982], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0062, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0080,  0.0226,  0.0280,  0.0400,  0.0360],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1949, 0.1964, 0.2314, 0.1890, 0.1884], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0200, -0.0100, -0.0304, -0.0290],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1970, 0.2115, 0.1656, 0.2200, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0167, -0.0077, -0.0560, -0.0196, -0.0194],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1953, 0.2002, 0.1788, 0.2103, 0.2153], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0006, -0.0012, -0.0313, -0.0063, -0.0369]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23269959 0.20253241 0.19423272 0.18967965 0.1808556 ]
np_weight_alpha[1] [0.20432875 0.22076629 0.19383593 0.19494091 0.18612814]
np_weight_alpha[2] [0.19457172 0.19398122 0.21971568 0.19684507 0.19488636]
np_weight_alpha[3] [0.18986025 0.19521368 0.1974781  0.21611586 0.20133208]
np_weight_alpha[4] [0.17980559 0.18586169 0.19413802 0.2005294  0.23966531]
-------------Round number:  760  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5119047619047619
client Accurancy:  0.4603174603174603
client Accurancy:  0.40476190476190477
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.7646258503401361
Average Global Trainning Loss:  0.7174148663371599
All users are selected
model: 0 tensor([0.2327, 0.2025, 0.1942, 0.1897, 0.1809], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0186, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0131, -0.0216, -0.0151,  0.0306, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2043, 0.2208, 0.1938, 0.1949, 0.1861], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0469, -0.0392, -0.0441,  0.0008, -0.0384],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1940, 0.2197, 0.1968, 0.1949], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0120, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0689, -0.0711, -0.0654, -0.0307, -0.0667],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1899, 0.1952, 0.1975, 0.2161, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0710, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2067, 0.2029, 0.1984, 0.0390, 0.1931],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1798, 0.1859, 0.1941, 0.2005, 0.2397], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0206, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0759, -0.0723, -0.0739, -0.0414, -0.0702]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24072795 0.2159185  0.20052549 0.1560408  0.18678719]
np_weight_alpha[1] [0.2170713  0.2267236  0.20311925 0.16317977 0.18990603]
np_weight_alpha[2] [0.19600299 0.1958439  0.22148156 0.19080245 0.1958691 ]
np_weight_alpha[3] [0.18179654 0.18744323 0.19043869 0.2451426  0.19517899]
np_weight_alpha[4] [0.18142593 0.18631779 0.1945007  0.19441326 0.24334234]
-------------Round number:  761  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5277777777777778
client Accurancy:  0.4880952380952381
client Accurancy:  0.4166666666666667
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.7738095238095238
Average Global Trainning Loss:  0.6808759001647534
All users are selected
model: 0 tensor([0.2407, 0.2159, 0.2005, 0.1560, 0.1868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0201, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0094, -0.0045, -0.0152, -0.0346, -0.0152],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2171, 0.2267, 0.2031, 0.1632, 0.1899], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0320, -0.0417, -0.0433, -0.0620, -0.0441],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1960, 0.1958, 0.2215, 0.1908, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0824, -0.0843, -0.0790, -0.0645, -0.0772],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1818, 0.1874, 0.1904, 0.2451, 0.1952], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0132, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0398, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2169, 0.2164, 0.2190, 0.1674, 0.2134],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1814, 0.1863, 0.1945, 0.1944, 0.2433], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0124, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0605, -0.0586, -0.0565, -0.0489, -0.0516]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.23626666 0.20364593 0.19889838 0.17545474 0.18573424]
np_weight_alpha[1] [0.20391549 0.22468652 0.20125279 0.18099867 0.18914662]
np_weight_alpha[2] [0.19668335 0.19690207 0.22264497 0.18822938 0.19554028]
np_weight_alpha[3] [0.1790065  0.18422475 0.18651798 0.25818422 0.19206654]
np_weight_alpha[4] [0.18208835 0.1862441  0.19362831 0.19207168 0.24596757]
-------------Round number:  762  -------------
client Accurancy:  0.49603174603174605
client Accurancy:  0.5317460317460317
client Accurancy:  0.47619047619047616
client Accurancy:  0.42063492063492064
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4492063492063492
Average Global Trainning Accurancy:  0.7772108843537415
Average Global Trainning Loss:  0.6641754773198342
All users are selected
model: 0 tensor([0.2363, 0.2036, 0.1989, 0.1755, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0107, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0320, 0.0279, 0.0389, 0.0132, 0.0347],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2039, 0.2247, 0.2013, 0.1810, 0.1891], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0055, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0150, 0.0179, 0.0286, 0.0008, 0.0183],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1967, 0.1969, 0.2226, 0.1882, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0035, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0132, -0.0126, -0.0320, -0.0256, -0.0194],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1790, 0.1842, 0.1865, 0.2582, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0216, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0189, -0.0181, -0.0129,  0.0363, -0.0165],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1821, 0.1862, 0.1936, 0.1921, 0.2460], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0136, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0166, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0169, -0.0193, -0.0191, -0.0294, -0.0079]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23559377 0.20421316 0.18877883 0.19093268 0.18048154]
np_weight_alpha[1] [0.20460914 0.22382765 0.18867798 0.19593172 0.1869535 ]
np_weight_alpha[2] [0.18885498 0.18851389 0.23625636 0.19264759 0.19372717]
np_weight_alpha[3] [0.191831   0.19613443 0.19329448 0.21635737 0.20238277]
np_weight_alpha[4] [0.18053012 0.18653277 0.19341706 0.20197442 0.2375456 ]
-------------Round number:  763  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5277777777777778
client Accurancy:  0.4801587301587302
client Accurancy:  0.4126984126984127
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.7690476190476191
Average Global Trainning Loss:  0.6790403612616922
All users are selected
model: 0 tensor([0.2356, 0.2042, 0.1888, 0.1909, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0307, 0.0201, 0.0198, 0.0377, 0.0267],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2046, 0.2238, 0.1887, 0.1959, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0075,  0.0012, -0.0104,  0.0108,  0.0018],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1889, 0.1885, 0.2363, 0.1926, 0.1937], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0094, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0391, -0.0416, -0.0153, -0.0315, -0.0317],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1918, 0.1961, 0.1933, 0.2164, 0.2024], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0208, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0501, 0.0499, 0.0389, 0.0117, 0.0393],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1805, 0.1865, 0.1934, 0.2020, 0.2375], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0191, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0326, -0.0302, -0.0326, -0.0309, -0.0349]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23344128 0.21042767 0.19504659 0.18026702 0.18081738]
np_weight_alpha[1] [0.23765421 0.21041667 0.23574947 0.1439252  0.1722544 ]
np_weight_alpha[2] [0.19593577 0.19805703 0.22042033 0.19220328 0.19338359]
np_weight_alpha[3] [0.1795368  0.18358818 0.1912277  0.2458833  0.19976403]
np_weight_alpha[4] [0.18066609 0.1840201  0.19268714 0.19949178 0.24313484]
-------------Round number:  764  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5198412698412699
client Accurancy:  0.4880952380952381
client Accurancy:  0.4087301587301587
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.44603174603174606
Average Global Trainning Accurancy:  0.7775510204081633
Average Global Trainning Loss:  0.6800317050648385
All users are selected
model: 0 tensor([0.2334, 0.2104, 0.1950, 0.1803, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0100, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0283, 0.0332, 0.0237, 0.0191, 0.0238],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2377, 0.2104, 0.2357, 0.1439, 0.1723], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0336, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0523,  0.0081,  0.0531, -0.0349,  0.0004],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1959, 0.1981, 0.2204, 0.1922, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0294, -0.0298, -0.0266, -0.0286, -0.0269],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1795, 0.1836, 0.1912, 0.2459, 0.1998], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0110, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0112, -0.0130, -0.0052,  0.0186, -0.0077],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1807, 0.1840, 0.1927, 0.1995, 0.2431], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0111, -0.0114, -0.0087, -0.0138, -0.0013]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23238511 0.20214556 0.19624503 0.18655951 0.1826648 ]
np_weight_alpha[1] [0.20089144 0.21869992 0.19821727 0.19443741 0.18775389]
np_weight_alpha[2] [0.19680575 0.19936784 0.21943115 0.19244523 0.19195004]
np_weight_alpha[3] [0.18707512 0.19263417 0.19240983 0.22452313 0.20335779]
np_weight_alpha[4] [0.18984234 0.1944746  0.18972811 0.22299597 0.20295896]
-------------Round number:  765  -------------
client Accurancy:  0.4880952380952381
client Accurancy:  0.5277777777777778
client Accurancy:  0.4801587301587302
client Accurancy:  0.4087301587301587
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.7700680272108843
Average Global Trainning Loss:  0.7265030426232993
All users are selected
model: 0 tensor([0.2324, 0.2021, 0.1962, 0.1866, 0.1827], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0153, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0358, 0.0333, 0.0383, 0.0323, 0.0380],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2009, 0.2187, 0.1982, 0.1944, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0027, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0220, 0.0245, 0.0306, 0.0241, 0.0266],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1968, 0.1994, 0.2194, 0.1924, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0116, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0267, -0.0239, -0.0346, -0.0330, -0.0327],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1871, 0.1926, 0.1924, 0.2245, 0.2034], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0045, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0186, -0.0192, -0.0186, -0.0065, -0.0162],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1898, 0.1945, 0.1897, 0.2230, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0178, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0054, -0.0076, -0.0205,  0.0034, -0.0491]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23387209 0.20362987 0.19282973 0.18924496 0.1804234 ]
np_weight_alpha[1] [0.20420265 0.22036688 0.19294478 0.19564994 0.18683572]
np_weight_alpha[2] [0.19310057 0.19284764 0.22493763 0.19492142 0.19419278]
np_weight_alpha[3] [0.18995494 0.19587027 0.19506809 0.21557297 0.20353374]
np_weight_alpha[4] [0.17954618 0.18571913 0.1934805  0.20279308 0.238461  ]
-------------Round number:  766  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5119047619047619
client Accurancy:  0.4642857142857143
client Accurancy:  0.4126984126984127
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4396825396825397
Average Global Trainning Accurancy:  0.7704081632653061
Average Global Trainning Loss:  0.6851720277954932
All users are selected
model: 0 tensor([0.2339, 0.2036, 0.1928, 0.1892, 0.1804], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0441, 0.0343, 0.0383, 0.0440, 0.0400],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2042, 0.2204, 0.1929, 0.1956, 0.1868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0103, 0.0177, 0.0116, 0.0206, 0.0185],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1931, 0.1928, 0.2249, 0.1949, 0.1942], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0039, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0197, -0.0223, -0.0123, -0.0191, -0.0169],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1900, 0.1959, 0.1951, 0.2156, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0158, -0.0154, -0.0215, -0.0283, -0.0220],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1795, 0.1857, 0.1935, 0.2028, 0.2385], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0158, -0.0169, -0.0191, -0.0160]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23132002 0.20886001 0.19392641 0.18515126 0.18074235]
np_weight_alpha[1] [0.20945936 0.21889086 0.19671728 0.19059084 0.18434165]
np_weight_alpha[2] [0.19455703 0.19689076 0.21987118 0.19573177 0.1929492 ]
np_weight_alpha[3] [0.18526258 0.19050615 0.19556402 0.2241317  0.2045355 ]
np_weight_alpha[4] [0.18056418 0.1839159  0.19223529 0.20367917 0.2396055 ]
-------------Round number:  767  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5238095238095238
client Accurancy:  0.5
client Accurancy:  0.4087301587301587
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.44682539682539685
Average Global Trainning Accurancy:  0.7704081632653061
Average Global Trainning Loss:  0.7031857029921343
All users are selected
model: 0 tensor([0.2313, 0.2089, 0.1939, 0.1852, 0.1807], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0257, 0.0322, 0.0228, 0.0234, 0.0236],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2095, 0.2189, 0.1967, 0.1906, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0175, 0.0099, 0.0083, 0.0070, 0.0075],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1946, 0.1969, 0.2199, 0.1957, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0274, -0.0269, -0.0243, -0.0235, -0.0242],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1853, 0.1905, 0.1956, 0.2241, 0.2045], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0046, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0099, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0034, -0.0043,  0.0002,  0.0022, -0.0012],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1806, 0.1839, 0.1922, 0.2037, 0.2396], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0114, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0112, -0.0119, -0.0088, -0.0098, -0.0034]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23288658 0.20142916 0.19594869 0.18698454 0.18275103]
np_weight_alpha[1] [0.2017321  0.2196842  0.19815645 0.19339566 0.18703166]
np_weight_alpha[2] [0.19652262 0.19825374 0.21952671 0.19387423 0.19182271]
np_weight_alpha[3] [0.19550304 0.20547824 0.188337   0.20673963 0.20394208]
np_weight_alpha[4] [0.19136764 0.19818664 0.19113873 0.20756422 0.21174276]
-------------Round number:  768  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5238095238095238
client Accurancy:  0.4801587301587302
client Accurancy:  0.4007936507936508
client Accurancy:  0.31746031746031744
Average Global Accurancy:  0.4396825396825397
Average Global Trainning Accurancy:  0.7663265306122449
Average Global Trainning Loss:  0.7307487643494898
All users are selected
model: 0 tensor([0.2329, 0.2014, 0.1959, 0.1870, 0.1828], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0379, 0.0333, 0.0369, 0.0316, 0.0377],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2197, 0.1982, 0.1934, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0222, 0.0255, 0.0272, 0.0213, 0.0245],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1965, 0.1983, 0.2195, 0.1939, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0272, -0.0261, -0.0278, -0.0315, -0.0339],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1955, 0.2055, 0.1883, 0.2067, 0.2039], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0124, -0.0080, -0.0253, -0.0259, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1914, 0.1982, 0.1911, 0.2076, 0.2117], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0175, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0032, -0.0028, -0.0200, -0.0093, -0.0388]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23205186 0.20293523 0.19390298 0.19034314 0.18076684]
np_weight_alpha[1] [0.20338792 0.21883088 0.1948929  0.19602145 0.18686692]
np_weight_alpha[2] [0.19426802 0.19490781 0.21862426 0.19593085 0.19626914]
np_weight_alpha[3] [0.19054118 0.19584925 0.19606446 0.21559423 0.20195095]
np_weight_alpha[4] [0.1798285  0.18568653 0.19540952 0.20109643 0.23797907]
-------------Round number:  769  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5079365079365079
client Accurancy:  0.45634920634920634
client Accurancy:  0.4087301587301587
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.7683673469387755
Average Global Trainning Loss:  0.6943086585220025
All users are selected
model: 0 tensor([0.2321, 0.2029, 0.1939, 0.1903, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0443, 0.0350, 0.0412, 0.0455, 0.0412],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2034, 0.2188, 0.1949, 0.1960, 0.1869], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0118, 0.0188, 0.0160, 0.0231, 0.0202],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1949, 0.2186, 0.1959, 0.1963], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0201, -0.0222, -0.0206, -0.0212, -0.0167],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1905, 0.1958, 0.1961, 0.2156, 0.2020], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0192, -0.0187, -0.0246, -0.0279, -0.0280],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1798, 0.1857, 0.1954, 0.2011, 0.2380], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0167, -0.0146, -0.0129, -0.0204, -0.0125]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23049676 0.20878989 0.19350505 0.18599366 0.18121468]
np_weight_alpha[1] [0.20936544 0.21847354 0.19652689 0.19073696 0.18489721]
np_weight_alpha[2] [0.19407398 0.19669993 0.21977855 0.19674861 0.19269885]
np_weight_alpha[3] [0.18616383 0.19070688 0.19666152 0.2204359  0.20603192]
np_weight_alpha[4] [0.1811165  0.18455714 0.19208933 0.20514089 0.23709616]
-------------Round number:  770  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5158730158730159
client Accurancy:  0.4880952380952381
client Accurancy:  0.40476190476190477
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.7741496598639456
Average Global Trainning Loss:  0.6954658767803996
All users are selected
model: 0 tensor([0.2305, 0.2088, 0.1935, 0.1860, 0.1812], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0261, 0.0328, 0.0230, 0.0242, 0.0239],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2094, 0.2185, 0.1965, 0.1907, 0.1849], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0038, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0175, 0.0100, 0.0082, 0.0069, 0.0074],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1941, 0.1967, 0.2198, 0.1967, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0306, -0.0298, -0.0270, -0.0258, -0.0273],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1862, 0.1907, 0.1967, 0.2204, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0016, -0.0030,  0.0022,  0.0008,  0.0021],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 25.0
model: 4 tensor([0.1811, 0.1846, 0.1921, 0.2051, 0.2371], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0103, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0157, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0102, -0.0109, -0.0079, -0.0070, -0.0042]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.2320073  0.201282   0.19585054 0.1875262  0.18333405]
np_weight_alpha[1] [0.20156255 0.21905057 0.19804984 0.19371885 0.18761821]
np_weight_alpha[2] [0.19639044 0.19812864 0.21934056 0.19433814 0.19180226]
np_weight_alpha[3] [0.22455677 0.274714   0.14697596 0.19668911 0.15706417]
np_weight_alpha[4] [0.19201808 0.19851553 0.19149543 0.199757   0.218214  ]
-------------Round number:  771  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5238095238095238
client Accurancy:  0.4801587301587302
client Accurancy:  0.3968253968253968
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.7503401360544217
Average Global Trainning Loss:  0.7709716796875
All users are selected
model: 0 tensor([0.2320, 0.2013, 0.1959, 0.1875, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0369, 0.0329, 0.0371, 0.0333, 0.0381],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2016, 0.2191, 0.1980, 0.1937, 0.1876], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0224, 0.0257, 0.0274, 0.0230, 0.0259],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1964, 0.1981, 0.2193, 0.1943, 0.1918], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0233, -0.0227, -0.0218, -0.0282, -0.0311],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2246, 0.2747, 0.1470, 0.1967, 0.1571], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0543, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0085,  0.0527, -0.0804, -0.0487, -0.0775],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1920, 0.1985, 0.1915, 0.1998, 0.2182], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0010, -0.0005, -0.0187, -0.0155, -0.0285]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23237571 0.2033277  0.19375941 0.1894638  0.1810734 ]
np_weight_alpha[1] [0.20381066 0.21880227 0.1952473  0.19533114 0.18680853]
np_weight_alpha[2] [0.19416867 0.19529614 0.21616033 0.19703943 0.19733544]
np_weight_alpha[3] [0.21414492 0.26328295 0.15879191 0.19725847 0.16652174]
np_weight_alpha[4] [0.1803195  0.18581209 0.19649373 0.2014879  0.23588684]
-------------Round number:  772  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5119047619047619
client Accurancy:  0.44841269841269843
client Accurancy:  0.39285714285714285
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.43253968253968256
Average Global Trainning Accurancy:  0.7568027210884354
Average Global Trainning Loss:  0.7258898676658163
All users are selected
model: 0 tensor([0.2324, 0.2033, 0.1938, 0.1895, 0.1811], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[1.0037e-02, 1.8775e-05, 1.5848e-02, 1.9894e-02, 2.9318e-03],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00]],
       device='cuda:0')
teacher_idx: 0 grad_lr: 5.0
model: 1 tensor([0.2038, 0.2188, 0.1952, 0.1953, 0.1868], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0246, -0.0195, -0.0062, -0.0046, -0.0207],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1942, 0.1953, 0.2162, 0.1970, 0.1973], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0318, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0351,  0.0375, -0.0200,  0.0425,  0.0482],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2141, 0.2633, 0.1588, 0.1973, 0.1665], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0352, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0291, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0607,  0.1039, -0.0049, -0.0377, -0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1803, 0.1858, 0.1965, 0.2015, 0.2359], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0209, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0525, -0.0515, -0.0263, -0.0407, -0.0527]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22837716 0.25371674 0.16282077 0.14402992 0.21105546]
np_weight_alpha[1] [0.2130768  0.22391456 0.18623976 0.18480639 0.19196244]
np_weight_alpha[2] [0.18545522 0.18423966 0.27261043 0.18123382 0.17646088]
np_weight_alpha[3] [0.1750735  0.180353   0.18422574 0.26313466 0.19721304]
np_weight_alpha[4] [0.18712123 0.1914169  0.1780199  0.19615361 0.24728829]
-------------Round number:  773  -------------
client Accurancy:  0.5
client Accurancy:  0.5079365079365079
client Accurancy:  0.503968253968254
client Accurancy:  0.4007936507936508
client Accurancy:  0.30158730158730157
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.7833333333333333
Average Global Trainning Loss:  0.6893015751222364
All users are selected
model: 0 tensor([0.2284, 0.2537, 0.1628, 0.1440, 0.2111], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0416, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0929, -0.0405, -0.1140, -0.1015, -0.0645],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 0.2
model: 1 tensor([0.2131, 0.2239, 0.1862, 0.1848, 0.1920], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1123, -0.1168, -0.1213, -0.0869, -0.1176],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1855, 0.1842, 0.2726, 0.1812, 0.1765], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0332, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0233, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0588, -0.0629, -0.0294, -0.0426, -0.0602],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1751, 0.1804, 0.1842, 0.2631, 0.1972], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0262, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0642, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.4351, 0.4351, 0.4275, 0.3395, 0.4421],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.04
model: 4 tensor([0.1871, 0.1914, 0.1780, 0.1962, 0.2473], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0149, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0232, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1611, -0.1597, -0.1599, -0.1256, -0.1540]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.22904667 0.24671273 0.16854809 0.15152745 0.20416507]
np_weight_alpha[1] [0.2130434  0.22592318 0.18798628 0.18032515 0.192722  ]
np_weight_alpha[2] [0.18450202 0.18413998 0.27699256 0.17774196 0.17662343]
np_weight_alpha[3] [0.17319416 0.17782652 0.1815824  0.27419767 0.1931992 ]
np_weight_alpha[4] [0.18776551 0.19157296 0.17919885 0.1895865  0.2518762 ]
-------------Round number:  774  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5119047619047619
client Accurancy:  0.4722222222222222
client Accurancy:  0.43253968253968256
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.44365079365079363
Average Global Trainning Accurancy:  0.7969387755102041
Average Global Trainning Loss:  0.6273182564041242
All users are selected
model: 0 tensor([0.2290, 0.2467, 0.1685, 0.1515, 0.2042], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0319, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0080,  0.0553, -0.0138, -0.0231,  0.0363],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2130, 0.2259, 0.1880, 0.1803, 0.1927], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0265, 0.0221, 0.0122, 0.0056, 0.0239],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1845, 0.1841, 0.2770, 0.1777, 0.1766], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0373, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0361, -0.0361,  0.0320, -0.0468, -0.0451],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1732, 0.1778, 0.1816, 0.2742, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0355, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0068, 0.0058, 0.0047, 0.0775, 0.0104],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1878, 0.1916, 0.1792, 0.1896, 0.2519], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0173, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0174, -0.0198, -0.0405, -0.0397, -0.0060]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23552613 0.20306128 0.19414759 0.18674803 0.18051691]
np_weight_alpha[1] [0.20422481 0.22275181 0.19353643 0.19257729 0.18690965]
np_weight_alpha[2] [0.19406866 0.19373494 0.21918298 0.19788972 0.19512375]
np_weight_alpha[3] [0.18754584 0.19292164 0.19766319 0.21827187 0.20359744]
np_weight_alpha[4] [0.18062025 0.18631488 0.19423917 0.20375386 0.23507184]
-------------Round number:  775  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5079365079365079
client Accurancy:  0.4722222222222222
client Accurancy:  0.4246031746031746
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.777891156462585
Average Global Trainning Loss:  0.6621672545971513
All users are selected
model: 0 tensor([0.2355, 0.2031, 0.1941, 0.1867, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0093, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0146, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0302, 0.0179, 0.0326, 0.0231, 0.0243],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2042, 0.2228, 0.1935, 0.1926, 0.1869], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0027,  0.0067,  0.0091,  0.0022,  0.0043],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1941, 0.1937, 0.2192, 0.1979, 0.1951], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0240, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0298,  0.0284, -0.0070,  0.0296,  0.0340],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1929, 0.1977, 0.2183, 0.2036], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0220, -0.0217, -0.0138, -0.0195, -0.0243],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1806, 0.1863, 0.1942, 0.2038, 0.2351], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0189, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0333, -0.0325, -0.0222, -0.0361, -0.0370]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23246804 0.21015073 0.18678409 0.18877383 0.18182328]
np_weight_alpha[1] [0.23932396 0.2076058  0.16891898 0.19987415 0.18427718]
np_weight_alpha[2] [0.1861106  0.18713753 0.25367886 0.18988664 0.1831864 ]
np_weight_alpha[3] [0.18927014 0.19415708 0.19109079 0.21794547 0.20753652]
np_weight_alpha[4] [0.18135406 0.18585578 0.1836578  0.20652315 0.24260925]
-------------Round number:  776  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5079365079365079
client Accurancy:  0.46825396825396826
client Accurancy:  0.4166666666666667
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.7775510204081633
Average Global Trainning Loss:  0.6765261280293368
All users are selected
model: 0 tensor([0.2325, 0.2102, 0.1868, 0.1888, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0204, 0.0266, 0.0080, 0.0244, 0.0179],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2393, 0.2076, 0.1689, 0.1999, 0.1843], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0141, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0089, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0474, -0.0005, -0.0216,  0.0190,  0.0059],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1861, 0.1871, 0.2537, 0.1899, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0181, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0378, -0.0384,  0.0085, -0.0249, -0.0355],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1893, 0.1942, 0.1911, 0.2179, 0.2075], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0182, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0100,  0.0077,  0.0067, -0.0150,  0.0131],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1814, 0.1859, 0.1837, 0.2065, 0.2426], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0171, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0114, -0.0115, -0.0187, -0.0014, -0.0030]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23318794 0.20223178 0.19745871 0.18379433 0.18332733]
np_weight_alpha[1] [0.20171124 0.2186626  0.20026395 0.1908751  0.18848705]
np_weight_alpha[2] [0.19802131 0.19963999 0.22025242 0.18916069 0.19292562]
np_weight_alpha[3] [0.1835166  0.19024289 0.18830973 0.23996398 0.19796684]
np_weight_alpha[4] [0.19157402 0.19639482 0.23233902 0.1688793  0.21081278]
-------------Round number:  777  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5158730158730159
client Accurancy:  0.48412698412698413
client Accurancy:  0.4246031746031746
client Accurancy:  0.2857142857142857
Average Global Accurancy:  0.4373015873015873
Average Global Trainning Accurancy:  0.7690476190476191
Average Global Trainning Loss:  0.7263348014987245
All users are selected
model: 0 tensor([0.2332, 0.2022, 0.1975, 0.1838, 0.1833], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0342, 0.0299, 0.0351, 0.0297, 0.0358],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2017, 0.2187, 0.2003, 0.1909, 0.1885], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0228, 0.0261, 0.0317, 0.0227, 0.0285],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1980, 0.1996, 0.2203, 0.1892, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0029, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0280, -0.0261, -0.0270, -0.0400, -0.0335],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1835, 0.1902, 0.1883, 0.2400, 0.1980], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0105, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0133, -0.0139, -0.0193,  0.0161, -0.0173],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1916, 0.1964, 0.2323, 0.1689, 0.2108], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0111, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0066, -0.0083,  0.0190, -0.0568, -0.0417]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23365492 0.2044749  0.19457537 0.18668696 0.1806079 ]
np_weight_alpha[1] [0.20505202 0.21953613 0.19468874 0.19425772 0.18646537]
np_weight_alpha[2] [0.19498841 0.19476321 0.21688032 0.19802684 0.19534123]
np_weight_alpha[3] [0.18748866 0.19444077 0.19790344 0.21457998 0.20558721]
np_weight_alpha[4] [0.17949337 0.1854263  0.19365062 0.20593852 0.23549111]
-------------Round number:  778  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.46825396825396826
client Accurancy:  0.4246031746031746
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.782312925170068
Average Global Trainning Loss:  0.661054836973852
All users are selected
model: 0 tensor([0.2337, 0.2045, 0.1946, 0.1867, 0.1806], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0087, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0137, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0398, 0.0305, 0.0358, 0.0346, 0.0352],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2051, 0.2195, 0.1947, 0.1943, 0.1865], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0090, 0.0151, 0.0115, 0.0146, 0.0159],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1950, 0.1948, 0.2169, 0.1980, 0.1953], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0153, -0.0180, -0.0159, -0.0167, -0.0156],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1875, 0.1944, 0.1979, 0.2146, 0.2056], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0109, -0.0096, -0.0117, -0.0122, -0.0115],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1795, 0.1854, 0.1937, 0.2059, 0.2355], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0098, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0165, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0220, -0.0194, -0.0220, -0.0208, -0.0203]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23034039 0.20852931 0.19334133 0.18698175 0.18080725]
np_weight_alpha[1] [0.2090776  0.21810205 0.1961208  0.19259639 0.18410313]
np_weight_alpha[2] [0.19390182 0.19630559 0.21696769 0.198267   0.19455789]
np_weight_alpha[3] [0.1873869  0.19274282 0.19820715 0.21593304 0.20573011]
np_weight_alpha[4] [0.18061018 0.18367442 0.19382179 0.20492007 0.23697355]
-------------Round number:  779  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.5158730158730159
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.44126984126984126
Average Global Trainning Accurancy:  0.7761904761904762
Average Global Trainning Loss:  0.6902332954666242
All users are selected
model: 0 tensor([0.2303, 0.2085, 0.1933, 0.1870, 0.1808], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0233, 0.0294, 0.0185, 0.0225, 0.0206],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2091, 0.2181, 0.1961, 0.1926, 0.1841], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0037, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0166, 0.0100, 0.0061, 0.0086, 0.0054],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 5.0
model: 2 tensor([0.1939, 0.1963, 0.2170, 0.1983, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0019, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0264, -0.0244, -0.0174, -0.0208],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1874, 0.1927, 0.1982, 0.2159, 0.2057], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0112, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0018, -0.0024,  0.0038, -0.0090, -0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1806, 0.1837, 0.1938, 0.2049, 0.2370], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0095, -0.0112, -0.0056, -0.0061, -0.0028]], device='cuda:0')
teacher_idx: 4 grad_lr: 5.0
np_weight_alpha[0] [0.23148632 0.2013154  0.19706361 0.18704015 0.18309452]
np_weight_alpha[1] [0.17420849 0.21470156 0.21227056 0.19579789 0.20302151]
np_weight_alpha[2] [0.19769506 0.19925284 0.21866147 0.19231623 0.19207443]
np_weight_alpha[3] [0.18510064 0.19325101 0.17006417 0.25612748 0.19545667]
np_weight_alpha[4] [0.19281411 0.2045731  0.18675569 0.19985855 0.21599858]
-------------Round number:  780  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.5119047619047619
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.30952380952380953
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.7738095238095238
Average Global Trainning Loss:  0.7056244519292092
All users are selected
model: 0 tensor([0.2315, 0.2013, 0.1971, 0.1870, 0.1831], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0319, 0.0281, 0.0347, 0.0315, 0.0351],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1742, 0.2147, 0.2123, 0.1958, 0.2030], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0053, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0089,  0.0195,  0.0409,  0.0255,  0.0419],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1977, 0.1993, 0.2187, 0.1923, 0.1921], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0261, -0.0255, -0.0251, -0.0358, -0.0344],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1851, 0.1933, 0.1701, 0.2561, 0.1955], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0217, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0132, -0.0116, -0.0391,  0.0328, -0.0199],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1928, 0.2046, 0.1868, 0.1999, 0.2160], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0025, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0031,  0.0028, -0.0267, -0.0222, -0.0329]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23353857 0.20466913 0.19392233 0.1873785  0.18049143]
np_weight_alpha[1] [0.20659594 0.21956511 0.19489653 0.19385932 0.1850831 ]
np_weight_alpha[2] [0.19436403 0.19530398 0.21474935 0.19858198 0.19700065]
np_weight_alpha[3] [0.18826815 0.1945273  0.19877636 0.2133926  0.20503558]
np_weight_alpha[4] [0.17968489 0.18504389 0.19618541 0.20484044 0.23424534]
-------------Round number:  781  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5
client Accurancy:  0.4880952380952381
client Accurancy:  0.42857142857142855
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.44285714285714284
Average Global Trainning Accurancy:  0.7816326530612245
Average Global Trainning Loss:  0.6617351090826956
All users are selected
model: 0 tensor([0.2335, 0.2047, 0.1939, 0.1874, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0423, 0.0329, 0.0369, 0.0366, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2066, 0.2196, 0.1949, 0.1939, 0.1851], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0036, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0112, 0.0161, 0.0115, 0.0147, 0.0135],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1953, 0.2147, 0.1986, 0.1970], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0014, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0223, -0.0242, -0.0258, -0.0219, -0.0190],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1883, 0.1945, 0.1988, 0.2134, 0.2050], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0019, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0089, -0.0077, -0.0088, -0.0117, -0.0113],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1797, 0.1850, 0.1962, 0.2048, 0.2342], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0092, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0199, -0.0181, -0.0154, -0.0198, -0.0174]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22943059 0.20817462 0.19334953 0.18737194 0.18167336]
np_weight_alpha[1] [0.20861715 0.21720383 0.19654693 0.19241619 0.18521592]
np_weight_alpha[2] [0.19387987 0.1966983  0.21852964 0.19764729 0.1932449 ]
np_weight_alpha[3] [0.18459955 0.18464577 0.19375125 0.22398497 0.21301843]
np_weight_alpha[4] [0.18147989 0.1847187  0.19267423 0.20573248 0.23539475]
-------------Round number:  782  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.5198412698412699
client Accurancy:  0.4880952380952381
client Accurancy:  0.40476190476190477
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4396825396825397
Average Global Trainning Accurancy:  0.7789115646258503
Average Global Trainning Loss:  0.6909910448554422
All users are selected
model: 0 tensor([0.2294, 0.2082, 0.1933, 0.1874, 0.1817], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0228, 0.0278, 0.0186, 0.0214, 0.0209],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2086, 0.2172, 0.1965, 0.1924, 0.1852], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0198, 0.0147, 0.0113, 0.0118, 0.0113],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1967, 0.2185, 0.1976, 0.1932], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0298, -0.0290, -0.0249, -0.0235, -0.0258],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1846, 0.1846, 0.1938, 0.2240, 0.2130], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0020, -0.0080,  0.0010,  0.0082,  0.0107],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1815, 0.1847, 0.1927, 0.2057, 0.2354], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0151, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0130, -0.0143, -0.0112, -0.0103, -0.0078]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2303383  0.20206183 0.19638634 0.18799539 0.18321815]
np_weight_alpha[1] [0.2023538  0.21669972 0.1988077  0.19423941 0.18789935]
np_weight_alpha[2] [0.19693777 0.19888854 0.21735096 0.1944342  0.19238858]
np_weight_alpha[3] [0.20348802 0.23618667 0.19762361 0.19203036 0.17067131]
np_weight_alpha[4] [0.18312004 0.18729763 0.19194788 0.20398301 0.23365143]
-------------Round number:  783  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5079365079365079
client Accurancy:  0.48412698412698413
client Accurancy:  0.39285714285714285
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.7707482993197279
Average Global Trainning Loss:  0.7102093962585034
All users are selected
model: 0 tensor([0.2303, 0.2021, 0.1964, 0.1880, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0302, 0.0274, 0.0322, 0.0303, 0.0337],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2024, 0.2167, 0.1988, 0.1942, 0.1879], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0206, 0.0228, 0.0266, 0.0229, 0.0258],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1969, 0.1989, 0.2174, 0.1944, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0068, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0255, -0.0246, -0.0242, -0.0316, -0.0325],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2035, 0.2362, 0.1976, 0.1920, 0.1707], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0113, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0013,  0.0270, -0.0162, -0.0378, -0.0516],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1831, 0.1873, 0.1919, 0.2040, 0.2337], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0108, -0.0123, -0.0188, -0.0143, -0.0120]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23251739 0.2047157  0.19423501 0.18803827 0.18049361]
np_weight_alpha[1] [0.20525731 0.21815597 0.19564833 0.19488187 0.1860565 ]
np_weight_alpha[2] [0.19470248 0.19573206 0.2141728  0.19826318 0.19712947]
np_weight_alpha[3] [0.18697388 0.1935572  0.19814995 0.21464539 0.2066736 ]
np_weight_alpha[4] [0.18048865 0.1856303  0.19625337 0.20384598 0.23378177]
-------------Round number:  784  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.49603174603174605
client Accurancy:  0.48412698412698413
client Accurancy:  0.42857142857142855
client Accurancy:  0.3412698412698413
Average Global Accurancy:  0.44047619047619047
Average Global Trainning Accurancy:  0.7836734693877551
Average Global Trainning Loss:  0.6623331705729166
All users are selected
model: 0 tensor([0.2325, 0.2047, 0.1942, 0.1880, 0.1805], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0426, 0.0336, 0.0375, 0.0385, 0.0359],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2053, 0.2182, 0.1956, 0.1949, 0.1861], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0110, 0.0160, 0.0129, 0.0180, 0.0152],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1947, 0.1957, 0.2142, 0.1983, 0.1971], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0175, -0.0195, -0.0208, -0.0172, -0.0142],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1870, 0.1936, 0.1981, 0.2146, 0.2067], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0083, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0183, -0.0162, -0.0176, -0.0206, -0.0180],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1805, 0.1856, 0.1963, 0.2038, 0.2338], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0152, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0178, -0.0161, -0.0135, -0.0188, -0.0145]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22878361 0.20822531 0.1937316  0.18692578 0.18233363]
np_weight_alpha[1] [0.20873114 0.21716568 0.1970497  0.19139963 0.18565385]
np_weight_alpha[2] [0.19426031 0.19723189 0.21767126 0.19743921 0.19339731]
np_weight_alpha[3] [0.1872339  0.1914826  0.19738515 0.21755144 0.20634694]
np_weight_alpha[4] [0.18217076 0.18528628 0.19287522 0.20575763 0.23391008]
-------------Round number:  785  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5079365079365079
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.4388888888888889
Average Global Trainning Accurancy:  0.7802721088435374
Average Global Trainning Loss:  0.6884301425648385
All users are selected
model: 0 tensor([0.2288, 0.2082, 0.1937, 0.1869, 0.1823], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0220, 0.0268, 0.0184, 0.0196, 0.0201],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2087, 0.2172, 0.1970, 0.1914, 0.1857], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0206, 0.0156, 0.0127, 0.0110, 0.0125],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1972, 0.2177, 0.1974, 0.1934], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0081, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0293, -0.0284, -0.0257, -0.0246, -0.0258],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1872, 0.1915, 0.1974, 0.2176, 0.2063], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0030, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0033, 0.0015, 0.0069, 0.0059, 0.0066],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1822, 0.1853, 0.1929, 0.2058, 0.2339], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0154, -0.0162, -0.0136, -0.0128, -0.0117]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22951831 0.20219791 0.19612378 0.18846957 0.18369044]
np_weight_alpha[1] [0.2024598  0.21646935 0.19858204 0.19469225 0.18779653]
np_weight_alpha[2] [0.1966231  0.19865657 0.21715407 0.19515078 0.19241552]
np_weight_alpha[3] [0.19484481 0.20802273 0.18730016 0.21242754 0.19740474]
np_weight_alpha[4] [0.1835401  0.18718387 0.1919523  0.20391871 0.23340496]
-------------Round number:  786  -------------
client Accurancy:  0.4722222222222222
client Accurancy:  0.5079365079365079
client Accurancy:  0.47619047619047616
client Accurancy:  0.4007936507936508
client Accurancy:  0.3333333333333333
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.7802721088435374
Average Global Trainning Loss:  0.685817256590136
All users are selected
model: 0 tensor([0.2295, 0.2022, 0.1961, 0.1885, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0144, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0279, 0.0250, 0.0300, 0.0284, 0.0311],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2025, 0.2165, 0.1986, 0.1947, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0196, 0.0223, 0.0257, 0.0223, 0.0242],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1966, 0.1987, 0.2172, 0.1952, 0.1924], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0019, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0236, -0.0228, -0.0220, -0.0295, -0.0310],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1948, 0.2080, 0.1873, 0.2124, 0.1974], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0021, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0065, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0040,  0.0024, -0.0225, -0.0115, -0.0183],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1835, 0.1872, 0.1920, 0.2039, 0.2334], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0132, -0.0149, -0.0212, -0.0162, -0.0127]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23163278 0.20500852 0.19397762 0.18815303 0.18122803]
np_weight_alpha[1] [0.20552403 0.21738291 0.19550747 0.19499944 0.18658617]
np_weight_alpha[2] [0.19441862 0.19558091 0.21368355 0.19876692 0.19755   ]
np_weight_alpha[3] [0.18825084 0.19471814 0.1988142  0.21337296 0.2048439 ]
np_weight_alpha[4] [0.18128352 0.18621571 0.1967481  0.20375225 0.23200037]
-------------Round number:  787  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.49206349206349204
client Accurancy:  0.4722222222222222
client Accurancy:  0.4246031746031746
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.4380952380952381
Average Global Trainning Accurancy:  0.780952380952381
Average Global Trainning Loss:  0.6679544254225127
All users are selected
model: 0 tensor([0.2316, 0.2050, 0.1940, 0.1882, 0.1812], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0133, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0440, 0.0363, 0.0395, 0.0449, 0.0378],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2055, 0.2174, 0.1955, 0.1950, 0.1866], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0028, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0082, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0146, 0.0189, 0.0162, 0.0247, 0.0180],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1944, 0.1956, 0.2137, 0.1988, 0.1975], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0084, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0157, -0.0174, -0.0186, -0.0116, -0.0122],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1883, 0.1947, 0.1988, 0.2134, 0.2048], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0155, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0273, -0.0262, -0.0287, -0.0504, -0.0280],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1813, 0.1862, 0.1967, 0.2038, 0.2320], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0160, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0146, -0.0128, -0.0099, -0.0087, -0.0133]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22935496 0.20870456 0.194312   0.18369974 0.18392868]
np_weight_alpha[1] [0.2092481  0.2173466  0.1974691  0.18878934 0.18714686]
np_weight_alpha[2] [0.19492047 0.19768004 0.21768737 0.19516426 0.19454785]
np_weight_alpha[3] [0.18344037 0.18839414 0.1947106  0.23344812 0.20000675]
np_weight_alpha[4] [0.18388247 0.18681648 0.19405581 0.19973902 0.23550616]
-------------Round number:  788  -------------
client Accurancy:  0.46825396825396826
client Accurancy:  0.503968253968254
client Accurancy:  0.47619047619047616
client Accurancy:  0.40476190476190477
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.7789115646258503
Average Global Trainning Loss:  0.6992972237723214
All users are selected
model: 0 tensor([0.2294, 0.2087, 0.1943, 0.1837, 0.1839], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0129, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0225, 0.0262, 0.0175, 0.0150, 0.0197],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2092, 0.2173, 0.1975, 0.1888, 0.1871], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0229, 0.0175, 0.0145, 0.0105, 0.0158],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1949, 0.1977, 0.2177, 0.1952, 0.1945], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0283, -0.0244, -0.0268, -0.0251],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1834, 0.1884, 0.1947, 0.2334, 0.2000], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0044, -0.0050,  0.0005,  0.0178, -0.0032],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1839, 0.1868, 0.1941, 0.1997, 0.2355], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0086, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0114, -0.0117, -0.0099, -0.0158, -0.0060]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22832645 0.20213902 0.19646099 0.18859558 0.18447791]
np_weight_alpha[1] [0.20236363 0.21645378 0.19899566 0.1943925  0.1877944 ]
np_weight_alpha[2] [0.19692832 0.19909252 0.21588907 0.19517367 0.19291644]
np_weight_alpha[3] [0.20970502 0.21813264 0.19625446 0.15454867 0.22135922]
np_weight_alpha[4] [0.18425618 0.18723479 0.19245629 0.20387368 0.23217914]
-------------Round number:  789  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5079365079365079
client Accurancy:  0.4801587301587302
client Accurancy:  0.38492063492063494
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.4357142857142857
Average Global Trainning Accurancy:  0.7738095238095238
Average Global Trainning Loss:  0.7041486467633928
All users are selected
model: 0 tensor([0.2283, 0.2021, 0.1965, 0.1886, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0276, 0.0254, 0.0304, 0.0277, 0.0315],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2024, 0.2165, 0.1990, 0.1944, 0.1878], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0023, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0211, 0.0241, 0.0272, 0.0225, 0.0250],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1969, 0.1991, 0.2159, 0.1952, 0.1929], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0217, -0.0208, -0.0213, -0.0279, -0.0294],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2097, 0.2181, 0.1963, 0.1545, 0.2214], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0072, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0076,  0.0090, -0.0164, -0.0727,  0.0040],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1843, 0.1872, 0.1925, 0.2039, 0.2322], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0136, -0.0159, -0.0217, -0.0158, -0.0145]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23068571 0.20460413 0.19401059 0.18904123 0.18165833]
np_weight_alpha[1] [0.20506364 0.21674368 0.19554843 0.19568226 0.18696207]
np_weight_alpha[2] [0.19441193 0.19560549 0.21326369 0.19873382 0.1979851 ]
np_weight_alpha[3] [0.18855904 0.1952767  0.19876881 0.21386647 0.20352899]
np_weight_alpha[4] [0.18168166 0.1865547  0.19718996 0.20261706 0.23195659]
-------------Round number:  790  -------------
client Accurancy:  0.4642857142857143
client Accurancy:  0.49603174603174605
client Accurancy:  0.45634920634920634
client Accurancy:  0.4126984126984127
client Accurancy:  0.3373015873015873
Average Global Accurancy:  0.43333333333333335
Average Global Trainning Accurancy:  0.7775510204081633
Average Global Trainning Loss:  0.6746834060772746
All users are selected
model: 0 tensor([0.2307, 0.2046, 0.1940, 0.1890, 0.1817], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0073, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0194, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0487, -0.0562, -0.0513,  0.0169, -0.0525],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2051, 0.2167, 0.1955, 0.1957, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0026, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0811, -0.0762, -0.0772, -0.0062, -0.0749],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1944, 0.1956, 0.2133, 0.1987, 0.1980], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1143, -0.1152, -0.1177, -0.0495, -0.1081],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1886, 0.1953, 0.1988, 0.2139, 0.2035], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.1106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.3586, 0.3584, 0.3524, 0.0902, 0.3484],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.04
model: 4 tensor([0.1817, 0.1866, 0.1972, 0.2026, 0.2320], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0078, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1141, -0.1119, -0.1074, -0.0513, -0.1107]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24170555 0.2202607  0.20387776 0.14139709 0.1927589 ]
np_weight_alpha[1] [0.20842004 0.2198762  0.19796017 0.1845277  0.18921591]
np_weight_alpha[2] [0.19688338 0.19825554 0.21708691 0.18857323 0.19920094]
np_weight_alpha[3] [0.18638368 0.19275926 0.19638775 0.22319026 0.20127901]
np_weight_alpha[4] [0.18450227 0.18863967 0.19804725 0.19239175 0.23641904]
-------------Round number:  791  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.5079365079365079
client Accurancy:  0.48412698412698413
client Accurancy:  0.4087301587301587
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4365079365079365
Average Global Trainning Accurancy:  0.7857142857142857
Average Global Trainning Loss:  0.6549514874309099
All users are selected
model: 0 tensor([0.2417, 0.2203, 0.2039, 0.1414, 0.1928], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0283, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0199, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[-0.0898, -0.0359, -0.0963, -0.1284, -0.0968],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 0.2
model: 1 tensor([0.2084, 0.2199, 0.1980, 0.1845, 0.1892], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0041, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0643, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.2019, 0.0514, 0.1900, 0.1749, 0.1992],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1969, 0.1983, 0.2171, 0.1886, 0.1992], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0022, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0143, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1476, -0.1061, -0.1453, -0.1256, -0.1402],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1864, 0.1928, 0.1964, 0.2232, 0.2013], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0040, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0391, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.1945, 0.2034, 0.1987, 0.1255, 0.1926],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 0.2
model: 4 tensor([0.1845, 0.1886, 0.1980, 0.1924, 0.2364], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0227, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.1233, -0.0744, -0.1166, -0.1079, -0.1196]], device='cuda:0')
teacher_idx: 4 grad_lr: 0.2
np_weight_alpha[0] [0.24377342 0.20750229 0.2030916  0.15343644 0.19219626]
np_weight_alpha[1] [0.1994406  0.2455041  0.19154882 0.18182632 0.18168013]
np_weight_alpha[2] [0.19950545 0.19271989 0.22019657 0.18722808 0.20034999]
np_weight_alpha[3] [0.18390647 0.18819158 0.1925276  0.23687223 0.19850208]
np_weight_alpha[4] [0.1868835  0.18168221 0.19862898 0.191433   0.24137236]
-------------Round number:  792  -------------
client Accurancy:  0.4801587301587302
client Accurancy:  0.5357142857142857
client Accurancy:  0.4722222222222222
client Accurancy:  0.4126984126984127
client Accurancy:  0.2976190476190476
Average Global Accurancy:  0.4396825396825397
Average Global Trainning Accurancy:  0.7863945578231293
Average Global Trainning Loss:  0.656438752258716
All users are selected
model: 0 tensor([0.2438, 0.2075, 0.2031, 0.1534, 0.1922], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0211, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0145, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0320,  0.0223,  0.0282, -0.0171,  0.0307],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.1994, 0.2455, 0.1915, 0.1818, 0.1817], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0140, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0310, 0.0619, 0.0322, 0.0223, 0.0317],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1995, 0.1927, 0.2202, 0.1872, 0.2003], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0031, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0085, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0304, -0.0383, -0.0331, -0.0460, -0.0316],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1839, 0.1882, 0.1925, 0.2369, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0067, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0003, -0.0012,  0.0011,  0.0286,  0.0003],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1869, 0.1817, 0.1986, 0.1914, 0.2414], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0115, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0159, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0186, -0.0287, -0.0224, -0.0379, -0.0173]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23260234 0.20368771 0.19343911 0.1893238  0.180947  ]
np_weight_alpha[1] [0.2040059  0.22000252 0.19493547 0.19507344 0.18598264]
np_weight_alpha[2] [0.19394179 0.19500236 0.21796371 0.19718002 0.19591212]
np_weight_alpha[3] [0.20836033 0.22097811 0.21300387 0.13364281 0.2240149 ]
np_weight_alpha[4] [0.18059008 0.18510976 0.19521011 0.2035045  0.23558551]
-------------Round number:  793  -------------
client Accurancy:  0.4523809523809524
client Accurancy:  0.503968253968254
client Accurancy:  0.46825396825396826
client Accurancy:  0.4126984126984127
client Accurancy:  0.3253968253968254
Average Global Accurancy:  0.43253968253968256
Average Global Trainning Accurancy:  0.7833333333333333
Average Global Trainning Loss:  0.6637202879198555
All users are selected
model: 0 tensor([0.2326, 0.2037, 0.1934, 0.1893, 0.1809], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0162, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0271, 0.0178, 0.0435, 0.0289, 0.0260],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2040, 0.2200, 0.1949, 0.1951, 0.1860], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0033, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0106, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0019, 0.0105, 0.0273, 0.0132, 0.0100],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1939, 0.1950, 0.2180, 0.1972, 0.1959], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0020, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0299, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0266,  0.0259, -0.0322,  0.0143,  0.0205],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2084, 0.2210, 0.2130, 0.1336, 0.2240], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0283, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0101, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0059,  0.0008, -0.0070, -0.1116, -0.0087],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1806, 0.1851, 0.1952, 0.2035, 0.2356], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0095, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0169, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0314, -0.0319, -0.0193, -0.0303, -0.0284]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23588622 0.21388555 0.17871165 0.18833402 0.18318252]
np_weight_alpha[1] [0.21458158 0.22262084 0.18062183 0.19389713 0.18827856]
np_weight_alpha[2] [0.17716008 0.17879252 0.26806384 0.19151223 0.18447138]
np_weight_alpha[3] [0.18784419 0.19348124 0.19334616 0.21932955 0.2059989 ]
np_weight_alpha[4] [0.18349162 0.18814097 0.18580297 0.20459461 0.23796983]
-------------Round number:  794  -------------
client Accurancy:  0.4365079365079365
client Accurancy:  0.4801587301587302
client Accurancy:  0.4642857142857143
client Accurancy:  0.42063492063492064
client Accurancy:  0.3492063492063492
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.7748299319727892
Average Global Trainning Loss:  0.692984693877551
All users are selected
model: 0 tensor([0.2359, 0.2139, 0.1787, 0.1883, 0.1832], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0118, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0431, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0211, 0.1059, 0.0712, 0.0906, 0.0891],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 0.2
model: 1 tensor([0.2146, 0.2226, 0.1806, 0.1939, 0.1883], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0286, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0860, 0.0180, 0.0404, 0.0620, 0.0638],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 0.2
model: 2 tensor([0.1772, 0.1788, 0.2681, 0.1915, 0.1845], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0296, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0097, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0638, -0.0723, -0.0102, -0.0663, -0.0715],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 0.2
model: 3 tensor([0.1878, 0.1935, 0.1933, 0.2193, 0.2060], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0216, -0.0378, -0.0375, -0.0364],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1835, 0.1881, 0.1858, 0.2046, 0.2380], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0104, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0188, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0326, -0.0562, -0.0504, -0.0444]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2505618  0.20621875 0.17906803 0.1842874  0.17986397]
np_weight_alpha[1] [0.20757332 0.23129857 0.18332191 0.19172831 0.1860779 ]
np_weight_alpha[2] [0.17755084 0.18052308 0.2651032  0.1912385  0.18558444]
np_weight_alpha[3] [0.17410816 0.18509188 0.20059866 0.2280794  0.21212192]
np_weight_alpha[4] [0.17059869 0.17797574 0.19799061 0.21119048 0.24224444]
-------------Round number:  795  -------------
client Accurancy:  0.503968253968254
client Accurancy:  0.5436507936507936
client Accurancy:  0.48412698412698413
client Accurancy:  0.40476190476190477
client Accurancy:  0.3134920634920635
Average Global Accurancy:  0.45
Average Global Trainning Accurancy:  0.7952380952380952
Average Global Trainning Loss:  0.6244388087266156
All users are selected
model: 0 tensor([0.2506, 0.2062, 0.1791, 0.1843, 0.1799], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0184, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0150, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0520, 0.0344, 0.0179, 0.0298, 0.0352],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2076, 0.2313, 0.1833, 0.1917, 0.1861], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0088, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0268, 0.0376, 0.0129, 0.0205, 0.0266],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1776, 0.1805, 0.2651, 0.1912, 0.1856], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0270, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0063, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0470, -0.0443,  0.0221, -0.0365, -0.0407],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1741, 0.1851, 0.2006, 0.2281, 0.2121], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0060, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0215, -0.0179, -0.0044,  0.0088,  0.0024],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1706, 0.1780, 0.1980, 0.2112, 0.2422], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0163, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0167, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0288, -0.0272, -0.0196, -0.0134, -0.0143]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.23415266 0.20484507 0.19424267 0.18787958 0.17888002]
np_weight_alpha[1] [0.2053703  0.21911708 0.19506463 0.19577648 0.18467149]
np_weight_alpha[2] [0.19524543 0.19544709 0.21404177 0.19838132 0.1968844 ]
np_weight_alpha[3] [0.18921791 0.19634908 0.19828539 0.21304557 0.20310201]
np_weight_alpha[4] [0.17892918 0.18416105 0.19595848 0.20286565 0.23808557]
-------------Round number:  796  -------------
client Accurancy:  0.4603174603174603
client Accurancy:  0.4880952380952381
client Accurancy:  0.45634920634920634
client Accurancy:  0.4246031746031746
client Accurancy:  0.34523809523809523
Average Global Accurancy:  0.43492063492063493
Average Global Trainning Accurancy:  0.7874149659863946
Average Global Trainning Loss:  0.6430490091544431
All users are selected
model: 0 tensor([0.2342, 0.2048, 0.1942, 0.1879, 0.1789], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0091, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0134, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0352, 0.0258, 0.0293, 0.0296, 0.0274],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2054, 0.2191, 0.1951, 0.1958, 0.1847], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0034, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0098, 0.0156, 0.0119, 0.0153, 0.0129],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1952, 0.1954, 0.2140, 0.1984, 0.1969], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0013, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0152, -0.0169, -0.0181, -0.0163, -0.0139],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1892, 0.1963, 0.1983, 0.2130, 0.2031], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0016, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0020, -0.0009, -0.0040, -0.0051, -0.0066],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1789, 0.1842, 0.1960, 0.2029, 0.2381], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0108, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0158, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0249, -0.0237, -0.0217, -0.0258, -0.0184]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2296805  0.20798048 0.19375056 0.18741515 0.18117335]
np_weight_alpha[1] [0.20851427 0.21701115 0.19599083 0.1933637  0.18512006]
np_weight_alpha[2] [0.19428839 0.19615537 0.2165652  0.19841348 0.19457754]
np_weight_alpha[3] [0.18101247 0.18230711 0.19913384 0.22015613 0.21739045]
np_weight_alpha[4] [0.18100452 0.18468817 0.19392277 0.20491335 0.23547117]
-------------Round number:  797  -------------
client Accurancy:  0.4444444444444444
client Accurancy:  0.503968253968254
client Accurancy:  0.4801587301587302
client Accurancy:  0.4126984126984127
client Accurancy:  0.32936507936507936
Average Global Accurancy:  0.43412698412698414
Average Global Trainning Accurancy:  0.7870748299319728
Average Global Trainning Loss:  0.6563268129517432
All users are selected
model: 0 tensor([0.2297, 0.2080, 0.1938, 0.1874, 0.1812], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0075, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0131, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0204, 0.0237, 0.0139, 0.0167, 0.0156],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2085, 0.2170, 0.1960, 0.1934, 0.1851], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0032, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0241, 0.0185, 0.0141, 0.0170, 0.0154],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1962, 0.2166, 0.1984, 0.1946], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0018, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0071, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0317, -0.0315, -0.0259, -0.0246, -0.0258],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1810, 0.1823, 0.1991, 0.2202, 0.2174], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0069, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0033, -0.0073,  0.0088,  0.0085,  0.0178],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 5.0
model: 4 tensor([0.1810, 0.1847, 0.1939, 0.2049, 0.2355], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0096, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0147, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0150, -0.0152, -0.0112, -0.0127, -0.0080]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22868514 0.20171972 0.19735993 0.18850961 0.18372564]
np_weight_alpha[1] [0.20198575 0.21674395 0.19950213 0.19403236 0.18773587]
np_weight_alpha[2] [0.19793932 0.19965284 0.21492256 0.19501378 0.19247146]
np_weight_alpha[3] [0.2204645  0.24523303 0.17852964 0.19949736 0.15627553]
np_weight_alpha[4] [0.18356483 0.18719015 0.19206683 0.20445323 0.232725  ]
-------------Round number:  798  -------------
client Accurancy:  0.47619047619047616
client Accurancy:  0.5079365079365079
client Accurancy:  0.46825396825396826
client Accurancy:  0.38492063492063494
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.43174603174603177
Average Global Trainning Accurancy:  0.7687074829931972
Average Global Trainning Loss:  0.6998183062287415
All users are selected
model: 0 tensor([0.2287, 0.2017, 0.1974, 0.1885, 0.1837], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0061, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0138, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0272, 0.0245, 0.0302, 0.0255, 0.0295],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2020, 0.2167, 0.1995, 0.1940, 0.1877], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0077, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0213, 0.0249, 0.0278, 0.0208, 0.0249],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1979, 0.1997, 0.2149, 0.1950, 0.1925], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0015, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0064, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0221, -0.0217, -0.0238, -0.0292, -0.0319],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.2205, 0.2452, 0.1785, 0.1995, 0.1563], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0242, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0066, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0221,  0.0396, -0.0307, -0.0234, -0.0588],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1836, 0.1872, 0.1921, 0.2045, 0.2327], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0079, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0172, -0.0187, -0.0254, -0.0167, -0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.2303024  0.20397183 0.19393241 0.19000088 0.1817925 ]
np_weight_alpha[1] [0.20441431 0.21614665 0.19550309 0.19695923 0.1869767 ]
np_weight_alpha[2] [0.19427146 0.19552551 0.21327992 0.19841242 0.19851066]
np_weight_alpha[3] [0.18830052 0.19534136 0.19879515 0.21285416 0.20470887]
np_weight_alpha[4] [0.18176803 0.1865244  0.19765131 0.2012969  0.23275936]
-------------Round number:  799  -------------
client Accurancy:  0.45634920634920634
client Accurancy:  0.5
client Accurancy:  0.45634920634920634
client Accurancy:  0.4166666666666667
client Accurancy:  0.32142857142857145
Average Global Accurancy:  0.4301587301587302
Average Global Trainning Accurancy:  0.7843537414965986
Average Global Trainning Loss:  0.6618390764508929
All users are selected
model: 0 tensor([0.2303, 0.2040, 0.1939, 0.1900, 0.1818], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0070, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0127, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0344, 0.0264, 0.0301, 0.0330, 0.0302],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 0 grad_lr: 1.0
model: 1 tensor([0.2044, 0.2161, 0.1955, 0.1970, 0.1870], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0024, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0076, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0116, 0.0162, 0.0140, 0.0198, 0.0168],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.0000, 0.0000, 0.0000, 0.0000]], device='cuda:0')
teacher_idx: 1 grad_lr: 1.0
model: 2 tensor([0.1943, 0.1955, 0.2133, 0.1984, 0.1985], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0012, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0144, -0.0157, -0.0157, -0.0138, -0.0101],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 2 grad_lr: 1.0
model: 3 tensor([0.1883, 0.1953, 0.1988, 0.2129, 0.2047], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0017, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0074, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0127, -0.0108, -0.0128, -0.0156, -0.0143],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000]], device='cuda:0')
teacher_idx: 3 grad_lr: 1.0
model: 4 tensor([0.1818, 0.1865, 0.1977, 0.2013, 0.2328], device='cuda:0',
       grad_fn=<SelectBackward>) tensor([0.2000, 0.2000, 0.2000, 0.2000, 0.2000], device='cuda:0')
loss_penalty: tensor(0.0080, device='cuda:0', grad_fn=<AddBackward0>)
loss: tensor(0.0148, device='cuda:0', grad_fn=<AddBackward0>)
weight.grad: tensor([[ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
        [-0.0198, -0.0186, -0.0163, -0.0236, -0.0175]], device='cuda:0')
teacher_idx: 4 grad_lr: 1.0
np_weight_alpha[0] [0.22786303 0.20786195 0.19411899 0.18759948 0.18255654]
np_weight_alpha[1] [0.20836008 0.21592359 0.19695638 0.19270337 0.18605657]
np_weight_alpha[2] [0.19466852 0.1971562  0.21544033 0.19815199 0.19458294]
np_weight_alpha[3] [0.18792725 0.19279794 0.19810416 0.21555047 0.2056202 ]
np_weight_alpha[4] [0.18242633 0.18571301 0.19407922 0.2050202  0.23276116]
Cifar10_FedAvg_0.005_1.0_15_5u_20b_20_0
std: 0.0
Mean: 0.46904761904761905
